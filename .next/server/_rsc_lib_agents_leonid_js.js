"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_rsc_lib_agents_leonid_js";
exports.ids = ["_rsc_lib_agents_leonid_js"];
exports.modules = {

/***/ "(rsc)/./lib/agents/leonid.js":
/*!******************************!*\
  !*** ./lib/agents/leonid.js ***!
  \******************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("\nconst crypto = __webpack_require__(/*! crypto */ \"crypto\");\nconst { wrapAgentOutput, unwrapLegacy } = __webpack_require__(/*! ../../utils/agentEnvelope.js */ \"(rsc)/./utils/agentEnvelope.js\");\nconst inputDefaults = {\n    mode: \"deep\",\n    channel: \"multi\",\n    tone_pack: \"mixed\",\n    goal: \"get_reply\",\n    product_name: \"AgentOS\",\n    product_one_liner: \"автоматизация продаж/поддержки/контента через ИИ-агентов: лиды, ответы, CRM-рутины, репутация\",\n    constraints: {\n        max_chars_first: 280,\n        max_chars_followup: 240,\n        no_links: false\n    },\n    anatoly_output_json: null,\n    artem_output_json: null,\n    lead_identity: {\n        company_name: \"\",\n        brand: \"\",\n        city: \"\"\n    },\n    language: \"ru\"\n};\nconst inputSchema = {\n    type: \"object\",\n    additionalProperties: false,\n    properties: {\n        mode: {\n            type: \"string\",\n            enum: [\n                \"quick\",\n                \"deep\"\n            ],\n            default: \"deep\"\n        },\n        channel: {\n            type: \"string\",\n            enum: [\n                \"telegram\",\n                \"vk\",\n                \"whatsapp\",\n                \"multi\"\n            ],\n            default: \"multi\"\n        },\n        tone_pack: {\n            type: \"string\",\n            enum: [\n                \"neutral\",\n                \"business\",\n                \"short_hard\",\n                \"mixed\"\n            ],\n            default: \"mixed\"\n        },\n        goal: {\n            type: \"string\",\n            enum: [\n                \"get_reply\",\n                \"qualify\",\n                \"book_call\",\n                \"send_audit\"\n            ],\n            default: \"get_reply\"\n        },\n        product_name: {\n            type: \"string\"\n        },\n        product_one_liner: {\n            type: \"string\"\n        },\n        constraints: {\n            type: \"object\",\n            properties: {\n                max_chars_first: {\n                    type: \"number\",\n                    default: 280\n                },\n                max_chars_followup: {\n                    type: \"number\",\n                    default: 240\n                },\n                no_links: {\n                    type: \"boolean\",\n                    default: false\n                }\n            }\n        },\n        anatoly_output_json: {\n            type: [\n                \"object\",\n                \"null\"\n            ]\n        },\n        artem_output_json: {\n            type: [\n                \"object\",\n                \"null\"\n            ]\n        },\n        lead_identity: {\n            type: [\n                \"object\",\n                \"null\"\n            ]\n        },\n        language: {\n            type: \"string\",\n            default: \"ru\"\n        }\n    },\n    required: [\n        \"mode\"\n    ],\n    default: inputDefaults\n};\nconst outputSchema = {\n    type: \"object\",\n    required: [\n        \"dm_pack\",\n        \"meta\"\n    ],\n    additionalProperties: false,\n    properties: {\n        dm_pack: {\n            type: \"object\"\n        },\n        meta: {\n            type: \"object\"\n        }\n    }\n};\nconst systemPrompt = `Ты — ИИ-агент agentOS: \"Леонид — Аутрич в мессенджерах\".\nРоль: писать короткие DM без воды и без выдумок по входному JSON.`;\nconst leonidAgent = {\n    id: \"leonid-outreach-dm-ru\",\n    displayName: \"Леонид — Аутрич в мессенджерах\",\n    description: \"Генерирует короткие DM для Telegram/VK/WhatsApp на основе разборов/горячих сигналов.\",\n    inputSchema,\n    outputSchema,\n    systemPrompt\n};\nconst wrapOutput = (legacyOutput, input)=>wrapAgentOutput({\n        agentId: leonidAgent.id,\n        inputEcho: input,\n        mode: input.mode,\n        legacyOutput\n    });\nconst fluffBlacklist = [\n    \"лидер рынка\",\n    \"инновацион\",\n    \"синерг\",\n    \"под ключ\",\n    \"революцион\",\n    \"уникальн\",\n    \"лучший\",\n    \"гарантир\",\n    \"рост продаж\"\n];\nconst sanitizeText = (text, constraints)=>{\n    const trimmed = text.replace(/\\s+$/g, \"\").trim();\n    if (constraints.no_links) {\n        const hadLinks = /https?:\\/\\/\\S+|\\bссылк[а-я]*\\b|\\bлинк[а-я]*\\b|\\blink\\b/gi.test(trimmed);\n        const stripped = trimmed.replace(/https?:\\/\\/\\S+/gi, \" \").replace(/ссылк[а-я]*/gi, \" \").replace(/линк[а-я]*/gi, \" \").replace(/\\blink\\b/gi, \" \").replace(/\\s+/g, \" \").trim();\n        if (hadLinks) {\n            return `${stripped}${stripped ? \". \" : \"\"}Скину текстом.`.trim();\n        }\n        return stripped;\n    }\n    return trimmed;\n};\nconst clampText = (text, max)=>{\n    if (!text) return \"\";\n    if (text.length <= max) return text;\n    return text.slice(0, max - 1).trim() + \"…\";\n};\nconst dedupeArray = (arr)=>Array.from(new Set(arr.filter((item)=>item !== undefined)));\nconst normalizeInput = (input)=>{\n    const safe = typeof input === \"object\" && input !== null ? input : {};\n    const mode = safe.mode === \"quick\" ? \"quick\" : \"deep\";\n    const tone_pack = [\n        \"neutral\",\n        \"business\",\n        \"short_hard\",\n        \"mixed\"\n    ].includes(safe.tone_pack) ? safe.tone_pack : \"mixed\";\n    return {\n        mode,\n        channel: [\n            \"telegram\",\n            \"vk\",\n            \"whatsapp\",\n            \"multi\"\n        ].includes(safe.channel) ? safe.channel : \"multi\",\n        tone_pack,\n        goal: [\n            \"get_reply\",\n            \"qualify\",\n            \"book_call\",\n            \"send_audit\"\n        ].includes(safe.goal) ? safe.goal : \"get_reply\",\n        product_name: typeof safe.product_name === \"string\" && safe.product_name.trim() ? safe.product_name.trim() : \"AgentOS\",\n        product_one_liner: typeof safe.product_one_liner === \"string\" && safe.product_one_liner.trim() ? safe.product_one_liner.trim() : inputDefaults.product_one_liner,\n        constraints: {\n            max_chars_first: typeof safe.constraints?.max_chars_first === \"number\" ? Math.max(60, Math.round(safe.constraints.max_chars_first)) : 280,\n            max_chars_followup: typeof safe.constraints?.max_chars_followup === \"number\" ? Math.max(60, Math.round(safe.constraints.max_chars_followup)) : 240,\n            no_links: safe.constraints?.no_links === true\n        },\n        anatoly_output_json: safe.anatoly_output_json ?? null,\n        artem_output_json: safe.artem_output_json ?? null,\n        lead_identity: safe.lead_identity ?? {},\n        language: safe.language === \"ru\" ? \"ru\" : \"ru\"\n    };\n};\nconst extractAnatolyData = (anatoly)=>{\n    if (!anatoly || typeof anatoly !== \"object\") return null;\n    const account = anatoly.account_card || anatoly.accountCard || null;\n    if (!account || typeof account !== \"object\") return null;\n    const hooks = Array.isArray(account.top_personalization_hooks) ? account.top_personalization_hooks : [];\n    const pains = Array.isArray(account.pain_hypotheses) ? account.pain_hypotheses : [];\n    const primaryHook = hooks[0] || null;\n    const secondaryHook = hooks[1] || null;\n    const primaryPain = pains[0] || null;\n    const companyName = account.company_name || \"\";\n    const proofItems = Array.isArray(anatoly.meta?.proof_items) ? anatoly.meta.proof_items : [];\n    return {\n        companyName,\n        hooks: hooks.slice(0, 2),\n        primaryHook,\n        secondaryHook,\n        primaryPain,\n        proofItems\n    };\n};\nconst extractArtemData = (artem)=>{\n    if (!artem || typeof artem !== \"object\") return null;\n    const leads = Array.isArray(artem.hot_leads) ? artem.hot_leads : [];\n    if (leads.length === 0) return null;\n    const topLead = leads[0];\n    const proofItems = Array.isArray(artem.meta?.proof_items) ? artem.meta.proof_items : [];\n    return {\n        topLead,\n        proofItems\n    };\n};\nconst buildPersonalizationFromAnatoly = (anatolyData)=>{\n    if (!anatolyData) return null;\n    const hook = anatolyData.primaryHook || anatolyData.secondaryHook;\n    const pain = anatolyData.primaryPain;\n    const personalizationLine = hook?.hook_text ? `Вижу у вас: ${clampText(hook.hook_text, 120)}.` : null;\n    const valueLine = pain?.hypothesis ? `Есть гипотеза, где можно снять нагрузку: ${clampText(pain.hypothesis, 120)}.` : \"Есть гипотеза, где можно ускорить процессы без переработок.\";\n    let refs = dedupeArray([\n        ...hook?.related_proofs ?? [],\n        ...pain?.related_proofs ?? []\n    ]).filter((item)=>typeof item === \"number\");\n    if (refs.length === 0 && anatolyData.proofItems.length > 0) {\n        refs = [\n            0\n        ];\n    }\n    return {\n        personalizationLine,\n        valueLine,\n        groundingRefs: refs\n    };\n};\nconst buildPersonalizationFromArtem = (artemData)=>{\n    if (!artemData) return null;\n    const lead = artemData.topLead;\n    const reason = lead?.hot_reasons?.[0] || lead?.request_summary || \"\";\n    const category = lead?.category_hint ? `по теме ${lead.category_hint}` : \"\";\n    const personalizationLine = clampText(removePersonalData(`Есть открытый сигнал ${category}: ${reason}`.trim()), 140);\n    const valueLine = \"Есть идеи, как быстро помочь и снять узкие места.\";\n    let refs = Array.isArray(lead?.proof_refs) ? lead.proof_refs : [];\n    if (refs.length === 0 && artemData.proofItems.length > 0) {\n        refs = [\n            0\n        ];\n    }\n    return {\n        personalizationLine,\n        valueLine,\n        groundingRefs: refs,\n        lead\n    };\n};\nconst buildQuestionLine = (goal)=>{\n    switch(goal){\n        case \"qualify\":\n            return \"Кто у вас отвечает за это направление?\";\n        case \"book_call\":\n            return \"Удобно коротко созвониться на 10 минут?\";\n        case \"send_audit\":\n            return \"Скинуть мини-аудит на 5 пунктов?\";\n        case \"get_reply\":\n        default:\n            return \"Актуально обсудить?\";\n    }\n};\nconst buildCtaLine = (goal)=>{\n    switch(goal){\n        case \"send_audit\":\n            return \"Могу сделать мини-аудит и прислать в чате.\";\n        case \"book_call\":\n            return \"Если ок, предложу пару слотов на созвон.\";\n        case \"qualify\":\n            return \"Могу коротко описать, как это закрываем за 3–7 дней.\";\n        case \"get_reply\":\n        default:\n            return \"Могу скинуть 3 идеи/мини-аудит, если интересно.\";\n    }\n};\nconst buildObjectionPreemptLine = (tone)=>{\n    if (tone === \"business\") {\n        return \"Если не в приоритете сейчас, просто дайте знать, и я не буду давить.\";\n    }\n    if (tone === \"short_hard\") {\n        return \"Если неактуально, ок, закрою тему без лишних сообщений.\";\n    }\n    return \"\";\n};\nconst removePersonalData = (text)=>String(text || \"\").replace(/[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,}/gi, \"[контакт скрыт]\").replace(/(\\+7|8)\\s?\\(?\\d{3}\\)?[\\s-]?\\d{3}[\\s-]?\\d{2}[\\s-]?\\d{2}/g, \"[телефон скрыт]\");\nconst applyChannelToneTweaks = (line, channel)=>{\n    const text = String(line || \"\").trim();\n    if (!text) return text;\n    if (channel === \"whatsapp\") {\n        if (/актуально обсудить\\?/i.test(text)) return \"Если тема актуальна, могу аккуратно подсказать шаги?\";\n        return text.replace(/Коротко:/i, \"Коротко и мягко:\");\n    }\n    if (channel === \"telegram\") {\n        return clampText(text, 120);\n    }\n    if (channel === \"vk\") {\n        return text.replace(/Привет!/i, \"Добрый день!\");\n    }\n    return text;\n};\nconst buildChannelTweaks = ()=>({\n        TG: \"Коротко и по делу, минимальные формулировки.\",\n        VK: \"Чуть формальнее, один чёткий вопрос в конце.\",\n        WA: \"Мягче по тону, без резкого давления и с вежливым заходом.\"\n    });\nconst tonePrefix = (tone)=>{\n    if (tone === \"business\") return \"Добрый день!\";\n    if (tone === \"short_hard\") return \"Коротко:\";\n    return \"Привет!\";\n};\nconst composeMessage = ({ personalizationLine, valueLine, questionLine, ctaLine, tone, channel, objectionPreemptLine })=>{\n    const lines = [];\n    const prefix = tonePrefix(tone);\n    if (personalizationLine) {\n        lines.push(prefix ? `${prefix} ${personalizationLine}` : personalizationLine);\n    } else if (prefix) {\n        lines.push(prefix);\n    }\n    if (valueLine) lines.push(valueLine);\n    if (objectionPreemptLine) lines.push(objectionPreemptLine);\n    if (questionLine) lines.push(questionLine);\n    if (ctaLine) lines.push(ctaLine);\n    return lines.map((line)=>removePersonalData(line)).map((line)=>applyChannelToneTweaks(line, channel));\n};\nconst trimMessageToLimit = (lines, maxChars)=>{\n    let text = lines.join(\"\\n\");\n    if (text.length <= maxChars) return {\n        text,\n        lines\n    };\n    const reduced = [\n        ...lines\n    ];\n    if (reduced.length > 4) reduced.splice(2, 1);\n    text = reduced.join(\"\\n\");\n    if (text.length <= maxChars) return {\n        text,\n        lines: reduced\n    };\n    if (reduced.length > 3) {\n        reduced.splice(1, 1);\n    }\n    text = reduced.join(\"\\n\");\n    if (text.length <= maxChars) return {\n        text,\n        lines: reduced\n    };\n    const shortened = reduced.map((line)=>clampText(line, Math.max(40, Math.floor(maxChars / 3))));\n    return {\n        text: shortened.join(\"\\n\"),\n        lines: shortened\n    };\n};\nconst buildFollowups = (tone, goal, personalizationLine, groundingRefs, maxChars, channel, constraints, count = 3)=>{\n    const followups = [];\n    const templates = [\n        {\n            angle: \"reminder\",\n            text: `Напомню про сообщение выше. Могу кратко подсветить 2–3 точки для улучшения.`\n        },\n        {\n            angle: \"value_drop\",\n            text: `Если полезно, пришлю мини-аудит в 5 пунктов без обязательств.`\n        },\n        {\n            angle: \"breakup\",\n            text: `Если не актуально — просто скажите, чтобы не отвлекать.`\n        }\n    ];\n    const offsets = count === 2 ? [\n        2,\n        7\n    ] : [\n        1,\n        4,\n        7\n    ];\n    for(let i = 0; i < Math.min(count, templates.length); i += 1){\n        const template = templates[i];\n        let text = template.text;\n        if (tone === \"short_hard\") {\n            text = text.replace(\"Если полезно, \", \"\").replace(\"без обязательств\", \"\");\n        }\n        if (tone === \"business\") {\n            text = `Коллеги, ${text}`;\n        }\n        text = applyChannelToneTweaks(removePersonalData(text), channel);\n        const finalText = sanitizeText(clampText(text, maxChars), constraints);\n        followups.push({\n            day_offset: offsets[i],\n            text: finalText,\n            tone,\n            angle: template.angle,\n            grounding_refs: groundingRefs\n        });\n    }\n    return followups;\n};\nconst buildMessageSet = ({ personalizationLine, valueLine, groundingRefs, tone, channel, goal, constraints, followupCount })=>{\n    const questionLine = buildQuestionLine(goal);\n    const ctaLine = buildCtaLine(goal);\n    const objectionPreemptLine = buildObjectionPreemptLine(tone);\n    const lines = composeMessage({\n        personalizationLine,\n        valueLine,\n        questionLine,\n        ctaLine,\n        tone,\n        channel,\n        objectionPreemptLine\n    });\n    const trimmed = trimMessageToLimit(lines, constraints.max_chars_first);\n    const sanitizedText = sanitizeText(trimmed.text, constraints);\n    const first_message = {\n        text: sanitizedText,\n        tone,\n        personalization_line: personalizationLine || \"\",\n        objection_preempt_line: objectionPreemptLine,\n        question_line: questionLine,\n        cta_line: ctaLine,\n        grounding_refs: groundingRefs\n    };\n    const followups = buildFollowups(tone, goal, personalizationLine, groundingRefs, constraints.max_chars_followup, channel, constraints, followupCount);\n    return {\n        first_message,\n        followups\n    };\n};\nconst buildLeadLabel = (anatolyData, artemData, leadIdentity)=>{\n    if (anatolyData?.companyName) return anatolyData.companyName;\n    if (leadIdentity?.company_name) return leadIdentity.company_name;\n    if (artemData?.topLead?.title) return `Hot lead: ${artemData.topLead.title}`;\n    return \"Hot lead\";\n};\nconst containsFluff = (text)=>fluffBlacklist.some((word)=>text.toLowerCase().includes(word));\nconst validateQuality = (messages, constraints, usedPersonalization)=>{\n    const allTexts = messages.flatMap((item)=>[\n            {\n                text: item.first_message.text,\n                limit: constraints.max_chars_first\n            },\n            ...item.followups.map((f)=>({\n                    text: f.text,\n                    limit: constraints.max_chars_followup\n                }))\n        ]);\n    const withinCharLimits = allTexts.every(({ text, limit })=>text.length <= limit);\n    const noFluff = !allTexts.some(({ text })=>containsFluff(text));\n    return {\n        no_fluff: noFluff,\n        within_char_limits: withinCharLimits,\n        no_fabrication: true,\n        has_personalization: usedPersonalization\n    };\n};\nconst generateOutput = async (rawInput = {}, options = {})=>{\n    const input = normalizeInput(rawInput);\n    const anatolyData = extractAnatolyData(input.anatoly_output_json);\n    const artemData = extractArtemData(input.artem_output_json);\n    if (!anatolyData && !artemData) {\n        const messageText = \"Пришли разбор Марии (JSON) или hot-leads Артёма, чтобы я сделал персонализацию.\";\n        const output = {\n            dm_pack: {\n                lead_label: \"Нужны данные\",\n                channel: input.channel,\n                channel_tweaks: buildChannelTweaks(),\n                messages: {\n                    first_message: {\n                        text: clampText(messageText, input.constraints.max_chars_first),\n                        tone: \"neutral\",\n                        personalization_line: \"\",\n                        objection_preempt_line: \"\",\n                        question_line: messageText,\n                        cta_line: \"\",\n                        grounding_refs: []\n                    },\n                    followups: []\n                }\n            },\n            meta: {\n                generated_at: new Date().toISOString(),\n                used_inputs: {\n                    used_anatoly: false,\n                    used_artem: false\n                },\n                limitations: [\n                    \"Нет входных JSON для персонализации.\"\n                ],\n                assumptions: [],\n                link_policy: {\n                    no_links: input.constraints.no_links,\n                    replacement: \"Скину текстом.\"\n                },\n                safety: {\n                    no_personal_data: true,\n                    no_stalking: true\n                },\n                quality_checks: {\n                    no_fluff: true,\n                    within_char_limits: true,\n                    no_fabrication: true,\n                    has_personalization: false\n                },\n                needsReview: true\n            }\n        };\n        return {\n            output: wrapOutput(output, input),\n            effectiveInput: input\n        };\n    }\n    const messageSets = [];\n    const variants = [];\n    if (anatolyData) {\n        const personalization = buildPersonalizationFromAnatoly(anatolyData);\n        if (personalization) {\n            messageSets.push({\n                label: anatolyData.companyName || \"Company\",\n                source: \"anatoly\",\n                personalization\n            });\n        }\n    }\n    if (artemData) {\n        const personalization = buildPersonalizationFromArtem(artemData);\n        if (personalization) {\n            messageSets.push({\n                label: artemData.topLead?.title ? `Hot lead: ${artemData.topLead.title}` : \"Hot lead\",\n                source: \"artem\",\n                personalization\n            });\n        }\n    }\n    const tones = input.tone_pack === \"mixed\" ? [\n        \"neutral\",\n        \"business\",\n        \"short_hard\"\n    ] : [\n        input.tone_pack\n    ];\n    const followupCount = input.tone_pack === \"mixed\" ? 2 : 3;\n    messageSets.forEach((set)=>{\n        tones.forEach((tone)=>{\n            const messageSet = buildMessageSet({\n                personalizationLine: set.personalization.personalizationLine,\n                valueLine: set.personalization.valueLine,\n                groundingRefs: set.personalization.groundingRefs,\n                tone,\n                channel: input.channel === \"multi\" ? \"telegram\" : input.channel,\n                goal: input.goal,\n                constraints: input.constraints,\n                followupCount\n            });\n            variants.push({\n                label: set.label,\n                tone,\n                ...messageSet\n            });\n        });\n    });\n    const primary = variants[0];\n    const leadLabel = buildLeadLabel(anatolyData, artemData, input.lead_identity);\n    const dm_pack = {\n        lead_label: leadLabel,\n        channel: input.channel,\n        channel_tweaks: buildChannelTweaks(),\n        messages: primary ? {\n            first_message: primary.first_message,\n            followups: primary.followups\n        } : {\n            first_message: {\n                text: \"\",\n                tone: \"neutral\",\n                personalization_line: \"\",\n                objection_preempt_line: \"\",\n                question_line: \"\",\n                cta_line: \"\",\n                grounding_refs: []\n            },\n            followups: []\n        },\n        variants: variants.length > 1 ? variants.map((variant)=>({\n                label: variant.label,\n                tone: variant.tone,\n                first_message: variant.first_message,\n                followups: variant.followups\n            })) : undefined\n    };\n    const usedPersonalization = variants.some((variant)=>variant.first_message.personalization_line);\n    const quality = validateQuality(variants, input.constraints, usedPersonalization);\n    const fromHotLead = Boolean(artemData);\n    const output = {\n        dm_pack,\n        meta: {\n            generated_at: new Date().toISOString(),\n            used_inputs: {\n                used_anatoly: Boolean(anatolyData),\n                used_artem: Boolean(artemData)\n            },\n            limitations: [],\n            assumptions: [],\n            link_policy: {\n                no_links: input.constraints.no_links,\n                replacement: \"Скину текстом.\"\n            },\n            safety: {\n                no_personal_data: true,\n                no_stalking: fromHotLead\n            },\n            quality_checks: quality,\n            needsReview: !usedPersonalization\n        }\n    };\n    return {\n        output: wrapOutput(output, input),\n        effectiveInput: input\n    };\n};\nconst generateLeonidOutput = async (input = {}, options = {})=>{\n    const result = await generateOutput(input, options);\n    return result.output;\n};\nconst validateLeonidOutput = (payload)=>{\n    const errors = [];\n    const legacy = unwrapLegacy(payload);\n    if (!legacy || typeof legacy !== \"object\") {\n        return {\n            valid: false,\n            errors: [\n                \"Output must be an object.\"\n            ]\n        };\n    }\n    payload = legacy;\n    if (!payload.dm_pack) errors.push(\"dm_pack required\");\n    if (!payload.meta) errors.push(\"meta required\");\n    if (payload.dm_pack && !payload.dm_pack.channel_tweaks) {\n        errors.push(\"dm_pack.channel_tweaks required\");\n    }\n    if (!payload.meta?.link_policy || typeof payload.meta.link_policy.no_links !== \"boolean\") {\n        errors.push(\"meta.link_policy required\");\n    }\n    return {\n        valid: errors.length === 0,\n        errors\n    };\n};\nmodule.exports = {\n    inputDefaults,\n    inputSchema,\n    outputSchema,\n    systemPrompt,\n    leonidAgent,\n    normalizeInput,\n    generateOutput,\n    generateLeonidOutput,\n    validateLeonidOutput\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UUFBUTdMLE9BQU8sQ0FBQzBKLGNBQWMsRUFBRTtRQUN0RG9DLE9BQU81RixJQUFJLENBQUM7SUFDZDtJQUNBLElBQUksQ0FBQzJGLFFBQVE1TCxJQUFJLEVBQUVrSyxlQUFlLE9BQU8wQixRQUFRNUwsSUFBSSxDQUFDa0ssV0FBVyxDQUFDbkwsUUFBUSxLQUFLLFdBQVc7UUFDeEY4TSxPQUFPNUYsSUFBSSxDQUFDO0lBQ2Q7SUFDQSxPQUFPO1FBQUU4RixPQUFPRixPQUFPdkssTUFBTSxLQUFLO1FBQUd1SztJQUFPO0FBQzlDO0FBRUFHLE9BQU9DLE9BQU8sR0FBRztJQUNmNU47SUFDQWtCO0lBQ0FPO0lBQ0FHO0lBQ0FDO0lBQ0E4QjtJQUNBbUg7SUFDQXNDO0lBQ0FFO0FBQ0YiLCJzb3VyY2VzIjpbIi9Vc2Vycy9hYnV6YWRhL0Rlc2t0b3AvYWdlbnRPUy9saWIvYWdlbnRzL2xlb25pZC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBjcnlwdG8gPSByZXF1aXJlKFwiY3J5cHRvXCIpO1xuY29uc3QgeyB3cmFwQWdlbnRPdXRwdXQsIHVud3JhcExlZ2FjeSB9ID0gcmVxdWlyZShcIi4uLy4uL3V0aWxzL2FnZW50RW52ZWxvcGUuanNcIik7XG5cbmNvbnN0IGlucHV0RGVmYXVsdHMgPSB7XG4gIG1vZGU6IFwiZGVlcFwiLFxuICBjaGFubmVsOiBcIm11bHRpXCIsXG4gIHRvbmVfcGFjazogXCJtaXhlZFwiLFxuICBnb2FsOiBcImdldF9yZXBseVwiLFxuICBwcm9kdWN0X25hbWU6IFwiQWdlbnRPU1wiLFxuICBwcm9kdWN0X29uZV9saW5lcjpcbiAgICBcItCw0LLRgtC+0LzQsNGC0LjQt9Cw0YbQuNGPINC/0YDQvtC00LDQti/Qv9C+0LTQtNC10YDQttC60Lgv0LrQvtC90YLQtdC90YLQsCDRh9C10YDQtdC3INCY0Jgt0LDQs9C10L3RgtC+0LI6INC70LjQtNGLLCDQvtGC0LLQtdGC0YssIENSTS3RgNGD0YLQuNC90YssINGA0LXQv9GD0YLQsNGG0LjRj1wiLFxuICBjb25zdHJhaW50czoge1xuICAgIG1heF9jaGFyc19maXJzdDogMjgwLFxuICAgIG1heF9jaGFyc19mb2xsb3d1cDogMjQwLFxuICAgIG5vX2xpbmtzOiBmYWxzZVxuICB9LFxuICBhbmF0b2x5X291dHB1dF9qc29uOiBudWxsLFxuICBhcnRlbV9vdXRwdXRfanNvbjogbnVsbCxcbiAgbGVhZF9pZGVudGl0eTogeyBjb21wYW55X25hbWU6IFwiXCIsIGJyYW5kOiBcIlwiLCBjaXR5OiBcIlwiIH0sXG4gIGxhbmd1YWdlOiBcInJ1XCJcbn07XG5cbmNvbnN0IGlucHV0U2NoZW1hID0ge1xuICB0eXBlOiBcIm9iamVjdFwiLFxuICBhZGRpdGlvbmFsUHJvcGVydGllczogZmFsc2UsXG4gIHByb3BlcnRpZXM6IHtcbiAgICBtb2RlOiB7IHR5cGU6IFwic3RyaW5nXCIsIGVudW06IFtcInF1aWNrXCIsIFwiZGVlcFwiXSwgZGVmYXVsdDogXCJkZWVwXCIgfSxcbiAgICBjaGFubmVsOiB7XG4gICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgZW51bTogW1widGVsZWdyYW1cIiwgXCJ2a1wiLCBcIndoYXRzYXBwXCIsIFwibXVsdGlcIl0sXG4gICAgICBkZWZhdWx0OiBcIm11bHRpXCJcbiAgICB9LFxuICAgIHRvbmVfcGFjazoge1xuICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgIGVudW06IFtcIm5ldXRyYWxcIiwgXCJidXNpbmVzc1wiLCBcInNob3J0X2hhcmRcIiwgXCJtaXhlZFwiXSxcbiAgICAgIGRlZmF1bHQ6IFwibWl4ZWRcIlxuICAgIH0sXG4gICAgZ29hbDoge1xuICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgIGVudW06IFtcImdldF9yZXBseVwiLCBcInF1YWxpZnlcIiwgXCJib29rX2NhbGxcIiwgXCJzZW5kX2F1ZGl0XCJdLFxuICAgICAgZGVmYXVsdDogXCJnZXRfcmVwbHlcIlxuICAgIH0sXG4gICAgcHJvZHVjdF9uYW1lOiB7IHR5cGU6IFwic3RyaW5nXCIgfSxcbiAgICBwcm9kdWN0X29uZV9saW5lcjogeyB0eXBlOiBcInN0cmluZ1wiIH0sXG4gICAgY29uc3RyYWludHM6IHtcbiAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIG1heF9jaGFyc19maXJzdDogeyB0eXBlOiBcIm51bWJlclwiLCBkZWZhdWx0OiAyODAgfSxcbiAgICAgICAgbWF4X2NoYXJzX2ZvbGxvd3VwOiB7IHR5cGU6IFwibnVtYmVyXCIsIGRlZmF1bHQ6IDI0MCB9LFxuICAgICAgICBub19saW5rczogeyB0eXBlOiBcImJvb2xlYW5cIiwgZGVmYXVsdDogZmFsc2UgfVxuICAgICAgfVxuICAgIH0sXG4gICAgYW5hdG9seV9vdXRwdXRfanNvbjogeyB0eXBlOiBbXCJvYmplY3RcIiwgXCJudWxsXCJdIH0sXG4gICAgYXJ0ZW1fb3V0cHV0X2pzb246IHsgdHlwZTogW1wib2JqZWN0XCIsIFwibnVsbFwiXSB9LFxuICAgIGxlYWRfaWRlbnRpdHk6IHsgdHlwZTogW1wib2JqZWN0XCIsIFwibnVsbFwiXSB9LFxuICAgIGxhbmd1YWdlOiB7IHR5cGU6IFwic3RyaW5nXCIsIGRlZmF1bHQ6IFwicnVcIiB9XG4gIH0sXG4gIHJlcXVpcmVkOiBbXCJtb2RlXCJdLFxuICBkZWZhdWx0OiBpbnB1dERlZmF1bHRzXG59O1xuXG5jb25zdCBvdXRwdXRTY2hlbWEgPSB7XG4gIHR5cGU6IFwib2JqZWN0XCIsXG4gIHJlcXVpcmVkOiBbXCJkbV9wYWNrXCIsIFwibWV0YVwiXSxcbiAgYWRkaXRpb25hbFByb3BlcnRpZXM6IGZhbHNlLFxuICBwcm9wZXJ0aWVzOiB7XG4gICAgZG1fcGFjazogeyB0eXBlOiBcIm9iamVjdFwiIH0sXG4gICAgbWV0YTogeyB0eXBlOiBcIm9iamVjdFwiIH1cbiAgfVxufTtcblxuY29uc3Qgc3lzdGVtUHJvbXB0ID0gYNCi0Ysg4oCUINCY0Jgt0LDQs9C10L3RgiBhZ2VudE9TOiBcItCb0LXQvtC90LjQtCDigJQg0JDRg9GC0YDQuNGHINCyINC80LXRgdGB0LXQvdC00LbQtdGA0LDRhVwiLlxu0KDQvtC70Yw6INC/0LjRgdCw0YLRjCDQutC+0YDQvtGC0LrQuNC1IERNINCx0LXQtyDQstC+0LTRiyDQuCDQsdC10Lcg0LLRi9C00YPQvNC+0Log0L/QviDQstGF0L7QtNC90L7QvNGDIEpTT04uYDtcblxuY29uc3QgbGVvbmlkQWdlbnQgPSB7XG4gIGlkOiBcImxlb25pZC1vdXRyZWFjaC1kbS1ydVwiLFxuICBkaXNwbGF5TmFtZTogXCLQm9C10L7QvdC40LQg4oCUINCQ0YPRgtGA0LjRhyDQsiDQvNC10YHRgdC10L3QtNC20LXRgNCw0YVcIixcbiAgZGVzY3JpcHRpb246XG4gICAgXCLQk9C10L3QtdGA0LjRgNGD0LXRgiDQutC+0YDQvtGC0LrQuNC1IERNINC00LvRjyBUZWxlZ3JhbS9WSy9XaGF0c0FwcCDQvdCwINC+0YHQvdC+0LLQtSDRgNCw0LfQsdC+0YDQvtCyL9Cz0L7RgNGP0YfQuNGFINGB0LjQs9C90LDQu9C+0LIuXCIsXG4gIGlucHV0U2NoZW1hLFxuICBvdXRwdXRTY2hlbWEsXG4gIHN5c3RlbVByb21wdFxufTtcblxuY29uc3Qgd3JhcE91dHB1dCA9IChsZWdhY3lPdXRwdXQsIGlucHV0KSA9PlxuICB3cmFwQWdlbnRPdXRwdXQoe1xuICAgIGFnZW50SWQ6IGxlb25pZEFnZW50LmlkLFxuICAgIGlucHV0RWNobzogaW5wdXQsXG4gICAgbW9kZTogaW5wdXQubW9kZSxcbiAgICBsZWdhY3lPdXRwdXRcbiAgfSk7XG5cbmNvbnN0IGZsdWZmQmxhY2tsaXN0ID0gW1xuICBcItC70LjQtNC10YAg0YDRi9C90LrQsFwiLFxuICBcItC40L3QvdC+0LLQsNGG0LjQvtC9XCIsXG4gIFwi0YHQuNC90LXRgNCzXCIsXG4gIFwi0L/QvtC0INC60LvRjtGHXCIsXG4gIFwi0YDQtdCy0L7Qu9GO0YbQuNC+0L1cIixcbiAgXCLRg9C90LjQutCw0LvRjNC9XCIsXG4gIFwi0LvRg9GH0YjQuNC5XCIsXG4gIFwi0LPQsNGA0LDQvdGC0LjRgFwiLFxuICBcItGA0L7RgdGCINC/0YDQvtC00LDQtlwiXG5dO1xuXG5jb25zdCBzYW5pdGl6ZVRleHQgPSAodGV4dCwgY29uc3RyYWludHMpID0+IHtcbiAgY29uc3QgdHJpbW1lZCA9IHRleHQucmVwbGFjZSgvXFxzKyQvZywgXCJcIikudHJpbSgpO1xuICBpZiAoY29uc3RyYWludHMubm9fbGlua3MpIHtcbiAgICBjb25zdCBoYWRMaW5rcyA9IC9odHRwcz86XFwvXFwvXFxTK3xcXGLRgdGB0YvQu9C6W9CwLdGPXSpcXGJ8XFxi0LvQuNC90Lpb0LAt0Y9dKlxcYnxcXGJsaW5rXFxiL2dpLnRlc3QodHJpbW1lZCk7XG4gICAgY29uc3Qgc3RyaXBwZWQgPSB0cmltbWVkXG4gICAgICAucmVwbGFjZSgvaHR0cHM/OlxcL1xcL1xcUysvZ2ksIFwiIFwiKVxuICAgICAgLnJlcGxhY2UoL9GB0YHRi9C70Lpb0LAt0Y9dKi9naSwgXCIgXCIpXG4gICAgICAucmVwbGFjZSgv0LvQuNC90Lpb0LAt0Y9dKi9naSwgXCIgXCIpXG4gICAgICAucmVwbGFjZSgvXFxibGlua1xcYi9naSwgXCIgXCIpXG4gICAgICAucmVwbGFjZSgvXFxzKy9nLCBcIiBcIilcbiAgICAgIC50cmltKCk7XG4gICAgaWYgKGhhZExpbmtzKSB7XG4gICAgICByZXR1cm4gYCR7c3RyaXBwZWR9JHtzdHJpcHBlZCA/IFwiLiBcIiA6IFwiXCJ90KHQutC40L3RgyDRgtC10LrRgdGC0L7QvC5gLnRyaW0oKTtcbiAgICB9XG4gICAgcmV0dXJuIHN0cmlwcGVkO1xuICB9XG4gIHJldHVybiB0cmltbWVkO1xufTtcblxuY29uc3QgY2xhbXBUZXh0ID0gKHRleHQsIG1heCkgPT4ge1xuICBpZiAoIXRleHQpIHJldHVybiBcIlwiO1xuICBpZiAodGV4dC5sZW5ndGggPD0gbWF4KSByZXR1cm4gdGV4dDtcbiAgcmV0dXJuIHRleHQuc2xpY2UoMCwgbWF4IC0gMSkudHJpbSgpICsgXCLigKZcIjtcbn07XG5cbmNvbnN0IGRlZHVwZUFycmF5ID0gKGFycikgPT4gQXJyYXkuZnJvbShuZXcgU2V0KGFyci5maWx0ZXIoKGl0ZW0pID0+IGl0ZW0gIT09IHVuZGVmaW5lZCkpKTtcblxuY29uc3Qgbm9ybWFsaXplSW5wdXQgPSAoaW5wdXQpID0+IHtcbiAgY29uc3Qgc2FmZSA9IHR5cGVvZiBpbnB1dCA9PT0gXCJvYmplY3RcIiAmJiBpbnB1dCAhPT0gbnVsbCA/IGlucHV0IDoge307XG4gIGNvbnN0IG1vZGUgPSBzYWZlLm1vZGUgPT09IFwicXVpY2tcIiA/IFwicXVpY2tcIiA6IFwiZGVlcFwiO1xuICBjb25zdCB0b25lX3BhY2sgPSBbXCJuZXV0cmFsXCIsIFwiYnVzaW5lc3NcIiwgXCJzaG9ydF9oYXJkXCIsIFwibWl4ZWRcIl0uaW5jbHVkZXMoc2FmZS50b25lX3BhY2spXG4gICAgPyBzYWZlLnRvbmVfcGFja1xuICAgIDogXCJtaXhlZFwiO1xuICByZXR1cm4ge1xuICAgIG1vZGUsXG4gICAgY2hhbm5lbDogW1widGVsZWdyYW1cIiwgXCJ2a1wiLCBcIndoYXRzYXBwXCIsIFwibXVsdGlcIl0uaW5jbHVkZXMoc2FmZS5jaGFubmVsKVxuICAgICAgPyBzYWZlLmNoYW5uZWxcbiAgICAgIDogXCJtdWx0aVwiLFxuICAgIHRvbmVfcGFjayxcbiAgICBnb2FsOiBbXCJnZXRfcmVwbHlcIiwgXCJxdWFsaWZ5XCIsIFwiYm9va19jYWxsXCIsIFwic2VuZF9hdWRpdFwiXS5pbmNsdWRlcyhzYWZlLmdvYWwpXG4gICAgICA/IHNhZmUuZ29hbFxuICAgICAgOiBcImdldF9yZXBseVwiLFxuICAgIHByb2R1Y3RfbmFtZTogdHlwZW9mIHNhZmUucHJvZHVjdF9uYW1lID09PSBcInN0cmluZ1wiICYmIHNhZmUucHJvZHVjdF9uYW1lLnRyaW0oKVxuICAgICAgPyBzYWZlLnByb2R1Y3RfbmFtZS50cmltKClcbiAgICAgIDogXCJBZ2VudE9TXCIsXG4gICAgcHJvZHVjdF9vbmVfbGluZXI6XG4gICAgICB0eXBlb2Ygc2FmZS5wcm9kdWN0X29uZV9saW5lciA9PT0gXCJzdHJpbmdcIiAmJiBzYWZlLnByb2R1Y3Rfb25lX2xpbmVyLnRyaW0oKVxuICAgICAgICA/IHNhZmUucHJvZHVjdF9vbmVfbGluZXIudHJpbSgpXG4gICAgICAgIDogaW5wdXREZWZhdWx0cy5wcm9kdWN0X29uZV9saW5lcixcbiAgICBjb25zdHJhaW50czoge1xuICAgICAgbWF4X2NoYXJzX2ZpcnN0OlxuICAgICAgICB0eXBlb2Ygc2FmZS5jb25zdHJhaW50cz8ubWF4X2NoYXJzX2ZpcnN0ID09PSBcIm51bWJlclwiXG4gICAgICAgICAgPyBNYXRoLm1heCg2MCwgTWF0aC5yb3VuZChzYWZlLmNvbnN0cmFpbnRzLm1heF9jaGFyc19maXJzdCkpXG4gICAgICAgICAgOiAyODAsXG4gICAgICBtYXhfY2hhcnNfZm9sbG93dXA6XG4gICAgICAgIHR5cGVvZiBzYWZlLmNvbnN0cmFpbnRzPy5tYXhfY2hhcnNfZm9sbG93dXAgPT09IFwibnVtYmVyXCJcbiAgICAgICAgICA/IE1hdGgubWF4KDYwLCBNYXRoLnJvdW5kKHNhZmUuY29uc3RyYWludHMubWF4X2NoYXJzX2ZvbGxvd3VwKSlcbiAgICAgICAgICA6IDI0MCxcbiAgICAgIG5vX2xpbmtzOiBzYWZlLmNvbnN0cmFpbnRzPy5ub19saW5rcyA9PT0gdHJ1ZVxuICAgIH0sXG4gICAgYW5hdG9seV9vdXRwdXRfanNvbjogc2FmZS5hbmF0b2x5X291dHB1dF9qc29uID8/IG51bGwsXG4gICAgYXJ0ZW1fb3V0cHV0X2pzb246IHNhZmUuYXJ0ZW1fb3V0cHV0X2pzb24gPz8gbnVsbCxcbiAgICBsZWFkX2lkZW50aXR5OiBzYWZlLmxlYWRfaWRlbnRpdHkgPz8ge30sXG4gICAgbGFuZ3VhZ2U6IHNhZmUubGFuZ3VhZ2UgPT09IFwicnVcIiA/IFwicnVcIiA6IFwicnVcIlxuICB9O1xufTtcblxuY29uc3QgZXh0cmFjdEFuYXRvbHlEYXRhID0gKGFuYXRvbHkpID0+IHtcbiAgaWYgKCFhbmF0b2x5IHx8IHR5cGVvZiBhbmF0b2x5ICE9PSBcIm9iamVjdFwiKSByZXR1cm4gbnVsbDtcbiAgY29uc3QgYWNjb3VudCA9IGFuYXRvbHkuYWNjb3VudF9jYXJkIHx8IGFuYXRvbHkuYWNjb3VudENhcmQgfHwgbnVsbDtcbiAgaWYgKCFhY2NvdW50IHx8IHR5cGVvZiBhY2NvdW50ICE9PSBcIm9iamVjdFwiKSByZXR1cm4gbnVsbDtcbiAgY29uc3QgaG9va3MgPSBBcnJheS5pc0FycmF5KGFjY291bnQudG9wX3BlcnNvbmFsaXphdGlvbl9ob29rcylcbiAgICA/IGFjY291bnQudG9wX3BlcnNvbmFsaXphdGlvbl9ob29rc1xuICAgIDogW107XG4gIGNvbnN0IHBhaW5zID0gQXJyYXkuaXNBcnJheShhY2NvdW50LnBhaW5faHlwb3RoZXNlcykgPyBhY2NvdW50LnBhaW5faHlwb3RoZXNlcyA6IFtdO1xuICBjb25zdCBwcmltYXJ5SG9vayA9IGhvb2tzWzBdIHx8IG51bGw7XG4gIGNvbnN0IHNlY29uZGFyeUhvb2sgPSBob29rc1sxXSB8fCBudWxsO1xuICBjb25zdCBwcmltYXJ5UGFpbiA9IHBhaW5zWzBdIHx8IG51bGw7XG4gIGNvbnN0IGNvbXBhbnlOYW1lID0gYWNjb3VudC5jb21wYW55X25hbWUgfHwgXCJcIjtcbiAgY29uc3QgcHJvb2ZJdGVtcyA9IEFycmF5LmlzQXJyYXkoYW5hdG9seS5tZXRhPy5wcm9vZl9pdGVtcykgPyBhbmF0b2x5Lm1ldGEucHJvb2ZfaXRlbXMgOiBbXTtcbiAgcmV0dXJuIHtcbiAgICBjb21wYW55TmFtZSxcbiAgICBob29rczogaG9va3Muc2xpY2UoMCwgMiksXG4gICAgcHJpbWFyeUhvb2ssXG4gICAgc2Vjb25kYXJ5SG9vayxcbiAgICBwcmltYXJ5UGFpbixcbiAgICBwcm9vZkl0ZW1zXG4gIH07XG59O1xuXG5jb25zdCBleHRyYWN0QXJ0ZW1EYXRhID0gKGFydGVtKSA9PiB7XG4gIGlmICghYXJ0ZW0gfHwgdHlwZW9mIGFydGVtICE9PSBcIm9iamVjdFwiKSByZXR1cm4gbnVsbDtcbiAgY29uc3QgbGVhZHMgPSBBcnJheS5pc0FycmF5KGFydGVtLmhvdF9sZWFkcykgPyBhcnRlbS5ob3RfbGVhZHMgOiBbXTtcbiAgaWYgKGxlYWRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIG51bGw7XG4gIGNvbnN0IHRvcExlYWQgPSBsZWFkc1swXTtcbiAgY29uc3QgcHJvb2ZJdGVtcyA9IEFycmF5LmlzQXJyYXkoYXJ0ZW0ubWV0YT8ucHJvb2ZfaXRlbXMpID8gYXJ0ZW0ubWV0YS5wcm9vZl9pdGVtcyA6IFtdO1xuICByZXR1cm4geyB0b3BMZWFkLCBwcm9vZkl0ZW1zIH07XG59O1xuXG5jb25zdCBidWlsZFBlcnNvbmFsaXphdGlvbkZyb21BbmF0b2x5ID0gKGFuYXRvbHlEYXRhKSA9PiB7XG4gIGlmICghYW5hdG9seURhdGEpIHJldHVybiBudWxsO1xuICBjb25zdCBob29rID0gYW5hdG9seURhdGEucHJpbWFyeUhvb2sgfHwgYW5hdG9seURhdGEuc2Vjb25kYXJ5SG9vaztcbiAgY29uc3QgcGFpbiA9IGFuYXRvbHlEYXRhLnByaW1hcnlQYWluO1xuICBjb25zdCBwZXJzb25hbGl6YXRpb25MaW5lID0gaG9vaz8uaG9va190ZXh0XG4gICAgPyBg0JLQuNC20YMg0YMg0LLQsNGBOiAke2NsYW1wVGV4dChob29rLmhvb2tfdGV4dCwgMTIwKX0uYFxuICAgIDogbnVsbDtcbiAgY29uc3QgdmFsdWVMaW5lID0gcGFpbj8uaHlwb3RoZXNpc1xuICAgID8gYNCV0YHRgtGMINCz0LjQv9C+0YLQtdC30LAsINCz0LTQtSDQvNC+0LbQvdC+INGB0L3Rj9GC0Ywg0L3QsNCz0YDRg9C30LrRgzogJHtjbGFtcFRleHQocGFpbi5oeXBvdGhlc2lzLCAxMjApfS5gXG4gICAgOiBcItCV0YHRgtGMINCz0LjQv9C+0YLQtdC30LAsINCz0LTQtSDQvNC+0LbQvdC+INGD0YHQutC+0YDQuNGC0Ywg0L/RgNC+0YbQtdGB0YHRiyDQsdC10Lcg0L/QtdGA0LXRgNCw0LHQvtGC0L7Qui5cIjtcbiAgbGV0IHJlZnMgPSBkZWR1cGVBcnJheShbXG4gICAgLi4uKGhvb2s/LnJlbGF0ZWRfcHJvb2ZzID8/IFtdKSxcbiAgICAuLi4ocGFpbj8ucmVsYXRlZF9wcm9vZnMgPz8gW10pXG4gIF0pLmZpbHRlcigoaXRlbSkgPT4gdHlwZW9mIGl0ZW0gPT09IFwibnVtYmVyXCIpO1xuICBpZiAocmVmcy5sZW5ndGggPT09IDAgJiYgYW5hdG9seURhdGEucHJvb2ZJdGVtcy5sZW5ndGggPiAwKSB7XG4gICAgcmVmcyA9IFswXTtcbiAgfVxuICByZXR1cm4geyBwZXJzb25hbGl6YXRpb25MaW5lLCB2YWx1ZUxpbmUsIGdyb3VuZGluZ1JlZnM6IHJlZnMgfTtcbn07XG5cbmNvbnN0IGJ1aWxkUGVyc29uYWxpemF0aW9uRnJvbUFydGVtID0gKGFydGVtRGF0YSkgPT4ge1xuICBpZiAoIWFydGVtRGF0YSkgcmV0dXJuIG51bGw7XG4gIGNvbnN0IGxlYWQgPSBhcnRlbURhdGEudG9wTGVhZDtcbiAgY29uc3QgcmVhc29uID0gbGVhZD8uaG90X3JlYXNvbnM/LlswXSB8fCBsZWFkPy5yZXF1ZXN0X3N1bW1hcnkgfHwgXCJcIjtcbiAgY29uc3QgY2F0ZWdvcnkgPSBsZWFkPy5jYXRlZ29yeV9oaW50ID8gYNC/0L4g0YLQtdC80LUgJHtsZWFkLmNhdGVnb3J5X2hpbnR9YCA6IFwiXCI7XG4gIGNvbnN0IHBlcnNvbmFsaXphdGlvbkxpbmUgPSBjbGFtcFRleHQoXG4gICAgcmVtb3ZlUGVyc29uYWxEYXRhKGDQldGB0YLRjCDQvtGC0LrRgNGL0YLRi9C5INGB0LjQs9C90LDQuyAke2NhdGVnb3J5fTogJHtyZWFzb259YC50cmltKCkpLFxuICAgIDE0MFxuICApO1xuICBjb25zdCB2YWx1ZUxpbmUgPSBcItCV0YHRgtGMINC40LTQtdC4LCDQutCw0Log0LHRi9GB0YLRgNC+INC/0L7QvNC+0YfRjCDQuCDRgdC90Y/RgtGMINGD0LfQutC40LUg0LzQtdGB0YLQsC5cIjtcbiAgbGV0IHJlZnMgPSBBcnJheS5pc0FycmF5KGxlYWQ/LnByb29mX3JlZnMpID8gbGVhZC5wcm9vZl9yZWZzIDogW107XG4gIGlmIChyZWZzLmxlbmd0aCA9PT0gMCAmJiBhcnRlbURhdGEucHJvb2ZJdGVtcy5sZW5ndGggPiAwKSB7XG4gICAgcmVmcyA9IFswXTtcbiAgfVxuICByZXR1cm4geyBwZXJzb25hbGl6YXRpb25MaW5lLCB2YWx1ZUxpbmUsIGdyb3VuZGluZ1JlZnM6IHJlZnMsIGxlYWQgfTtcbn07XG5cbmNvbnN0IGJ1aWxkUXVlc3Rpb25MaW5lID0gKGdvYWwpID0+IHtcbiAgc3dpdGNoIChnb2FsKSB7XG4gICAgY2FzZSBcInF1YWxpZnlcIjpcbiAgICAgIHJldHVybiBcItCa0YLQviDRgyDQstCw0YEg0L7RgtCy0LXRh9Cw0LXRgiDQt9CwINGN0YLQviDQvdCw0L/RgNCw0LLQu9C10L3QuNC1P1wiO1xuICAgIGNhc2UgXCJib29rX2NhbGxcIjpcbiAgICAgIHJldHVybiBcItCj0LTQvtCx0L3QviDQutC+0YDQvtGC0LrQviDRgdC+0LfQstC+0L3QuNGC0YzRgdGPINC90LAgMTAg0LzQuNC90YPRgj9cIjtcbiAgICBjYXNlIFwic2VuZF9hdWRpdFwiOlxuICAgICAgcmV0dXJuIFwi0KHQutC40L3Rg9GC0Ywg0LzQuNC90Lgt0LDRg9C00LjRgiDQvdCwIDUg0L/Rg9C90LrRgtC+0LI/XCI7XG4gICAgY2FzZSBcImdldF9yZXBseVwiOlxuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gXCLQkNC60YLRg9Cw0LvRjNC90L4g0L7QsdGB0YPQtNC40YLRjD9cIjtcbiAgfVxufTtcblxuY29uc3QgYnVpbGRDdGFMaW5lID0gKGdvYWwpID0+IHtcbiAgc3dpdGNoIChnb2FsKSB7XG4gICAgY2FzZSBcInNlbmRfYXVkaXRcIjpcbiAgICAgIHJldHVybiBcItCc0L7Qs9GDINGB0LTQtdC70LDRgtGMINC80LjQvdC4LdCw0YPQtNC40YIg0Lgg0L/RgNC40YHQu9Cw0YLRjCDQsiDRh9Cw0YLQtS5cIjtcbiAgICBjYXNlIFwiYm9va19jYWxsXCI6XG4gICAgICByZXR1cm4gXCLQldGB0LvQuCDQvtC6LCDQv9GA0LXQtNC70L7QttGDINC/0LDRgNGDINGB0LvQvtGC0L7QsiDQvdCwINGB0L7Qt9Cy0L7QvS5cIjtcbiAgICBjYXNlIFwicXVhbGlmeVwiOlxuICAgICAgcmV0dXJuIFwi0JzQvtCz0YMg0LrQvtGA0L7RgtC60L4g0L7Qv9C40YHQsNGC0YwsINC60LDQuiDRjdGC0L4g0LfQsNC60YDRi9Cy0LDQtdC8INC30LAgM+KAkzcg0LTQvdC10LkuXCI7XG4gICAgY2FzZSBcImdldF9yZXBseVwiOlxuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gXCLQnNC+0LPRgyDRgdC60LjQvdGD0YLRjCAzINC40LTQtdC4L9C80LjQvdC4LdCw0YPQtNC40YIsINC10YHQu9C4INC40L3RgtC10YDQtdGB0L3Qvi5cIjtcbiAgfVxufTtcblxuY29uc3QgYnVpbGRPYmplY3Rpb25QcmVlbXB0TGluZSA9ICh0b25lKSA9PiB7XG4gIGlmICh0b25lID09PSBcImJ1c2luZXNzXCIpIHtcbiAgICByZXR1cm4gXCLQldGB0LvQuCDQvdC1INCyINC/0YDQuNC+0YDQuNGC0LXRgtC1INGB0LXQudGH0LDRgSwg0L/RgNC+0YHRgtC+INC00LDQudGC0LUg0LfQvdCw0YLRjCwg0Lgg0Y8g0L3QtSDQsdGD0LTRgyDQtNCw0LLQuNGC0YwuXCI7XG4gIH1cbiAgaWYgKHRvbmUgPT09IFwic2hvcnRfaGFyZFwiKSB7XG4gICAgcmV0dXJuIFwi0JXRgdC70Lgg0L3QtdCw0LrRgtGD0LDQu9GM0L3Qviwg0L7Quiwg0LfQsNC60YDQvtGOINGC0LXQvNGDINCx0LXQtyDQu9C40YjQvdC40YUg0YHQvtC+0LHRidC10L3QuNC5LlwiO1xuICB9XG4gIHJldHVybiBcIlwiO1xufTtcblxuY29uc3QgcmVtb3ZlUGVyc29uYWxEYXRhID0gKHRleHQpID0+XG4gIFN0cmluZyh0ZXh0IHx8IFwiXCIpXG4gICAgLnJlcGxhY2UoL1tBLVowLTkuXyUrLV0rQFtBLVowLTkuLV0rXFwuW0EtWl17Mix9L2dpLCBcIlvQutC+0L3RgtCw0LrRgiDRgdC60YDRi9GCXVwiKVxuICAgIC5yZXBsYWNlKC8oXFwrN3w4KVxccz9cXCg/XFxkezN9XFwpP1tcXHMtXT9cXGR7M31bXFxzLV0/XFxkezJ9W1xccy1dP1xcZHsyfS9nLCBcIlvRgtC10LvQtdGE0L7QvSDRgdC60YDRi9GCXVwiKTtcblxuY29uc3QgYXBwbHlDaGFubmVsVG9uZVR3ZWFrcyA9IChsaW5lLCBjaGFubmVsKSA9PiB7XG4gIGNvbnN0IHRleHQgPSBTdHJpbmcobGluZSB8fCBcIlwiKS50cmltKCk7XG4gIGlmICghdGV4dCkgcmV0dXJuIHRleHQ7XG4gIGlmIChjaGFubmVsID09PSBcIndoYXRzYXBwXCIpIHtcbiAgICBpZiAoL9Cw0LrRgtGD0LDQu9GM0L3QviDQvtCx0YHRg9C00LjRgtGMXFw/L2kudGVzdCh0ZXh0KSkgcmV0dXJuIFwi0JXRgdC70Lgg0YLQtdC80LAg0LDQutGC0YPQsNC70YzQvdCwLCDQvNC+0LPRgyDQsNC60LrRg9GA0LDRgtC90L4g0L/QvtC00YHQutCw0LfQsNGC0Ywg0YjQsNCz0Lg/XCI7XG4gICAgcmV0dXJuIHRleHQucmVwbGFjZSgv0JrQvtGA0L7RgtC60L46L2ksIFwi0JrQvtGA0L7RgtC60L4g0Lgg0LzRj9Cz0LrQvjpcIik7XG4gIH1cbiAgaWYgKGNoYW5uZWwgPT09IFwidGVsZWdyYW1cIikge1xuICAgIHJldHVybiBjbGFtcFRleHQodGV4dCwgMTIwKTtcbiAgfVxuICBpZiAoY2hhbm5lbCA9PT0gXCJ2a1wiKSB7XG4gICAgcmV0dXJuIHRleHQucmVwbGFjZSgv0J/RgNC40LLQtdGCIS9pLCBcItCU0L7QsdGA0YvQuSDQtNC10L3RjCFcIik7XG4gIH1cbiAgcmV0dXJuIHRleHQ7XG59O1xuXG5jb25zdCBidWlsZENoYW5uZWxUd2Vha3MgPSAoKSA9PiAoe1xuICBURzogXCLQmtC+0YDQvtGC0LrQviDQuCDQv9C+INC00LXQu9GDLCDQvNC40L3QuNC80LDQu9GM0L3Ri9C1INGE0L7RgNC80YPQu9C40YDQvtCy0LrQuC5cIixcbiAgVks6IFwi0KfRg9GC0Ywg0YTQvtGA0LzQsNC70YzQvdC10LUsINC+0LTQuNC9INGH0ZHRgtC60LjQuSDQstC+0L/RgNC+0YEg0LIg0LrQvtC90YbQtS5cIixcbiAgV0E6IFwi0JzRj9Cz0YfQtSDQv9C+INGC0L7QvdGDLCDQsdC10Lcg0YDQtdC30LrQvtCz0L4g0LTQsNCy0LvQtdC90LjRjyDQuCDRgSDQstC10LbQu9C40LLRi9C8INC30LDRhdC+0LTQvtC8LlwiXG59KTtcblxuY29uc3QgdG9uZVByZWZpeCA9ICh0b25lKSA9PiB7XG4gIGlmICh0b25lID09PSBcImJ1c2luZXNzXCIpIHJldHVybiBcItCU0L7QsdGA0YvQuSDQtNC10L3RjCFcIjtcbiAgaWYgKHRvbmUgPT09IFwic2hvcnRfaGFyZFwiKSByZXR1cm4gXCLQmtC+0YDQvtGC0LrQvjpcIjtcbiAgcmV0dXJuIFwi0J/RgNC40LLQtdGCIVwiO1xufTtcblxuY29uc3QgY29tcG9zZU1lc3NhZ2UgPSAoe1xuICBwZXJzb25hbGl6YXRpb25MaW5lLFxuICB2YWx1ZUxpbmUsXG4gIHF1ZXN0aW9uTGluZSxcbiAgY3RhTGluZSxcbiAgdG9uZSxcbiAgY2hhbm5lbCxcbiAgb2JqZWN0aW9uUHJlZW1wdExpbmVcbn0pID0+IHtcbiAgY29uc3QgbGluZXMgPSBbXTtcbiAgY29uc3QgcHJlZml4ID0gdG9uZVByZWZpeCh0b25lKTtcbiAgaWYgKHBlcnNvbmFsaXphdGlvbkxpbmUpIHtcbiAgICBsaW5lcy5wdXNoKHByZWZpeCA/IGAke3ByZWZpeH0gJHtwZXJzb25hbGl6YXRpb25MaW5lfWAgOiBwZXJzb25hbGl6YXRpb25MaW5lKTtcbiAgfSBlbHNlIGlmIChwcmVmaXgpIHtcbiAgICBsaW5lcy5wdXNoKHByZWZpeCk7XG4gIH1cbiAgaWYgKHZhbHVlTGluZSkgbGluZXMucHVzaCh2YWx1ZUxpbmUpO1xuICBpZiAob2JqZWN0aW9uUHJlZW1wdExpbmUpIGxpbmVzLnB1c2gob2JqZWN0aW9uUHJlZW1wdExpbmUpO1xuICBpZiAocXVlc3Rpb25MaW5lKSBsaW5lcy5wdXNoKHF1ZXN0aW9uTGluZSk7XG4gIGlmIChjdGFMaW5lKSBsaW5lcy5wdXNoKGN0YUxpbmUpO1xuICByZXR1cm4gbGluZXNcbiAgICAubWFwKChsaW5lKSA9PiByZW1vdmVQZXJzb25hbERhdGEobGluZSkpXG4gICAgLm1hcCgobGluZSkgPT4gYXBwbHlDaGFubmVsVG9uZVR3ZWFrcyhsaW5lLCBjaGFubmVsKSk7XG59O1xuXG5jb25zdCB0cmltTWVzc2FnZVRvTGltaXQgPSAobGluZXMsIG1heENoYXJzKSA9PiB7XG4gIGxldCB0ZXh0ID0gbGluZXMuam9pbihcIlxcblwiKTtcbiAgaWYgKHRleHQubGVuZ3RoIDw9IG1heENoYXJzKSByZXR1cm4geyB0ZXh0LCBsaW5lcyB9O1xuXG4gIGNvbnN0IHJlZHVjZWQgPSBbLi4ubGluZXNdO1xuICBpZiAocmVkdWNlZC5sZW5ndGggPiA0KSByZWR1Y2VkLnNwbGljZSgyLCAxKTtcbiAgdGV4dCA9IHJlZHVjZWQuam9pbihcIlxcblwiKTtcbiAgaWYgKHRleHQubGVuZ3RoIDw9IG1heENoYXJzKSByZXR1cm4geyB0ZXh0LCBsaW5lczogcmVkdWNlZCB9O1xuXG4gIGlmIChyZWR1Y2VkLmxlbmd0aCA+IDMpIHtcbiAgICByZWR1Y2VkLnNwbGljZSgxLCAxKTtcbiAgfVxuICB0ZXh0ID0gcmVkdWNlZC5qb2luKFwiXFxuXCIpO1xuICBpZiAodGV4dC5sZW5ndGggPD0gbWF4Q2hhcnMpIHJldHVybiB7IHRleHQsIGxpbmVzOiByZWR1Y2VkIH07XG5cbiAgY29uc3Qgc2hvcnRlbmVkID0gcmVkdWNlZC5tYXAoKGxpbmUpID0+IGNsYW1wVGV4dChsaW5lLCBNYXRoLm1heCg0MCwgTWF0aC5mbG9vcihtYXhDaGFycyAvIDMpKSkpO1xuICByZXR1cm4geyB0ZXh0OiBzaG9ydGVuZWQuam9pbihcIlxcblwiKSwgbGluZXM6IHNob3J0ZW5lZCB9O1xufTtcblxuY29uc3QgYnVpbGRGb2xsb3d1cHMgPSAoXG4gIHRvbmUsXG4gIGdvYWwsXG4gIHBlcnNvbmFsaXphdGlvbkxpbmUsXG4gIGdyb3VuZGluZ1JlZnMsXG4gIG1heENoYXJzLFxuICBjaGFubmVsLFxuICBjb25zdHJhaW50cyxcbiAgY291bnQgPSAzXG4pID0+IHtcbiAgY29uc3QgZm9sbG93dXBzID0gW107XG4gIGNvbnN0IHRlbXBsYXRlcyA9IFtcbiAgICB7XG4gICAgICBhbmdsZTogXCJyZW1pbmRlclwiLFxuICAgICAgdGV4dDogYNCd0LDQv9C+0LzQvdGOINC/0YDQviDRgdC+0L7QsdGJ0LXQvdC40LUg0LLRi9GI0LUuINCc0L7Qs9GDINC60YDQsNGC0LrQviDQv9C+0LTRgdCy0LXRgtC40YLRjCAy4oCTMyDRgtC+0YfQutC4INC00LvRjyDRg9C70YPRh9GI0LXQvdC40Y8uYFxuICAgIH0sXG4gICAge1xuICAgICAgYW5nbGU6IFwidmFsdWVfZHJvcFwiLFxuICAgICAgdGV4dDogYNCV0YHQu9C4INC/0L7Qu9C10LfQvdC+LCDQv9GA0LjRiNC70Y4g0LzQuNC90Lgt0LDRg9C00LjRgiDQsiA1INC/0YPQvdC60YLQvtCyINCx0LXQtyDQvtCx0Y/Qt9Cw0YLQtdC70YzRgdGC0LIuYFxuICAgIH0sXG4gICAge1xuICAgICAgYW5nbGU6IFwiYnJlYWt1cFwiLFxuICAgICAgdGV4dDogYNCV0YHQu9C4INC90LUg0LDQutGC0YPQsNC70YzQvdC+IOKAlCDQv9GA0L7RgdGC0L4g0YHQutCw0LbQuNGC0LUsINGH0YLQvtCx0Ysg0L3QtSDQvtGC0LLQu9C10LrQsNGC0YwuYFxuICAgIH1cbiAgXTtcblxuICBjb25zdCBvZmZzZXRzID0gY291bnQgPT09IDIgPyBbMiwgN10gOiBbMSwgNCwgN107XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgTWF0aC5taW4oY291bnQsIHRlbXBsYXRlcy5sZW5ndGgpOyBpICs9IDEpIHtcbiAgICBjb25zdCB0ZW1wbGF0ZSA9IHRlbXBsYXRlc1tpXTtcbiAgICBsZXQgdGV4dCA9IHRlbXBsYXRlLnRleHQ7XG4gICAgaWYgKHRvbmUgPT09IFwic2hvcnRfaGFyZFwiKSB7XG4gICAgICB0ZXh0ID0gdGV4dC5yZXBsYWNlKFwi0JXRgdC70Lgg0L/QvtC70LXQt9C90L4sIFwiLCBcIlwiKS5yZXBsYWNlKFwi0LHQtdC3INC+0LHRj9C30LDRgtC10LvRjNGB0YLQslwiLCBcIlwiKTtcbiAgICB9XG4gICAgaWYgKHRvbmUgPT09IFwiYnVzaW5lc3NcIikge1xuICAgICAgdGV4dCA9IGDQmtC+0LvQu9C10LPQuCwgJHt0ZXh0fWA7XG4gICAgfVxuICAgIHRleHQgPSBhcHBseUNoYW5uZWxUb25lVHdlYWtzKHJlbW92ZVBlcnNvbmFsRGF0YSh0ZXh0KSwgY2hhbm5lbCk7XG4gICAgY29uc3QgZmluYWxUZXh0ID0gc2FuaXRpemVUZXh0KGNsYW1wVGV4dCh0ZXh0LCBtYXhDaGFycyksIGNvbnN0cmFpbnRzKTtcbiAgICBmb2xsb3d1cHMucHVzaCh7XG4gICAgICBkYXlfb2Zmc2V0OiBvZmZzZXRzW2ldLFxuICAgICAgdGV4dDogZmluYWxUZXh0LFxuICAgICAgdG9uZSxcbiAgICAgIGFuZ2xlOiB0ZW1wbGF0ZS5hbmdsZSxcbiAgICAgIGdyb3VuZGluZ19yZWZzOiBncm91bmRpbmdSZWZzXG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIGZvbGxvd3Vwcztcbn07XG5cbmNvbnN0IGJ1aWxkTWVzc2FnZVNldCA9ICh7XG4gIHBlcnNvbmFsaXphdGlvbkxpbmUsXG4gIHZhbHVlTGluZSxcbiAgZ3JvdW5kaW5nUmVmcyxcbiAgdG9uZSxcbiAgY2hhbm5lbCxcbiAgZ29hbCxcbiAgY29uc3RyYWludHMsXG4gIGZvbGxvd3VwQ291bnRcbn0pID0+IHtcbiAgY29uc3QgcXVlc3Rpb25MaW5lID0gYnVpbGRRdWVzdGlvbkxpbmUoZ29hbCk7XG4gIGNvbnN0IGN0YUxpbmUgPSBidWlsZEN0YUxpbmUoZ29hbCk7XG4gIGNvbnN0IG9iamVjdGlvblByZWVtcHRMaW5lID0gYnVpbGRPYmplY3Rpb25QcmVlbXB0TGluZSh0b25lKTtcbiAgY29uc3QgbGluZXMgPSBjb21wb3NlTWVzc2FnZSh7XG4gICAgcGVyc29uYWxpemF0aW9uTGluZSxcbiAgICB2YWx1ZUxpbmUsXG4gICAgcXVlc3Rpb25MaW5lLFxuICAgIGN0YUxpbmUsXG4gICAgdG9uZSxcbiAgICBjaGFubmVsLFxuICAgIG9iamVjdGlvblByZWVtcHRMaW5lXG4gIH0pO1xuICBjb25zdCB0cmltbWVkID0gdHJpbU1lc3NhZ2VUb0xpbWl0KGxpbmVzLCBjb25zdHJhaW50cy5tYXhfY2hhcnNfZmlyc3QpO1xuICBjb25zdCBzYW5pdGl6ZWRUZXh0ID0gc2FuaXRpemVUZXh0KHRyaW1tZWQudGV4dCwgY29uc3RyYWludHMpO1xuXG4gIGNvbnN0IGZpcnN0X21lc3NhZ2UgPSB7XG4gICAgdGV4dDogc2FuaXRpemVkVGV4dCxcbiAgICB0b25lLFxuICAgIHBlcnNvbmFsaXphdGlvbl9saW5lOiBwZXJzb25hbGl6YXRpb25MaW5lIHx8IFwiXCIsXG4gICAgb2JqZWN0aW9uX3ByZWVtcHRfbGluZTogb2JqZWN0aW9uUHJlZW1wdExpbmUsXG4gICAgcXVlc3Rpb25fbGluZTogcXVlc3Rpb25MaW5lLFxuICAgIGN0YV9saW5lOiBjdGFMaW5lLFxuICAgIGdyb3VuZGluZ19yZWZzOiBncm91bmRpbmdSZWZzXG4gIH07XG5cbiAgY29uc3QgZm9sbG93dXBzID0gYnVpbGRGb2xsb3d1cHMoXG4gICAgdG9uZSxcbiAgICBnb2FsLFxuICAgIHBlcnNvbmFsaXphdGlvbkxpbmUsXG4gICAgZ3JvdW5kaW5nUmVmcyxcbiAgICBjb25zdHJhaW50cy5tYXhfY2hhcnNfZm9sbG93dXAsXG4gICAgY2hhbm5lbCxcbiAgICBjb25zdHJhaW50cyxcbiAgICBmb2xsb3d1cENvdW50XG4gICk7XG5cbiAgcmV0dXJuIHsgZmlyc3RfbWVzc2FnZSwgZm9sbG93dXBzIH07XG59O1xuXG5jb25zdCBidWlsZExlYWRMYWJlbCA9IChhbmF0b2x5RGF0YSwgYXJ0ZW1EYXRhLCBsZWFkSWRlbnRpdHkpID0+IHtcbiAgaWYgKGFuYXRvbHlEYXRhPy5jb21wYW55TmFtZSkgcmV0dXJuIGFuYXRvbHlEYXRhLmNvbXBhbnlOYW1lO1xuICBpZiAobGVhZElkZW50aXR5Py5jb21wYW55X25hbWUpIHJldHVybiBsZWFkSWRlbnRpdHkuY29tcGFueV9uYW1lO1xuICBpZiAoYXJ0ZW1EYXRhPy50b3BMZWFkPy50aXRsZSkgcmV0dXJuIGBIb3QgbGVhZDogJHthcnRlbURhdGEudG9wTGVhZC50aXRsZX1gO1xuICByZXR1cm4gXCJIb3QgbGVhZFwiO1xufTtcblxuY29uc3QgY29udGFpbnNGbHVmZiA9ICh0ZXh0KSA9PlxuICBmbHVmZkJsYWNrbGlzdC5zb21lKCh3b3JkKSA9PiB0ZXh0LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMod29yZCkpO1xuXG5jb25zdCB2YWxpZGF0ZVF1YWxpdHkgPSAobWVzc2FnZXMsIGNvbnN0cmFpbnRzLCB1c2VkUGVyc29uYWxpemF0aW9uKSA9PiB7XG4gIGNvbnN0IGFsbFRleHRzID0gbWVzc2FnZXMuZmxhdE1hcCgoaXRlbSkgPT4gW1xuICAgIHsgdGV4dDogaXRlbS5maXJzdF9tZXNzYWdlLnRleHQsIGxpbWl0OiBjb25zdHJhaW50cy5tYXhfY2hhcnNfZmlyc3QgfSxcbiAgICAuLi5pdGVtLmZvbGxvd3Vwcy5tYXAoKGYpID0+ICh7IHRleHQ6IGYudGV4dCwgbGltaXQ6IGNvbnN0cmFpbnRzLm1heF9jaGFyc19mb2xsb3d1cCB9KSlcbiAgXSk7XG4gIGNvbnN0IHdpdGhpbkNoYXJMaW1pdHMgPSBhbGxUZXh0cy5ldmVyeSgoeyB0ZXh0LCBsaW1pdCB9KSA9PiB0ZXh0Lmxlbmd0aCA8PSBsaW1pdCk7XG4gIGNvbnN0IG5vRmx1ZmYgPSAhYWxsVGV4dHMuc29tZSgoeyB0ZXh0IH0pID0+IGNvbnRhaW5zRmx1ZmYodGV4dCkpO1xuICByZXR1cm4ge1xuICAgIG5vX2ZsdWZmOiBub0ZsdWZmLFxuICAgIHdpdGhpbl9jaGFyX2xpbWl0czogd2l0aGluQ2hhckxpbWl0cyxcbiAgICBub19mYWJyaWNhdGlvbjogdHJ1ZSxcbiAgICBoYXNfcGVyc29uYWxpemF0aW9uOiB1c2VkUGVyc29uYWxpemF0aW9uXG4gIH07XG59O1xuXG5jb25zdCBnZW5lcmF0ZU91dHB1dCA9IGFzeW5jIChyYXdJbnB1dCA9IHt9LCBvcHRpb25zID0ge30pID0+IHtcbiAgY29uc3QgaW5wdXQgPSBub3JtYWxpemVJbnB1dChyYXdJbnB1dCk7XG4gIGNvbnN0IGFuYXRvbHlEYXRhID0gZXh0cmFjdEFuYXRvbHlEYXRhKGlucHV0LmFuYXRvbHlfb3V0cHV0X2pzb24pO1xuICBjb25zdCBhcnRlbURhdGEgPSBleHRyYWN0QXJ0ZW1EYXRhKGlucHV0LmFydGVtX291dHB1dF9qc29uKTtcblxuICBpZiAoIWFuYXRvbHlEYXRhICYmICFhcnRlbURhdGEpIHtcbiAgICBjb25zdCBtZXNzYWdlVGV4dCA9IFwi0J/RgNC40YjQu9C4INGA0LDQt9Cx0L7RgCDQnNCw0YDQuNC4IChKU09OKSDQuNC70LggaG90LWxlYWRzINCQ0YDRgtGR0LzQsCwg0YfRgtC+0LHRiyDRjyDRgdC00LXQu9Cw0Lsg0L/QtdGA0YHQvtC90LDQu9C40LfQsNGG0LjRji5cIjtcbiAgICBjb25zdCBvdXRwdXQgPSB7XG4gICAgICBkbV9wYWNrOiB7XG4gICAgICAgIGxlYWRfbGFiZWw6IFwi0J3Rg9C20L3RiyDQtNCw0L3QvdGL0LVcIixcbiAgICAgICAgY2hhbm5lbDogaW5wdXQuY2hhbm5lbCxcbiAgICAgICAgY2hhbm5lbF90d2Vha3M6IGJ1aWxkQ2hhbm5lbFR3ZWFrcygpLFxuICAgICAgICBtZXNzYWdlczoge1xuICAgICAgICAgIGZpcnN0X21lc3NhZ2U6IHtcbiAgICAgICAgICAgIHRleHQ6IGNsYW1wVGV4dChtZXNzYWdlVGV4dCwgaW5wdXQuY29uc3RyYWludHMubWF4X2NoYXJzX2ZpcnN0KSxcbiAgICAgICAgICAgIHRvbmU6IFwibmV1dHJhbFwiLFxuICAgICAgICAgICAgcGVyc29uYWxpemF0aW9uX2xpbmU6IFwiXCIsXG4gICAgICAgICAgICBvYmplY3Rpb25fcHJlZW1wdF9saW5lOiBcIlwiLFxuICAgICAgICAgICAgcXVlc3Rpb25fbGluZTogbWVzc2FnZVRleHQsXG4gICAgICAgICAgICBjdGFfbGluZTogXCJcIixcbiAgICAgICAgICAgIGdyb3VuZGluZ19yZWZzOiBbXVxuICAgICAgICAgIH0sXG4gICAgICAgICAgZm9sbG93dXBzOiBbXVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgbWV0YToge1xuICAgICAgICBnZW5lcmF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgdXNlZF9pbnB1dHM6IHsgdXNlZF9hbmF0b2x5OiBmYWxzZSwgdXNlZF9hcnRlbTogZmFsc2UgfSxcbiAgICAgICAgbGltaXRhdGlvbnM6IFtcItCd0LXRgiDQstGF0L7QtNC90YvRhSBKU09OINC00LvRjyDQv9C10YDRgdC+0L3QsNC70LjQt9Cw0YbQuNC4LlwiXSxcbiAgICAgICAgYXNzdW1wdGlvbnM6IFtdLFxuICAgICAgICBsaW5rX3BvbGljeTogeyBub19saW5rczogaW5wdXQuY29uc3RyYWludHMubm9fbGlua3MsIHJlcGxhY2VtZW50OiBcItCh0LrQuNC90YMg0YLQtdC60YHRgtC+0LwuXCIgfSxcbiAgICAgICAgc2FmZXR5OiB7IG5vX3BlcnNvbmFsX2RhdGE6IHRydWUsIG5vX3N0YWxraW5nOiB0cnVlIH0sXG4gICAgICAgIHF1YWxpdHlfY2hlY2tzOiB7XG4gICAgICAgICAgbm9fZmx1ZmY6IHRydWUsXG4gICAgICAgICAgd2l0aGluX2NoYXJfbGltaXRzOiB0cnVlLFxuICAgICAgICAgIG5vX2ZhYnJpY2F0aW9uOiB0cnVlLFxuICAgICAgICAgIGhhc19wZXJzb25hbGl6YXRpb246IGZhbHNlXG4gICAgICAgIH0sXG4gICAgICAgIG5lZWRzUmV2aWV3OiB0cnVlXG4gICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4geyBvdXRwdXQ6IHdyYXBPdXRwdXQob3V0cHV0LCBpbnB1dCksIGVmZmVjdGl2ZUlucHV0OiBpbnB1dCB9O1xuICB9XG5cbiAgY29uc3QgbWVzc2FnZVNldHMgPSBbXTtcbiAgY29uc3QgdmFyaWFudHMgPSBbXTtcblxuICBpZiAoYW5hdG9seURhdGEpIHtcbiAgICBjb25zdCBwZXJzb25hbGl6YXRpb24gPSBidWlsZFBlcnNvbmFsaXphdGlvbkZyb21BbmF0b2x5KGFuYXRvbHlEYXRhKTtcbiAgICBpZiAocGVyc29uYWxpemF0aW9uKSB7XG4gICAgICBtZXNzYWdlU2V0cy5wdXNoKHtcbiAgICAgICAgbGFiZWw6IGFuYXRvbHlEYXRhLmNvbXBhbnlOYW1lIHx8IFwiQ29tcGFueVwiLFxuICAgICAgICBzb3VyY2U6IFwiYW5hdG9seVwiLFxuICAgICAgICBwZXJzb25hbGl6YXRpb25cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGlmIChhcnRlbURhdGEpIHtcbiAgICBjb25zdCBwZXJzb25hbGl6YXRpb24gPSBidWlsZFBlcnNvbmFsaXphdGlvbkZyb21BcnRlbShhcnRlbURhdGEpO1xuICAgIGlmIChwZXJzb25hbGl6YXRpb24pIHtcbiAgICAgIG1lc3NhZ2VTZXRzLnB1c2goe1xuICAgICAgICBsYWJlbDogYXJ0ZW1EYXRhLnRvcExlYWQ/LnRpdGxlID8gYEhvdCBsZWFkOiAke2FydGVtRGF0YS50b3BMZWFkLnRpdGxlfWAgOiBcIkhvdCBsZWFkXCIsXG4gICAgICAgIHNvdXJjZTogXCJhcnRlbVwiLFxuICAgICAgICBwZXJzb25hbGl6YXRpb25cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IHRvbmVzID0gaW5wdXQudG9uZV9wYWNrID09PSBcIm1peGVkXCIgPyBbXCJuZXV0cmFsXCIsIFwiYnVzaW5lc3NcIiwgXCJzaG9ydF9oYXJkXCJdIDogW2lucHV0LnRvbmVfcGFja107XG5cbiAgY29uc3QgZm9sbG93dXBDb3VudCA9IGlucHV0LnRvbmVfcGFjayA9PT0gXCJtaXhlZFwiID8gMiA6IDM7XG5cbiAgbWVzc2FnZVNldHMuZm9yRWFjaCgoc2V0KSA9PiB7XG4gICAgdG9uZXMuZm9yRWFjaCgodG9uZSkgPT4ge1xuICAgICAgY29uc3QgbWVzc2FnZVNldCA9IGJ1aWxkTWVzc2FnZVNldCh7XG4gICAgICAgIHBlcnNvbmFsaXphdGlvbkxpbmU6IHNldC5wZXJzb25hbGl6YXRpb24ucGVyc29uYWxpemF0aW9uTGluZSxcbiAgICAgICAgdmFsdWVMaW5lOiBzZXQucGVyc29uYWxpemF0aW9uLnZhbHVlTGluZSxcbiAgICAgICAgZ3JvdW5kaW5nUmVmczogc2V0LnBlcnNvbmFsaXphdGlvbi5ncm91bmRpbmdSZWZzLFxuICAgICAgICB0b25lLFxuICAgICAgICBjaGFubmVsOiBpbnB1dC5jaGFubmVsID09PSBcIm11bHRpXCIgPyBcInRlbGVncmFtXCIgOiBpbnB1dC5jaGFubmVsLFxuICAgICAgICBnb2FsOiBpbnB1dC5nb2FsLFxuICAgICAgICBjb25zdHJhaW50czogaW5wdXQuY29uc3RyYWludHMsXG4gICAgICAgIGZvbGxvd3VwQ291bnRcbiAgICAgIH0pO1xuICAgICAgdmFyaWFudHMucHVzaCh7XG4gICAgICAgIGxhYmVsOiBzZXQubGFiZWwsXG4gICAgICAgIHRvbmUsXG4gICAgICAgIC4uLm1lc3NhZ2VTZXRcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBjb25zdCBwcmltYXJ5ID0gdmFyaWFudHNbMF07XG4gIGNvbnN0IGxlYWRMYWJlbCA9IGJ1aWxkTGVhZExhYmVsKGFuYXRvbHlEYXRhLCBhcnRlbURhdGEsIGlucHV0LmxlYWRfaWRlbnRpdHkpO1xuXG4gIGNvbnN0IGRtX3BhY2sgPSB7XG4gICAgbGVhZF9sYWJlbDogbGVhZExhYmVsLFxuICAgIGNoYW5uZWw6IGlucHV0LmNoYW5uZWwsXG4gICAgY2hhbm5lbF90d2Vha3M6IGJ1aWxkQ2hhbm5lbFR3ZWFrcygpLFxuICAgIG1lc3NhZ2VzOiBwcmltYXJ5XG4gICAgICA/IHtcbiAgICAgICAgICBmaXJzdF9tZXNzYWdlOiBwcmltYXJ5LmZpcnN0X21lc3NhZ2UsXG4gICAgICAgICAgZm9sbG93dXBzOiBwcmltYXJ5LmZvbGxvd3Vwc1xuICAgICAgICB9XG4gICAgICA6IHtcbiAgICAgICAgICBmaXJzdF9tZXNzYWdlOiB7XG4gICAgICAgICAgICB0ZXh0OiBcIlwiLFxuICAgICAgICAgICAgdG9uZTogXCJuZXV0cmFsXCIsXG4gICAgICAgICAgICBwZXJzb25hbGl6YXRpb25fbGluZTogXCJcIixcbiAgICAgICAgICAgIG9iamVjdGlvbl9wcmVlbXB0X2xpbmU6IFwiXCIsXG4gICAgICAgICAgICBxdWVzdGlvbl9saW5lOiBcIlwiLFxuICAgICAgICAgICAgY3RhX2xpbmU6IFwiXCIsXG4gICAgICAgICAgICBncm91bmRpbmdfcmVmczogW11cbiAgICAgICAgICB9LFxuICAgICAgICAgIGZvbGxvd3VwczogW11cbiAgICAgICAgfSxcbiAgICB2YXJpYW50czogdmFyaWFudHMubGVuZ3RoID4gMSA/IHZhcmlhbnRzLm1hcCgodmFyaWFudCkgPT4gKHtcbiAgICAgIGxhYmVsOiB2YXJpYW50LmxhYmVsLFxuICAgICAgdG9uZTogdmFyaWFudC50b25lLFxuICAgICAgZmlyc3RfbWVzc2FnZTogdmFyaWFudC5maXJzdF9tZXNzYWdlLFxuICAgICAgZm9sbG93dXBzOiB2YXJpYW50LmZvbGxvd3Vwc1xuICAgIH0pKSA6IHVuZGVmaW5lZFxuICB9O1xuXG4gIGNvbnN0IHVzZWRQZXJzb25hbGl6YXRpb24gPSB2YXJpYW50cy5zb21lKCh2YXJpYW50KSA9PiB2YXJpYW50LmZpcnN0X21lc3NhZ2UucGVyc29uYWxpemF0aW9uX2xpbmUpO1xuICBjb25zdCBxdWFsaXR5ID0gdmFsaWRhdGVRdWFsaXR5KHZhcmlhbnRzLCBpbnB1dC5jb25zdHJhaW50cywgdXNlZFBlcnNvbmFsaXphdGlvbik7XG4gIGNvbnN0IGZyb21Ib3RMZWFkID0gQm9vbGVhbihhcnRlbURhdGEpO1xuXG4gIGNvbnN0IG91dHB1dCA9IHtcbiAgICBkbV9wYWNrLFxuICAgIG1ldGE6IHtcbiAgICAgIGdlbmVyYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgdXNlZF9pbnB1dHM6IHsgdXNlZF9hbmF0b2x5OiBCb29sZWFuKGFuYXRvbHlEYXRhKSwgdXNlZF9hcnRlbTogQm9vbGVhbihhcnRlbURhdGEpIH0sXG4gICAgICBsaW1pdGF0aW9uczogW10sXG4gICAgICBhc3N1bXB0aW9uczogW10sXG4gICAgICBsaW5rX3BvbGljeTogeyBub19saW5rczogaW5wdXQuY29uc3RyYWludHMubm9fbGlua3MsIHJlcGxhY2VtZW50OiBcItCh0LrQuNC90YMg0YLQtdC60YHRgtC+0LwuXCIgfSxcbiAgICAgIHNhZmV0eTogeyBub19wZXJzb25hbF9kYXRhOiB0cnVlLCBub19zdGFsa2luZzogZnJvbUhvdExlYWQgfSxcbiAgICAgIHF1YWxpdHlfY2hlY2tzOiBxdWFsaXR5LFxuICAgICAgbmVlZHNSZXZpZXc6ICF1c2VkUGVyc29uYWxpemF0aW9uXG4gICAgfVxuICB9O1xuXG4gIHJldHVybiB7IG91dHB1dDogd3JhcE91dHB1dChvdXRwdXQsIGlucHV0KSwgZWZmZWN0aXZlSW5wdXQ6IGlucHV0IH07XG59O1xuXG5jb25zdCBnZW5lcmF0ZUxlb25pZE91dHB1dCA9IGFzeW5jIChpbnB1dCA9IHt9LCBvcHRpb25zID0ge30pID0+IHtcbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2VuZXJhdGVPdXRwdXQoaW5wdXQsIG9wdGlvbnMpO1xuICByZXR1cm4gcmVzdWx0Lm91dHB1dDtcbn07XG5cbmNvbnN0IHZhbGlkYXRlTGVvbmlkT3V0cHV0ID0gKHBheWxvYWQpID0+IHtcbiAgY29uc3QgZXJyb3JzID0gW107XG4gIGNvbnN0IGxlZ2FjeSA9IHVud3JhcExlZ2FjeShwYXlsb2FkKTtcbiAgaWYgKCFsZWdhY3kgfHwgdHlwZW9mIGxlZ2FjeSAhPT0gXCJvYmplY3RcIikge1xuICAgIHJldHVybiB7IHZhbGlkOiBmYWxzZSwgZXJyb3JzOiBbXCJPdXRwdXQgbXVzdCBiZSBhbiBvYmplY3QuXCJdIH07XG4gIH1cbiAgcGF5bG9hZCA9IGxlZ2FjeTtcbiAgaWYgKCFwYXlsb2FkLmRtX3BhY2spIGVycm9ycy5wdXNoKFwiZG1fcGFjayByZXF1aXJlZFwiKTtcbiAgaWYgKCFwYXlsb2FkLm1ldGEpIGVycm9ycy5wdXNoKFwibWV0YSByZXF1aXJlZFwiKTtcbiAgaWYgKHBheWxvYWQuZG1fcGFjayAmJiAhcGF5bG9hZC5kbV9wYWNrLmNoYW5uZWxfdHdlYWtzKSB7XG4gICAgZXJyb3JzLnB1c2goXCJkbV9wYWNrLmNoYW5uZWxfdHdlYWtzIHJlcXVpcmVkXCIpO1xuICB9XG4gIGlmICghcGF5bG9hZC5tZXRhPy5saW5rX3BvbGljeSB8fCB0eXBlb2YgcGF5bG9hZC5tZXRhLmxpbmtfcG9saWN5Lm5vX2xpbmtzICE9PSBcImJvb2xlYW5cIikge1xuICAgIGVycm9ycy5wdXNoKFwibWV0YS5saW5rX3BvbGljeSByZXF1aXJlZFwiKTtcbiAgfVxuICByZXR1cm4geyB2YWxpZDogZXJyb3JzLmxlbmd0aCA9PT0gMCwgZXJyb3JzIH07XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgaW5wdXREZWZhdWx0cyxcbiAgaW5wdXRTY2hlbWEsXG4gIG91dHB1dFNjaGVtYSxcbiAgc3lzdGVtUHJvbXB0LFxuICBsZW9uaWRBZ2VudCxcbiAgbm9ybWFsaXplSW5wdXQsXG4gIGdlbmVyYXRlT3V0cHV0LFxuICBnZW5lcmF0ZUxlb25pZE91dHB1dCxcbiAgdmFsaWRhdGVMZW9uaWRPdXRwdXRcbn07XG4iXSwibmFtZXMiOlsiY3J5cHRvIiwicmVxdWlyZSIsIndyYXBBZ2VudE91dHB1dCIsInVud3JhcExlZ2FjeSIsImlucHV0RGVmYXVsdHMiLCJtb2RlIiwiY2hhbm5lbCIsInRvbmVfcGFjayIsImdvYWwiLCJwcm9kdWN0X25hbWUiLCJwcm9kdWN0X29uZV9saW5lciIsImNvbnN0cmFpbnRzIiwibWF4X2NoYXJzX2ZpcnN0IiwibWF4X2NoYXJzX2ZvbGxvd3VwIiwibm9fbGlua3MiLCJhbmF0b2x5X291dHB1dF9qc29uIiwiYXJ0ZW1fb3V0cHV0X2pzb24iLCJsZWFkX2lkZW50aXR5IiwiY29tcGFueV9uYW1lIiwiYnJhbmQiLCJjaXR5IiwibGFuZ3VhZ2UiLCJpbnB1dFNjaGVtYSIsInR5cGUiLCJhZGRpdGlvbmFsUHJvcGVydGllcyIsInByb3BlcnRpZXMiLCJlbnVtIiwiZGVmYXVsdCIsInJlcXVpcmVkIiwib3V0cHV0U2NoZW1hIiwiZG1fcGFjayIsIm1ldGEiLCJzeXN0ZW1Qcm9tcHQiLCJsZW9uaWRBZ2VudCIsImlkIiwiZGlzcGxheU5hbWUiLCJkZXNjcmlwdGlvbiIsIndyYXBPdXRwdXQiLCJsZWdhY3lPdXRwdXQiLCJpbnB1dCIsImFnZW50SWQiLCJpbnB1dEVjaG8iLCJmbHVmZkJsYWNrbGlzdCIsInNhbml0aXplVGV4dCIsInRleHQiLCJ0cmltbWVkIiwicmVwbGFjZSIsInRyaW0iLCJoYWRMaW5rcyIsInRlc3QiLCJzdHJpcHBlZCIsImNsYW1wVGV4dCIsIm1heCIsImxlbmd0aCIsInNsaWNlIiwiZGVkdXBlQXJyYXkiLCJhcnIiLCJBcnJheSIsImZyb20iLCJTZXQiLCJmaWx0ZXIiLCJpdGVtIiwidW5kZWZpbmVkIiwibm9ybWFsaXplSW5wdXQiLCJzYWZlIiwiaW5jbHVkZXMiLCJNYXRoIiwicm91bmQiLCJleHRyYWN0QW5hdG9seURhdGEiLCJhbmF0b2x5IiwiYWNjb3VudCIsImFjY291bnRfY2FyZCIsImFjY291bnRDYXJkIiwiaG9va3MiLCJpc0FycmF5IiwidG9wX3BlcnNvbmFsaXphdGlvbl9ob29rcyIsInBhaW5zIiwicGFpbl9oeXBvdGhlc2VzIiwicHJpbWFyeUhvb2siLCJzZWNvbmRhcnlIb29rIiwicHJpbWFyeVBhaW4iLCJjb21wYW55TmFtZSIsInByb29mSXRlbXMiLCJwcm9vZl9pdGVtcyIsImV4dHJhY3RBcnRlbURhdGEiLCJhcnRlbSIsImxlYWRzIiwiaG90X2xlYWRzIiwidG9wTGVhZCIsImJ1aWxkUGVyc29uYWxpemF0aW9uRnJvbUFuYXRvbHkiLCJhbmF0b2x5RGF0YSIsImhvb2siLCJwYWluIiwicGVyc29uYWxpemF0aW9uTGluZSIsImhvb2tfdGV4dCIsInZhbHVlTGluZSIsImh5cG90aGVzaXMiLCJyZWZzIiwicmVsYXRlZF9wcm9vZnMiLCJncm91bmRpbmdSZWZzIiwiYnVpbGRQZXJzb25hbGl6YXRpb25Gcm9tQXJ0ZW0iLCJhcnRlbURhdGEiLCJsZWFkIiwicmVhc29uIiwiaG90X3JlYXNvbnMiLCJyZXF1ZXN0X3N1bW1hcnkiLCJjYXRlZ29yeSIsImNhdGVnb3J5X2hpbnQiLCJyZW1vdmVQZXJzb25hbERhdGEiLCJwcm9vZl9yZWZzIiwiYnVpbGRRdWVzdGlvbkxpbmUiLCJidWlsZEN0YUxpbmUiLCJidWlsZE9iamVjdGlvblByZWVtcHRMaW5lIiwidG9uZSIsIlN0cmluZyIsImFwcGx5Q2hhbm5lbFRvbmVUd2Vha3MiLCJsaW5lIiwiYnVpbGRDaGFubmVsVHdlYWtzIiwiVEciLCJWSyIsIldBIiwidG9uZVByZWZpeCIsImNvbXBvc2VNZXNzYWdlIiwicXVlc3Rpb25MaW5lIiwiY3RhTGluZSIsIm9iamVjdGlvblByZWVtcHRMaW5lIiwibGluZXMiLCJwcmVmaXgiLCJwdXNoIiwibWFwIiwidHJpbU1lc3NhZ2VUb0xpbWl0IiwibWF4Q2hhcnMiLCJqb2luIiwicmVkdWNlZCIsInNwbGljZSIsInNob3J0ZW5lZCIsImZsb29yIiwiYnVpbGRGb2xsb3d1cHMiLCJjb3VudCIsImZvbGxvd3VwcyIsInRlbXBsYXRlcyIsImFuZ2xlIiwib2Zmc2V0cyIsImkiLCJtaW4iLCJ0ZW1wbGF0ZSIsImZpbmFsVGV4dCIsImRheV9vZmZzZXQiLCJncm91bmRpbmdfcmVmcyIsImJ1aWxkTWVzc2FnZVNldCIsImZvbGxvd3VwQ291bnQiLCJzYW5pdGl6ZWRUZXh0IiwiZmlyc3RfbWVzc2FnZSIsInBlcnNvbmFsaXphdGlvbl9saW5lIiwib2JqZWN0aW9uX3ByZWVtcHRfbGluZSIsInF1ZXN0aW9uX2xpbmUiLCJjdGFfbGluZSIsImJ1aWxkTGVhZExhYmVsIiwibGVhZElkZW50aXR5IiwidGl0bGUiLCJjb250YWluc0ZsdWZmIiwic29tZSIsIndvcmQiLCJ0b0xvd2VyQ2FzZSIsInZhbGlkYXRlUXVhbGl0eSIsIm1lc3NhZ2VzIiwidXNlZFBlcnNvbmFsaXphdGlvbiIsImFsbFRleHRzIiwiZmxhdE1hcCIsImxpbWl0IiwiZiIsIndpdGhpbkNoYXJMaW1pdHMiLCJldmVyeSIsIm5vRmx1ZmYiLCJub19mbHVmZiIsIndpdGhpbl9jaGFyX2xpbWl0cyIsIm5vX2ZhYnJpY2F0aW9uIiwiaGFzX3BlcnNvbmFsaXphdGlvbiIsImdlbmVyYXRlT3V0cHV0IiwicmF3SW5wdXQiLCJvcHRpb25zIiwibWVzc2FnZVRleHQiLCJvdXRwdXQiLCJsZWFkX2xhYmVsIiwiY2hhbm5lbF90d2Vha3MiLCJnZW5lcmF0ZWRfYXQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJ1c2VkX2lucHV0cyIsInVzZWRfYW5hdG9seSIsInVzZWRfYXJ0ZW0iLCJsaW1pdGF0aW9ucyIsImFzc3VtcHRpb25zIiwibGlua19wb2xpY3kiLCJyZXBsYWNlbWVudCIsInNhZmV0eSIsIm5vX3BlcnNvbmFsX2RhdGEiLCJub19zdGFsa2luZyIsInF1YWxpdHlfY2hlY2tzIiwibmVlZHNSZXZpZXciLCJlZmZlY3RpdmVJbnB1dCIsIm1lc3NhZ2VTZXRzIiwidmFyaWFudHMiLCJwZXJzb25hbGl6YXRpb24iLCJsYWJlbCIsInNvdXJjZSIsInRvbmVzIiwiZm9yRWFjaCIsInNldCIsIm1lc3NhZ2VTZXQiLCJwcmltYXJ5IiwibGVhZExhYmVsIiwidmFyaWFudCIsInF1YWxpdHkiLCJmcm9tSG90TGVhZCIsIkJvb2xlYW4iLCJnZW5lcmF0ZUxlb25pZE91dHB1dCIsInJlc3VsdCIsInZhbGlkYXRlTGVvbmlkT3V0cHV0IiwicGF5bG9hZCIsImVycm9ycyIsImxlZ2FjeSIsInZhbGlkIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/agents/leonid.js\n");

/***/ }),

/***/ "(rsc)/./lib/llm/provider.js":
/*!*****************************!*\
  !*** ./lib/llm/provider.js ***!
  \*****************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("\nconst fs = __webpack_require__(/*! node:fs */ \"node:fs\");\nconst path = __webpack_require__(/*! node:path */ \"node:path\");\nconst DEFAULT_PROVIDER = \"fake\";\nconst normalizeProviderName = (value)=>{\n    const normalized = String(value || \"\").trim().toLowerCase();\n    return normalized === \"real\" ? \"real\" : \"fake\";\n};\nconst getConfiguredProviderName = ()=>normalizeProviderName(process.env.LLM_PROVIDER || DEFAULT_PROVIDER);\nconst hasRealProviderCredentials = ()=>Boolean(String(process.env.OPENAI_API_KEY || \"\").trim());\nconst AGENT_ID_ALIASES = {\n    platon: \"platon-prospect-research-ru\",\n    anatoly: \"anatoly-account-research-ru\",\n    maxim: \"maxim-local-leads-ru\"\n};\nconst canonicalAgentId = (agentId)=>{\n    if (!agentId) return \"\";\n    const normalized = String(agentId).trim();\n    return AGENT_ID_ALIASES[normalized] || normalized;\n};\nconst resolveFixtureOutputPath = (agentId, fixturesRoot)=>{\n    const canonical = canonicalAgentId(agentId);\n    if (!canonical) return \"\";\n    const root = fixturesRoot || path.join(process.cwd(), \"fixtures\", \"agents\");\n    return path.join(root, canonical, \"output.json\");\n};\nconst hasFixtureForAgent = (agentId, fixturesRoot)=>{\n    const outputPath = resolveFixtureOutputPath(agentId, fixturesRoot);\n    return Boolean(outputPath && fs.existsSync(outputPath));\n};\nconst stripVolatile = (value)=>{\n    if (!value || typeof value !== \"object\") return value;\n    if (Array.isArray(value)) return value.map((item)=>stripVolatile(item));\n    const next = {};\n    Object.entries(value).forEach(([key, val])=>{\n        if (key === \"generated_at\") {\n            next[key] = \"1970-01-01T00:00:00.000Z\";\n            return;\n        }\n        if (key === \"run_id\" || key === \"trace_id\") {\n            next[key] = \"stub-run\";\n            return;\n        }\n        if (key === \"duration_ms\") {\n            next[key] = 0;\n            return;\n        }\n        next[key] = stripVolatile(val);\n    });\n    return next;\n};\nconst cloneJson = (value)=>{\n    try {\n        return JSON.parse(JSON.stringify(value));\n    } catch  {\n        return value;\n    }\n};\nconst pickSchemaNode = (schema)=>{\n    if (!schema || typeof schema !== \"object\") return {};\n    if (Array.isArray(schema.oneOf) && schema.oneOf.length) return schema.oneOf[0] || {};\n    if (Array.isArray(schema.anyOf) && schema.anyOf.length) return schema.anyOf[0] || {};\n    if (Array.isArray(schema.allOf) && schema.allOf.length) {\n        return schema.allOf.reduce((acc, item)=>({\n                ...acc,\n                ...item\n            }), {});\n    }\n    return schema;\n};\nconst schemaType = (schema)=>{\n    const node = pickSchemaNode(schema);\n    if (!node || typeof node !== \"object\") return \"object\";\n    if (node.const !== undefined) return typeof node.const;\n    if (node.default !== undefined) return typeof node.default;\n    if (Array.isArray(node.enum) && node.enum.length) return typeof node.enum[0];\n    if (Array.isArray(node.type)) return node.type[0] || \"object\";\n    return node.type || \"object\";\n};\nconst valueForFormat = (format)=>{\n    if (format === \"date-time\") return \"1970-01-01T00:00:00.000Z\";\n    if (format === \"date\") return \"1970-01-01\";\n    if (format === \"email\") return \"stub@example.com\";\n    if (format === \"uri\" || format === \"url\") return \"https://example.com\";\n    return \"stub\";\n};\nconst buildFromSchema = (schema, keyHint = \"\")=>{\n    const node = pickSchemaNode(schema);\n    if (!node || typeof node !== \"object\") return {};\n    if (Object.prototype.hasOwnProperty.call(node, \"const\")) return cloneJson(node.const);\n    if (Object.prototype.hasOwnProperty.call(node, \"default\")) return cloneJson(node.default);\n    if (Array.isArray(node.enum) && node.enum.length) return cloneJson(node.enum[0]);\n    const type = schemaType(node);\n    if (type === \"string\") {\n        if (node.format) return valueForFormat(node.format);\n        if (keyHint.toLowerCase().includes(\"email\")) return \"stub@example.com\";\n        if (keyHint.toLowerCase().includes(\"url\") || keyHint.toLowerCase().includes(\"link\")) {\n            return \"https://example.com\";\n        }\n        return \"stub\";\n    }\n    if (type === \"number\" || type === \"integer\") {\n        if (Number.isFinite(node.minimum)) return Number(node.minimum);\n        return 0;\n    }\n    if (type === \"boolean\") return false;\n    if (type === \"array\") {\n        const itemSchema = node.items || {};\n        return [\n            buildFromSchema(itemSchema, keyHint ? `${keyHint}_item` : \"item\")\n        ];\n    }\n    if (type === \"object\") {\n        const properties = node.properties && typeof node.properties === \"object\" ? node.properties : {};\n        const required = Array.isArray(node.required) ? node.required : [];\n        const keys = new Set([\n            ...required,\n            ...Object.keys(properties)\n        ]);\n        const result = {};\n        if (keys.size === 0) {\n            return keyHint === \"meta\" ? {\n                generated_at: \"1970-01-01T00:00:00.000Z\"\n            } : {};\n        }\n        keys.forEach((key)=>{\n            const childSchema = properties[key] || {};\n            result[key] = buildFromSchema(childSchema, key);\n        });\n        return result;\n    }\n    return {};\n};\nclass FakeLLMProvider {\n    constructor(options = {}){\n        this.name = \"fake\";\n        this.fixturesRoot = options.fixturesRoot || path.join(process.cwd(), \"fixtures\", \"agents\");\n    }\n    loadFixtureData(agentId) {\n        const outputPath = resolveFixtureOutputPath(agentId, this.fixturesRoot);\n        if (!outputPath || !fs.existsSync(outputPath)) return null;\n        try {\n            const parsed = JSON.parse(fs.readFileSync(outputPath, \"utf8\"));\n            const legacyData = parsed && parsed.data ? parsed.data : parsed;\n            return stripVolatile(cloneJson(legacyData));\n        } catch  {\n            return null;\n        }\n    }\n    async generateJson({ schema, meta } = {}) {\n        const agentId = meta && typeof meta === \"object\" ? meta.agent_id || meta.agentId : \"\";\n        const fixtureData = agentId ? this.loadFixtureData(agentId) : null;\n        if (fixtureData) {\n            return fixtureData;\n        }\n        return buildFromSchema(schema || {}, \"root\");\n    }\n}\nconst sanitizeSchemaName = (value)=>{\n    const normalized = String(value || \"agent_output\").replace(/[^a-zA-Z0-9_]/g, \"_\").replace(/_+/g, \"_\").replace(/^_+|_+$/g, \"\");\n    return normalized || \"agent_output\";\n};\nconst stripCodeFences = (value)=>String(value || \"\").replace(/```json/gi, \"```\").replace(/^```/, \"\").replace(/```$/, \"\").trim();\nconst parseJsonString = (value)=>{\n    if (typeof value !== \"string\") return null;\n    const direct = value.trim();\n    if (!direct) return null;\n    try {\n        return JSON.parse(direct);\n    } catch  {\n    // continue\n    }\n    const stripped = stripCodeFences(direct);\n    if (!stripped) return null;\n    try {\n        return JSON.parse(stripped);\n    } catch  {\n        return null;\n    }\n};\nconst extractErrorMessage = (payload)=>{\n    if (!payload || typeof payload !== \"object\") return \"\";\n    if (payload.error && typeof payload.error === \"object\") {\n        const message = payload.error.message || payload.error.code;\n        if (message) return String(message);\n    }\n    return \"\";\n};\nconst getNumericOption = (value, fallback)=>{\n    const numeric = Number(value);\n    return Number.isFinite(numeric) ? numeric : fallback;\n};\nclass RealLLMProvider {\n    constructor(options = {}){\n        this.name = \"real\";\n        this.apiKey = options.apiKey || process.env.OPENAI_API_KEY || \"\";\n        this.baseUrl = String(options.baseUrl || process.env.OPENAI_BASE_URL || \"https://api.openai.com/v1\").replace(/\\/+$/, \"\");\n        this.model = options.model || process.env.OPENAI_MODEL || \"gpt-5-mini\";\n        this.timeoutMs = getNumericOption(options.timeoutMs || process.env.OPENAI_TIMEOUT_MS, 45000);\n        this.fetchImpl = options.fetch || globalThis.fetch;\n    }\n    async requestChatCompletions(payload) {\n        if (typeof this.fetchImpl !== \"function\") {\n            throw new Error(\"Global fetch is not available for RealLLMProvider.\");\n        }\n        const controller = new AbortController();\n        const timeout = setTimeout(()=>controller.abort(), this.timeoutMs);\n        let response;\n        try {\n            response = await this.fetchImpl(`${this.baseUrl}/chat/completions`, {\n                method: \"POST\",\n                headers: {\n                    \"content-type\": \"application/json\",\n                    authorization: `Bearer ${this.apiKey}`\n                },\n                body: JSON.stringify(payload),\n                signal: controller.signal\n            });\n        } catch (error) {\n            const message = error && typeof error === \"object\" && error.name === \"AbortError\" ? `OpenAI request timed out after ${this.timeoutMs}ms` : `OpenAI request failed: ${error instanceof Error ? error.message : \"unknown error\"}`;\n            throw new Error(message);\n        } finally{\n            clearTimeout(timeout);\n        }\n        const text = await response.text();\n        const parsed = parseJsonString(text) || {};\n        if (!response.ok) {\n            const apiMessage = extractErrorMessage(parsed);\n            const reason = apiMessage || text.slice(0, 300) || `HTTP ${response.status}`;\n            const error = new Error(`OpenAI request failed (${response.status}): ${reason}`);\n            error.status = response.status;\n            throw error;\n        }\n        return parsed;\n    }\n    extractMessageText(payload) {\n        const content = payload?.choices?.[0]?.message?.content;\n        if (typeof content === \"string\") return content;\n        if (Array.isArray(content)) {\n            return content.map((part)=>{\n                if (!part || typeof part !== \"object\") return \"\";\n                if (typeof part.text === \"string\") return part.text;\n                if (part.text && typeof part.text === \"object\" && typeof part.text.value === \"string\") {\n                    return part.text.value;\n                }\n                if (typeof part.content === \"string\") return part.content;\n                return \"\";\n            }).join(\"\").trim();\n        }\n        return \"\";\n    }\n    buildMessages(system, prompt, schema) {\n        const baseSystem = typeof system === \"string\" && system.trim() ? system.trim() : \"You are a strict JSON assistant.\";\n        const schemaHint = schema && typeof schema === \"object\" && Object.keys(schema).length ? `Return only JSON that matches this schema:\\n${JSON.stringify(schema)}` : \"Return only valid JSON.\";\n        const userPrompt = typeof prompt === \"string\" && prompt.trim() ? prompt.trim() : \"{}\";\n        return [\n            {\n                role: \"system\",\n                content: `${baseSystem}\\n\\n${schemaHint}`\n            },\n            {\n                role: \"user\",\n                content: userPrompt\n            }\n        ];\n    }\n    async generateJson({ system, prompt, schema, temperature, maxTokens, meta } = {}) {\n        if (!this.apiKey) {\n            throw new Error(\"OPENAI_API_KEY is required when LLM_PROVIDER=real.\");\n        }\n        const requestedModel = meta && typeof meta === \"object\" && typeof meta.model === \"string\" ? meta.model.trim() : \"\";\n        const model = requestedModel || this.model;\n        const messages = this.buildMessages(system, prompt, schema);\n        const cappedTemperature = Math.min(Math.max(getNumericOption(temperature, 0.2), 0), 1.5);\n        const tokenLimit = Math.max(200, Math.min(6000, getNumericOption(maxTokens, 1800)));\n        const hasSchema = Boolean(schema && typeof schema === \"object\" && Object.keys(schema).length);\n        const schemaName = sanitizeSchemaName(meta && typeof meta === \"object\" ? meta.agent_id || meta.agentId || \"agent_output\" : \"agent_output\");\n        const withSchemaPayload = {\n            model,\n            messages,\n            temperature: cappedTemperature,\n            max_tokens: tokenLimit,\n            response_format: hasSchema ? {\n                type: \"json_schema\",\n                json_schema: {\n                    name: schemaName,\n                    strict: true,\n                    schema\n                }\n            } : {\n                type: \"json_object\"\n            }\n        };\n        let firstResult;\n        try {\n            firstResult = await this.requestChatCompletions(withSchemaPayload);\n        } catch (error) {\n            // Some models/endpoints may reject json_schema; fallback to plain json_object.\n            const fallbackPayload = {\n                model,\n                messages,\n                temperature: cappedTemperature,\n                max_tokens: tokenLimit,\n                response_format: {\n                    type: \"json_object\"\n                }\n            };\n            firstResult = await this.requestChatCompletions(fallbackPayload);\n        }\n        const text = this.extractMessageText(firstResult);\n        const parsed = parseJsonString(text);\n        if (parsed && typeof parsed === \"object\") {\n            return parsed;\n        }\n        throw new Error(\"OpenAI returned non-JSON output for generateJson().\");\n    }\n}\nconst createLLMProvider = ({ provider, fixturesRoot } = {})=>{\n    const mode = normalizeProviderName(provider || getConfiguredProviderName());\n    if (mode === \"real\") return new RealLLMProvider();\n    return new FakeLLMProvider({\n        fixturesRoot\n    });\n};\nlet singleton = null;\nconst getLLMProvider = (options = {})=>{\n    if (options.forceNew) return createLLMProvider(options);\n    if (!singleton) singleton = createLLMProvider(options);\n    return singleton;\n};\nconst isFakeLLMProvider = (provider)=>{\n    const name = provider && typeof provider === \"object\" ? provider.name : \"\";\n    return normalizeProviderName(name) === \"fake\";\n};\nmodule.exports = {\n    FakeLLMProvider,\n    RealLLMProvider,\n    buildFromSchema,\n    canonicalAgentId,\n    createLLMProvider,\n    getConfiguredProviderName,\n    getLLMProvider,\n    hasRealProviderCredentials,\n    hasFixtureForAgent,\n    isFakeLLMProvider,\n    resolveFixtureOutputPath,\n    stripVolatile\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvbGxtL3Byb3ZpZGVyLmpzIiwibWFwcGluZ3MiOiI7QUFBQSxNQUFNQSxLQUFLQyxtQkFBT0EsQ0FBQyx3QkFBUztBQUM1QixNQUFNQyxPQUFPRCxtQkFBT0EsQ0FBQyw0QkFBVztBQUVoQyxNQUFNRSxtQkFBbUI7QUFFekIsTUFBTUMsd0JBQXdCLENBQUNDO0lBQzdCLE1BQU1DLGFBQWFDLE9BQU9GLFNBQVMsSUFBSUcsSUFBSSxHQUFHQyxXQUFXO0lBQ3pELE9BQU9ILGVBQWUsU0FBUyxTQUFTO0FBQzFDO0FBRUEsTUFBTUksNEJBQTRCLElBQU1OLHNCQUFzQk8sUUFBUUMsR0FBRyxDQUFDQyxZQUFZLElBQUlWO0FBQzFGLE1BQU1XLDZCQUE2QixJQUNqQ0MsUUFBUVIsT0FBT0ksUUFBUUMsR0FBRyxDQUFDSSxjQUFjLElBQUksSUFBSVIsSUFBSTtBQUV2RCxNQUFNUyxtQkFBbUI7SUFDdkJDLFFBQVE7SUFDUkMsU0FBUztJQUNUQyxPQUFPO0FBQ1Q7QUFFQSxNQUFNQyxtQkFBbUIsQ0FBQ0M7SUFDeEIsSUFBSSxDQUFDQSxTQUFTLE9BQU87SUFDckIsTUFBTWhCLGFBQWFDLE9BQU9lLFNBQVNkLElBQUk7SUFDdkMsT0FBT1MsZ0JBQWdCLENBQUNYLFdBQVcsSUFBSUE7QUFDekM7QUFFQSxNQUFNaUIsMkJBQTJCLENBQUNELFNBQVNFO0lBQ3pDLE1BQU1DLFlBQVlKLGlCQUFpQkM7SUFDbkMsSUFBSSxDQUFDRyxXQUFXLE9BQU87SUFDdkIsTUFBTUMsT0FBT0YsZ0JBQWdCdEIsS0FBS3lCLElBQUksQ0FBQ2hCLFFBQVFpQixHQUFHLElBQUksWUFBWTtJQUNsRSxPQUFPMUIsS0FBS3lCLElBQUksQ0FBQ0QsTUFBTUQsV0FBVztBQUNwQztBQUVBLE1BQU1JLHFCQUFxQixDQUFDUCxTQUFTRTtJQUNuQyxNQUFNTSxhQUFhUCx5QkFBeUJELFNBQVNFO0lBQ3JELE9BQU9ULFFBQVFlLGNBQWM5QixHQUFHK0IsVUFBVSxDQUFDRDtBQUM3QztBQUVBLE1BQU1FLGdCQUFnQixDQUFDM0I7SUFDckIsSUFBSSxDQUFDQSxTQUFTLE9BQU9BLFVBQVUsVUFBVSxPQUFPQTtJQUNoRCxJQUFJNEIsTUFBTUMsT0FBTyxDQUFDN0IsUUFBUSxPQUFPQSxNQUFNOEIsR0FBRyxDQUFDLENBQUNDLE9BQVNKLGNBQWNJO0lBRW5FLE1BQU1DLE9BQU8sQ0FBQztJQUNkQyxPQUFPQyxPQUFPLENBQUNsQyxPQUFPbUMsT0FBTyxDQUFDLENBQUMsQ0FBQ0MsS0FBS0MsSUFBSTtRQUN2QyxJQUFJRCxRQUFRLGdCQUFnQjtZQUMxQkosSUFBSSxDQUFDSSxJQUFJLEdBQUc7WUFDWjtRQUNGO1FBQ0EsSUFBSUEsUUFBUSxZQUFZQSxRQUFRLFlBQVk7WUFDMUNKLElBQUksQ0FBQ0ksSUFBSSxHQUFHO1lBQ1o7UUFDRjtRQUNBLElBQUlBLFFBQVEsZUFBZTtZQUN6QkosSUFBSSxDQUFDSSxJQUFJLEdBQUc7WUFDWjtRQUNGO1FBQ0FKLElBQUksQ0FBQ0ksSUFBSSxHQUFHVCxjQUFjVTtJQUM1QjtJQUNBLE9BQU9MO0FBQ1Q7QUFFQSxNQUFNTSxZQUFZLENBQUN0QztJQUNqQixJQUFJO1FBQ0YsT0FBT3VDLEtBQUtDLEtBQUssQ0FBQ0QsS0FBS0UsU0FBUyxDQUFDekM7SUFDbkMsRUFBRSxPQUFNO1FBQ04sT0FBT0E7SUFDVDtBQUNGO0FBRUEsTUFBTTBDLGlCQUFpQixDQUFDQztJQUN0QixJQUFJLENBQUNBLFVBQVUsT0FBT0EsV0FBVyxVQUFVLE9BQU8sQ0FBQztJQUNuRCxJQUFJZixNQUFNQyxPQUFPLENBQUNjLE9BQU9DLEtBQUssS0FBS0QsT0FBT0MsS0FBSyxDQUFDQyxNQUFNLEVBQUUsT0FBT0YsT0FBT0MsS0FBSyxDQUFDLEVBQUUsSUFBSSxDQUFDO0lBQ25GLElBQUloQixNQUFNQyxPQUFPLENBQUNjLE9BQU9HLEtBQUssS0FBS0gsT0FBT0csS0FBSyxDQUFDRCxNQUFNLEVBQUUsT0FBT0YsT0FBT0csS0FBSyxDQUFDLEVBQUUsSUFBSSxDQUFDO0lBQ25GLElBQUlsQixNQUFNQyxPQUFPLENBQUNjLE9BQU9JLEtBQUssS0FBS0osT0FBT0ksS0FBSyxDQUFDRixNQUFNLEVBQUU7UUFDdEQsT0FBT0YsT0FBT0ksS0FBSyxDQUFDQyxNQUFNLENBQUMsQ0FBQ0MsS0FBS2xCLE9BQVU7Z0JBQUUsR0FBR2tCLEdBQUc7Z0JBQUUsR0FBR2xCLElBQUk7WUFBQyxJQUFJLENBQUM7SUFDcEU7SUFDQSxPQUFPWTtBQUNUO0FBRUEsTUFBTU8sYUFBYSxDQUFDUDtJQUNsQixNQUFNUSxPQUFPVCxlQUFlQztJQUM1QixJQUFJLENBQUNRLFFBQVEsT0FBT0EsU0FBUyxVQUFVLE9BQU87SUFDOUMsSUFBSUEsS0FBS0MsS0FBSyxLQUFLQyxXQUFXLE9BQU8sT0FBT0YsS0FBS0MsS0FBSztJQUN0RCxJQUFJRCxLQUFLRyxPQUFPLEtBQUtELFdBQVcsT0FBTyxPQUFPRixLQUFLRyxPQUFPO0lBQzFELElBQUkxQixNQUFNQyxPQUFPLENBQUNzQixLQUFLSSxJQUFJLEtBQUtKLEtBQUtJLElBQUksQ0FBQ1YsTUFBTSxFQUFFLE9BQU8sT0FBT00sS0FBS0ksSUFBSSxDQUFDLEVBQUU7SUFDNUUsSUFBSTNCLE1BQU1DLE9BQU8sQ0FBQ3NCLEtBQUtLLElBQUksR0FBRyxPQUFPTCxLQUFLSyxJQUFJLENBQUMsRUFBRSxJQUFJO0lBQ3JELE9BQU9MLEtBQUtLLElBQUksSUFBSTtBQUN0QjtBQUVBLE1BQU1DLGlCQUFpQixDQUFDQztJQUN0QixJQUFJQSxXQUFXLGFBQWEsT0FBTztJQUNuQyxJQUFJQSxXQUFXLFFBQVEsT0FBTztJQUM5QixJQUFJQSxXQUFXLFNBQVMsT0FBTztJQUMvQixJQUFJQSxXQUFXLFNBQVNBLFdBQVcsT0FBTyxPQUFPO0lBQ2pELE9BQU87QUFDVDtBQUVBLE1BQU1DLGtCQUFrQixDQUFDaEIsUUFBUWlCLFVBQVUsRUFBRTtJQUMzQyxNQUFNVCxPQUFPVCxlQUFlQztJQUM1QixJQUFJLENBQUNRLFFBQVEsT0FBT0EsU0FBUyxVQUFVLE9BQU8sQ0FBQztJQUUvQyxJQUFJbEIsT0FBTzRCLFNBQVMsQ0FBQ0MsY0FBYyxDQUFDQyxJQUFJLENBQUNaLE1BQU0sVUFBVSxPQUFPYixVQUFVYSxLQUFLQyxLQUFLO0lBQ3BGLElBQUluQixPQUFPNEIsU0FBUyxDQUFDQyxjQUFjLENBQUNDLElBQUksQ0FBQ1osTUFBTSxZQUFZLE9BQU9iLFVBQVVhLEtBQUtHLE9BQU87SUFDeEYsSUFBSTFCLE1BQU1DLE9BQU8sQ0FBQ3NCLEtBQUtJLElBQUksS0FBS0osS0FBS0ksSUFBSSxDQUFDVixNQUFNLEVBQUUsT0FBT1AsVUFBVWEsS0FBS0ksSUFBSSxDQUFDLEVBQUU7SUFFL0UsTUFBTUMsT0FBT04sV0FBV0M7SUFFeEIsSUFBSUssU0FBUyxVQUFVO1FBQ3JCLElBQUlMLEtBQUtPLE1BQU0sRUFBRSxPQUFPRCxlQUFlTixLQUFLTyxNQUFNO1FBQ2xELElBQUlFLFFBQVF4RCxXQUFXLEdBQUc0RCxRQUFRLENBQUMsVUFBVSxPQUFPO1FBQ3BELElBQUlKLFFBQVF4RCxXQUFXLEdBQUc0RCxRQUFRLENBQUMsVUFBVUosUUFBUXhELFdBQVcsR0FBRzRELFFBQVEsQ0FBQyxTQUFTO1lBQ25GLE9BQU87UUFDVDtRQUNBLE9BQU87SUFDVDtJQUVBLElBQUlSLFNBQVMsWUFBWUEsU0FBUyxXQUFXO1FBQzNDLElBQUlTLE9BQU9DLFFBQVEsQ0FBQ2YsS0FBS2dCLE9BQU8sR0FBRyxPQUFPRixPQUFPZCxLQUFLZ0IsT0FBTztRQUM3RCxPQUFPO0lBQ1Q7SUFFQSxJQUFJWCxTQUFTLFdBQVcsT0FBTztJQUUvQixJQUFJQSxTQUFTLFNBQVM7UUFDcEIsTUFBTVksYUFBYWpCLEtBQUtrQixLQUFLLElBQUksQ0FBQztRQUNsQyxPQUFPO1lBQUNWLGdCQUFnQlMsWUFBWVIsVUFBVSxHQUFHQSxRQUFRLEtBQUssQ0FBQyxHQUFHO1NBQVE7SUFDNUU7SUFFQSxJQUFJSixTQUFTLFVBQVU7UUFDckIsTUFBTWMsYUFBYW5CLEtBQUttQixVQUFVLElBQUksT0FBT25CLEtBQUttQixVQUFVLEtBQUssV0FBV25CLEtBQUttQixVQUFVLEdBQUcsQ0FBQztRQUMvRixNQUFNQyxXQUFXM0MsTUFBTUMsT0FBTyxDQUFDc0IsS0FBS29CLFFBQVEsSUFBSXBCLEtBQUtvQixRQUFRLEdBQUcsRUFBRTtRQUNsRSxNQUFNQyxPQUFPLElBQUlDLElBQUk7ZUFBSUY7ZUFBYXRDLE9BQU91QyxJQUFJLENBQUNGO1NBQVk7UUFDOUQsTUFBTUksU0FBUyxDQUFDO1FBRWhCLElBQUlGLEtBQUtHLElBQUksS0FBSyxHQUFHO1lBQ25CLE9BQU9mLFlBQVksU0FBUztnQkFBRWdCLGNBQWM7WUFBMkIsSUFBSSxDQUFDO1FBQzlFO1FBRUFKLEtBQUtyQyxPQUFPLENBQUMsQ0FBQ0M7WUFDWixNQUFNeUMsY0FBY1AsVUFBVSxDQUFDbEMsSUFBSSxJQUFJLENBQUM7WUFDeENzQyxNQUFNLENBQUN0QyxJQUFJLEdBQUd1QixnQkFBZ0JrQixhQUFhekM7UUFDN0M7UUFFQSxPQUFPc0M7SUFDVDtJQUVBLE9BQU8sQ0FBQztBQUNWO0FBRUEsTUFBTUk7SUFDSixZQUFZQyxVQUFVLENBQUMsQ0FBQyxDQUFFO1FBQ3hCLElBQUksQ0FBQ0MsSUFBSSxHQUFHO1FBQ1osSUFBSSxDQUFDN0QsWUFBWSxHQUFHNEQsUUFBUTVELFlBQVksSUFBSXRCLEtBQUt5QixJQUFJLENBQUNoQixRQUFRaUIsR0FBRyxJQUFJLFlBQVk7SUFDbkY7SUFFQTBELGdCQUFnQmhFLE9BQU8sRUFBRTtRQUN2QixNQUFNUSxhQUFhUCx5QkFBeUJELFNBQVMsSUFBSSxDQUFDRSxZQUFZO1FBQ3RFLElBQUksQ0FBQ00sY0FBYyxDQUFDOUIsR0FBRytCLFVBQVUsQ0FBQ0QsYUFBYSxPQUFPO1FBQ3RELElBQUk7WUFDRixNQUFNeUQsU0FBUzNDLEtBQUtDLEtBQUssQ0FBQzdDLEdBQUd3RixZQUFZLENBQUMxRCxZQUFZO1lBQ3RELE1BQU0yRCxhQUFhRixVQUFVQSxPQUFPRyxJQUFJLEdBQUdILE9BQU9HLElBQUksR0FBR0g7WUFDekQsT0FBT3ZELGNBQWNXLFVBQVU4QztRQUNqQyxFQUFFLE9BQU07WUFDTixPQUFPO1FBQ1Q7SUFDRjtJQUVBLE1BQU1FLGFBQWEsRUFBRTNDLE1BQU0sRUFBRTRDLElBQUksRUFBRSxHQUFHLENBQUMsQ0FBQyxFQUFFO1FBQ3hDLE1BQU10RSxVQUFVc0UsUUFBUSxPQUFPQSxTQUFTLFdBQVdBLEtBQUtDLFFBQVEsSUFBSUQsS0FBS3RFLE9BQU8sR0FBRztRQUNuRixNQUFNd0UsY0FBY3hFLFVBQVUsSUFBSSxDQUFDZ0UsZUFBZSxDQUFDaEUsV0FBVztRQUM5RCxJQUFJd0UsYUFBYTtZQUNmLE9BQU9BO1FBQ1Q7UUFFQSxPQUFPOUIsZ0JBQWdCaEIsVUFBVSxDQUFDLEdBQUc7SUFDdkM7QUFDRjtBQUVBLE1BQU0rQyxxQkFBcUIsQ0FBQzFGO0lBQzFCLE1BQU1DLGFBQWFDLE9BQU9GLFNBQVMsZ0JBQ2hDMkYsT0FBTyxDQUFDLGtCQUFrQixLQUMxQkEsT0FBTyxDQUFDLE9BQU8sS0FDZkEsT0FBTyxDQUFDLFlBQVk7SUFDdkIsT0FBTzFGLGNBQWM7QUFDdkI7QUFFQSxNQUFNMkYsa0JBQWtCLENBQUM1RixRQUN2QkUsT0FBT0YsU0FBUyxJQUNiMkYsT0FBTyxDQUFDLGFBQWEsT0FDckJBLE9BQU8sQ0FBQyxRQUFRLElBQ2hCQSxPQUFPLENBQUMsUUFBUSxJQUNoQnhGLElBQUk7QUFFVCxNQUFNMEYsa0JBQWtCLENBQUM3RjtJQUN2QixJQUFJLE9BQU9BLFVBQVUsVUFBVSxPQUFPO0lBQ3RDLE1BQU04RixTQUFTOUYsTUFBTUcsSUFBSTtJQUN6QixJQUFJLENBQUMyRixRQUFRLE9BQU87SUFDcEIsSUFBSTtRQUNGLE9BQU92RCxLQUFLQyxLQUFLLENBQUNzRDtJQUNwQixFQUFFLE9BQU07SUFDTixXQUFXO0lBQ2I7SUFDQSxNQUFNQyxXQUFXSCxnQkFBZ0JFO0lBQ2pDLElBQUksQ0FBQ0MsVUFBVSxPQUFPO0lBQ3RCLElBQUk7UUFDRixPQUFPeEQsS0FBS0MsS0FBSyxDQUFDdUQ7SUFDcEIsRUFBRSxPQUFNO1FBQ04sT0FBTztJQUNUO0FBQ0Y7QUFFQSxNQUFNQyxzQkFBc0IsQ0FBQ0M7SUFDM0IsSUFBSSxDQUFDQSxXQUFXLE9BQU9BLFlBQVksVUFBVSxPQUFPO0lBQ3BELElBQUlBLFFBQVFDLEtBQUssSUFBSSxPQUFPRCxRQUFRQyxLQUFLLEtBQUssVUFBVTtRQUN0RCxNQUFNQyxVQUFVRixRQUFRQyxLQUFLLENBQUNDLE9BQU8sSUFBSUYsUUFBUUMsS0FBSyxDQUFDRSxJQUFJO1FBQzNELElBQUlELFNBQVMsT0FBT2pHLE9BQU9pRztJQUM3QjtJQUNBLE9BQU87QUFDVDtBQUVBLE1BQU1FLG1CQUFtQixDQUFDckcsT0FBT3NHO0lBQy9CLE1BQU1DLFVBQVV0QyxPQUFPakU7SUFDdkIsT0FBT2lFLE9BQU9DLFFBQVEsQ0FBQ3FDLFdBQVdBLFVBQVVEO0FBQzlDO0FBRUEsTUFBTUU7SUFDSixZQUFZekIsVUFBVSxDQUFDLENBQUMsQ0FBRTtRQUN4QixJQUFJLENBQUNDLElBQUksR0FBRztRQUNaLElBQUksQ0FBQ3lCLE1BQU0sR0FBRzFCLFFBQVEwQixNQUFNLElBQUluRyxRQUFRQyxHQUFHLENBQUNJLGNBQWMsSUFBSTtRQUM5RCxJQUFJLENBQUMrRixPQUFPLEdBQUd4RyxPQUNiNkUsUUFBUTJCLE9BQU8sSUFBSXBHLFFBQVFDLEdBQUcsQ0FBQ29HLGVBQWUsSUFBSSw2QkFDbERoQixPQUFPLENBQUMsUUFBUTtRQUNsQixJQUFJLENBQUNpQixLQUFLLEdBQUc3QixRQUFRNkIsS0FBSyxJQUFJdEcsUUFBUUMsR0FBRyxDQUFDc0csWUFBWSxJQUFJO1FBQzFELElBQUksQ0FBQ0MsU0FBUyxHQUFHVCxpQkFBaUJ0QixRQUFRK0IsU0FBUyxJQUFJeEcsUUFBUUMsR0FBRyxDQUFDd0csaUJBQWlCLEVBQUU7UUFDdEYsSUFBSSxDQUFDQyxTQUFTLEdBQUdqQyxRQUFRa0MsS0FBSyxJQUFJQyxXQUFXRCxLQUFLO0lBQ3BEO0lBRUEsTUFBTUUsdUJBQXVCbEIsT0FBTyxFQUFFO1FBQ3BDLElBQUksT0FBTyxJQUFJLENBQUNlLFNBQVMsS0FBSyxZQUFZO1lBQ3hDLE1BQU0sSUFBSUksTUFBTTtRQUNsQjtRQUNBLE1BQU1DLGFBQWEsSUFBSUM7UUFDdkIsTUFBTUMsVUFBVUMsV0FBVyxJQUFNSCxXQUFXSSxLQUFLLElBQUksSUFBSSxDQUFDWCxTQUFTO1FBQ25FLElBQUlZO1FBQ0osSUFBSTtZQUNGQSxXQUFXLE1BQU0sSUFBSSxDQUFDVixTQUFTLENBQUMsR0FBRyxJQUFJLENBQUNOLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyxFQUFFO2dCQUNsRWlCLFFBQVE7Z0JBQ1JDLFNBQVM7b0JBQ1AsZ0JBQWdCO29CQUNoQkMsZUFBZSxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUNwQixNQUFNLEVBQUU7Z0JBQ3hDO2dCQUNBcUIsTUFBTXZGLEtBQUtFLFNBQVMsQ0FBQ3dEO2dCQUNyQjhCLFFBQVFWLFdBQVdVLE1BQU07WUFDM0I7UUFDRixFQUFFLE9BQU83QixPQUFPO1lBQ2QsTUFBTUMsVUFDSkQsU0FBUyxPQUFPQSxVQUFVLFlBQVlBLE1BQU1sQixJQUFJLEtBQUssZUFDakQsQ0FBQywrQkFBK0IsRUFBRSxJQUFJLENBQUM4QixTQUFTLENBQUMsRUFBRSxDQUFDLEdBQ3BELENBQUMsdUJBQXVCLEVBQUVaLGlCQUFpQmtCLFFBQVFsQixNQUFNQyxPQUFPLEdBQUcsaUJBQWlCO1lBQzFGLE1BQU0sSUFBSWlCLE1BQU1qQjtRQUNsQixTQUFVO1lBQ1I2QixhQUFhVDtRQUNmO1FBRUEsTUFBTVUsT0FBTyxNQUFNUCxTQUFTTyxJQUFJO1FBQ2hDLE1BQU0vQyxTQUFTVyxnQkFBZ0JvQyxTQUFTLENBQUM7UUFDekMsSUFBSSxDQUFDUCxTQUFTUSxFQUFFLEVBQUU7WUFDaEIsTUFBTUMsYUFBYW5DLG9CQUFvQmQ7WUFDdkMsTUFBTWtELFNBQVNELGNBQWNGLEtBQUtJLEtBQUssQ0FBQyxHQUFHLFFBQVEsQ0FBQyxLQUFLLEVBQUVYLFNBQVNZLE1BQU0sRUFBRTtZQUM1RSxNQUFNcEMsUUFBUSxJQUFJa0IsTUFBTSxDQUFDLHVCQUF1QixFQUFFTSxTQUFTWSxNQUFNLENBQUMsR0FBRyxFQUFFRixRQUFRO1lBQy9FbEMsTUFBTW9DLE1BQU0sR0FBR1osU0FBU1ksTUFBTTtZQUM5QixNQUFNcEM7UUFDUjtRQUNBLE9BQU9oQjtJQUNUO0lBRUFxRCxtQkFBbUJ0QyxPQUFPLEVBQUU7UUFDMUIsTUFBTXVDLFVBQVV2QyxTQUFTd0MsU0FBUyxDQUFDLEVBQUUsRUFBRXRDLFNBQVNxQztRQUNoRCxJQUFJLE9BQU9BLFlBQVksVUFBVSxPQUFPQTtRQUN4QyxJQUFJNUcsTUFBTUMsT0FBTyxDQUFDMkcsVUFBVTtZQUMxQixPQUFPQSxRQUNKMUcsR0FBRyxDQUFDLENBQUM0RztnQkFDSixJQUFJLENBQUNBLFFBQVEsT0FBT0EsU0FBUyxVQUFVLE9BQU87Z0JBQzlDLElBQUksT0FBT0EsS0FBS1QsSUFBSSxLQUFLLFVBQVUsT0FBT1MsS0FBS1QsSUFBSTtnQkFDbkQsSUFBSVMsS0FBS1QsSUFBSSxJQUFJLE9BQU9TLEtBQUtULElBQUksS0FBSyxZQUFZLE9BQU9TLEtBQUtULElBQUksQ0FBQ2pJLEtBQUssS0FBSyxVQUFVO29CQUNyRixPQUFPMEksS0FBS1QsSUFBSSxDQUFDakksS0FBSztnQkFDeEI7Z0JBQ0EsSUFBSSxPQUFPMEksS0FBS0YsT0FBTyxLQUFLLFVBQVUsT0FBT0UsS0FBS0YsT0FBTztnQkFDekQsT0FBTztZQUNULEdBQ0NsSCxJQUFJLENBQUMsSUFDTG5CLElBQUk7UUFDVDtRQUNBLE9BQU87SUFDVDtJQUVBd0ksY0FBY0MsTUFBTSxFQUFFQyxNQUFNLEVBQUVsRyxNQUFNLEVBQUU7UUFDcEMsTUFBTW1HLGFBQ0osT0FBT0YsV0FBVyxZQUFZQSxPQUFPekksSUFBSSxLQUNyQ3lJLE9BQU96SSxJQUFJLEtBQ1g7UUFDTixNQUFNNEksYUFDSnBHLFVBQVUsT0FBT0EsV0FBVyxZQUFZVixPQUFPdUMsSUFBSSxDQUFDN0IsUUFBUUUsTUFBTSxHQUM5RCxDQUFDLDRDQUE0QyxFQUFFTixLQUFLRSxTQUFTLENBQUNFLFNBQVMsR0FDdkU7UUFDTixNQUFNcUcsYUFBYSxPQUFPSCxXQUFXLFlBQVlBLE9BQU8xSSxJQUFJLEtBQUswSSxPQUFPMUksSUFBSSxLQUFLO1FBQ2pGLE9BQU87WUFDTDtnQkFBRThJLE1BQU07Z0JBQVVULFNBQVMsR0FBR00sV0FBVyxJQUFJLEVBQUVDLFlBQVk7WUFBQztZQUM1RDtnQkFBRUUsTUFBTTtnQkFBUVQsU0FBU1E7WUFBVztTQUNyQztJQUNIO0lBRUEsTUFBTTFELGFBQWEsRUFBRXNELE1BQU0sRUFBRUMsTUFBTSxFQUFFbEcsTUFBTSxFQUFFdUcsV0FBVyxFQUFFQyxTQUFTLEVBQUU1RCxJQUFJLEVBQUUsR0FBRyxDQUFDLENBQUMsRUFBRTtRQUNoRixJQUFJLENBQUMsSUFBSSxDQUFDa0IsTUFBTSxFQUFFO1lBQ2hCLE1BQU0sSUFBSVcsTUFBTTtRQUNsQjtRQUVBLE1BQU1nQyxpQkFDSjdELFFBQVEsT0FBT0EsU0FBUyxZQUFZLE9BQU9BLEtBQUtxQixLQUFLLEtBQUssV0FDdERyQixLQUFLcUIsS0FBSyxDQUFDekcsSUFBSSxLQUNmO1FBQ04sTUFBTXlHLFFBQVF3QyxrQkFBa0IsSUFBSSxDQUFDeEMsS0FBSztRQUMxQyxNQUFNeUMsV0FBVyxJQUFJLENBQUNWLGFBQWEsQ0FBQ0MsUUFBUUMsUUFBUWxHO1FBQ3BELE1BQU0yRyxvQkFBb0JDLEtBQUtDLEdBQUcsQ0FBQ0QsS0FBS0UsR0FBRyxDQUFDcEQsaUJBQWlCNkMsYUFBYSxNQUFNLElBQUk7UUFDcEYsTUFBTVEsYUFBYUgsS0FBS0UsR0FBRyxDQUFDLEtBQUtGLEtBQUtDLEdBQUcsQ0FBQyxNQUFNbkQsaUJBQWlCOEMsV0FBVztRQUM1RSxNQUFNUSxZQUFZakosUUFBUWlDLFVBQVUsT0FBT0EsV0FBVyxZQUFZVixPQUFPdUMsSUFBSSxDQUFDN0IsUUFBUUUsTUFBTTtRQUM1RixNQUFNK0csYUFBYWxFLG1CQUNqQkgsUUFBUSxPQUFPQSxTQUFTLFdBQVdBLEtBQUtDLFFBQVEsSUFBSUQsS0FBS3RFLE9BQU8sSUFBSSxpQkFBaUI7UUFHdkYsTUFBTTRJLG9CQUFvQjtZQUN4QmpEO1lBQ0F5QztZQUNBSCxhQUFhSTtZQUNiUSxZQUFZSjtZQUNaSyxpQkFBaUJKLFlBQ2I7Z0JBQ0VuRyxNQUFNO2dCQUNOd0csYUFBYTtvQkFBRWhGLE1BQU00RTtvQkFBWUssUUFBUTtvQkFBTXRIO2dCQUFPO1lBQ3hELElBQ0E7Z0JBQUVhLE1BQU07WUFBYztRQUM1QjtRQUVBLElBQUkwRztRQUNKLElBQUk7WUFDRkEsY0FBYyxNQUFNLElBQUksQ0FBQy9DLHNCQUFzQixDQUFDMEM7UUFDbEQsRUFBRSxPQUFPM0QsT0FBTztZQUNkLCtFQUErRTtZQUMvRSxNQUFNaUUsa0JBQWtCO2dCQUN0QnZEO2dCQUNBeUM7Z0JBQ0FILGFBQWFJO2dCQUNiUSxZQUFZSjtnQkFDWkssaUJBQWlCO29CQUFFdkcsTUFBTTtnQkFBYztZQUN6QztZQUNBMEcsY0FBYyxNQUFNLElBQUksQ0FBQy9DLHNCQUFzQixDQUFDZ0Q7UUFDbEQ7UUFFQSxNQUFNbEMsT0FBTyxJQUFJLENBQUNNLGtCQUFrQixDQUFDMkI7UUFDckMsTUFBTWhGLFNBQVNXLGdCQUFnQm9DO1FBQy9CLElBQUkvQyxVQUFVLE9BQU9BLFdBQVcsVUFBVTtZQUN4QyxPQUFPQTtRQUNUO1FBRUEsTUFBTSxJQUFJa0MsTUFBTTtJQUNsQjtBQUNGO0FBRUEsTUFBTWdELG9CQUFvQixDQUFDLEVBQUVDLFFBQVEsRUFBRWxKLFlBQVksRUFBRSxHQUFHLENBQUMsQ0FBQztJQUN4RCxNQUFNbUosT0FBT3ZLLHNCQUFzQnNLLFlBQVloSztJQUMvQyxJQUFJaUssU0FBUyxRQUFRLE9BQU8sSUFBSTlEO0lBQ2hDLE9BQU8sSUFBSTFCLGdCQUFnQjtRQUFFM0Q7SUFBYTtBQUM1QztBQUVBLElBQUlvSixZQUFZO0FBRWhCLE1BQU1DLGlCQUFpQixDQUFDekYsVUFBVSxDQUFDLENBQUM7SUFDbEMsSUFBSUEsUUFBUTBGLFFBQVEsRUFBRSxPQUFPTCxrQkFBa0JyRjtJQUMvQyxJQUFJLENBQUN3RixXQUFXQSxZQUFZSCxrQkFBa0JyRjtJQUM5QyxPQUFPd0Y7QUFDVDtBQUVBLE1BQU1HLG9CQUFvQixDQUFDTDtJQUN6QixNQUFNckYsT0FBT3FGLFlBQVksT0FBT0EsYUFBYSxXQUFXQSxTQUFTckYsSUFBSSxHQUFHO0lBQ3hFLE9BQU9qRixzQkFBc0JpRixVQUFVO0FBQ3pDO0FBRUEyRixPQUFPQyxPQUFPLEdBQUc7SUFDZjlGO0lBQ0EwQjtJQUNBN0M7SUFDQTNDO0lBQ0FvSjtJQUNBL0o7SUFDQW1LO0lBQ0EvSjtJQUNBZTtJQUNBa0o7SUFDQXhKO0lBQ0FTO0FBQ0YiLCJzb3VyY2VzIjpbIi9Vc2Vycy9hYnV6YWRhL0Rlc2t0b3AvYWdlbnRPUy9saWIvbGxtL3Byb3ZpZGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGZzID0gcmVxdWlyZShcIm5vZGU6ZnNcIik7XG5jb25zdCBwYXRoID0gcmVxdWlyZShcIm5vZGU6cGF0aFwiKTtcblxuY29uc3QgREVGQVVMVF9QUk9WSURFUiA9IFwiZmFrZVwiO1xuXG5jb25zdCBub3JtYWxpemVQcm92aWRlck5hbWUgPSAodmFsdWUpID0+IHtcbiAgY29uc3Qgbm9ybWFsaXplZCA9IFN0cmluZyh2YWx1ZSB8fCBcIlwiKS50cmltKCkudG9Mb3dlckNhc2UoKTtcbiAgcmV0dXJuIG5vcm1hbGl6ZWQgPT09IFwicmVhbFwiID8gXCJyZWFsXCIgOiBcImZha2VcIjtcbn07XG5cbmNvbnN0IGdldENvbmZpZ3VyZWRQcm92aWRlck5hbWUgPSAoKSA9PiBub3JtYWxpemVQcm92aWRlck5hbWUocHJvY2Vzcy5lbnYuTExNX1BST1ZJREVSIHx8IERFRkFVTFRfUFJPVklERVIpO1xuY29uc3QgaGFzUmVhbFByb3ZpZGVyQ3JlZGVudGlhbHMgPSAoKSA9PlxuICBCb29sZWFuKFN0cmluZyhwcm9jZXNzLmVudi5PUEVOQUlfQVBJX0tFWSB8fCBcIlwiKS50cmltKCkpO1xuXG5jb25zdCBBR0VOVF9JRF9BTElBU0VTID0ge1xuICBwbGF0b246IFwicGxhdG9uLXByb3NwZWN0LXJlc2VhcmNoLXJ1XCIsXG4gIGFuYXRvbHk6IFwiYW5hdG9seS1hY2NvdW50LXJlc2VhcmNoLXJ1XCIsXG4gIG1heGltOiBcIm1heGltLWxvY2FsLWxlYWRzLXJ1XCJcbn07XG5cbmNvbnN0IGNhbm9uaWNhbEFnZW50SWQgPSAoYWdlbnRJZCkgPT4ge1xuICBpZiAoIWFnZW50SWQpIHJldHVybiBcIlwiO1xuICBjb25zdCBub3JtYWxpemVkID0gU3RyaW5nKGFnZW50SWQpLnRyaW0oKTtcbiAgcmV0dXJuIEFHRU5UX0lEX0FMSUFTRVNbbm9ybWFsaXplZF0gfHwgbm9ybWFsaXplZDtcbn07XG5cbmNvbnN0IHJlc29sdmVGaXh0dXJlT3V0cHV0UGF0aCA9IChhZ2VudElkLCBmaXh0dXJlc1Jvb3QpID0+IHtcbiAgY29uc3QgY2Fub25pY2FsID0gY2Fub25pY2FsQWdlbnRJZChhZ2VudElkKTtcbiAgaWYgKCFjYW5vbmljYWwpIHJldHVybiBcIlwiO1xuICBjb25zdCByb290ID0gZml4dHVyZXNSb290IHx8IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCBcImZpeHR1cmVzXCIsIFwiYWdlbnRzXCIpO1xuICByZXR1cm4gcGF0aC5qb2luKHJvb3QsIGNhbm9uaWNhbCwgXCJvdXRwdXQuanNvblwiKTtcbn07XG5cbmNvbnN0IGhhc0ZpeHR1cmVGb3JBZ2VudCA9IChhZ2VudElkLCBmaXh0dXJlc1Jvb3QpID0+IHtcbiAgY29uc3Qgb3V0cHV0UGF0aCA9IHJlc29sdmVGaXh0dXJlT3V0cHV0UGF0aChhZ2VudElkLCBmaXh0dXJlc1Jvb3QpO1xuICByZXR1cm4gQm9vbGVhbihvdXRwdXRQYXRoICYmIGZzLmV4aXN0c1N5bmMob3V0cHV0UGF0aCkpO1xufTtcblxuY29uc3Qgc3RyaXBWb2xhdGlsZSA9ICh2YWx1ZSkgPT4ge1xuICBpZiAoIXZhbHVlIHx8IHR5cGVvZiB2YWx1ZSAhPT0gXCJvYmplY3RcIikgcmV0dXJuIHZhbHVlO1xuICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHJldHVybiB2YWx1ZS5tYXAoKGl0ZW0pID0+IHN0cmlwVm9sYXRpbGUoaXRlbSkpO1xuXG4gIGNvbnN0IG5leHQgPSB7fTtcbiAgT2JqZWN0LmVudHJpZXModmFsdWUpLmZvckVhY2goKFtrZXksIHZhbF0pID0+IHtcbiAgICBpZiAoa2V5ID09PSBcImdlbmVyYXRlZF9hdFwiKSB7XG4gICAgICBuZXh0W2tleV0gPSBcIjE5NzAtMDEtMDFUMDA6MDA6MDAuMDAwWlwiO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoa2V5ID09PSBcInJ1bl9pZFwiIHx8IGtleSA9PT0gXCJ0cmFjZV9pZFwiKSB7XG4gICAgICBuZXh0W2tleV0gPSBcInN0dWItcnVuXCI7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChrZXkgPT09IFwiZHVyYXRpb25fbXNcIikge1xuICAgICAgbmV4dFtrZXldID0gMDtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgbmV4dFtrZXldID0gc3RyaXBWb2xhdGlsZSh2YWwpO1xuICB9KTtcbiAgcmV0dXJuIG5leHQ7XG59O1xuXG5jb25zdCBjbG9uZUpzb24gPSAodmFsdWUpID0+IHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh2YWx1ZSkpO1xuICB9IGNhdGNoIHtcbiAgICByZXR1cm4gdmFsdWU7XG4gIH1cbn07XG5cbmNvbnN0IHBpY2tTY2hlbWFOb2RlID0gKHNjaGVtYSkgPT4ge1xuICBpZiAoIXNjaGVtYSB8fCB0eXBlb2Ygc2NoZW1hICE9PSBcIm9iamVjdFwiKSByZXR1cm4ge307XG4gIGlmIChBcnJheS5pc0FycmF5KHNjaGVtYS5vbmVPZikgJiYgc2NoZW1hLm9uZU9mLmxlbmd0aCkgcmV0dXJuIHNjaGVtYS5vbmVPZlswXSB8fCB7fTtcbiAgaWYgKEFycmF5LmlzQXJyYXkoc2NoZW1hLmFueU9mKSAmJiBzY2hlbWEuYW55T2YubGVuZ3RoKSByZXR1cm4gc2NoZW1hLmFueU9mWzBdIHx8IHt9O1xuICBpZiAoQXJyYXkuaXNBcnJheShzY2hlbWEuYWxsT2YpICYmIHNjaGVtYS5hbGxPZi5sZW5ndGgpIHtcbiAgICByZXR1cm4gc2NoZW1hLmFsbE9mLnJlZHVjZSgoYWNjLCBpdGVtKSA9PiAoeyAuLi5hY2MsIC4uLml0ZW0gfSksIHt9KTtcbiAgfVxuICByZXR1cm4gc2NoZW1hO1xufTtcblxuY29uc3Qgc2NoZW1hVHlwZSA9IChzY2hlbWEpID0+IHtcbiAgY29uc3Qgbm9kZSA9IHBpY2tTY2hlbWFOb2RlKHNjaGVtYSk7XG4gIGlmICghbm9kZSB8fCB0eXBlb2Ygbm9kZSAhPT0gXCJvYmplY3RcIikgcmV0dXJuIFwib2JqZWN0XCI7XG4gIGlmIChub2RlLmNvbnN0ICE9PSB1bmRlZmluZWQpIHJldHVybiB0eXBlb2Ygbm9kZS5jb25zdDtcbiAgaWYgKG5vZGUuZGVmYXVsdCAhPT0gdW5kZWZpbmVkKSByZXR1cm4gdHlwZW9mIG5vZGUuZGVmYXVsdDtcbiAgaWYgKEFycmF5LmlzQXJyYXkobm9kZS5lbnVtKSAmJiBub2RlLmVudW0ubGVuZ3RoKSByZXR1cm4gdHlwZW9mIG5vZGUuZW51bVswXTtcbiAgaWYgKEFycmF5LmlzQXJyYXkobm9kZS50eXBlKSkgcmV0dXJuIG5vZGUudHlwZVswXSB8fCBcIm9iamVjdFwiO1xuICByZXR1cm4gbm9kZS50eXBlIHx8IFwib2JqZWN0XCI7XG59O1xuXG5jb25zdCB2YWx1ZUZvckZvcm1hdCA9IChmb3JtYXQpID0+IHtcbiAgaWYgKGZvcm1hdCA9PT0gXCJkYXRlLXRpbWVcIikgcmV0dXJuIFwiMTk3MC0wMS0wMVQwMDowMDowMC4wMDBaXCI7XG4gIGlmIChmb3JtYXQgPT09IFwiZGF0ZVwiKSByZXR1cm4gXCIxOTcwLTAxLTAxXCI7XG4gIGlmIChmb3JtYXQgPT09IFwiZW1haWxcIikgcmV0dXJuIFwic3R1YkBleGFtcGxlLmNvbVwiO1xuICBpZiAoZm9ybWF0ID09PSBcInVyaVwiIHx8IGZvcm1hdCA9PT0gXCJ1cmxcIikgcmV0dXJuIFwiaHR0cHM6Ly9leGFtcGxlLmNvbVwiO1xuICByZXR1cm4gXCJzdHViXCI7XG59O1xuXG5jb25zdCBidWlsZEZyb21TY2hlbWEgPSAoc2NoZW1hLCBrZXlIaW50ID0gXCJcIikgPT4ge1xuICBjb25zdCBub2RlID0gcGlja1NjaGVtYU5vZGUoc2NoZW1hKTtcbiAgaWYgKCFub2RlIHx8IHR5cGVvZiBub2RlICE9PSBcIm9iamVjdFwiKSByZXR1cm4ge307XG5cbiAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChub2RlLCBcImNvbnN0XCIpKSByZXR1cm4gY2xvbmVKc29uKG5vZGUuY29uc3QpO1xuICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG5vZGUsIFwiZGVmYXVsdFwiKSkgcmV0dXJuIGNsb25lSnNvbihub2RlLmRlZmF1bHQpO1xuICBpZiAoQXJyYXkuaXNBcnJheShub2RlLmVudW0pICYmIG5vZGUuZW51bS5sZW5ndGgpIHJldHVybiBjbG9uZUpzb24obm9kZS5lbnVtWzBdKTtcblxuICBjb25zdCB0eXBlID0gc2NoZW1hVHlwZShub2RlKTtcblxuICBpZiAodHlwZSA9PT0gXCJzdHJpbmdcIikge1xuICAgIGlmIChub2RlLmZvcm1hdCkgcmV0dXJuIHZhbHVlRm9yRm9ybWF0KG5vZGUuZm9ybWF0KTtcbiAgICBpZiAoa2V5SGludC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwiZW1haWxcIikpIHJldHVybiBcInN0dWJAZXhhbXBsZS5jb21cIjtcbiAgICBpZiAoa2V5SGludC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwidXJsXCIpIHx8IGtleUhpbnQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcImxpbmtcIikpIHtcbiAgICAgIHJldHVybiBcImh0dHBzOi8vZXhhbXBsZS5jb21cIjtcbiAgICB9XG4gICAgcmV0dXJuIFwic3R1YlwiO1xuICB9XG5cbiAgaWYgKHR5cGUgPT09IFwibnVtYmVyXCIgfHwgdHlwZSA9PT0gXCJpbnRlZ2VyXCIpIHtcbiAgICBpZiAoTnVtYmVyLmlzRmluaXRlKG5vZGUubWluaW11bSkpIHJldHVybiBOdW1iZXIobm9kZS5taW5pbXVtKTtcbiAgICByZXR1cm4gMDtcbiAgfVxuXG4gIGlmICh0eXBlID09PSBcImJvb2xlYW5cIikgcmV0dXJuIGZhbHNlO1xuXG4gIGlmICh0eXBlID09PSBcImFycmF5XCIpIHtcbiAgICBjb25zdCBpdGVtU2NoZW1hID0gbm9kZS5pdGVtcyB8fCB7fTtcbiAgICByZXR1cm4gW2J1aWxkRnJvbVNjaGVtYShpdGVtU2NoZW1hLCBrZXlIaW50ID8gYCR7a2V5SGludH1faXRlbWAgOiBcIml0ZW1cIildO1xuICB9XG5cbiAgaWYgKHR5cGUgPT09IFwib2JqZWN0XCIpIHtcbiAgICBjb25zdCBwcm9wZXJ0aWVzID0gbm9kZS5wcm9wZXJ0aWVzICYmIHR5cGVvZiBub2RlLnByb3BlcnRpZXMgPT09IFwib2JqZWN0XCIgPyBub2RlLnByb3BlcnRpZXMgOiB7fTtcbiAgICBjb25zdCByZXF1aXJlZCA9IEFycmF5LmlzQXJyYXkobm9kZS5yZXF1aXJlZCkgPyBub2RlLnJlcXVpcmVkIDogW107XG4gICAgY29uc3Qga2V5cyA9IG5ldyBTZXQoWy4uLnJlcXVpcmVkLCAuLi5PYmplY3Qua2V5cyhwcm9wZXJ0aWVzKV0pO1xuICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xuXG4gICAgaWYgKGtleXMuc2l6ZSA9PT0gMCkge1xuICAgICAgcmV0dXJuIGtleUhpbnQgPT09IFwibWV0YVwiID8geyBnZW5lcmF0ZWRfYXQ6IFwiMTk3MC0wMS0wMVQwMDowMDowMC4wMDBaXCIgfSA6IHt9O1xuICAgIH1cblxuICAgIGtleXMuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgICBjb25zdCBjaGlsZFNjaGVtYSA9IHByb3BlcnRpZXNba2V5XSB8fCB7fTtcbiAgICAgIHJlc3VsdFtrZXldID0gYnVpbGRGcm9tU2NoZW1hKGNoaWxkU2NoZW1hLCBrZXkpO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIHJldHVybiB7fTtcbn07XG5cbmNsYXNzIEZha2VMTE1Qcm92aWRlciB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMgPSB7fSkge1xuICAgIHRoaXMubmFtZSA9IFwiZmFrZVwiO1xuICAgIHRoaXMuZml4dHVyZXNSb290ID0gb3B0aW9ucy5maXh0dXJlc1Jvb3QgfHwgcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksIFwiZml4dHVyZXNcIiwgXCJhZ2VudHNcIik7XG4gIH1cblxuICBsb2FkRml4dHVyZURhdGEoYWdlbnRJZCkge1xuICAgIGNvbnN0IG91dHB1dFBhdGggPSByZXNvbHZlRml4dHVyZU91dHB1dFBhdGgoYWdlbnRJZCwgdGhpcy5maXh0dXJlc1Jvb3QpO1xuICAgIGlmICghb3V0cHV0UGF0aCB8fCAhZnMuZXhpc3RzU3luYyhvdXRwdXRQYXRoKSkgcmV0dXJuIG51bGw7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHBhcnNlZCA9IEpTT04ucGFyc2UoZnMucmVhZEZpbGVTeW5jKG91dHB1dFBhdGgsIFwidXRmOFwiKSk7XG4gICAgICBjb25zdCBsZWdhY3lEYXRhID0gcGFyc2VkICYmIHBhcnNlZC5kYXRhID8gcGFyc2VkLmRhdGEgOiBwYXJzZWQ7XG4gICAgICByZXR1cm4gc3RyaXBWb2xhdGlsZShjbG9uZUpzb24obGVnYWN5RGF0YSkpO1xuICAgIH0gY2F0Y2gge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZ2VuZXJhdGVKc29uKHsgc2NoZW1hLCBtZXRhIH0gPSB7fSkge1xuICAgIGNvbnN0IGFnZW50SWQgPSBtZXRhICYmIHR5cGVvZiBtZXRhID09PSBcIm9iamVjdFwiID8gbWV0YS5hZ2VudF9pZCB8fCBtZXRhLmFnZW50SWQgOiBcIlwiO1xuICAgIGNvbnN0IGZpeHR1cmVEYXRhID0gYWdlbnRJZCA/IHRoaXMubG9hZEZpeHR1cmVEYXRhKGFnZW50SWQpIDogbnVsbDtcbiAgICBpZiAoZml4dHVyZURhdGEpIHtcbiAgICAgIHJldHVybiBmaXh0dXJlRGF0YTtcbiAgICB9XG5cbiAgICByZXR1cm4gYnVpbGRGcm9tU2NoZW1hKHNjaGVtYSB8fCB7fSwgXCJyb290XCIpO1xuICB9XG59XG5cbmNvbnN0IHNhbml0aXplU2NoZW1hTmFtZSA9ICh2YWx1ZSkgPT4ge1xuICBjb25zdCBub3JtYWxpemVkID0gU3RyaW5nKHZhbHVlIHx8IFwiYWdlbnRfb3V0cHV0XCIpXG4gICAgLnJlcGxhY2UoL1teYS16QS1aMC05X10vZywgXCJfXCIpXG4gICAgLnJlcGxhY2UoL18rL2csIFwiX1wiKVxuICAgIC5yZXBsYWNlKC9eXyt8XyskL2csIFwiXCIpO1xuICByZXR1cm4gbm9ybWFsaXplZCB8fCBcImFnZW50X291dHB1dFwiO1xufTtcblxuY29uc3Qgc3RyaXBDb2RlRmVuY2VzID0gKHZhbHVlKSA9PlxuICBTdHJpbmcodmFsdWUgfHwgXCJcIilcbiAgICAucmVwbGFjZSgvYGBganNvbi9naSwgXCJgYGBcIilcbiAgICAucmVwbGFjZSgvXmBgYC8sIFwiXCIpXG4gICAgLnJlcGxhY2UoL2BgYCQvLCBcIlwiKVxuICAgIC50cmltKCk7XG5cbmNvbnN0IHBhcnNlSnNvblN0cmluZyA9ICh2YWx1ZSkgPT4ge1xuICBpZiAodHlwZW9mIHZhbHVlICE9PSBcInN0cmluZ1wiKSByZXR1cm4gbnVsbDtcbiAgY29uc3QgZGlyZWN0ID0gdmFsdWUudHJpbSgpO1xuICBpZiAoIWRpcmVjdCkgcmV0dXJuIG51bGw7XG4gIHRyeSB7XG4gICAgcmV0dXJuIEpTT04ucGFyc2UoZGlyZWN0KTtcbiAgfSBjYXRjaCB7XG4gICAgLy8gY29udGludWVcbiAgfVxuICBjb25zdCBzdHJpcHBlZCA9IHN0cmlwQ29kZUZlbmNlcyhkaXJlY3QpO1xuICBpZiAoIXN0cmlwcGVkKSByZXR1cm4gbnVsbDtcbiAgdHJ5IHtcbiAgICByZXR1cm4gSlNPTi5wYXJzZShzdHJpcHBlZCk7XG4gIH0gY2F0Y2gge1xuICAgIHJldHVybiBudWxsO1xuICB9XG59O1xuXG5jb25zdCBleHRyYWN0RXJyb3JNZXNzYWdlID0gKHBheWxvYWQpID0+IHtcbiAgaWYgKCFwYXlsb2FkIHx8IHR5cGVvZiBwYXlsb2FkICE9PSBcIm9iamVjdFwiKSByZXR1cm4gXCJcIjtcbiAgaWYgKHBheWxvYWQuZXJyb3IgJiYgdHlwZW9mIHBheWxvYWQuZXJyb3IgPT09IFwib2JqZWN0XCIpIHtcbiAgICBjb25zdCBtZXNzYWdlID0gcGF5bG9hZC5lcnJvci5tZXNzYWdlIHx8IHBheWxvYWQuZXJyb3IuY29kZTtcbiAgICBpZiAobWVzc2FnZSkgcmV0dXJuIFN0cmluZyhtZXNzYWdlKTtcbiAgfVxuICByZXR1cm4gXCJcIjtcbn07XG5cbmNvbnN0IGdldE51bWVyaWNPcHRpb24gPSAodmFsdWUsIGZhbGxiYWNrKSA9PiB7XG4gIGNvbnN0IG51bWVyaWMgPSBOdW1iZXIodmFsdWUpO1xuICByZXR1cm4gTnVtYmVyLmlzRmluaXRlKG51bWVyaWMpID8gbnVtZXJpYyA6IGZhbGxiYWNrO1xufTtcblxuY2xhc3MgUmVhbExMTVByb3ZpZGVyIHtcbiAgY29uc3RydWN0b3Iob3B0aW9ucyA9IHt9KSB7XG4gICAgdGhpcy5uYW1lID0gXCJyZWFsXCI7XG4gICAgdGhpcy5hcGlLZXkgPSBvcHRpb25zLmFwaUtleSB8fCBwcm9jZXNzLmVudi5PUEVOQUlfQVBJX0tFWSB8fCBcIlwiO1xuICAgIHRoaXMuYmFzZVVybCA9IFN0cmluZyhcbiAgICAgIG9wdGlvbnMuYmFzZVVybCB8fCBwcm9jZXNzLmVudi5PUEVOQUlfQkFTRV9VUkwgfHwgXCJodHRwczovL2FwaS5vcGVuYWkuY29tL3YxXCJcbiAgICApLnJlcGxhY2UoL1xcLyskLywgXCJcIik7XG4gICAgdGhpcy5tb2RlbCA9IG9wdGlvbnMubW9kZWwgfHwgcHJvY2Vzcy5lbnYuT1BFTkFJX01PREVMIHx8IFwiZ3B0LTUtbWluaVwiO1xuICAgIHRoaXMudGltZW91dE1zID0gZ2V0TnVtZXJpY09wdGlvbihvcHRpb25zLnRpbWVvdXRNcyB8fCBwcm9jZXNzLmVudi5PUEVOQUlfVElNRU9VVF9NUywgNDUwMDApO1xuICAgIHRoaXMuZmV0Y2hJbXBsID0gb3B0aW9ucy5mZXRjaCB8fCBnbG9iYWxUaGlzLmZldGNoO1xuICB9XG5cbiAgYXN5bmMgcmVxdWVzdENoYXRDb21wbGV0aW9ucyhwYXlsb2FkKSB7XG4gICAgaWYgKHR5cGVvZiB0aGlzLmZldGNoSW1wbCAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJHbG9iYWwgZmV0Y2ggaXMgbm90IGF2YWlsYWJsZSBmb3IgUmVhbExMTVByb3ZpZGVyLlwiKTtcbiAgICB9XG4gICAgY29uc3QgY29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcbiAgICBjb25zdCB0aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiBjb250cm9sbGVyLmFib3J0KCksIHRoaXMudGltZW91dE1zKTtcbiAgICBsZXQgcmVzcG9uc2U7XG4gICAgdHJ5IHtcbiAgICAgIHJlc3BvbnNlID0gYXdhaXQgdGhpcy5mZXRjaEltcGwoYCR7dGhpcy5iYXNlVXJsfS9jaGF0L2NvbXBsZXRpb25zYCwge1xuICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgXCJjb250ZW50LXR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICAgICAgYXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuYXBpS2V5fWBcbiAgICAgICAgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkocGF5bG9hZCksXG4gICAgICAgIHNpZ25hbDogY29udHJvbGxlci5zaWduYWxcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zdCBtZXNzYWdlID1cbiAgICAgICAgZXJyb3IgJiYgdHlwZW9mIGVycm9yID09PSBcIm9iamVjdFwiICYmIGVycm9yLm5hbWUgPT09IFwiQWJvcnRFcnJvclwiXG4gICAgICAgICAgPyBgT3BlbkFJIHJlcXVlc3QgdGltZWQgb3V0IGFmdGVyICR7dGhpcy50aW1lb3V0TXN9bXNgXG4gICAgICAgICAgOiBgT3BlbkFJIHJlcXVlc3QgZmFpbGVkOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogXCJ1bmtub3duIGVycm9yXCJ9YDtcbiAgICAgIHRocm93IG5ldyBFcnJvcihtZXNzYWdlKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xuICAgIH1cblxuICAgIGNvbnN0IHRleHQgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgY29uc3QgcGFyc2VkID0gcGFyc2VKc29uU3RyaW5nKHRleHQpIHx8IHt9O1xuICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgIGNvbnN0IGFwaU1lc3NhZ2UgPSBleHRyYWN0RXJyb3JNZXNzYWdlKHBhcnNlZCk7XG4gICAgICBjb25zdCByZWFzb24gPSBhcGlNZXNzYWdlIHx8IHRleHQuc2xpY2UoMCwgMzAwKSB8fCBgSFRUUCAke3Jlc3BvbnNlLnN0YXR1c31gO1xuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoYE9wZW5BSSByZXF1ZXN0IGZhaWxlZCAoJHtyZXNwb25zZS5zdGF0dXN9KTogJHtyZWFzb259YCk7XG4gICAgICBlcnJvci5zdGF0dXMgPSByZXNwb25zZS5zdGF0dXM7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gICAgcmV0dXJuIHBhcnNlZDtcbiAgfVxuXG4gIGV4dHJhY3RNZXNzYWdlVGV4dChwYXlsb2FkKSB7XG4gICAgY29uc3QgY29udGVudCA9IHBheWxvYWQ/LmNob2ljZXM/LlswXT8ubWVzc2FnZT8uY29udGVudDtcbiAgICBpZiAodHlwZW9mIGNvbnRlbnQgPT09IFwic3RyaW5nXCIpIHJldHVybiBjb250ZW50O1xuICAgIGlmIChBcnJheS5pc0FycmF5KGNvbnRlbnQpKSB7XG4gICAgICByZXR1cm4gY29udGVudFxuICAgICAgICAubWFwKChwYXJ0KSA9PiB7XG4gICAgICAgICAgaWYgKCFwYXJ0IHx8IHR5cGVvZiBwYXJ0ICE9PSBcIm9iamVjdFwiKSByZXR1cm4gXCJcIjtcbiAgICAgICAgICBpZiAodHlwZW9mIHBhcnQudGV4dCA9PT0gXCJzdHJpbmdcIikgcmV0dXJuIHBhcnQudGV4dDtcbiAgICAgICAgICBpZiAocGFydC50ZXh0ICYmIHR5cGVvZiBwYXJ0LnRleHQgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIHBhcnQudGV4dC52YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgcmV0dXJuIHBhcnQudGV4dC52YWx1ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHR5cGVvZiBwYXJ0LmNvbnRlbnQgPT09IFwic3RyaW5nXCIpIHJldHVybiBwYXJ0LmNvbnRlbnQ7XG4gICAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgICAgIH0pXG4gICAgICAgIC5qb2luKFwiXCIpXG4gICAgICAgIC50cmltKCk7XG4gICAgfVxuICAgIHJldHVybiBcIlwiO1xuICB9XG5cbiAgYnVpbGRNZXNzYWdlcyhzeXN0ZW0sIHByb21wdCwgc2NoZW1hKSB7XG4gICAgY29uc3QgYmFzZVN5c3RlbSA9XG4gICAgICB0eXBlb2Ygc3lzdGVtID09PSBcInN0cmluZ1wiICYmIHN5c3RlbS50cmltKClcbiAgICAgICAgPyBzeXN0ZW0udHJpbSgpXG4gICAgICAgIDogXCJZb3UgYXJlIGEgc3RyaWN0IEpTT04gYXNzaXN0YW50LlwiO1xuICAgIGNvbnN0IHNjaGVtYUhpbnQgPVxuICAgICAgc2NoZW1hICYmIHR5cGVvZiBzY2hlbWEgPT09IFwib2JqZWN0XCIgJiYgT2JqZWN0LmtleXMoc2NoZW1hKS5sZW5ndGhcbiAgICAgICAgPyBgUmV0dXJuIG9ubHkgSlNPTiB0aGF0IG1hdGNoZXMgdGhpcyBzY2hlbWE6XFxuJHtKU09OLnN0cmluZ2lmeShzY2hlbWEpfWBcbiAgICAgICAgOiBcIlJldHVybiBvbmx5IHZhbGlkIEpTT04uXCI7XG4gICAgY29uc3QgdXNlclByb21wdCA9IHR5cGVvZiBwcm9tcHQgPT09IFwic3RyaW5nXCIgJiYgcHJvbXB0LnRyaW0oKSA/IHByb21wdC50cmltKCkgOiBcInt9XCI7XG4gICAgcmV0dXJuIFtcbiAgICAgIHsgcm9sZTogXCJzeXN0ZW1cIiwgY29udGVudDogYCR7YmFzZVN5c3RlbX1cXG5cXG4ke3NjaGVtYUhpbnR9YCB9LFxuICAgICAgeyByb2xlOiBcInVzZXJcIiwgY29udGVudDogdXNlclByb21wdCB9XG4gICAgXTtcbiAgfVxuXG4gIGFzeW5jIGdlbmVyYXRlSnNvbih7IHN5c3RlbSwgcHJvbXB0LCBzY2hlbWEsIHRlbXBlcmF0dXJlLCBtYXhUb2tlbnMsIG1ldGEgfSA9IHt9KSB7XG4gICAgaWYgKCF0aGlzLmFwaUtleSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiT1BFTkFJX0FQSV9LRVkgaXMgcmVxdWlyZWQgd2hlbiBMTE1fUFJPVklERVI9cmVhbC5cIik7XG4gICAgfVxuXG4gICAgY29uc3QgcmVxdWVzdGVkTW9kZWwgPVxuICAgICAgbWV0YSAmJiB0eXBlb2YgbWV0YSA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgbWV0YS5tb2RlbCA9PT0gXCJzdHJpbmdcIlxuICAgICAgICA/IG1ldGEubW9kZWwudHJpbSgpXG4gICAgICAgIDogXCJcIjtcbiAgICBjb25zdCBtb2RlbCA9IHJlcXVlc3RlZE1vZGVsIHx8IHRoaXMubW9kZWw7XG4gICAgY29uc3QgbWVzc2FnZXMgPSB0aGlzLmJ1aWxkTWVzc2FnZXMoc3lzdGVtLCBwcm9tcHQsIHNjaGVtYSk7XG4gICAgY29uc3QgY2FwcGVkVGVtcGVyYXR1cmUgPSBNYXRoLm1pbihNYXRoLm1heChnZXROdW1lcmljT3B0aW9uKHRlbXBlcmF0dXJlLCAwLjIpLCAwKSwgMS41KTtcbiAgICBjb25zdCB0b2tlbkxpbWl0ID0gTWF0aC5tYXgoMjAwLCBNYXRoLm1pbig2MDAwLCBnZXROdW1lcmljT3B0aW9uKG1heFRva2VucywgMTgwMCkpKTtcbiAgICBjb25zdCBoYXNTY2hlbWEgPSBCb29sZWFuKHNjaGVtYSAmJiB0eXBlb2Ygc2NoZW1hID09PSBcIm9iamVjdFwiICYmIE9iamVjdC5rZXlzKHNjaGVtYSkubGVuZ3RoKTtcbiAgICBjb25zdCBzY2hlbWFOYW1lID0gc2FuaXRpemVTY2hlbWFOYW1lKFxuICAgICAgbWV0YSAmJiB0eXBlb2YgbWV0YSA9PT0gXCJvYmplY3RcIiA/IG1ldGEuYWdlbnRfaWQgfHwgbWV0YS5hZ2VudElkIHx8IFwiYWdlbnRfb3V0cHV0XCIgOiBcImFnZW50X291dHB1dFwiXG4gICAgKTtcblxuICAgIGNvbnN0IHdpdGhTY2hlbWFQYXlsb2FkID0ge1xuICAgICAgbW9kZWwsXG4gICAgICBtZXNzYWdlcyxcbiAgICAgIHRlbXBlcmF0dXJlOiBjYXBwZWRUZW1wZXJhdHVyZSxcbiAgICAgIG1heF90b2tlbnM6IHRva2VuTGltaXQsXG4gICAgICByZXNwb25zZV9mb3JtYXQ6IGhhc1NjaGVtYVxuICAgICAgICA/IHtcbiAgICAgICAgICAgIHR5cGU6IFwianNvbl9zY2hlbWFcIixcbiAgICAgICAgICAgIGpzb25fc2NoZW1hOiB7IG5hbWU6IHNjaGVtYU5hbWUsIHN0cmljdDogdHJ1ZSwgc2NoZW1hIH1cbiAgICAgICAgICB9XG4gICAgICAgIDogeyB0eXBlOiBcImpzb25fb2JqZWN0XCIgfVxuICAgIH07XG5cbiAgICBsZXQgZmlyc3RSZXN1bHQ7XG4gICAgdHJ5IHtcbiAgICAgIGZpcnN0UmVzdWx0ID0gYXdhaXQgdGhpcy5yZXF1ZXN0Q2hhdENvbXBsZXRpb25zKHdpdGhTY2hlbWFQYXlsb2FkKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgLy8gU29tZSBtb2RlbHMvZW5kcG9pbnRzIG1heSByZWplY3QganNvbl9zY2hlbWE7IGZhbGxiYWNrIHRvIHBsYWluIGpzb25fb2JqZWN0LlxuICAgICAgY29uc3QgZmFsbGJhY2tQYXlsb2FkID0ge1xuICAgICAgICBtb2RlbCxcbiAgICAgICAgbWVzc2FnZXMsXG4gICAgICAgIHRlbXBlcmF0dXJlOiBjYXBwZWRUZW1wZXJhdHVyZSxcbiAgICAgICAgbWF4X3Rva2VuczogdG9rZW5MaW1pdCxcbiAgICAgICAgcmVzcG9uc2VfZm9ybWF0OiB7IHR5cGU6IFwianNvbl9vYmplY3RcIiB9XG4gICAgICB9O1xuICAgICAgZmlyc3RSZXN1bHQgPSBhd2FpdCB0aGlzLnJlcXVlc3RDaGF0Q29tcGxldGlvbnMoZmFsbGJhY2tQYXlsb2FkKTtcbiAgICB9XG5cbiAgICBjb25zdCB0ZXh0ID0gdGhpcy5leHRyYWN0TWVzc2FnZVRleHQoZmlyc3RSZXN1bHQpO1xuICAgIGNvbnN0IHBhcnNlZCA9IHBhcnNlSnNvblN0cmluZyh0ZXh0KTtcbiAgICBpZiAocGFyc2VkICYmIHR5cGVvZiBwYXJzZWQgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgIHJldHVybiBwYXJzZWQ7XG4gICAgfVxuXG4gICAgdGhyb3cgbmV3IEVycm9yKFwiT3BlbkFJIHJldHVybmVkIG5vbi1KU09OIG91dHB1dCBmb3IgZ2VuZXJhdGVKc29uKCkuXCIpO1xuICB9XG59XG5cbmNvbnN0IGNyZWF0ZUxMTVByb3ZpZGVyID0gKHsgcHJvdmlkZXIsIGZpeHR1cmVzUm9vdCB9ID0ge30pID0+IHtcbiAgY29uc3QgbW9kZSA9IG5vcm1hbGl6ZVByb3ZpZGVyTmFtZShwcm92aWRlciB8fCBnZXRDb25maWd1cmVkUHJvdmlkZXJOYW1lKCkpO1xuICBpZiAobW9kZSA9PT0gXCJyZWFsXCIpIHJldHVybiBuZXcgUmVhbExMTVByb3ZpZGVyKCk7XG4gIHJldHVybiBuZXcgRmFrZUxMTVByb3ZpZGVyKHsgZml4dHVyZXNSb290IH0pO1xufTtcblxubGV0IHNpbmdsZXRvbiA9IG51bGw7XG5cbmNvbnN0IGdldExMTVByb3ZpZGVyID0gKG9wdGlvbnMgPSB7fSkgPT4ge1xuICBpZiAob3B0aW9ucy5mb3JjZU5ldykgcmV0dXJuIGNyZWF0ZUxMTVByb3ZpZGVyKG9wdGlvbnMpO1xuICBpZiAoIXNpbmdsZXRvbikgc2luZ2xldG9uID0gY3JlYXRlTExNUHJvdmlkZXIob3B0aW9ucyk7XG4gIHJldHVybiBzaW5nbGV0b247XG59O1xuXG5jb25zdCBpc0Zha2VMTE1Qcm92aWRlciA9IChwcm92aWRlcikgPT4ge1xuICBjb25zdCBuYW1lID0gcHJvdmlkZXIgJiYgdHlwZW9mIHByb3ZpZGVyID09PSBcIm9iamVjdFwiID8gcHJvdmlkZXIubmFtZSA6IFwiXCI7XG4gIHJldHVybiBub3JtYWxpemVQcm92aWRlck5hbWUobmFtZSkgPT09IFwiZmFrZVwiO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIEZha2VMTE1Qcm92aWRlcixcbiAgUmVhbExMTVByb3ZpZGVyLFxuICBidWlsZEZyb21TY2hlbWEsXG4gIGNhbm9uaWNhbEFnZW50SWQsXG4gIGNyZWF0ZUxMTVByb3ZpZGVyLFxuICBnZXRDb25maWd1cmVkUHJvdmlkZXJOYW1lLFxuICBnZXRMTE1Qcm92aWRlcixcbiAgaGFzUmVhbFByb3ZpZGVyQ3JlZGVudGlhbHMsXG4gIGhhc0ZpeHR1cmVGb3JBZ2VudCxcbiAgaXNGYWtlTExNUHJvdmlkZXIsXG4gIHJlc29sdmVGaXh0dXJlT3V0cHV0UGF0aCxcbiAgc3RyaXBWb2xhdGlsZVxufTtcbiJdLCJuYW1lcyI6WyJmcyIsInJlcXVpcmUiLCJwYXRoIiwiREVGQVVMVF9QUk9WSURFUiIsIm5vcm1hbGl6ZVByb3ZpZGVyTmFtZSIsInZhbHVlIiwibm9ybWFsaXplZCIsIlN0cmluZyIsInRyaW0iLCJ0b0xvd2VyQ2FzZSIsImdldENvbmZpZ3VyZWRQcm92aWRlck5hbWUiLCJwcm9jZXNzIiwiZW52IiwiTExNX1BST1ZJREVSIiwiaGFzUmVhbFByb3ZpZGVyQ3JlZGVudGlhbHMiLCJCb29sZWFuIiwiT1BFTkFJX0FQSV9LRVkiLCJBR0VOVF9JRF9BTElBU0VTIiwicGxhdG9uIiwiYW5hdG9seSIsIm1heGltIiwiY2Fub25pY2FsQWdlbnRJZCIsImFnZW50SWQiLCJyZXNvbHZlRml4dHVyZU91dHB1dFBhdGgiLCJmaXh0dXJlc1Jvb3QiLCJjYW5vbmljYWwiLCJyb290Iiwiam9pbiIsImN3ZCIsImhhc0ZpeHR1cmVGb3JBZ2VudCIsIm91dHB1dFBhdGgiLCJleGlzdHNTeW5jIiwic3RyaXBWb2xhdGlsZSIsIkFycmF5IiwiaXNBcnJheSIsIm1hcCIsIml0ZW0iLCJuZXh0IiwiT2JqZWN0IiwiZW50cmllcyIsImZvckVhY2giLCJrZXkiLCJ2YWwiLCJjbG9uZUpzb24iLCJKU09OIiwicGFyc2UiLCJzdHJpbmdpZnkiLCJwaWNrU2NoZW1hTm9kZSIsInNjaGVtYSIsIm9uZU9mIiwibGVuZ3RoIiwiYW55T2YiLCJhbGxPZiIsInJlZHVjZSIsImFjYyIsInNjaGVtYVR5cGUiLCJub2RlIiwiY29uc3QiLCJ1bmRlZmluZWQiLCJkZWZhdWx0IiwiZW51bSIsInR5cGUiLCJ2YWx1ZUZvckZvcm1hdCIsImZvcm1hdCIsImJ1aWxkRnJvbVNjaGVtYSIsImtleUhpbnQiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJpbmNsdWRlcyIsIk51bWJlciIsImlzRmluaXRlIiwibWluaW11bSIsIml0ZW1TY2hlbWEiLCJpdGVtcyIsInByb3BlcnRpZXMiLCJyZXF1aXJlZCIsImtleXMiLCJTZXQiLCJyZXN1bHQiLCJzaXplIiwiZ2VuZXJhdGVkX2F0IiwiY2hpbGRTY2hlbWEiLCJGYWtlTExNUHJvdmlkZXIiLCJvcHRpb25zIiwibmFtZSIsImxvYWRGaXh0dXJlRGF0YSIsInBhcnNlZCIsInJlYWRGaWxlU3luYyIsImxlZ2FjeURhdGEiLCJkYXRhIiwiZ2VuZXJhdGVKc29uIiwibWV0YSIsImFnZW50X2lkIiwiZml4dHVyZURhdGEiLCJzYW5pdGl6ZVNjaGVtYU5hbWUiLCJyZXBsYWNlIiwic3RyaXBDb2RlRmVuY2VzIiwicGFyc2VKc29uU3RyaW5nIiwiZGlyZWN0Iiwic3RyaXBwZWQiLCJleHRyYWN0RXJyb3JNZXNzYWdlIiwicGF5bG9hZCIsImVycm9yIiwibWVzc2FnZSIsImNvZGUiLCJnZXROdW1lcmljT3B0aW9uIiwiZmFsbGJhY2siLCJudW1lcmljIiwiUmVhbExMTVByb3ZpZGVyIiwiYXBpS2V5IiwiYmFzZVVybCIsIk9QRU5BSV9CQVNFX1VSTCIsIm1vZGVsIiwiT1BFTkFJX01PREVMIiwidGltZW91dE1zIiwiT1BFTkFJX1RJTUVPVVRfTVMiLCJmZXRjaEltcGwiLCJmZXRjaCIsImdsb2JhbFRoaXMiLCJyZXF1ZXN0Q2hhdENvbXBsZXRpb25zIiwiRXJyb3IiLCJjb250cm9sbGVyIiwiQWJvcnRDb250cm9sbGVyIiwidGltZW91dCIsInNldFRpbWVvdXQiLCJhYm9ydCIsInJlc3BvbnNlIiwibWV0aG9kIiwiaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJib2R5Iiwic2lnbmFsIiwiY2xlYXJUaW1lb3V0IiwidGV4dCIsIm9rIiwiYXBpTWVzc2FnZSIsInJlYXNvbiIsInNsaWNlIiwic3RhdHVzIiwiZXh0cmFjdE1lc3NhZ2VUZXh0IiwiY29udGVudCIsImNob2ljZXMiLCJwYXJ0IiwiYnVpbGRNZXNzYWdlcyIsInN5c3RlbSIsInByb21wdCIsImJhc2VTeXN0ZW0iLCJzY2hlbWFIaW50IiwidXNlclByb21wdCIsInJvbGUiLCJ0ZW1wZXJhdHVyZSIsIm1heFRva2VucyIsInJlcXVlc3RlZE1vZGVsIiwibWVzc2FnZXMiLCJjYXBwZWRUZW1wZXJhdHVyZSIsIk1hdGgiLCJtaW4iLCJtYXgiLCJ0b2tlbkxpbWl0IiwiaGFzU2NoZW1hIiwic2NoZW1hTmFtZSIsIndpdGhTY2hlbWFQYXlsb2FkIiwibWF4X3Rva2VucyIsInJlc3BvbnNlX2Zvcm1hdCIsImpzb25fc2NoZW1hIiwic3RyaWN0IiwiZmlyc3RSZXN1bHQiLCJmYWxsYmFja1BheWxvYWQiLCJjcmVhdGVMTE1Qcm92aWRlciIsInByb3ZpZGVyIiwibW9kZSIsInNpbmdsZXRvbiIsImdldExMTVByb3ZpZGVyIiwiZm9yY2VOZXciLCJpc0Zha2VMTE1Qcm92aWRlciIsIm1vZHVsZSIsImV4cG9ydHMiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/llm/provider.js\n");

/***/ }),

/***/ "(rsc)/./utils/agentEnvelope.js":
/*!********************************!*\
  !*** ./utils/agentEnvelope.js ***!
  \********************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("\nconst { randomUUID } = __webpack_require__(/*! crypto */ \"crypto\");\nconst { getAgentSchema } = __webpack_require__(/*! ./agentSchemas */ \"(rsc)/./utils/agentSchemas.js\");\nconst { validateAgentResponse } = __webpack_require__(/*! ./validateAgentResponse */ \"(rsc)/./utils/validateAgentResponse.js\");\nconst { buildHandoff } = __webpack_require__(/*! ./handoff */ \"(rsc)/./utils/handoff.js\");\nconst { getConfiguredProviderName, hasRealProviderCredentials } = __webpack_require__(/*! ../lib/llm/provider.js */ \"(rsc)/./lib/llm/provider.js\");\nconst makeRunId = ()=>{\n    if (typeof randomUUID === \"function\") {\n        return randomUUID();\n    }\n    const rand = Math.random().toString(36).slice(2, 8);\n    return `run_${Date.now()}_${rand}`;\n};\nconst deriveQualityChecks = (legacyMeta = {})=>{\n    const legacy = legacyMeta && legacyMeta.quality_checks ? legacyMeta.quality_checks : {};\n    const providerName = getConfiguredProviderName();\n    const withinLimits = typeof legacy.within_max_words === \"boolean\" ? legacy.within_max_words : typeof legacy.within_limits === \"boolean\" ? legacy.within_limits : true;\n    const noFabrication = typeof legacy.no_fabrication === \"boolean\" ? legacy.no_fabrication : typeof legacy.no_gray_scraping === \"boolean\" ? legacy.no_gray_scraping : true;\n    const dedupeOk = typeof legacy.dedupe_ok === \"boolean\" ? legacy.dedupe_ok : true;\n    const groundingOk = typeof legacy.grounded_claims_ok === \"boolean\" ? legacy.grounded_claims_ok : typeof legacy.grounding_ok === \"boolean\" ? legacy.grounding_ok : true;\n    const llmConnectedByEnv = providerName === \"real\" && hasRealProviderCredentials();\n    return {\n        no_fabrication: noFabrication,\n        within_limits: withinLimits,\n        dedupe_ok: dedupeOk,\n        grounding_ok: groundingOk,\n        llm_connected: typeof legacy.llm_connected === \"boolean\" ? legacy.llm_connected : llmConnectedByEnv,\n        schema_valid: true\n    };\n};\nconst unwrapLegacy = (payload)=>{\n    if (payload && payload.data && payload.meta) return payload.data;\n    return payload;\n};\nconst sanitizeInputEcho = (input)=>{\n    if (!input || typeof input !== \"object\") return input;\n    const clone = Array.isArray(input) ? [\n        ...input\n    ] : {\n        ...input\n    };\n    if (Array.isArray(clone)) return clone;\n    Object.keys(clone).forEach((key)=>{\n        if (key.startsWith(\"__\")) {\n            delete clone[key];\n        }\n    });\n    return clone;\n};\nconst wrapAgentOutput = ({ agentId, inputEcho, mode, legacyOutput, webStatsOverride, traceId })=>{\n    const data = legacyOutput || {};\n    const legacyMeta = data && data.meta ? data.meta : {};\n    const schema = getAgentSchema(agentId);\n    const validation = validateAgentResponse(data, schema);\n    const qualityChecks = deriveQualityChecks(legacyMeta);\n    qualityChecks.schema_valid = validation.ok;\n    const limitations = Array.isArray(legacyMeta.limitations) ? legacyMeta.limitations : [];\n    const assumptions = Array.isArray(legacyMeta.assumptions) ? legacyMeta.assumptions : [];\n    const warnings = Array.isArray(legacyMeta.warnings) ? legacyMeta.warnings : [];\n    const budgetApplied = legacyMeta && typeof legacyMeta.budget_applied === \"object\" ? legacyMeta.budget_applied : null;\n    const knowledgeUsed = legacyMeta && legacyMeta.knowledge_used || inputEcho && inputEcho.__knowledge_used || {\n        workspace_items: 0,\n        agent_items: 0,\n        top_ids: []\n    };\n    const web_stats = webStatsOverride || (legacyMeta && legacyMeta.web_stats ? legacyMeta.web_stats : null);\n    const handoff = buildHandoff(agentId, data);\n    const envelopeMeta = {\n        agent_id: agentId,\n        generated_at: new Date().toISOString(),\n        run_id: makeRunId(),\n        mode: mode || \"\",\n        input_echo: sanitizeInputEcho(inputEcho) || {},\n        quality_checks: qualityChecks,\n        limitations,\n        assumptions,\n        handoff,\n        web_stats,\n        knowledge_used: knowledgeUsed\n    };\n    if (warnings.length) {\n        envelopeMeta.warnings = warnings;\n    }\n    if (budgetApplied) {\n        envelopeMeta.budget_applied = budgetApplied;\n    }\n    const hasWebStats = web_stats && typeof web_stats === \"object\";\n    const trace_id = traceId || (hasWebStats ? envelopeMeta.run_id : undefined);\n    if (trace_id) {\n        envelopeMeta.trace_id = trace_id;\n    }\n    return {\n        data,\n        meta: envelopeMeta,\n        validation\n    };\n};\nmodule.exports = {\n    wrapAgentOutput,\n    unwrapLegacy\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUEsSUFBSUgsU0FBU2lCLE1BQU0sRUFBRTtRQUNuQk4sYUFBYVgsUUFBUSxHQUFHQTtJQUMxQjtJQUNBLElBQUlDLGVBQWU7UUFDakJVLGFBQWFULGNBQWMsR0FBR0Q7SUFDaEM7SUFFQSxNQUFNaUIsY0FBY1QsYUFBYSxPQUFPQSxjQUFjO0lBQ3RELE1BQU1VLFdBQVcxQixXQUFZeUIsQ0FBQUEsY0FBY1AsYUFBYUksTUFBTSxHQUFHSyxTQUFRO0lBQ3pFLElBQUlELFVBQVU7UUFDWlIsYUFBYVEsUUFBUSxHQUFHQTtJQUMxQjtJQUVBLE9BQU87UUFBRTVDO1FBQU1DLE1BQU1tQztRQUFjaEI7SUFBVztBQUNoRDtBQUVBMEIsT0FBT0MsT0FBTyxHQUFHO0lBQ2ZuQztJQUNBZDtBQUNGIiwic291cmNlcyI6WyIvVXNlcnMvYWJ1emFkYS9EZXNrdG9wL2FnZW50T1MvdXRpbHMvYWdlbnRFbnZlbG9wZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB7IHJhbmRvbVVVSUQgfSA9IHJlcXVpcmUoXCJjcnlwdG9cIik7XG5jb25zdCB7IGdldEFnZW50U2NoZW1hIH0gPSByZXF1aXJlKFwiLi9hZ2VudFNjaGVtYXNcIik7XG5jb25zdCB7IHZhbGlkYXRlQWdlbnRSZXNwb25zZSB9ID0gcmVxdWlyZShcIi4vdmFsaWRhdGVBZ2VudFJlc3BvbnNlXCIpO1xuY29uc3QgeyBidWlsZEhhbmRvZmYgfSA9IHJlcXVpcmUoXCIuL2hhbmRvZmZcIik7XG5jb25zdCB7XG4gIGdldENvbmZpZ3VyZWRQcm92aWRlck5hbWUsXG4gIGhhc1JlYWxQcm92aWRlckNyZWRlbnRpYWxzXG59ID0gcmVxdWlyZShcIi4uL2xpYi9sbG0vcHJvdmlkZXIuanNcIik7XG5cbmNvbnN0IG1ha2VSdW5JZCA9ICgpID0+IHtcbiAgaWYgKHR5cGVvZiByYW5kb21VVUlEID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICByZXR1cm4gcmFuZG9tVVVJRCgpO1xuICB9XG4gIGNvbnN0IHJhbmQgPSBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zbGljZSgyLCA4KTtcbiAgcmV0dXJuIGBydW5fJHtEYXRlLm5vdygpfV8ke3JhbmR9YDtcbn07XG5cbmNvbnN0IGRlcml2ZVF1YWxpdHlDaGVja3MgPSAobGVnYWN5TWV0YSA9IHt9KSA9PiB7XG4gIGNvbnN0IGxlZ2FjeSA9IGxlZ2FjeU1ldGEgJiYgbGVnYWN5TWV0YS5xdWFsaXR5X2NoZWNrcyA/IGxlZ2FjeU1ldGEucXVhbGl0eV9jaGVja3MgOiB7fTtcbiAgY29uc3QgcHJvdmlkZXJOYW1lID0gZ2V0Q29uZmlndXJlZFByb3ZpZGVyTmFtZSgpO1xuICBjb25zdCB3aXRoaW5MaW1pdHMgPVxuICAgIHR5cGVvZiBsZWdhY3kud2l0aGluX21heF93b3JkcyA9PT0gXCJib29sZWFuXCJcbiAgICAgID8gbGVnYWN5LndpdGhpbl9tYXhfd29yZHNcbiAgICAgIDogdHlwZW9mIGxlZ2FjeS53aXRoaW5fbGltaXRzID09PSBcImJvb2xlYW5cIlxuICAgICAgICA/IGxlZ2FjeS53aXRoaW5fbGltaXRzXG4gICAgICAgIDogdHJ1ZTtcbiAgY29uc3Qgbm9GYWJyaWNhdGlvbiA9XG4gICAgdHlwZW9mIGxlZ2FjeS5ub19mYWJyaWNhdGlvbiA9PT0gXCJib29sZWFuXCJcbiAgICAgID8gbGVnYWN5Lm5vX2ZhYnJpY2F0aW9uXG4gICAgICA6IHR5cGVvZiBsZWdhY3kubm9fZ3JheV9zY3JhcGluZyA9PT0gXCJib29sZWFuXCJcbiAgICAgICAgPyBsZWdhY3kubm9fZ3JheV9zY3JhcGluZ1xuICAgICAgICA6IHRydWU7XG4gIGNvbnN0IGRlZHVwZU9rID0gdHlwZW9mIGxlZ2FjeS5kZWR1cGVfb2sgPT09IFwiYm9vbGVhblwiID8gbGVnYWN5LmRlZHVwZV9vayA6IHRydWU7XG4gIGNvbnN0IGdyb3VuZGluZ09rID1cbiAgICB0eXBlb2YgbGVnYWN5Lmdyb3VuZGVkX2NsYWltc19vayA9PT0gXCJib29sZWFuXCJcbiAgICAgID8gbGVnYWN5Lmdyb3VuZGVkX2NsYWltc19va1xuICAgICAgOiB0eXBlb2YgbGVnYWN5Lmdyb3VuZGluZ19vayA9PT0gXCJib29sZWFuXCJcbiAgICAgICAgPyBsZWdhY3kuZ3JvdW5kaW5nX29rXG4gICAgICAgIDogdHJ1ZTtcbiAgY29uc3QgbGxtQ29ubmVjdGVkQnlFbnYgPSBwcm92aWRlck5hbWUgPT09IFwicmVhbFwiICYmIGhhc1JlYWxQcm92aWRlckNyZWRlbnRpYWxzKCk7XG4gIHJldHVybiB7XG4gICAgbm9fZmFicmljYXRpb246IG5vRmFicmljYXRpb24sXG4gICAgd2l0aGluX2xpbWl0czogd2l0aGluTGltaXRzLFxuICAgIGRlZHVwZV9vazogZGVkdXBlT2ssXG4gICAgZ3JvdW5kaW5nX29rOiBncm91bmRpbmdPayxcbiAgICBsbG1fY29ubmVjdGVkOlxuICAgICAgdHlwZW9mIGxlZ2FjeS5sbG1fY29ubmVjdGVkID09PSBcImJvb2xlYW5cIlxuICAgICAgICA/IGxlZ2FjeS5sbG1fY29ubmVjdGVkXG4gICAgICAgIDogbGxtQ29ubmVjdGVkQnlFbnYsXG4gICAgc2NoZW1hX3ZhbGlkOiB0cnVlXG4gIH07XG59O1xuXG5jb25zdCB1bndyYXBMZWdhY3kgPSAocGF5bG9hZCkgPT4ge1xuICBpZiAocGF5bG9hZCAmJiBwYXlsb2FkLmRhdGEgJiYgcGF5bG9hZC5tZXRhKSByZXR1cm4gcGF5bG9hZC5kYXRhO1xuICByZXR1cm4gcGF5bG9hZDtcbn07XG5cbmNvbnN0IHNhbml0aXplSW5wdXRFY2hvID0gKGlucHV0KSA9PiB7XG4gIGlmICghaW5wdXQgfHwgdHlwZW9mIGlucHV0ICE9PSBcIm9iamVjdFwiKSByZXR1cm4gaW5wdXQ7XG4gIGNvbnN0IGNsb25lID0gQXJyYXkuaXNBcnJheShpbnB1dCkgPyBbLi4uaW5wdXRdIDogeyAuLi5pbnB1dCB9O1xuICBpZiAoQXJyYXkuaXNBcnJheShjbG9uZSkpIHJldHVybiBjbG9uZTtcbiAgT2JqZWN0LmtleXMoY2xvbmUpLmZvckVhY2goKGtleSkgPT4ge1xuICAgIGlmIChrZXkuc3RhcnRzV2l0aChcIl9fXCIpKSB7XG4gICAgICBkZWxldGUgY2xvbmVba2V5XTtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gY2xvbmU7XG59O1xuXG5jb25zdCB3cmFwQWdlbnRPdXRwdXQgPSAoe1xuICBhZ2VudElkLFxuICBpbnB1dEVjaG8sXG4gIG1vZGUsXG4gIGxlZ2FjeU91dHB1dCxcbiAgd2ViU3RhdHNPdmVycmlkZSxcbiAgdHJhY2VJZFxufSkgPT4ge1xuICBjb25zdCBkYXRhID0gbGVnYWN5T3V0cHV0IHx8IHt9O1xuICBjb25zdCBsZWdhY3lNZXRhID0gZGF0YSAmJiBkYXRhLm1ldGEgPyBkYXRhLm1ldGEgOiB7fTtcbiAgY29uc3Qgc2NoZW1hID0gZ2V0QWdlbnRTY2hlbWEoYWdlbnRJZCk7XG4gIGNvbnN0IHZhbGlkYXRpb24gPSB2YWxpZGF0ZUFnZW50UmVzcG9uc2UoZGF0YSwgc2NoZW1hKTtcblxuICBjb25zdCBxdWFsaXR5Q2hlY2tzID0gZGVyaXZlUXVhbGl0eUNoZWNrcyhsZWdhY3lNZXRhKTtcbiAgcXVhbGl0eUNoZWNrcy5zY2hlbWFfdmFsaWQgPSB2YWxpZGF0aW9uLm9rO1xuXG4gIGNvbnN0IGxpbWl0YXRpb25zID0gQXJyYXkuaXNBcnJheShsZWdhY3lNZXRhLmxpbWl0YXRpb25zKSA/IGxlZ2FjeU1ldGEubGltaXRhdGlvbnMgOiBbXTtcbiAgY29uc3QgYXNzdW1wdGlvbnMgPSBBcnJheS5pc0FycmF5KGxlZ2FjeU1ldGEuYXNzdW1wdGlvbnMpID8gbGVnYWN5TWV0YS5hc3N1bXB0aW9ucyA6IFtdO1xuICBjb25zdCB3YXJuaW5ncyA9IEFycmF5LmlzQXJyYXkobGVnYWN5TWV0YS53YXJuaW5ncykgPyBsZWdhY3lNZXRhLndhcm5pbmdzIDogW107XG4gIGNvbnN0IGJ1ZGdldEFwcGxpZWQgPVxuICAgIGxlZ2FjeU1ldGEgJiYgdHlwZW9mIGxlZ2FjeU1ldGEuYnVkZ2V0X2FwcGxpZWQgPT09IFwib2JqZWN0XCJcbiAgICAgID8gbGVnYWN5TWV0YS5idWRnZXRfYXBwbGllZFxuICAgICAgOiBudWxsO1xuICBjb25zdCBrbm93bGVkZ2VVc2VkID1cbiAgICAobGVnYWN5TWV0YSAmJiBsZWdhY3lNZXRhLmtub3dsZWRnZV91c2VkKSB8fFxuICAgIChpbnB1dEVjaG8gJiYgaW5wdXRFY2hvLl9fa25vd2xlZGdlX3VzZWQpIHx8XG4gICAgeyB3b3Jrc3BhY2VfaXRlbXM6IDAsIGFnZW50X2l0ZW1zOiAwLCB0b3BfaWRzOiBbXSB9O1xuXG4gIGNvbnN0IHdlYl9zdGF0cyA9XG4gICAgd2ViU3RhdHNPdmVycmlkZSB8fCAobGVnYWN5TWV0YSAmJiBsZWdhY3lNZXRhLndlYl9zdGF0cyA/IGxlZ2FjeU1ldGEud2ViX3N0YXRzIDogbnVsbCk7XG5cbiAgY29uc3QgaGFuZG9mZiA9IGJ1aWxkSGFuZG9mZihhZ2VudElkLCBkYXRhKTtcblxuICBjb25zdCBlbnZlbG9wZU1ldGEgPSB7XG4gICAgYWdlbnRfaWQ6IGFnZW50SWQsXG4gICAgZ2VuZXJhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgcnVuX2lkOiBtYWtlUnVuSWQoKSxcbiAgICBtb2RlOiBtb2RlIHx8IFwiXCIsXG4gICAgaW5wdXRfZWNobzogc2FuaXRpemVJbnB1dEVjaG8oaW5wdXRFY2hvKSB8fCB7fSxcbiAgICBxdWFsaXR5X2NoZWNrczogcXVhbGl0eUNoZWNrcyxcbiAgICBsaW1pdGF0aW9ucyxcbiAgICBhc3N1bXB0aW9ucyxcbiAgICBoYW5kb2ZmLFxuICAgIHdlYl9zdGF0cyxcbiAgICBrbm93bGVkZ2VfdXNlZDoga25vd2xlZGdlVXNlZFxuICB9O1xuXG4gIGlmICh3YXJuaW5ncy5sZW5ndGgpIHtcbiAgICBlbnZlbG9wZU1ldGEud2FybmluZ3MgPSB3YXJuaW5ncztcbiAgfVxuICBpZiAoYnVkZ2V0QXBwbGllZCkge1xuICAgIGVudmVsb3BlTWV0YS5idWRnZXRfYXBwbGllZCA9IGJ1ZGdldEFwcGxpZWQ7XG4gIH1cblxuICBjb25zdCBoYXNXZWJTdGF0cyA9IHdlYl9zdGF0cyAmJiB0eXBlb2Ygd2ViX3N0YXRzID09PSBcIm9iamVjdFwiO1xuICBjb25zdCB0cmFjZV9pZCA9IHRyYWNlSWQgfHwgKGhhc1dlYlN0YXRzID8gZW52ZWxvcGVNZXRhLnJ1bl9pZCA6IHVuZGVmaW5lZCk7XG4gIGlmICh0cmFjZV9pZCkge1xuICAgIGVudmVsb3BlTWV0YS50cmFjZV9pZCA9IHRyYWNlX2lkO1xuICB9XG5cbiAgcmV0dXJuIHsgZGF0YSwgbWV0YTogZW52ZWxvcGVNZXRhLCB2YWxpZGF0aW9uIH07XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgd3JhcEFnZW50T3V0cHV0LFxuICB1bndyYXBMZWdhY3lcbn07XG4iXSwibmFtZXMiOlsicmFuZG9tVVVJRCIsInJlcXVpcmUiLCJnZXRBZ2VudFNjaGVtYSIsInZhbGlkYXRlQWdlbnRSZXNwb25zZSIsImJ1aWxkSGFuZG9mZiIsImdldENvbmZpZ3VyZWRQcm92aWRlck5hbWUiLCJoYXNSZWFsUHJvdmlkZXJDcmVkZW50aWFscyIsIm1ha2VSdW5JZCIsInJhbmQiLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJzbGljZSIsIkRhdGUiLCJub3ciLCJkZXJpdmVRdWFsaXR5Q2hlY2tzIiwibGVnYWN5TWV0YSIsImxlZ2FjeSIsInF1YWxpdHlfY2hlY2tzIiwicHJvdmlkZXJOYW1lIiwid2l0aGluTGltaXRzIiwid2l0aGluX21heF93b3JkcyIsIndpdGhpbl9saW1pdHMiLCJub0ZhYnJpY2F0aW9uIiwibm9fZmFicmljYXRpb24iLCJub19ncmF5X3NjcmFwaW5nIiwiZGVkdXBlT2siLCJkZWR1cGVfb2siLCJncm91bmRpbmdPayIsImdyb3VuZGVkX2NsYWltc19vayIsImdyb3VuZGluZ19vayIsImxsbUNvbm5lY3RlZEJ5RW52IiwibGxtX2Nvbm5lY3RlZCIsInNjaGVtYV92YWxpZCIsInVud3JhcExlZ2FjeSIsInBheWxvYWQiLCJkYXRhIiwibWV0YSIsInNhbml0aXplSW5wdXRFY2hvIiwiaW5wdXQiLCJjbG9uZSIsIkFycmF5IiwiaXNBcnJheSIsIk9iamVjdCIsImtleXMiLCJmb3JFYWNoIiwia2V5Iiwic3RhcnRzV2l0aCIsIndyYXBBZ2VudE91dHB1dCIsImFnZW50SWQiLCJpbnB1dEVjaG8iLCJtb2RlIiwibGVnYWN5T3V0cHV0Iiwid2ViU3RhdHNPdmVycmlkZSIsInRyYWNlSWQiLCJzY2hlbWEiLCJ2YWxpZGF0aW9uIiwicXVhbGl0eUNoZWNrcyIsIm9rIiwibGltaXRhdGlvbnMiLCJhc3N1bXB0aW9ucyIsIndhcm5pbmdzIiwiYnVkZ2V0QXBwbGllZCIsImJ1ZGdldF9hcHBsaWVkIiwia25vd2xlZGdlVXNlZCIsImtub3dsZWRnZV91c2VkIiwiX19rbm93bGVkZ2VfdXNlZCIsIndvcmtzcGFjZV9pdGVtcyIsImFnZW50X2l0ZW1zIiwidG9wX2lkcyIsIndlYl9zdGF0cyIsImhhbmRvZmYiLCJlbnZlbG9wZU1ldGEiLCJhZ2VudF9pZCIsImdlbmVyYXRlZF9hdCIsInRvSVNPU3RyaW5nIiwicnVuX2lkIiwiaW5wdXRfZWNobyIsImxlbmd0aCIsImhhc1dlYlN0YXRzIiwidHJhY2VfaWQiLCJ1bmRlZmluZWQiLCJtb2R1bGUiLCJleHBvcnRzIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./utils/agentEnvelope.js\n");

/***/ }),

/***/ "(rsc)/./utils/agentSchemas.js":
/*!*******************************!*\
  !*** ./utils/agentSchemas.js ***!
  \*******************************/
/***/ ((module) => {

eval("\nconst platonSchema = {\n    required: {\n        segments: \"array\",\n        company_candidates: \"array\",\n        meta: \"object\"\n    }\n};\nconst agentSchemas = {\n    \"platon-prospect-research-ru\": platonSchema,\n    platon: platonSchema,\n    \"anatoly-account-research-ru\": {\n        required: {\n            account_card: \"object\",\n            meta: \"object\"\n        }\n    },\n    \"timofey-competitor-analysis-ru\": {\n        required: {\n            competitors: \"array\",\n            comparison_table: \"array\",\n            win_angles: \"array\",\n            agentos_positioning: \"object\",\n            offers: \"object\",\n            meta: \"object\"\n        }\n    },\n    \"maxim-local-leads-ru\": {\n        required: {\n            leads: \"array\",\n            meta: \"object\"\n        }\n    },\n    \"fedor-b2b-leads-ru\": {\n        required: {\n            leads: \"array\",\n            meta: \"object\"\n        }\n    },\n    \"artem-hot-leads-ru\": {\n        required: {\n            hot_leads: \"array\",\n            meta: \"object\"\n        }\n    },\n    \"leonid-outreach-dm-ru\": {\n        required: {\n            dm_pack: \"object\",\n            meta: \"object\"\n        }\n    },\n    \"emelyan-cold-email-ru\": {\n        required: {\n            email_sequences: \"array\",\n            meta: \"object\"\n        }\n    },\n    \"boris-bdr-operator-ru\": {\n        required: {\n            bdr_table: \"array\",\n            meta: \"object\"\n        }\n    },\n    \"pavel-reels-analysis-ru\": {\n        required: {\n            analysis: \"object\",\n            script_skeleton: \"object\",\n            improvements: \"object\",\n            meta: \"object\"\n        }\n    },\n    \"trofim-shorts-analogs-ru\": {\n        required: {\n            formats: \"array\",\n            recommendations: \"object\",\n            meta: \"object\"\n        }\n    },\n    \"irina-content-ideation-ru\": {\n        required: {\n            pillars: \"array\",\n            topics: \"array\",\n            cta_bank: \"object\",\n            meta: \"object\"\n        }\n    },\n    \"hariton-viral-hooks-ru\": {\n        required: {\n            hooks: \"array\",\n            posts: \"array\",\n            scripts: \"array\",\n            meta: \"object\"\n        }\n    },\n    \"kostya-image-generation-ru\": {\n        required: {\n            concepts: \"array\",\n            meta: \"object\"\n        }\n    },\n    \"seva-content-repurposing-ru\": {\n        required: {\n            pack: \"object\",\n            meta: \"object\"\n        }\n    },\n    \"mitya-workflow-diagram-ru\": {\n        required: {\n            diagram: \"object\",\n            landing_text: \"object\",\n            deck_script: \"object\",\n            meta: \"object\"\n        }\n    },\n    \"board-ceo-ru\": {\n        required: {\n            review: \"object\",\n            meta: \"object\"\n        }\n    },\n    \"board-cto-ru\": {\n        required: {\n            review: \"object\",\n            meta: \"object\"\n        }\n    },\n    \"board-cfo-ru\": {\n        required: {\n            review: \"object\",\n            meta: \"object\"\n        }\n    },\n    \"board-chair-ru\": {\n        required: {\n            review: \"object\",\n            meta: \"object\"\n        }\n    }\n};\nconst getAgentSchema = (agentId)=>agentSchemas[agentId] || null;\nmodule.exports = {\n    agentSchemas,\n    getAgentSchema\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi91dGlscy9hZ2VudFNjaGVtYXMuanMiLCJtYXBwaW5ncyI6IjtBQUFBLE1BQU1BLGVBQWU7SUFDbkJDLFVBQVU7UUFBRUMsVUFBVTtRQUFTQyxvQkFBb0I7UUFBU0MsTUFBTTtJQUFTO0FBQzdFO0FBRUEsTUFBTUMsZUFBZTtJQUNuQiwrQkFBK0JMO0lBQy9CTSxRQUFRTjtJQUNSLCtCQUErQjtRQUM3QkMsVUFBVTtZQUFFTSxjQUFjO1lBQVVILE1BQU07UUFBUztJQUNyRDtJQUNBLGtDQUFrQztRQUNoQ0gsVUFBVTtZQUNSTyxhQUFhO1lBQ2JDLGtCQUFrQjtZQUNsQkMsWUFBWTtZQUNaQyxxQkFBcUI7WUFDckJDLFFBQVE7WUFDUlIsTUFBTTtRQUNSO0lBQ0Y7SUFDQSx3QkFBd0I7UUFDdEJILFVBQVU7WUFBRVksT0FBTztZQUFTVCxNQUFNO1FBQVM7SUFDN0M7SUFDQSxzQkFBc0I7UUFDcEJILFVBQVU7WUFBRVksT0FBTztZQUFTVCxNQUFNO1FBQVM7SUFDN0M7SUFDQSxzQkFBc0I7UUFDcEJILFVBQVU7WUFBRWEsV0FBVztZQUFTVixNQUFNO1FBQVM7SUFDakQ7SUFDQSx5QkFBeUI7UUFDdkJILFVBQVU7WUFBRWMsU0FBUztZQUFVWCxNQUFNO1FBQVM7SUFDaEQ7SUFDQSx5QkFBeUI7UUFDdkJILFVBQVU7WUFBRWUsaUJBQWlCO1lBQVNaLE1BQU07UUFBUztJQUN2RDtJQUNBLHlCQUF5QjtRQUN2QkgsVUFBVTtZQUFFZ0IsV0FBVztZQUFTYixNQUFNO1FBQVM7SUFDakQ7SUFDQSwyQkFBMkI7UUFDekJILFVBQVU7WUFBRWlCLFVBQVU7WUFBVUMsaUJBQWlCO1lBQVVDLGNBQWM7WUFBVWhCLE1BQU07UUFBUztJQUNwRztJQUNBLDRCQUE0QjtRQUMxQkgsVUFBVTtZQUFFb0IsU0FBUztZQUFTQyxpQkFBaUI7WUFBVWxCLE1BQU07UUFBUztJQUMxRTtJQUNBLDZCQUE2QjtRQUMzQkgsVUFBVTtZQUFFc0IsU0FBUztZQUFTQyxRQUFRO1lBQVNDLFVBQVU7WUFBVXJCLE1BQU07UUFBUztJQUNwRjtJQUNBLDBCQUEwQjtRQUN4QkgsVUFBVTtZQUFFeUIsT0FBTztZQUFTQyxPQUFPO1lBQVNDLFNBQVM7WUFBU3hCLE1BQU07UUFBUztJQUMvRTtJQUNBLDhCQUE4QjtRQUM1QkgsVUFBVTtZQUFFNEIsVUFBVTtZQUFTekIsTUFBTTtRQUFTO0lBQ2hEO0lBQ0EsK0JBQStCO1FBQzdCSCxVQUFVO1lBQUU2QixNQUFNO1lBQVUxQixNQUFNO1FBQVM7SUFDN0M7SUFDQSw2QkFBNkI7UUFDM0JILFVBQVU7WUFBRThCLFNBQVM7WUFBVUMsY0FBYztZQUFVQyxhQUFhO1lBQVU3QixNQUFNO1FBQVM7SUFDL0Y7SUFDQSxnQkFBZ0I7UUFDZEgsVUFBVTtZQUFFaUMsUUFBUTtZQUFVOUIsTUFBTTtRQUFTO0lBQy9DO0lBQ0EsZ0JBQWdCO1FBQ2RILFVBQVU7WUFBRWlDLFFBQVE7WUFBVTlCLE1BQU07UUFBUztJQUMvQztJQUNBLGdCQUFnQjtRQUNkSCxVQUFVO1lBQUVpQyxRQUFRO1lBQVU5QixNQUFNO1FBQVM7SUFDL0M7SUFDQSxrQkFBa0I7UUFDaEJILFVBQVU7WUFBRWlDLFFBQVE7WUFBVTlCLE1BQU07UUFBUztJQUMvQztBQUNGO0FBRUEsTUFBTStCLGlCQUFpQixDQUFDQyxVQUFZL0IsWUFBWSxDQUFDK0IsUUFBUSxJQUFJO0FBRTdEQyxPQUFPQyxPQUFPLEdBQUc7SUFBRWpDO0lBQWM4QjtBQUFlIiwic291cmNlcyI6WyIvVXNlcnMvYWJ1emFkYS9EZXNrdG9wL2FnZW50T1MvdXRpbHMvYWdlbnRTY2hlbWFzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHBsYXRvblNjaGVtYSA9IHtcbiAgcmVxdWlyZWQ6IHsgc2VnbWVudHM6IFwiYXJyYXlcIiwgY29tcGFueV9jYW5kaWRhdGVzOiBcImFycmF5XCIsIG1ldGE6IFwib2JqZWN0XCIgfVxufTtcblxuY29uc3QgYWdlbnRTY2hlbWFzID0ge1xuICBcInBsYXRvbi1wcm9zcGVjdC1yZXNlYXJjaC1ydVwiOiBwbGF0b25TY2hlbWEsXG4gIHBsYXRvbjogcGxhdG9uU2NoZW1hLFxuICBcImFuYXRvbHktYWNjb3VudC1yZXNlYXJjaC1ydVwiOiB7XG4gICAgcmVxdWlyZWQ6IHsgYWNjb3VudF9jYXJkOiBcIm9iamVjdFwiLCBtZXRhOiBcIm9iamVjdFwiIH1cbiAgfSxcbiAgXCJ0aW1vZmV5LWNvbXBldGl0b3ItYW5hbHlzaXMtcnVcIjoge1xuICAgIHJlcXVpcmVkOiB7XG4gICAgICBjb21wZXRpdG9yczogXCJhcnJheVwiLFxuICAgICAgY29tcGFyaXNvbl90YWJsZTogXCJhcnJheVwiLFxuICAgICAgd2luX2FuZ2xlczogXCJhcnJheVwiLFxuICAgICAgYWdlbnRvc19wb3NpdGlvbmluZzogXCJvYmplY3RcIixcbiAgICAgIG9mZmVyczogXCJvYmplY3RcIixcbiAgICAgIG1ldGE6IFwib2JqZWN0XCJcbiAgICB9XG4gIH0sXG4gIFwibWF4aW0tbG9jYWwtbGVhZHMtcnVcIjoge1xuICAgIHJlcXVpcmVkOiB7IGxlYWRzOiBcImFycmF5XCIsIG1ldGE6IFwib2JqZWN0XCIgfVxuICB9LFxuICBcImZlZG9yLWIyYi1sZWFkcy1ydVwiOiB7XG4gICAgcmVxdWlyZWQ6IHsgbGVhZHM6IFwiYXJyYXlcIiwgbWV0YTogXCJvYmplY3RcIiB9XG4gIH0sXG4gIFwiYXJ0ZW0taG90LWxlYWRzLXJ1XCI6IHtcbiAgICByZXF1aXJlZDogeyBob3RfbGVhZHM6IFwiYXJyYXlcIiwgbWV0YTogXCJvYmplY3RcIiB9XG4gIH0sXG4gIFwibGVvbmlkLW91dHJlYWNoLWRtLXJ1XCI6IHtcbiAgICByZXF1aXJlZDogeyBkbV9wYWNrOiBcIm9iamVjdFwiLCBtZXRhOiBcIm9iamVjdFwiIH1cbiAgfSxcbiAgXCJlbWVseWFuLWNvbGQtZW1haWwtcnVcIjoge1xuICAgIHJlcXVpcmVkOiB7IGVtYWlsX3NlcXVlbmNlczogXCJhcnJheVwiLCBtZXRhOiBcIm9iamVjdFwiIH1cbiAgfSxcbiAgXCJib3Jpcy1iZHItb3BlcmF0b3ItcnVcIjoge1xuICAgIHJlcXVpcmVkOiB7IGJkcl90YWJsZTogXCJhcnJheVwiLCBtZXRhOiBcIm9iamVjdFwiIH1cbiAgfSxcbiAgXCJwYXZlbC1yZWVscy1hbmFseXNpcy1ydVwiOiB7XG4gICAgcmVxdWlyZWQ6IHsgYW5hbHlzaXM6IFwib2JqZWN0XCIsIHNjcmlwdF9za2VsZXRvbjogXCJvYmplY3RcIiwgaW1wcm92ZW1lbnRzOiBcIm9iamVjdFwiLCBtZXRhOiBcIm9iamVjdFwiIH1cbiAgfSxcbiAgXCJ0cm9maW0tc2hvcnRzLWFuYWxvZ3MtcnVcIjoge1xuICAgIHJlcXVpcmVkOiB7IGZvcm1hdHM6IFwiYXJyYXlcIiwgcmVjb21tZW5kYXRpb25zOiBcIm9iamVjdFwiLCBtZXRhOiBcIm9iamVjdFwiIH1cbiAgfSxcbiAgXCJpcmluYS1jb250ZW50LWlkZWF0aW9uLXJ1XCI6IHtcbiAgICByZXF1aXJlZDogeyBwaWxsYXJzOiBcImFycmF5XCIsIHRvcGljczogXCJhcnJheVwiLCBjdGFfYmFuazogXCJvYmplY3RcIiwgbWV0YTogXCJvYmplY3RcIiB9XG4gIH0sXG4gIFwiaGFyaXRvbi12aXJhbC1ob29rcy1ydVwiOiB7XG4gICAgcmVxdWlyZWQ6IHsgaG9va3M6IFwiYXJyYXlcIiwgcG9zdHM6IFwiYXJyYXlcIiwgc2NyaXB0czogXCJhcnJheVwiLCBtZXRhOiBcIm9iamVjdFwiIH1cbiAgfSxcbiAgXCJrb3N0eWEtaW1hZ2UtZ2VuZXJhdGlvbi1ydVwiOiB7XG4gICAgcmVxdWlyZWQ6IHsgY29uY2VwdHM6IFwiYXJyYXlcIiwgbWV0YTogXCJvYmplY3RcIiB9XG4gIH0sXG4gIFwic2V2YS1jb250ZW50LXJlcHVycG9zaW5nLXJ1XCI6IHtcbiAgICByZXF1aXJlZDogeyBwYWNrOiBcIm9iamVjdFwiLCBtZXRhOiBcIm9iamVjdFwiIH1cbiAgfSxcbiAgXCJtaXR5YS13b3JrZmxvdy1kaWFncmFtLXJ1XCI6IHtcbiAgICByZXF1aXJlZDogeyBkaWFncmFtOiBcIm9iamVjdFwiLCBsYW5kaW5nX3RleHQ6IFwib2JqZWN0XCIsIGRlY2tfc2NyaXB0OiBcIm9iamVjdFwiLCBtZXRhOiBcIm9iamVjdFwiIH1cbiAgfSxcbiAgXCJib2FyZC1jZW8tcnVcIjoge1xuICAgIHJlcXVpcmVkOiB7IHJldmlldzogXCJvYmplY3RcIiwgbWV0YTogXCJvYmplY3RcIiB9XG4gIH0sXG4gIFwiYm9hcmQtY3RvLXJ1XCI6IHtcbiAgICByZXF1aXJlZDogeyByZXZpZXc6IFwib2JqZWN0XCIsIG1ldGE6IFwib2JqZWN0XCIgfVxuICB9LFxuICBcImJvYXJkLWNmby1ydVwiOiB7XG4gICAgcmVxdWlyZWQ6IHsgcmV2aWV3OiBcIm9iamVjdFwiLCBtZXRhOiBcIm9iamVjdFwiIH1cbiAgfSxcbiAgXCJib2FyZC1jaGFpci1ydVwiOiB7XG4gICAgcmVxdWlyZWQ6IHsgcmV2aWV3OiBcIm9iamVjdFwiLCBtZXRhOiBcIm9iamVjdFwiIH1cbiAgfVxufTtcblxuY29uc3QgZ2V0QWdlbnRTY2hlbWEgPSAoYWdlbnRJZCkgPT4gYWdlbnRTY2hlbWFzW2FnZW50SWRdIHx8IG51bGw7XG5cbm1vZHVsZS5leHBvcnRzID0geyBhZ2VudFNjaGVtYXMsIGdldEFnZW50U2NoZW1hIH07XG4iXSwibmFtZXMiOlsicGxhdG9uU2NoZW1hIiwicmVxdWlyZWQiLCJzZWdtZW50cyIsImNvbXBhbnlfY2FuZGlkYXRlcyIsIm1ldGEiLCJhZ2VudFNjaGVtYXMiLCJwbGF0b24iLCJhY2NvdW50X2NhcmQiLCJjb21wZXRpdG9ycyIsImNvbXBhcmlzb25fdGFibGUiLCJ3aW5fYW5nbGVzIiwiYWdlbnRvc19wb3NpdGlvbmluZyIsIm9mZmVycyIsImxlYWRzIiwiaG90X2xlYWRzIiwiZG1fcGFjayIsImVtYWlsX3NlcXVlbmNlcyIsImJkcl90YWJsZSIsImFuYWx5c2lzIiwic2NyaXB0X3NrZWxldG9uIiwiaW1wcm92ZW1lbnRzIiwiZm9ybWF0cyIsInJlY29tbWVuZGF0aW9ucyIsInBpbGxhcnMiLCJ0b3BpY3MiLCJjdGFfYmFuayIsImhvb2tzIiwicG9zdHMiLCJzY3JpcHRzIiwiY29uY2VwdHMiLCJwYWNrIiwiZGlhZ3JhbSIsImxhbmRpbmdfdGV4dCIsImRlY2tfc2NyaXB0IiwicmV2aWV3IiwiZ2V0QWdlbnRTY2hlbWEiLCJhZ2VudElkIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./utils/agentSchemas.js\n");

/***/ }),

/***/ "(rsc)/./utils/handoff.js":
/*!**************************!*\
  !*** ./utils/handoff.js ***!
  \**************************/
/***/ ((module) => {

eval("\nconst HANDOFF_VERSION = \"1.0\";\nconst COMPAT_BY_TYPE = {\n    leads_table: [\n        \"anatoly-account-research-ru\",\n        \"leonid-outreach-dm-ru\",\n        \"emelyan-cold-email-ru\",\n        \"boris-bdr-operator-ru\"\n    ],\n    account_card: [\n        \"leonid-outreach-dm-ru\",\n        \"emelyan-cold-email-ru\",\n        \"boris-bdr-operator-ru\"\n    ],\n    hot_leads: [\n        \"leonid-outreach-dm-ru\",\n        \"boris-bdr-operator-ru\"\n    ],\n    messages_pack: [\n        \"boris-bdr-operator-ru\"\n    ],\n    bdr_queue: [],\n    board_review: [],\n    content_pack: []\n};\nconst RECOMMENDED_NEXT = {\n    \"platon-prospect-research-ru\": [\n        \"anatoly-account-research-ru\",\n        \"leonid-outreach-dm-ru\",\n        \"boris-bdr-operator-ru\"\n    ],\n    platon: [\n        \"anatoly-account-research-ru\",\n        \"leonid-outreach-dm-ru\",\n        \"boris-bdr-operator-ru\"\n    ],\n    \"maxim-local-leads-ru\": [\n        \"anatoly-account-research-ru\",\n        \"leonid-outreach-dm-ru\",\n        \"boris-bdr-operator-ru\"\n    ],\n    \"fedor-b2b-leads-ru\": [\n        \"anatoly-account-research-ru\",\n        \"emelyan-cold-email-ru\",\n        \"boris-bdr-operator-ru\"\n    ],\n    \"artem-hot-leads-ru\": [\n        \"anatoly-account-research-ru\",\n        \"leonid-outreach-dm-ru\",\n        \"boris-bdr-operator-ru\"\n    ],\n    \"anatoly-account-research-ru\": [\n        \"leonid-outreach-dm-ru\",\n        \"emelyan-cold-email-ru\",\n        \"boris-bdr-operator-ru\"\n    ],\n    \"timofey-competitor-analysis-ru\": [\n        \"platon-prospect-research-ru\",\n        \"anatoly-account-research-ru\",\n        \"boris-bdr-operator-ru\"\n    ],\n    \"leonid-outreach-dm-ru\": [\n        \"boris-bdr-operator-ru\"\n    ],\n    \"emelyan-cold-email-ru\": [\n        \"boris-bdr-operator-ru\"\n    ],\n    \"boris-bdr-operator-ru\": [\n        \"leonid-outreach-dm-ru\",\n        \"emelyan-cold-email-ru\"\n    ],\n    \"pavel-reels-analysis-ru\": [\n        \"hariton-viral-hooks-ru\",\n        \"trofim-shorts-analogs-ru\"\n    ],\n    \"trofim-shorts-analogs-ru\": [\n        \"hariton-viral-hooks-ru\",\n        \"pavel-reels-analysis-ru\"\n    ],\n    \"irina-content-ideation-ru\": [\n        \"hariton-viral-hooks-ru\",\n        \"kostya-image-generation-ru\"\n    ],\n    \"hariton-viral-hooks-ru\": [\n        \"kostya-image-generation-ru\",\n        \"seva-content-repurposing-ru\"\n    ],\n    \"kostya-image-generation-ru\": [\n        \"hariton-viral-hooks-ru\",\n        \"irina-content-ideation-ru\"\n    ],\n    \"seva-content-repurposing-ru\": [\n        \"hariton-viral-hooks-ru\",\n        \"kostya-image-generation-ru\"\n    ],\n    \"mitya-workflow-diagram-ru\": [\n        \"kostya-image-generation-ru\",\n        \"irina-content-ideation-ru\"\n    ],\n    \"board-ceo-ru\": [\n        \"board-chair-ru\"\n    ],\n    \"board-cto-ru\": [\n        \"board-chair-ru\"\n    ],\n    \"board-cfo-ru\": [\n        \"board-chair-ru\"\n    ],\n    \"board-chair-ru\": []\n};\nconst normalizeLead = (lead)=>{\n    if (!lead || typeof lead !== \"object\") return null;\n    const leadName = lead.name || lead.company_name || lead.title || lead.name_placeholder || lead.lead_label || lead.link || lead.url || \"Lead\";\n    const contact = {\n        email: lead.email || (lead.public_contacts ? lead.public_contacts.email : undefined) || undefined,\n        phone: lead.phone || (lead.public_contacts ? lead.public_contacts.phone : undefined) || undefined,\n        website: lead.website || lead.domain || undefined,\n        url: lead.link || lead.url || lead.source_url || undefined\n    };\n    const source = lead.source || lead.channel || lead.source_type || \"\";\n    return {\n        lead_name: String(leadName),\n        dedupe_key: lead.dedupe_key || lead.dedupe_key_raw || \"\",\n        contact,\n        source,\n        proof_refs: lead.proof_refs || undefined\n    };\n};\nconst buildLeadsTableEntities = (data)=>{\n    const list = data && data.leads || data && data.company_candidates || data && data.hot_leads || [];\n    const leads = Array.isArray(list) ? list.map(normalizeLead).filter(Boolean) : [];\n    return {\n        leads\n    };\n};\nconst buildAccountCardEntities = (data)=>{\n    const card = data && data.account_card ? data.account_card : {};\n    const meta = data && data.meta ? data.meta : {};\n    return {\n        company_name: card.company_name || \"\",\n        discovered_channels: card.discovered_channels || {},\n        hooks: card.top_personalization_hooks || [],\n        pains: card.pain_hypotheses || [],\n        proof_items: Array.isArray(meta.proof_items) ? meta.proof_items : []\n    };\n};\nconst buildMessagesPackEntities = (data, channelOverride)=>{\n    if (data && data.dm_pack) {\n        return {\n            lead_label: data.dm_pack.lead_label || \"lead\",\n            channel: data.dm_pack.channel || channelOverride || \"dm\",\n            messages: data.dm_pack.messages || data.dm_pack.variants || []\n        };\n    }\n    if (data && data.email_sequences) {\n        return {\n            lead_label: \"lead\",\n            channel: channelOverride || \"email\",\n            email_sequences: data.email_sequences\n        };\n    }\n    return {\n        lead_label: \"lead\",\n        channel: channelOverride || \"\",\n        messages: []\n    };\n};\nconst buildContentPackEntities = (data)=>{\n    if (!data || typeof data !== \"object\") return {};\n    const entities = {\n        ...data\n    };\n    if (entities.meta) delete entities.meta;\n    return entities;\n};\nconst buildBoardReviewEntities = (data)=>{\n    const review = data && typeof data.review === \"object\" ? data.review : {};\n    return {\n        role: review.role || \"\",\n        decision: review.decision || review.stance || review.recommendation || review.feasibility || \"\",\n        summary: review.final_summary || review.verdict || review.unit_economics_view || \"\",\n        references: review.references || {}\n    };\n};\nconst buildHandoff = (agentId, data)=>{\n    const recommended_next_agents = RECOMMENDED_NEXT[agentId] || [\n        \"boris-bdr-operator-ru\"\n    ];\n    if (agentId === \"platon\" || agentId === \"platon-prospect-research-ru\" || agentId === \"maxim-local-leads-ru\" || agentId === \"fedor-b2b-leads-ru\") {\n        const type = \"leads_table\";\n        return {\n            type,\n            version: HANDOFF_VERSION,\n            entities: buildLeadsTableEntities(data),\n            recommended_next_agents,\n            compat: COMPAT_BY_TYPE[type] || []\n        };\n    }\n    if (agentId === \"artem-hot-leads-ru\") {\n        const type = \"hot_leads\";\n        return {\n            type,\n            version: HANDOFF_VERSION,\n            entities: buildLeadsTableEntities(data),\n            recommended_next_agents,\n            compat: COMPAT_BY_TYPE[type] || []\n        };\n    }\n    if (agentId === \"anatoly-account-research-ru\") {\n        const type = \"account_card\";\n        return {\n            type,\n            version: HANDOFF_VERSION,\n            entities: buildAccountCardEntities(data),\n            recommended_next_agents,\n            compat: COMPAT_BY_TYPE[type] || []\n        };\n    }\n    if (agentId === \"leonid-outreach-dm-ru\") {\n        const type = \"messages_pack\";\n        return {\n            type,\n            version: HANDOFF_VERSION,\n            entities: buildMessagesPackEntities(data, \"dm\"),\n            recommended_next_agents,\n            compat: COMPAT_BY_TYPE[type] || []\n        };\n    }\n    if (agentId === \"emelyan-cold-email-ru\") {\n        const type = \"messages_pack\";\n        return {\n            type,\n            version: HANDOFF_VERSION,\n            entities: buildMessagesPackEntities(data, \"email\"),\n            recommended_next_agents,\n            compat: COMPAT_BY_TYPE[type] || []\n        };\n    }\n    if (agentId === \"boris-bdr-operator-ru\") {\n        const type = \"bdr_queue\";\n        return {\n            type,\n            version: HANDOFF_VERSION,\n            entities: {\n                rows: Array.isArray(data.bdr_table) ? data.bdr_table : []\n            },\n            recommended_next_agents,\n            compat: COMPAT_BY_TYPE[type] || []\n        };\n    }\n    if (agentId === \"timofey-competitor-analysis-ru\") {\n        const type = \"content_pack\";\n        return {\n            type,\n            version: HANDOFF_VERSION,\n            entities: {\n                competitors: data.competitors || [],\n                comparison_table: data.comparison_table || [],\n                offers: data.offers || {},\n                win_angles: data.win_angles || [],\n                agentos_positioning: data.agentos_positioning || {}\n            },\n            recommended_next_agents,\n            compat: COMPAT_BY_TYPE[type] || []\n        };\n    }\n    if (agentId === \"board-ceo-ru\" || agentId === \"board-cto-ru\" || agentId === \"board-cfo-ru\" || agentId === \"board-chair-ru\") {\n        const type = \"board_review\";\n        return {\n            type,\n            version: HANDOFF_VERSION,\n            entities: buildBoardReviewEntities(data),\n            recommended_next_agents,\n            compat: COMPAT_BY_TYPE[type] || []\n        };\n    }\n    const type = \"content_pack\";\n    return {\n        type,\n        version: HANDOFF_VERSION,\n        entities: buildContentPackEntities(data),\n        recommended_next_agents,\n        compat: COMPAT_BY_TYPE[type] || []\n    };\n};\nconst getHandoffTypeForAgent = (agentId)=>{\n    if (agentId === \"platon\" || agentId === \"platon-prospect-research-ru\" || agentId === \"maxim-local-leads-ru\" || agentId === \"fedor-b2b-leads-ru\") {\n        return \"leads_table\";\n    }\n    if (agentId === \"artem-hot-leads-ru\") return \"hot_leads\";\n    if (agentId === \"anatoly-account-research-ru\") return \"account_card\";\n    if (agentId === \"leonid-outreach-dm-ru\") return \"messages_pack\";\n    if (agentId === \"emelyan-cold-email-ru\") return \"messages_pack\";\n    if (agentId === \"boris-bdr-operator-ru\") return \"bdr_queue\";\n    if (agentId === \"timofey-competitor-analysis-ru\") return \"content_pack\";\n    if (agentId === \"board-ceo-ru\" || agentId === \"board-cto-ru\" || agentId === \"board-cfo-ru\" || agentId === \"board-chair-ru\") {\n        return \"board_review\";\n    }\n    return \"content_pack\";\n};\nmodule.exports = {\n    buildHandoff,\n    HANDOFF_VERSION,\n    COMPAT_BY_TYPE,\n    getHandoffTypeForAgent\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dG9wL2FnZW50T1MvdXRpbHMvaGFuZG9mZi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBIQU5ET0ZGX1ZFUlNJT04gPSBcIjEuMFwiO1xuXG5jb25zdCBDT01QQVRfQllfVFlQRSA9IHtcbiAgbGVhZHNfdGFibGU6IFtcbiAgICBcImFuYXRvbHktYWNjb3VudC1yZXNlYXJjaC1ydVwiLFxuICAgIFwibGVvbmlkLW91dHJlYWNoLWRtLXJ1XCIsXG4gICAgXCJlbWVseWFuLWNvbGQtZW1haWwtcnVcIixcbiAgICBcImJvcmlzLWJkci1vcGVyYXRvci1ydVwiXG4gIF0sXG4gIGFjY291bnRfY2FyZDogW1xuICAgIFwibGVvbmlkLW91dHJlYWNoLWRtLXJ1XCIsXG4gICAgXCJlbWVseWFuLWNvbGQtZW1haWwtcnVcIixcbiAgICBcImJvcmlzLWJkci1vcGVyYXRvci1ydVwiXG4gIF0sXG4gIGhvdF9sZWFkczogW1wibGVvbmlkLW91dHJlYWNoLWRtLXJ1XCIsIFwiYm9yaXMtYmRyLW9wZXJhdG9yLXJ1XCJdLFxuICBtZXNzYWdlc19wYWNrOiBbXCJib3Jpcy1iZHItb3BlcmF0b3ItcnVcIl0sXG4gIGJkcl9xdWV1ZTogW10sXG4gIGJvYXJkX3JldmlldzogW10sXG4gIGNvbnRlbnRfcGFjazogW11cbn07XG5cbmNvbnN0IFJFQ09NTUVOREVEX05FWFQgPSB7XG4gIFwicGxhdG9uLXByb3NwZWN0LXJlc2VhcmNoLXJ1XCI6IFtcbiAgICBcImFuYXRvbHktYWNjb3VudC1yZXNlYXJjaC1ydVwiLFxuICAgIFwibGVvbmlkLW91dHJlYWNoLWRtLXJ1XCIsXG4gICAgXCJib3Jpcy1iZHItb3BlcmF0b3ItcnVcIlxuICBdLFxuICBwbGF0b246IFtcbiAgICBcImFuYXRvbHktYWNjb3VudC1yZXNlYXJjaC1ydVwiLFxuICAgIFwibGVvbmlkLW91dHJlYWNoLWRtLXJ1XCIsXG4gICAgXCJib3Jpcy1iZHItb3BlcmF0b3ItcnVcIlxuICBdLFxuICBcIm1heGltLWxvY2FsLWxlYWRzLXJ1XCI6IFtcbiAgICBcImFuYXRvbHktYWNjb3VudC1yZXNlYXJjaC1ydVwiLFxuICAgIFwibGVvbmlkLW91dHJlYWNoLWRtLXJ1XCIsXG4gICAgXCJib3Jpcy1iZHItb3BlcmF0b3ItcnVcIlxuICBdLFxuICBcImZlZG9yLWIyYi1sZWFkcy1ydVwiOiBbXG4gICAgXCJhbmF0b2x5LWFjY291bnQtcmVzZWFyY2gtcnVcIixcbiAgICBcImVtZWx5YW4tY29sZC1lbWFpbC1ydVwiLFxuICAgIFwiYm9yaXMtYmRyLW9wZXJhdG9yLXJ1XCJcbiAgXSxcbiAgXCJhcnRlbS1ob3QtbGVhZHMtcnVcIjogW1xuICAgIFwiYW5hdG9seS1hY2NvdW50LXJlc2VhcmNoLXJ1XCIsXG4gICAgXCJsZW9uaWQtb3V0cmVhY2gtZG0tcnVcIixcbiAgICBcImJvcmlzLWJkci1vcGVyYXRvci1ydVwiXG4gIF0sXG4gIFwiYW5hdG9seS1hY2NvdW50LXJlc2VhcmNoLXJ1XCI6IFtcbiAgICBcImxlb25pZC1vdXRyZWFjaC1kbS1ydVwiLFxuICAgIFwiZW1lbHlhbi1jb2xkLWVtYWlsLXJ1XCIsXG4gICAgXCJib3Jpcy1iZHItb3BlcmF0b3ItcnVcIlxuICBdLFxuICBcInRpbW9mZXktY29tcGV0aXRvci1hbmFseXNpcy1ydVwiOiBbXG4gICAgXCJwbGF0b24tcHJvc3BlY3QtcmVzZWFyY2gtcnVcIixcbiAgICBcImFuYXRvbHktYWNjb3VudC1yZXNlYXJjaC1ydVwiLFxuICAgIFwiYm9yaXMtYmRyLW9wZXJhdG9yLXJ1XCJcbiAgXSxcbiAgXCJsZW9uaWQtb3V0cmVhY2gtZG0tcnVcIjogW1wiYm9yaXMtYmRyLW9wZXJhdG9yLXJ1XCJdLFxuICBcImVtZWx5YW4tY29sZC1lbWFpbC1ydVwiOiBbXCJib3Jpcy1iZHItb3BlcmF0b3ItcnVcIl0sXG4gIFwiYm9yaXMtYmRyLW9wZXJhdG9yLXJ1XCI6IFtcImxlb25pZC1vdXRyZWFjaC1kbS1ydVwiLCBcImVtZWx5YW4tY29sZC1lbWFpbC1ydVwiXSxcbiAgXCJwYXZlbC1yZWVscy1hbmFseXNpcy1ydVwiOiBbXCJoYXJpdG9uLXZpcmFsLWhvb2tzLXJ1XCIsIFwidHJvZmltLXNob3J0cy1hbmFsb2dzLXJ1XCJdLFxuICBcInRyb2ZpbS1zaG9ydHMtYW5hbG9ncy1ydVwiOiBbXCJoYXJpdG9uLXZpcmFsLWhvb2tzLXJ1XCIsIFwicGF2ZWwtcmVlbHMtYW5hbHlzaXMtcnVcIl0sXG4gIFwiaXJpbmEtY29udGVudC1pZGVhdGlvbi1ydVwiOiBbXCJoYXJpdG9uLXZpcmFsLWhvb2tzLXJ1XCIsIFwia29zdHlhLWltYWdlLWdlbmVyYXRpb24tcnVcIl0sXG4gIFwiaGFyaXRvbi12aXJhbC1ob29rcy1ydVwiOiBbXCJrb3N0eWEtaW1hZ2UtZ2VuZXJhdGlvbi1ydVwiLCBcInNldmEtY29udGVudC1yZXB1cnBvc2luZy1ydVwiXSxcbiAgXCJrb3N0eWEtaW1hZ2UtZ2VuZXJhdGlvbi1ydVwiOiBbXCJoYXJpdG9uLXZpcmFsLWhvb2tzLXJ1XCIsIFwiaXJpbmEtY29udGVudC1pZGVhdGlvbi1ydVwiXSxcbiAgXCJzZXZhLWNvbnRlbnQtcmVwdXJwb3NpbmctcnVcIjogW1wiaGFyaXRvbi12aXJhbC1ob29rcy1ydVwiLCBcImtvc3R5YS1pbWFnZS1nZW5lcmF0aW9uLXJ1XCJdLFxuICBcIm1pdHlhLXdvcmtmbG93LWRpYWdyYW0tcnVcIjogW1wia29zdHlhLWltYWdlLWdlbmVyYXRpb24tcnVcIiwgXCJpcmluYS1jb250ZW50LWlkZWF0aW9uLXJ1XCJdLFxuICBcImJvYXJkLWNlby1ydVwiOiBbXCJib2FyZC1jaGFpci1ydVwiXSxcbiAgXCJib2FyZC1jdG8tcnVcIjogW1wiYm9hcmQtY2hhaXItcnVcIl0sXG4gIFwiYm9hcmQtY2ZvLXJ1XCI6IFtcImJvYXJkLWNoYWlyLXJ1XCJdLFxuICBcImJvYXJkLWNoYWlyLXJ1XCI6IFtdXG59O1xuXG5jb25zdCBub3JtYWxpemVMZWFkID0gKGxlYWQpID0+IHtcbiAgaWYgKCFsZWFkIHx8IHR5cGVvZiBsZWFkICE9PSBcIm9iamVjdFwiKSByZXR1cm4gbnVsbDtcbiAgY29uc3QgbGVhZE5hbWUgPVxuICAgIGxlYWQubmFtZSB8fFxuICAgIGxlYWQuY29tcGFueV9uYW1lIHx8XG4gICAgbGVhZC50aXRsZSB8fFxuICAgIGxlYWQubmFtZV9wbGFjZWhvbGRlciB8fFxuICAgIGxlYWQubGVhZF9sYWJlbCB8fFxuICAgIGxlYWQubGluayB8fFxuICAgIGxlYWQudXJsIHx8XG4gICAgXCJMZWFkXCI7XG4gIGNvbnN0IGNvbnRhY3QgPSB7XG4gICAgZW1haWw6IGxlYWQuZW1haWwgfHwgKGxlYWQucHVibGljX2NvbnRhY3RzID8gbGVhZC5wdWJsaWNfY29udGFjdHMuZW1haWwgOiB1bmRlZmluZWQpIHx8IHVuZGVmaW5lZCxcbiAgICBwaG9uZTogbGVhZC5waG9uZSB8fCAobGVhZC5wdWJsaWNfY29udGFjdHMgPyBsZWFkLnB1YmxpY19jb250YWN0cy5waG9uZSA6IHVuZGVmaW5lZCkgfHwgdW5kZWZpbmVkLFxuICAgIHdlYnNpdGU6IGxlYWQud2Vic2l0ZSB8fCBsZWFkLmRvbWFpbiB8fCB1bmRlZmluZWQsXG4gICAgdXJsOiBsZWFkLmxpbmsgfHwgbGVhZC51cmwgfHwgbGVhZC5zb3VyY2VfdXJsIHx8IHVuZGVmaW5lZFxuICB9O1xuICBjb25zdCBzb3VyY2UgPSBsZWFkLnNvdXJjZSB8fCBsZWFkLmNoYW5uZWwgfHwgbGVhZC5zb3VyY2VfdHlwZSB8fCBcIlwiO1xuICByZXR1cm4ge1xuICAgIGxlYWRfbmFtZTogU3RyaW5nKGxlYWROYW1lKSxcbiAgICBkZWR1cGVfa2V5OiBsZWFkLmRlZHVwZV9rZXkgfHwgbGVhZC5kZWR1cGVfa2V5X3JhdyB8fCBcIlwiLFxuICAgIGNvbnRhY3QsXG4gICAgc291cmNlLFxuICAgIHByb29mX3JlZnM6IGxlYWQucHJvb2ZfcmVmcyB8fCB1bmRlZmluZWRcbiAgfTtcbn07XG5cbmNvbnN0IGJ1aWxkTGVhZHNUYWJsZUVudGl0aWVzID0gKGRhdGEpID0+IHtcbiAgY29uc3QgbGlzdCA9XG4gICAgKGRhdGEgJiYgZGF0YS5sZWFkcykgfHxcbiAgICAoZGF0YSAmJiBkYXRhLmNvbXBhbnlfY2FuZGlkYXRlcykgfHxcbiAgICAoZGF0YSAmJiBkYXRhLmhvdF9sZWFkcykgfHxcbiAgICBbXTtcbiAgY29uc3QgbGVhZHMgPSBBcnJheS5pc0FycmF5KGxpc3QpID8gbGlzdC5tYXAobm9ybWFsaXplTGVhZCkuZmlsdGVyKEJvb2xlYW4pIDogW107XG4gIHJldHVybiB7IGxlYWRzIH07XG59O1xuXG5jb25zdCBidWlsZEFjY291bnRDYXJkRW50aXRpZXMgPSAoZGF0YSkgPT4ge1xuICBjb25zdCBjYXJkID0gZGF0YSAmJiBkYXRhLmFjY291bnRfY2FyZCA/IGRhdGEuYWNjb3VudF9jYXJkIDoge307XG4gIGNvbnN0IG1ldGEgPSBkYXRhICYmIGRhdGEubWV0YSA/IGRhdGEubWV0YSA6IHt9O1xuICByZXR1cm4ge1xuICAgIGNvbXBhbnlfbmFtZTogY2FyZC5jb21wYW55X25hbWUgfHwgXCJcIixcbiAgICBkaXNjb3ZlcmVkX2NoYW5uZWxzOiBjYXJkLmRpc2NvdmVyZWRfY2hhbm5lbHMgfHwge30sXG4gICAgaG9va3M6IGNhcmQudG9wX3BlcnNvbmFsaXphdGlvbl9ob29rcyB8fCBbXSxcbiAgICBwYWluczogY2FyZC5wYWluX2h5cG90aGVzZXMgfHwgW10sXG4gICAgcHJvb2ZfaXRlbXM6IEFycmF5LmlzQXJyYXkobWV0YS5wcm9vZl9pdGVtcykgPyBtZXRhLnByb29mX2l0ZW1zIDogW11cbiAgfTtcbn07XG5cbmNvbnN0IGJ1aWxkTWVzc2FnZXNQYWNrRW50aXRpZXMgPSAoZGF0YSwgY2hhbm5lbE92ZXJyaWRlKSA9PiB7XG4gIGlmIChkYXRhICYmIGRhdGEuZG1fcGFjaykge1xuICAgIHJldHVybiB7XG4gICAgICBsZWFkX2xhYmVsOiBkYXRhLmRtX3BhY2subGVhZF9sYWJlbCB8fCBcImxlYWRcIixcbiAgICAgIGNoYW5uZWw6IGRhdGEuZG1fcGFjay5jaGFubmVsIHx8IGNoYW5uZWxPdmVycmlkZSB8fCBcImRtXCIsXG4gICAgICBtZXNzYWdlczogZGF0YS5kbV9wYWNrLm1lc3NhZ2VzIHx8IGRhdGEuZG1fcGFjay52YXJpYW50cyB8fCBbXVxuICAgIH07XG4gIH1cbiAgaWYgKGRhdGEgJiYgZGF0YS5lbWFpbF9zZXF1ZW5jZXMpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbGVhZF9sYWJlbDogXCJsZWFkXCIsXG4gICAgICBjaGFubmVsOiBjaGFubmVsT3ZlcnJpZGUgfHwgXCJlbWFpbFwiLFxuICAgICAgZW1haWxfc2VxdWVuY2VzOiBkYXRhLmVtYWlsX3NlcXVlbmNlc1xuICAgIH07XG4gIH1cbiAgcmV0dXJuIHsgbGVhZF9sYWJlbDogXCJsZWFkXCIsIGNoYW5uZWw6IGNoYW5uZWxPdmVycmlkZSB8fCBcIlwiLCBtZXNzYWdlczogW10gfTtcbn07XG5cbmNvbnN0IGJ1aWxkQ29udGVudFBhY2tFbnRpdGllcyA9IChkYXRhKSA9PiB7XG4gIGlmICghZGF0YSB8fCB0eXBlb2YgZGF0YSAhPT0gXCJvYmplY3RcIikgcmV0dXJuIHt9O1xuICBjb25zdCBlbnRpdGllcyA9IHsgLi4uZGF0YSB9O1xuICBpZiAoZW50aXRpZXMubWV0YSkgZGVsZXRlIGVudGl0aWVzLm1ldGE7XG4gIHJldHVybiBlbnRpdGllcztcbn07XG5cbmNvbnN0IGJ1aWxkQm9hcmRSZXZpZXdFbnRpdGllcyA9IChkYXRhKSA9PiB7XG4gIGNvbnN0IHJldmlldyA9IGRhdGEgJiYgdHlwZW9mIGRhdGEucmV2aWV3ID09PSBcIm9iamVjdFwiID8gZGF0YS5yZXZpZXcgOiB7fTtcbiAgcmV0dXJuIHtcbiAgICByb2xlOiByZXZpZXcucm9sZSB8fCBcIlwiLFxuICAgIGRlY2lzaW9uOlxuICAgICAgcmV2aWV3LmRlY2lzaW9uIHx8XG4gICAgICByZXZpZXcuc3RhbmNlIHx8XG4gICAgICByZXZpZXcucmVjb21tZW5kYXRpb24gfHxcbiAgICAgIHJldmlldy5mZWFzaWJpbGl0eSB8fFxuICAgICAgXCJcIixcbiAgICBzdW1tYXJ5OlxuICAgICAgcmV2aWV3LmZpbmFsX3N1bW1hcnkgfHxcbiAgICAgIHJldmlldy52ZXJkaWN0IHx8XG4gICAgICByZXZpZXcudW5pdF9lY29ub21pY3NfdmlldyB8fFxuICAgICAgXCJcIixcbiAgICByZWZlcmVuY2VzOiByZXZpZXcucmVmZXJlbmNlcyB8fCB7fVxuICB9O1xufTtcblxuY29uc3QgYnVpbGRIYW5kb2ZmID0gKGFnZW50SWQsIGRhdGEpID0+IHtcbiAgY29uc3QgcmVjb21tZW5kZWRfbmV4dF9hZ2VudHMgPSBSRUNPTU1FTkRFRF9ORVhUW2FnZW50SWRdIHx8IFtcImJvcmlzLWJkci1vcGVyYXRvci1ydVwiXTtcblxuICBpZiAoXG4gICAgYWdlbnRJZCA9PT0gXCJwbGF0b25cIiB8fFxuICAgIGFnZW50SWQgPT09IFwicGxhdG9uLXByb3NwZWN0LXJlc2VhcmNoLXJ1XCIgfHxcbiAgICBhZ2VudElkID09PSBcIm1heGltLWxvY2FsLWxlYWRzLXJ1XCIgfHxcbiAgICBhZ2VudElkID09PSBcImZlZG9yLWIyYi1sZWFkcy1ydVwiXG4gICkge1xuICAgIGNvbnN0IHR5cGUgPSBcImxlYWRzX3RhYmxlXCI7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGUsXG4gICAgICB2ZXJzaW9uOiBIQU5ET0ZGX1ZFUlNJT04sXG4gICAgICBlbnRpdGllczogYnVpbGRMZWFkc1RhYmxlRW50aXRpZXMoZGF0YSksXG4gICAgICByZWNvbW1lbmRlZF9uZXh0X2FnZW50cyxcbiAgICAgIGNvbXBhdDogQ09NUEFUX0JZX1RZUEVbdHlwZV0gfHwgW11cbiAgICB9O1xuICB9XG5cbiAgaWYgKGFnZW50SWQgPT09IFwiYXJ0ZW0taG90LWxlYWRzLXJ1XCIpIHtcbiAgICBjb25zdCB0eXBlID0gXCJob3RfbGVhZHNcIjtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZSxcbiAgICAgIHZlcnNpb246IEhBTkRPRkZfVkVSU0lPTixcbiAgICAgIGVudGl0aWVzOiBidWlsZExlYWRzVGFibGVFbnRpdGllcyhkYXRhKSxcbiAgICAgIHJlY29tbWVuZGVkX25leHRfYWdlbnRzLFxuICAgICAgY29tcGF0OiBDT01QQVRfQllfVFlQRVt0eXBlXSB8fCBbXVxuICAgIH07XG4gIH1cblxuICBpZiAoYWdlbnRJZCA9PT0gXCJhbmF0b2x5LWFjY291bnQtcmVzZWFyY2gtcnVcIikge1xuICAgIGNvbnN0IHR5cGUgPSBcImFjY291bnRfY2FyZFwiO1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlLFxuICAgICAgdmVyc2lvbjogSEFORE9GRl9WRVJTSU9OLFxuICAgICAgZW50aXRpZXM6IGJ1aWxkQWNjb3VudENhcmRFbnRpdGllcyhkYXRhKSxcbiAgICAgIHJlY29tbWVuZGVkX25leHRfYWdlbnRzLFxuICAgICAgY29tcGF0OiBDT01QQVRfQllfVFlQRVt0eXBlXSB8fCBbXVxuICAgIH07XG4gIH1cblxuICBpZiAoYWdlbnRJZCA9PT0gXCJsZW9uaWQtb3V0cmVhY2gtZG0tcnVcIikge1xuICAgIGNvbnN0IHR5cGUgPSBcIm1lc3NhZ2VzX3BhY2tcIjtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZSxcbiAgICAgIHZlcnNpb246IEhBTkRPRkZfVkVSU0lPTixcbiAgICAgIGVudGl0aWVzOiBidWlsZE1lc3NhZ2VzUGFja0VudGl0aWVzKGRhdGEsIFwiZG1cIiksXG4gICAgICByZWNvbW1lbmRlZF9uZXh0X2FnZW50cyxcbiAgICAgIGNvbXBhdDogQ09NUEFUX0JZX1RZUEVbdHlwZV0gfHwgW11cbiAgICB9O1xuICB9XG5cbiAgaWYgKGFnZW50SWQgPT09IFwiZW1lbHlhbi1jb2xkLWVtYWlsLXJ1XCIpIHtcbiAgICBjb25zdCB0eXBlID0gXCJtZXNzYWdlc19wYWNrXCI7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGUsXG4gICAgICB2ZXJzaW9uOiBIQU5ET0ZGX1ZFUlNJT04sXG4gICAgICBlbnRpdGllczogYnVpbGRNZXNzYWdlc1BhY2tFbnRpdGllcyhkYXRhLCBcImVtYWlsXCIpLFxuICAgICAgcmVjb21tZW5kZWRfbmV4dF9hZ2VudHMsXG4gICAgICBjb21wYXQ6IENPTVBBVF9CWV9UWVBFW3R5cGVdIHx8IFtdXG4gICAgfTtcbiAgfVxuXG4gIGlmIChhZ2VudElkID09PSBcImJvcmlzLWJkci1vcGVyYXRvci1ydVwiKSB7XG4gICAgY29uc3QgdHlwZSA9IFwiYmRyX3F1ZXVlXCI7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGUsXG4gICAgICB2ZXJzaW9uOiBIQU5ET0ZGX1ZFUlNJT04sXG4gICAgICBlbnRpdGllczogeyByb3dzOiBBcnJheS5pc0FycmF5KGRhdGEuYmRyX3RhYmxlKSA/IGRhdGEuYmRyX3RhYmxlIDogW10gfSxcbiAgICAgIHJlY29tbWVuZGVkX25leHRfYWdlbnRzLFxuICAgICAgY29tcGF0OiBDT01QQVRfQllfVFlQRVt0eXBlXSB8fCBbXVxuICAgIH07XG4gIH1cblxuICBpZiAoYWdlbnRJZCA9PT0gXCJ0aW1vZmV5LWNvbXBldGl0b3ItYW5hbHlzaXMtcnVcIikge1xuICAgIGNvbnN0IHR5cGUgPSBcImNvbnRlbnRfcGFja1wiO1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlLFxuICAgICAgdmVyc2lvbjogSEFORE9GRl9WRVJTSU9OLFxuICAgICAgZW50aXRpZXM6IHtcbiAgICAgICAgY29tcGV0aXRvcnM6IGRhdGEuY29tcGV0aXRvcnMgfHwgW10sXG4gICAgICAgIGNvbXBhcmlzb25fdGFibGU6IGRhdGEuY29tcGFyaXNvbl90YWJsZSB8fCBbXSxcbiAgICAgICAgb2ZmZXJzOiBkYXRhLm9mZmVycyB8fCB7fSxcbiAgICAgICAgd2luX2FuZ2xlczogZGF0YS53aW5fYW5nbGVzIHx8IFtdLFxuICAgICAgICBhZ2VudG9zX3Bvc2l0aW9uaW5nOiBkYXRhLmFnZW50b3NfcG9zaXRpb25pbmcgfHwge31cbiAgICAgIH0sXG4gICAgICByZWNvbW1lbmRlZF9uZXh0X2FnZW50cyxcbiAgICAgIGNvbXBhdDogQ09NUEFUX0JZX1RZUEVbdHlwZV0gfHwgW11cbiAgICB9O1xuICB9XG5cbiAgaWYgKFxuICAgIGFnZW50SWQgPT09IFwiYm9hcmQtY2VvLXJ1XCIgfHxcbiAgICBhZ2VudElkID09PSBcImJvYXJkLWN0by1ydVwiIHx8XG4gICAgYWdlbnRJZCA9PT0gXCJib2FyZC1jZm8tcnVcIiB8fFxuICAgIGFnZW50SWQgPT09IFwiYm9hcmQtY2hhaXItcnVcIlxuICApIHtcbiAgICBjb25zdCB0eXBlID0gXCJib2FyZF9yZXZpZXdcIjtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZSxcbiAgICAgIHZlcnNpb246IEhBTkRPRkZfVkVSU0lPTixcbiAgICAgIGVudGl0aWVzOiBidWlsZEJvYXJkUmV2aWV3RW50aXRpZXMoZGF0YSksXG4gICAgICByZWNvbW1lbmRlZF9uZXh0X2FnZW50cyxcbiAgICAgIGNvbXBhdDogQ09NUEFUX0JZX1RZUEVbdHlwZV0gfHwgW11cbiAgICB9O1xuICB9XG5cbiAgY29uc3QgdHlwZSA9IFwiY29udGVudF9wYWNrXCI7XG4gIHJldHVybiB7XG4gICAgdHlwZSxcbiAgICB2ZXJzaW9uOiBIQU5ET0ZGX1ZFUlNJT04sXG4gICAgZW50aXRpZXM6IGJ1aWxkQ29udGVudFBhY2tFbnRpdGllcyhkYXRhKSxcbiAgICByZWNvbW1lbmRlZF9uZXh0X2FnZW50cyxcbiAgICBjb21wYXQ6IENPTVBBVF9CWV9UWVBFW3R5cGVdIHx8IFtdXG4gIH07XG59O1xuXG5jb25zdCBnZXRIYW5kb2ZmVHlwZUZvckFnZW50ID0gKGFnZW50SWQpID0+IHtcbiAgaWYgKFxuICAgIGFnZW50SWQgPT09IFwicGxhdG9uXCIgfHxcbiAgICBhZ2VudElkID09PSBcInBsYXRvbi1wcm9zcGVjdC1yZXNlYXJjaC1ydVwiIHx8XG4gICAgYWdlbnRJZCA9PT0gXCJtYXhpbS1sb2NhbC1sZWFkcy1ydVwiIHx8XG4gICAgYWdlbnRJZCA9PT0gXCJmZWRvci1iMmItbGVhZHMtcnVcIlxuICApIHtcbiAgICByZXR1cm4gXCJsZWFkc190YWJsZVwiO1xuICB9XG4gIGlmIChhZ2VudElkID09PSBcImFydGVtLWhvdC1sZWFkcy1ydVwiKSByZXR1cm4gXCJob3RfbGVhZHNcIjtcbiAgaWYgKGFnZW50SWQgPT09IFwiYW5hdG9seS1hY2NvdW50LXJlc2VhcmNoLXJ1XCIpIHJldHVybiBcImFjY291bnRfY2FyZFwiO1xuICBpZiAoYWdlbnRJZCA9PT0gXCJsZW9uaWQtb3V0cmVhY2gtZG0tcnVcIikgcmV0dXJuIFwibWVzc2FnZXNfcGFja1wiO1xuICBpZiAoYWdlbnRJZCA9PT0gXCJlbWVseWFuLWNvbGQtZW1haWwtcnVcIikgcmV0dXJuIFwibWVzc2FnZXNfcGFja1wiO1xuICBpZiAoYWdlbnRJZCA9PT0gXCJib3Jpcy1iZHItb3BlcmF0b3ItcnVcIikgcmV0dXJuIFwiYmRyX3F1ZXVlXCI7XG4gIGlmIChhZ2VudElkID09PSBcInRpbW9mZXktY29tcGV0aXRvci1hbmFseXNpcy1ydVwiKSByZXR1cm4gXCJjb250ZW50X3BhY2tcIjtcbiAgaWYgKFxuICAgIGFnZW50SWQgPT09IFwiYm9hcmQtY2VvLXJ1XCIgfHxcbiAgICBhZ2VudElkID09PSBcImJvYXJkLWN0by1ydVwiIHx8XG4gICAgYWdlbnRJZCA9PT0gXCJib2FyZC1jZm8tcnVcIiB8fFxuICAgIGFnZW50SWQgPT09IFwiYm9hcmQtY2hhaXItcnVcIlxuICApIHtcbiAgICByZXR1cm4gXCJib2FyZF9yZXZpZXdcIjtcbiAgfVxuICByZXR1cm4gXCJjb250ZW50X3BhY2tcIjtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0geyBidWlsZEhhbmRvZmYsIEhBTkRPRkZfVkVSU0lPTiwgQ09NUEFUX0JZX1RZUEUsIGdldEhhbmRvZmZUeXBlRm9yQWdlbnQgfTtcbiJdLCJuYW1lcyI6WyJIQU5ET0ZGX1ZFUlNJT04iLCJDT01QQVRfQllfVFlQRSIsImxlYWRzX3RhYmxlIiwiYWNjb3VudF9jYXJkIiwiaG90X2xlYWRzIiwibWVzc2FnZXNfcGFjayIsImJkcl9xdWV1ZSIsImJvYXJkX3JldmlldyIsImNvbnRlbnRfcGFjayIsIlJFQ09NTUVOREVEX05FWFQiLCJwbGF0b24iLCJub3JtYWxpemVMZWFkIiwibGVhZCIsImxlYWROYW1lIiwibmFtZSIsImNvbXBhbnlfbmFtZSIsInRpdGxlIiwibmFtZV9wbGFjZWhvbGRlciIsImxlYWRfbGFiZWwiLCJsaW5rIiwidXJsIiwiY29udGFjdCIsImVtYWlsIiwicHVibGljX2NvbnRhY3RzIiwidW5kZWZpbmVkIiwicGhvbmUiLCJ3ZWJzaXRlIiwiZG9tYWluIiwic291cmNlX3VybCIsInNvdXJjZSIsImNoYW5uZWwiLCJzb3VyY2VfdHlwZSIsImxlYWRfbmFtZSIsIlN0cmluZyIsImRlZHVwZV9rZXkiLCJkZWR1cGVfa2V5X3JhdyIsInByb29mX3JlZnMiLCJidWlsZExlYWRzVGFibGVFbnRpdGllcyIsImRhdGEiLCJsaXN0IiwibGVhZHMiLCJjb21wYW55X2NhbmRpZGF0ZXMiLCJBcnJheSIsImlzQXJyYXkiLCJtYXAiLCJmaWx0ZXIiLCJCb29sZWFuIiwiYnVpbGRBY2NvdW50Q2FyZEVudGl0aWVzIiwiY2FyZCIsIm1ldGEiLCJkaXNjb3ZlcmVkX2NoYW5uZWxzIiwiaG9va3MiLCJ0b3BfcGVyc29uYWxpemF0aW9uX2hvb2tzIiwicGFpbnMiLCJwYWluX2h5cG90aGVzZXMiLCJwcm9vZl9pdGVtcyIsImJ1aWxkTWVzc2FnZXNQYWNrRW50aXRpZXMiLCJjaGFubmVsT3ZlcnJpZGUiLCJkbV9wYWNrIiwibWVzc2FnZXMiLCJ2YXJpYW50cyIsImVtYWlsX3NlcXVlbmNlcyIsImJ1aWxkQ29udGVudFBhY2tFbnRpdGllcyIsImVudGl0aWVzIiwiYnVpbGRCb2FyZFJldmlld0VudGl0aWVzIiwicmV2aWV3Iiwicm9sZSIsImRlY2lzaW9uIiwic3RhbmNlIiwicmVjb21tZW5kYXRpb24iLCJmZWFzaWJpbGl0eSIsInN1bW1hcnkiLCJmaW5hbF9zdW1tYXJ5IiwidmVyZGljdCIsInVuaXRfZWNvbm9taWNzX3ZpZXciLCJyZWZlcmVuY2VzIiwiYnVpbGRIYW5kb2ZmIiwiYWdlbnRJZCIsInJlY29tbWVuZGVkX25leHRfYWdlbnRzIiwidHlwZSIsInZlcnNpb24iLCJjb21wYXQiLCJyb3dzIiwiYmRyX3RhYmxlIiwiY29tcGV0aXRvcnMiLCJjb21wYXJpc29uX3RhYmxlIiwib2ZmZXJzIiwid2luX2FuZ2xlcyIsImFnZW50b3NfcG9zaXRpb25pbmciLCJnZXRIYW5kb2ZmVHlwZUZvckFnZW50IiwibW9kdWxlIiwiZXhwb3J0cyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./utils/handoff.js\n");

/***/ }),

/***/ "(rsc)/./utils/validateAgentResponse.js":
/*!****************************************!*\
  !*** ./utils/validateAgentResponse.js ***!
  \****************************************/
/***/ ((module) => {

eval("\nconst isObject = (value)=>typeof value === \"object\" && value !== null && !Array.isArray(value);\nconst isType = (value, type)=>{\n    if (type === \"array\") return Array.isArray(value);\n    if (type === \"object\") return isObject(value);\n    if (type === \"string\") return typeof value === \"string\";\n    if (type === \"number\") return typeof value === \"number\" && Number.isFinite(value);\n    if (type === \"boolean\") return typeof value === \"boolean\";\n    return value !== undefined;\n};\nconst validateAgentResponse = (data, schema)=>{\n    const errors = [];\n    if (!isObject(data)) {\n        return {\n            ok: false,\n            errors: [\n                \"data must be an object\"\n            ]\n        };\n    }\n    if (!schema || !schema.required) return {\n        ok: true,\n        errors\n    };\n    const required = schema.required || {};\n    Object.entries(required).forEach(([key, type])=>{\n        if (!(key in data)) {\n            errors.push(`missing key: ${key}`);\n            return;\n        }\n        if (type && !isType(data[key], type)) {\n            errors.push(`invalid type for ${key}: expected ${type}`);\n        }\n    });\n    return {\n        ok: errors.length === 0,\n        errors\n    };\n};\nmodule.exports = {\n    validateAgentResponse\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi91dGlscy92YWxpZGF0ZUFnZW50UmVzcG9uc2UuanMiLCJtYXBwaW5ncyI6IjtBQUFBLE1BQU1BLFdBQVcsQ0FBQ0MsUUFBVSxPQUFPQSxVQUFVLFlBQVlBLFVBQVUsUUFBUSxDQUFDQyxNQUFNQyxPQUFPLENBQUNGO0FBRTFGLE1BQU1HLFNBQVMsQ0FBQ0gsT0FBT0k7SUFDckIsSUFBSUEsU0FBUyxTQUFTLE9BQU9ILE1BQU1DLE9BQU8sQ0FBQ0Y7SUFDM0MsSUFBSUksU0FBUyxVQUFVLE9BQU9MLFNBQVNDO0lBQ3ZDLElBQUlJLFNBQVMsVUFBVSxPQUFPLE9BQU9KLFVBQVU7SUFDL0MsSUFBSUksU0FBUyxVQUFVLE9BQU8sT0FBT0osVUFBVSxZQUFZSyxPQUFPQyxRQUFRLENBQUNOO0lBQzNFLElBQUlJLFNBQVMsV0FBVyxPQUFPLE9BQU9KLFVBQVU7SUFDaEQsT0FBT0EsVUFBVU87QUFDbkI7QUFFQSxNQUFNQyx3QkFBd0IsQ0FBQ0MsTUFBTUM7SUFDbkMsTUFBTUMsU0FBUyxFQUFFO0lBQ2pCLElBQUksQ0FBQ1osU0FBU1UsT0FBTztRQUNuQixPQUFPO1lBQUVHLElBQUk7WUFBT0QsUUFBUTtnQkFBQzthQUF5QjtRQUFDO0lBQ3pEO0lBQ0EsSUFBSSxDQUFDRCxVQUFVLENBQUNBLE9BQU9HLFFBQVEsRUFBRSxPQUFPO1FBQUVELElBQUk7UUFBTUQ7SUFBTztJQUMzRCxNQUFNRSxXQUFXSCxPQUFPRyxRQUFRLElBQUksQ0FBQztJQUNyQ0MsT0FBT0MsT0FBTyxDQUFDRixVQUFVRyxPQUFPLENBQUMsQ0FBQyxDQUFDQyxLQUFLYixLQUFLO1FBQzNDLElBQUksQ0FBRWEsQ0FBQUEsT0FBT1IsSUFBRyxHQUFJO1lBQ2xCRSxPQUFPTyxJQUFJLENBQUMsQ0FBQyxhQUFhLEVBQUVELEtBQUs7WUFDakM7UUFDRjtRQUNBLElBQUliLFFBQVEsQ0FBQ0QsT0FBT00sSUFBSSxDQUFDUSxJQUFJLEVBQUViLE9BQU87WUFDcENPLE9BQU9PLElBQUksQ0FBQyxDQUFDLGlCQUFpQixFQUFFRCxJQUFJLFdBQVcsRUFBRWIsTUFBTTtRQUN6RDtJQUNGO0lBQ0EsT0FBTztRQUFFUSxJQUFJRCxPQUFPUSxNQUFNLEtBQUs7UUFBR1I7SUFBTztBQUMzQztBQUVBUyxPQUFPQyxPQUFPLEdBQUc7SUFBRWI7QUFBc0IiLCJzb3VyY2VzIjpbIi9Vc2Vycy9hYnV6YWRhL0Rlc2t0b3AvYWdlbnRPUy91dGlscy92YWxpZGF0ZUFnZW50UmVzcG9uc2UuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgaXNPYmplY3QgPSAodmFsdWUpID0+IHR5cGVvZiB2YWx1ZSA9PT0gXCJvYmplY3RcIiAmJiB2YWx1ZSAhPT0gbnVsbCAmJiAhQXJyYXkuaXNBcnJheSh2YWx1ZSk7XG5cbmNvbnN0IGlzVHlwZSA9ICh2YWx1ZSwgdHlwZSkgPT4ge1xuICBpZiAodHlwZSA9PT0gXCJhcnJheVwiKSByZXR1cm4gQXJyYXkuaXNBcnJheSh2YWx1ZSk7XG4gIGlmICh0eXBlID09PSBcIm9iamVjdFwiKSByZXR1cm4gaXNPYmplY3QodmFsdWUpO1xuICBpZiAodHlwZSA9PT0gXCJzdHJpbmdcIikgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIjtcbiAgaWYgKHR5cGUgPT09IFwibnVtYmVyXCIpIHJldHVybiB0eXBlb2YgdmFsdWUgPT09IFwibnVtYmVyXCIgJiYgTnVtYmVyLmlzRmluaXRlKHZhbHVlKTtcbiAgaWYgKHR5cGUgPT09IFwiYm9vbGVhblwiKSByZXR1cm4gdHlwZW9mIHZhbHVlID09PSBcImJvb2xlYW5cIjtcbiAgcmV0dXJuIHZhbHVlICE9PSB1bmRlZmluZWQ7XG59O1xuXG5jb25zdCB2YWxpZGF0ZUFnZW50UmVzcG9uc2UgPSAoZGF0YSwgc2NoZW1hKSA9PiB7XG4gIGNvbnN0IGVycm9ycyA9IFtdO1xuICBpZiAoIWlzT2JqZWN0KGRhdGEpKSB7XG4gICAgcmV0dXJuIHsgb2s6IGZhbHNlLCBlcnJvcnM6IFtcImRhdGEgbXVzdCBiZSBhbiBvYmplY3RcIl0gfTtcbiAgfVxuICBpZiAoIXNjaGVtYSB8fCAhc2NoZW1hLnJlcXVpcmVkKSByZXR1cm4geyBvazogdHJ1ZSwgZXJyb3JzIH07XG4gIGNvbnN0IHJlcXVpcmVkID0gc2NoZW1hLnJlcXVpcmVkIHx8IHt9O1xuICBPYmplY3QuZW50cmllcyhyZXF1aXJlZCkuZm9yRWFjaCgoW2tleSwgdHlwZV0pID0+IHtcbiAgICBpZiAoIShrZXkgaW4gZGF0YSkpIHtcbiAgICAgIGVycm9ycy5wdXNoKGBtaXNzaW5nIGtleTogJHtrZXl9YCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICh0eXBlICYmICFpc1R5cGUoZGF0YVtrZXldLCB0eXBlKSkge1xuICAgICAgZXJyb3JzLnB1c2goYGludmFsaWQgdHlwZSBmb3IgJHtrZXl9OiBleHBlY3RlZCAke3R5cGV9YCk7XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIHsgb2s6IGVycm9ycy5sZW5ndGggPT09IDAsIGVycm9ycyB9O1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSB7IHZhbGlkYXRlQWdlbnRSZXNwb25zZSB9O1xuIl0sIm5hbWVzIjpbImlzT2JqZWN0IiwidmFsdWUiLCJBcnJheSIsImlzQXJyYXkiLCJpc1R5cGUiLCJ0eXBlIiwiTnVtYmVyIiwiaXNGaW5pdGUiLCJ1bmRlZmluZWQiLCJ2YWxpZGF0ZUFnZW50UmVzcG9uc2UiLCJkYXRhIiwic2NoZW1hIiwiZXJyb3JzIiwib2siLCJyZXF1aXJlZCIsIk9iamVjdCIsImVudHJpZXMiLCJmb3JFYWNoIiwia2V5IiwicHVzaCIsImxlbmd0aCIsIm1vZHVsZSIsImV4cG9ydHMiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./utils/validateAgentResponse.js\n");

/***/ })

};
;