"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_rsc_lib_agents_boris_js";
exports.ids = ["_rsc_lib_agents_boris_js"];
exports.modules = {

/***/ "(rsc)/./lib/agents/boris.js":
/*!*****************************!*\
  !*** ./lib/agents/boris.js ***!
  \*****************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("\nconst crypto = __webpack_require__(/*! crypto */ \"crypto\");\nconst { canonicalizeUrl } = __webpack_require__(/*! ./webClient.js */ \"(rsc)/./lib/agents/webClient.js\");\nconst { wrapAgentOutput, unwrapLegacy } = __webpack_require__(/*! ../../utils/agentEnvelope.js */ \"(rsc)/./utils/agentEnvelope.js\");\nconst { applyBudget, applyBudgetMeta } = __webpack_require__(/*! ../../utils/budget.js */ \"(rsc)/./utils/budget.js\");\nconst inputDefaults = {\n    mode: \"deep\",\n    primary_channel: \"mixed\",\n    goal: \"get_reply\",\n    scheduling: {\n        followup_days: [\n            2,\n            5,\n            9\n        ],\n        timezone: \"Europe/Berlin\"\n    },\n    defaults: {\n        status_default: \"READY\",\n        max_items: 50\n    },\n    inputs: {\n        maxim_leads_json: null,\n        fedor_leads_json: null,\n        artem_hot_json: null,\n        anatoly_account_json: null,\n        leonid_dm_json: null,\n        emelyan_email_json: null\n    },\n    mapping_rules: {\n        prefer_hot_over_cold: true,\n        prefer_dm_over_email_for_local: true\n    },\n    language: \"ru\"\n};\nconst inputSchema = {\n    type: \"object\",\n    additionalProperties: false,\n    properties: {\n        mode: {\n            type: \"string\",\n            enum: [\n                \"quick\",\n                \"deep\"\n            ],\n            default: \"deep\"\n        },\n        primary_channel: {\n            type: \"string\",\n            enum: [\n                \"telegram\",\n                \"vk\",\n                \"whatsapp\",\n                \"email\",\n                \"mixed\"\n            ],\n            default: \"mixed\"\n        },\n        goal: {\n            type: \"string\",\n            enum: [\n                \"get_reply\",\n                \"qualify\",\n                \"book_call\",\n                \"send_audit\"\n            ],\n            default: \"get_reply\"\n        },\n        scheduling: {\n            type: \"object\",\n            properties: {\n                followup_days: {\n                    type: \"array\",\n                    items: {\n                        type: \"number\"\n                    }\n                },\n                timezone: {\n                    type: \"string\",\n                    default: \"Europe/Berlin\"\n                }\n            }\n        },\n        defaults: {\n            type: \"object\",\n            properties: {\n                status_default: {\n                    type: \"string\",\n                    default: \"READY\"\n                },\n                max_items: {\n                    type: \"number\",\n                    default: 50\n                }\n            }\n        },\n        inputs: {\n            type: \"object\"\n        },\n        maxim_leads_json: {\n            type: [\n                \"object\",\n                \"null\"\n            ]\n        },\n        fedor_leads_json: {\n            type: [\n                \"object\",\n                \"null\"\n            ]\n        },\n        artem_hot_json: {\n            type: [\n                \"object\",\n                \"null\"\n            ]\n        },\n        anatoly_account_json: {\n            type: [\n                \"object\",\n                \"null\"\n            ]\n        },\n        leonid_dm_json: {\n            type: [\n                \"object\",\n                \"null\"\n            ]\n        },\n        emelyan_email_json: {\n            type: [\n                \"object\",\n                \"null\"\n            ]\n        },\n        mapping_rules: {\n            type: \"object\",\n            properties: {\n                prefer_hot_over_cold: {\n                    type: \"boolean\",\n                    default: true\n                },\n                prefer_dm_over_email_for_local: {\n                    type: \"boolean\",\n                    default: true\n                }\n            }\n        },\n        language: {\n            type: \"string\",\n            default: \"ru\"\n        }\n    },\n    required: [\n        \"mode\"\n    ],\n    default: inputDefaults\n};\nconst outputSchema = {\n    type: \"object\",\n    required: [\n        \"bdr_table\",\n        \"meta\"\n    ],\n    additionalProperties: false,\n    properties: {\n        bdr_table: {\n            type: \"array\"\n        },\n        meta: {\n            type: \"object\"\n        }\n    }\n};\nconst systemPrompt = `Ты — ИИ-агент agentOS: \"Борис — Оператор BDR\".\nРоль: склеивать лиды + персонализацию + тексты в готовую очередь для отправки без выдумок.`;\nconst borisAgent = {\n    id: \"boris-bdr-operator-ru\",\n    displayName: \"Борис — Оператор BDR\",\n    description: \"Склеивает лиды и тексты из других агентов в очередь READY с дедупом и CSV.\",\n    inputSchema,\n    outputSchema,\n    systemPrompt\n};\nconst wrapOutput = (legacyOutput, input)=>wrapAgentOutput({\n        agentId: borisAgent.id,\n        inputEcho: input,\n        mode: input.mode,\n        legacyOutput\n    });\nconst unwrapPayload = (payload)=>payload && typeof payload === \"object\" && payload.data && payload.meta ? payload.data : payload;\nconst readPath = (obj, path)=>{\n    if (!obj || typeof obj !== \"object\" || !path) return undefined;\n    const keys = String(path).split(\".\").filter(Boolean);\n    let cursor = obj;\n    for (const key of keys){\n        if (!cursor || typeof cursor !== \"object\" && !Array.isArray(cursor)) return undefined;\n        cursor = cursor[key];\n        if (typeof cursor === \"undefined\") return undefined;\n    }\n    return cursor;\n};\nconst pickFirstDefined = (obj, paths)=>{\n    for (const path of paths){\n        const value = readPath(obj, path);\n        if (typeof value !== \"undefined\") return value;\n    }\n    return undefined;\n};\nconst extractHandoff = (payload)=>payload && typeof payload === \"object\" && payload.meta && payload.meta.handoff ? payload.meta.handoff : null;\nconst hasBorisCompat = (handoff)=>handoff && Array.isArray(handoff.compat) && handoff.compat.includes(borisAgent.id);\nconst normalizeInput = (input)=>{\n    const safe = typeof input === \"object\" && input !== null ? input : {};\n    const budget = safe.budget && typeof safe.budget === \"object\" ? safe.budget : null;\n    const mergedInputs = {\n        ...inputDefaults.inputs,\n        ...safe.inputs || {}\n    };\n    const normalized = {\n        mode: safe.mode === \"quick\" ? \"quick\" : \"deep\",\n        primary_channel: [\n            \"telegram\",\n            \"vk\",\n            \"whatsapp\",\n            \"email\",\n            \"mixed\"\n        ].includes(safe.primary_channel) ? safe.primary_channel : \"mixed\",\n        goal: [\n            \"get_reply\",\n            \"qualify\",\n            \"book_call\",\n            \"send_audit\"\n        ].includes(safe.goal) ? safe.goal : \"get_reply\",\n        scheduling: {\n            followup_days: Array.isArray(safe.scheduling?.followup_days) ? safe.scheduling.followup_days.map((item)=>Number(item)).filter((item)=>Number.isFinite(item)) : [\n                2,\n                5,\n                9\n            ],\n            timezone: typeof safe.scheduling?.timezone === \"string\" && safe.scheduling.timezone.trim() ? safe.scheduling.timezone.trim() : \"Europe/Berlin\"\n        },\n        defaults: {\n            status_default: typeof safe.defaults?.status_default === \"string\" ? safe.defaults.status_default : \"READY\",\n            max_items: typeof safe.defaults?.max_items === \"number\" && Number.isFinite(safe.defaults.max_items) ? Math.max(1, Math.round(safe.defaults.max_items)) : 50\n        },\n        inputs: {\n            maxim_leads_json: safe.maxim_leads_json ?? mergedInputs.maxim_leads_json ?? null,\n            fedor_leads_json: safe.fedor_leads_json ?? mergedInputs.fedor_leads_json ?? null,\n            artem_hot_json: safe.artem_hot_json ?? mergedInputs.artem_hot_json ?? null,\n            anatoly_account_json: safe.anatoly_account_json ?? mergedInputs.anatoly_account_json ?? null,\n            leonid_dm_json: safe.leonid_dm_json ?? mergedInputs.leonid_dm_json ?? null,\n            emelyan_email_json: safe.emelyan_email_json ?? mergedInputs.emelyan_email_json ?? null\n        },\n        mapping_rules: {\n            prefer_hot_over_cold: typeof safe.mapping_rules?.prefer_hot_over_cold === \"boolean\" ? safe.mapping_rules.prefer_hot_over_cold : true,\n            prefer_dm_over_email_for_local: typeof safe.mapping_rules?.prefer_dm_over_email_for_local === \"boolean\" ? safe.mapping_rules.prefer_dm_over_email_for_local : true\n        },\n        language: safe.language === \"ru\" ? \"ru\" : \"ru\"\n    };\n    const budgetResult = applyBudget(normalized, budget, {\n        maxItemsPaths: [\n            [\n                \"defaults\",\n                \"max_items\"\n            ]\n        ]\n    });\n    normalized.budget = budget;\n    normalized.budget_applied = budgetResult.budget_applied;\n    normalized.budget_warnings = budgetResult.warnings;\n    return normalized;\n};\nconst getDateInTimeZone = (date, timeZone)=>{\n    const formatter = new Intl.DateTimeFormat(\"en-CA\", {\n        timeZone,\n        year: \"numeric\",\n        month: \"2-digit\",\n        day: \"2-digit\"\n    });\n    return formatter.format(date);\n};\nconst addDays = (date, days)=>new Date(date.getTime() + days * 24 * 60 * 60 * 1000);\nconst toChannelLabel = (primaryChannel, leadSource)=>{\n    if (primaryChannel === \"telegram\") return \"TG\";\n    if (primaryChannel === \"vk\") return \"VK\";\n    if (primaryChannel === \"whatsapp\") return \"WA\";\n    if (primaryChannel === \"email\") return \"EMAIL\";\n    if (leadSource === \"vk\") return \"VK\";\n    if (leadSource === \"telegram\") return \"TG\";\n    return \"TG\";\n};\nconst hashId = (value)=>{\n    return crypto.createHash(\"sha1\").update(String(value)).digest(\"hex\").slice(0, 12);\n};\nconst escapeCsv = (value)=>{\n    const stringValue = value == null ? \"\" : String(value);\n    if (/[\",\\n]/.test(stringValue)) {\n        return `\"${stringValue.replace(/\"/g, '\"\"')}\"`;\n    }\n    return stringValue;\n};\nconst buildCsv = (rows, columns)=>{\n    const header = columns.map(escapeCsv).join(\",\");\n    const lines = rows.map((row)=>columns.map((col)=>escapeCsv(row[col])).join(\",\"));\n    return [\n        header,\n        ...lines\n    ].join(\"\\n\");\n};\nconst normalizeDmMessage = (value)=>{\n    if (!value) return null;\n    if (typeof value === \"string\" && value.trim()) {\n        return {\n            text: value.trim(),\n            personalization_line: \"\",\n            grounding_refs: []\n        };\n    }\n    if (typeof value !== \"object\") return null;\n    const text = String(value.text || value.body || value.message || \"\").trim();\n    if (!text) return null;\n    return {\n        ...value,\n        text,\n        personalization_line: String(value.personalization_line || \"\").trim(),\n        grounding_refs: Array.isArray(value.grounding_refs) ? value.grounding_refs : []\n    };\n};\nconst pickDmMessage = (leonidJson)=>{\n    if (!leonidJson || typeof leonidJson !== \"object\") return null;\n    const dmPack = leonidJson.dm_pack || leonidJson.dmPack || leonidJson.messages_pack || {};\n    const variants = [\n        ...Array.isArray(dmPack.variants) ? dmPack.variants : [],\n        ...Array.isArray(leonidJson.variants) ? leonidJson.variants : []\n    ];\n    const candidates = [\n        dmPack.messages?.first_message,\n        dmPack.messages?.firstMessage,\n        dmPack.first_message,\n        dmPack.firstMessage,\n        leonidJson.first_message,\n        leonidJson.firstMessage,\n        leonidJson.message,\n        leonidJson.text,\n        dmPack.message,\n        dmPack.text,\n        variants[0]?.first_message,\n        variants[0]?.firstMessage,\n        variants[0]?.message,\n        variants[0]?.text,\n        variants[0]\n    ];\n    for (const candidate of candidates){\n        const normalized = normalizeDmMessage(candidate);\n        if (normalized) return normalized;\n    }\n    return null;\n};\nconst normalizeEmailMessage = (value)=>{\n    if (!value) return null;\n    if (typeof value === \"string\" && value.trim()) {\n        return {\n            day_offset: 0,\n            subject: \"\",\n            body: value.trim(),\n            grounding_refs: []\n        };\n    }\n    if (typeof value !== \"object\") return null;\n    const body = String(value.body || value.text || value.message || \"\").trim();\n    const subject = String(value.subject || value.title || \"\").trim();\n    if (!body && !subject) return null;\n    return {\n        ...value,\n        day_offset: Number.isFinite(Number(value.day_offset)) ? Number(value.day_offset) : 0,\n        subject,\n        body,\n        grounding_refs: Array.isArray(value.grounding_refs) ? value.grounding_refs : []\n    };\n};\nconst pickEmailMessage = (emelyanJson)=>{\n    if (!emelyanJson || typeof emelyanJson !== \"object\") return null;\n    const sequences = pickFirstDefined(emelyanJson, [\n        \"email_sequences\",\n        \"data.email_sequences\"\n    ]);\n    const firstSequence = Array.isArray(sequences) && sequences.length ? sequences[0] : null;\n    const firstEmail = Array.isArray(firstSequence?.emails) ? firstSequence.emails[0] : null;\n    const candidates = [\n        firstEmail,\n        firstSequence?.first_email,\n        firstSequence?.primary_email,\n        emelyanJson,\n        emelyanJson.data,\n        emelyanJson.data?.first_email,\n        emelyanJson.data?.primary_email,\n        emelyanJson.data?.email,\n        emelyanJson.data?.message,\n        emelyanJson.data?.body,\n        emelyanJson.first_email,\n        emelyanJson.primary_email,\n        emelyanJson.email,\n        emelyanJson.message,\n        emelyanJson.body\n    ];\n    for (const candidate of candidates){\n        const normalized = normalizeEmailMessage(candidate);\n        if (normalized) return normalized;\n    }\n    return null;\n};\nconst pickDmFollowups = (leonidJson)=>{\n    if (!leonidJson || typeof leonidJson !== \"object\") return [];\n    const followups = pickFirstDefined(leonidJson, [\n        \"dm_pack.messages.followups\",\n        \"dmPack.messages.followups\",\n        \"dm_pack.followups\",\n        \"followups\"\n    ]);\n    const list = Array.isArray(followups) ? followups : [];\n    return list.map((item)=>({\n            day_offset: Number(item?.day_offset),\n            text: typeof item === \"string\" ? item.trim() : String(item?.text || item?.message || \"\").trim()\n        })).filter((item)=>Number.isFinite(item.day_offset) && item.text).slice(0, 3);\n};\nconst pickEmailFollowups = (emelyanJson)=>{\n    if (!emelyanJson || typeof emelyanJson !== \"object\") return [];\n    const sequences = Array.isArray(emelyanJson.email_sequences) ? emelyanJson.email_sequences : [];\n    const firstSequence = sequences[0];\n    const emailsCandidate = pickFirstDefined(emelyanJson, [\n        \"email_sequences.0.emails\",\n        \"data.email_sequences.0.emails\",\n        \"followups\",\n        \"emails\"\n    ]);\n    const emails = Array.isArray(emailsCandidate) ? emailsCandidate : Array.isArray(firstSequence?.emails) ? firstSequence.emails : [];\n    return emails.filter((item)=>Number(item?.day_offset) > 0).slice(0, 3).map((item)=>({\n            day_offset: Number(item?.day_offset),\n            subject: String(item?.subject || item?.title || \"\").trim(),\n            body: String(item?.body || item?.text || \"\").trim()\n        })).filter((item)=>Number.isFinite(item.day_offset) && item.body);\n};\nconst buildDefaultFollowupTemplates = (channel)=>{\n    if (channel === \"EMAIL\") {\n        return [\n            {\n                day_offset: 2,\n                subject: \"Короткое напоминание\",\n                body: \"Напомню про письмо выше. Если актуально, пришлю 2 шага.\"\n            },\n            {\n                day_offset: 5,\n                subject: \"Кейс-намек\",\n                body: \"Есть релевантный пример без цифр. Прислать текстом?\"\n            },\n            {\n                day_offset: 9,\n                subject: \"Закрываю тред\",\n                body: \"Если неактуально, закрою тред и вернусь позже.\"\n            }\n        ];\n    }\n    return [\n        {\n            day_offset: 2,\n            text: \"Напомню про сообщение выше. Если актуально, скину 2 шага.\"\n        },\n        {\n            day_offset: 5,\n            text: \"Есть похожий кейс без цифр. Скинуть коротко?\"\n        },\n        {\n            day_offset: 9,\n            text: \"Если не в приоритете, закрою тему без лишних сообщений.\"\n        }\n    ];\n};\nconst extractPersonalization = (anatolyJson, artemJson, leonidMessage)=>{\n    if (leonidMessage?.personalization_line) {\n        return {\n            text: leonidMessage.personalization_line,\n            refs: leonidMessage.grounding_refs || []\n        };\n    }\n    if (anatolyJson?.account_card) {\n        const hook = anatolyJson.account_card.top_personalization_hooks?.[0];\n        if (hook?.hook_text) {\n            return {\n                text: hook.hook_text,\n                refs: hook.related_proofs || []\n            };\n        }\n    }\n    if (artemJson?.hot_leads?.length) {\n        const lead = artemJson.hot_leads[0];\n        if (lead?.hot_reasons?.length) {\n            return {\n                text: lead.hot_reasons[0],\n                refs: lead.proof_refs || []\n            };\n        }\n    }\n    return {\n        text: \"\",\n        refs: []\n    };\n};\nconst buildMinimalTemplate = (personalization, channel)=>{\n    const intro = channel === \"EMAIL\" ? \"Добрый день.\" : \"Привет.\";\n    const line = personalization ? `Вижу ${personalization}.` : \"Короткий вопрос.\";\n    return `${intro} ${line} Могу показать 2–3 идеи. Актуально?`;\n};\nconst buildRow = ({ lead, type, channel, message, body, subject, personalization, status, nextDate, nextStepReason, sourceRefs, groundingRefs, needsReview, followupTemplates, batchKey, operatorNotes })=>{\n    const rawKey = lead.dedupe_key || lead.dedupe_key_raw || (lead.url ? canonicalizeUrl(lead.url) : \"\") || lead.website || lead.phone || lead.email || lead.name || \"lead\";\n    const dedupeKey = String(rawKey);\n    const leadId = hashId(dedupeKey);\n    return {\n        lead_id: leadId,\n        lead_name: lead.name || lead.title || lead.lead_name || \"Hot lead\",\n        channel,\n        contact: {\n            website: lead.website || null,\n            email: lead.email || null,\n            phone: lead.phone || null,\n            url: lead.url || lead.card_url || null\n        },\n        city: lead.city || null,\n        category: lead.category || lead.category_hint || null,\n        personalization: personalization || \"\",\n        message,\n        body: body || message || \"\",\n        subject: subject || (channel === \"EMAIL\" ? \"Короткий вопрос\" : undefined),\n        status,\n        next_step: status === \"READY\" ? \"Send follow-up #1\" : \"Wait reply\",\n        next_step_reason: nextStepReason || \"ready_for_send\",\n        next_followup_date: nextDate,\n        followup_templates: Array.isArray(followupTemplates) ? followupTemplates : [],\n        batch_key: batchKey || `${channel}|${type}`,\n        operator_notes: operatorNotes || \"\",\n        source_refs: sourceRefs,\n        grounding_refs: groundingRefs || [],\n        needsReview,\n        dedupe_key: dedupeKey\n    };\n};\nconst generateOutput = async (rawInput = {}, options = {})=>{\n    const input = normalizeInput(rawInput);\n    const inputs = input.inputs;\n    const hasAnyInput = Boolean(inputs.maxim_leads_json || inputs.fedor_leads_json || inputs.artem_hot_json || inputs.anatoly_account_json || inputs.leonid_dm_json || inputs.emelyan_email_json);\n    if (!hasAnyInput) {\n        const output = {\n            bdr_table: [],\n            meta: {\n                generated_at: new Date().toISOString(),\n                stats: {\n                    total_rows: 0,\n                    ready_count: 0,\n                    by_channel: {},\n                    needs_review_count: 0\n                },\n                limitations: [\n                    \"Какие JSON ты хочешь склеить (лиды + тексты)?\"\n                ],\n                assumptions: [],\n                status_transition_rules: {\n                    transitions: [\n                        {\n                            from: \"READY\",\n                            to: \"SENT\",\n                            when: \"оператор отправил первое сообщение\"\n                        },\n                        {\n                            from: \"SENT\",\n                            to: \"NO_REPLY\",\n                            when: \"нет ответа после followup D+9\"\n                        },\n                        {\n                            from: \"NO_REPLY\",\n                            to: \"INTERESTED\",\n                            when: \"получен ответ с интересом\"\n                        }\n                    ],\n                    next_step_reason: \"Строка хранится в bdr_table[].next_step_reason.\"\n                },\n                quality_checks: {\n                    no_fabrication: true,\n                    dedupe_ok: true,\n                    has_messages: false\n                },\n                export_helpers: {\n                    columns: [],\n                    csv: \"\"\n                }\n            }\n        };\n        applyBudgetMeta(output.meta, input);\n        return {\n            output: wrapOutput(output, input),\n            effectiveInput: input\n        };\n    }\n    const rawPayloads = [\n        inputs.maxim_leads_json,\n        inputs.fedor_leads_json,\n        inputs.artem_hot_json,\n        inputs.anatoly_account_json,\n        inputs.leonid_dm_json,\n        inputs.emelyan_email_json\n    ].filter(Boolean);\n    const handoffIssues = [];\n    rawPayloads.forEach((payload)=>{\n        const handoff = extractHandoff(payload);\n        if (!handoff || !handoff.type || !handoff.version) {\n            handoffIssues.push(\"missing\");\n            return;\n        }\n        if (!hasBorisCompat(handoff)) {\n            handoffIssues.push(\"incompatible\");\n        }\n    });\n    const handoffMismatch = rawPayloads.length > 0 && handoffIssues.length > 0;\n    const normalizedInputs = {\n        maxim_leads_json: unwrapPayload(inputs.maxim_leads_json),\n        fedor_leads_json: unwrapPayload(inputs.fedor_leads_json),\n        artem_hot_json: unwrapPayload(inputs.artem_hot_json),\n        anatoly_account_json: unwrapPayload(inputs.anatoly_account_json),\n        leonid_dm_json: unwrapPayload(inputs.leonid_dm_json),\n        emelyan_email_json: unwrapPayload(inputs.emelyan_email_json)\n    };\n    const extractLeads = (payload)=>{\n        const list = pickFirstDefined(payload, [\n            \"leads\",\n            \"data.leads\",\n            \"company_candidates\",\n            \"data.company_candidates\",\n            \"meta.handoff.entities.leads\"\n        ]);\n        return Array.isArray(list) ? list : [];\n    };\n    const extractHotLeads = (payload)=>{\n        const list = pickFirstDefined(payload, [\n            \"hot_leads\",\n            \"data.hot_leads\",\n            \"meta.handoff.entities.hot_leads\",\n            \"meta.handoff.entities.leads\"\n        ]);\n        return Array.isArray(list) ? list : [];\n    };\n    const maximLeads = extractLeads(normalizedInputs.maxim_leads_json);\n    const fedorLeads = extractLeads(normalizedInputs.fedor_leads_json);\n    const hotLeads = extractHotLeads(normalizedInputs.artem_hot_json);\n    const leonidMessage = pickDmMessage(normalizedInputs.leonid_dm_json);\n    const emelyanEmail = pickEmailMessage(normalizedInputs.emelyan_email_json);\n    const dmFollowups = pickDmFollowups(normalizedInputs.leonid_dm_json);\n    const emailFollowups = pickEmailFollowups(normalizedInputs.emelyan_email_json);\n    const personalization = extractPersonalization(normalizedInputs.anatoly_account_json, normalizedInputs.artem_hot_json, leonidMessage);\n    const schedulingDays = input.scheduling.followup_days.length ? input.scheduling.followup_days : [\n        2,\n        5,\n        9\n    ];\n    const nextDate = getDateInTimeZone(addDays(new Date(), schedulingDays[0]), input.scheduling.timezone);\n    const rows = [];\n    const dedupe = new Set();\n    const pushRow = (row)=>{\n        if (dedupe.has(row.dedupe_key)) return;\n        dedupe.add(row.dedupe_key);\n        rows.push(row);\n    };\n    const preferHot = input.mapping_rules.prefer_hot_over_cold;\n    const sourcePriority = preferHot ? [\n        \"hot\",\n        \"local\",\n        \"b2b\"\n    ] : [\n        \"local\",\n        \"b2b\",\n        \"hot\"\n    ];\n    const sources = {\n        hot: hotLeads.map((lead)=>({\n                lead,\n                type: \"hot\"\n            })),\n        local: maximLeads.map((lead)=>({\n                lead,\n                type: \"local\"\n            })),\n        b2b: fedorLeads.map((lead)=>({\n                lead,\n                type: \"b2b\"\n            }))\n    };\n    const buildMessageForLead = (leadType, lead)=>{\n        const channelPreference = input.primary_channel;\n        const hasDm = Boolean(leonidMessage);\n        const hasEmail = Boolean(emelyanEmail);\n        let channel = \"TG\";\n        let message = \"\";\n        let subject = \"\";\n        let needsReview = false;\n        let groundingRefs = personalization.refs || [];\n        let personalizationText = personalization.text;\n        let followupTemplates = [];\n        let nextStepReason = \"ready_for_send\";\n        let operatorNotes = \"\";\n        if (channelPreference === \"email\") {\n            channel = \"EMAIL\";\n        } else if (channelPreference === \"telegram\") {\n            channel = \"TG\";\n        } else if (channelPreference === \"vk\") {\n            channel = \"VK\";\n        } else if (channelPreference === \"whatsapp\") {\n            channel = \"WA\";\n        } else {\n            if (leadType === \"local\") {\n                channel = input.mapping_rules.prefer_dm_over_email_for_local ? \"TG\" : \"EMAIL\";\n            } else if (leadType === \"b2b\") {\n                channel = \"EMAIL\";\n            } else {\n                channel = \"TG\";\n            }\n        }\n        if (leadType === \"hot\" && lead?.hot_reasons?.length) {\n            personalizationText = lead.hot_reasons[0];\n            groundingRefs = lead.proof_refs || groundingRefs;\n        }\n        if (channel === \"EMAIL\" && hasEmail) {\n            message = emelyanEmail.body;\n            subject = emelyanEmail.subject || \"\";\n            groundingRefs = emelyanEmail.grounding_refs || groundingRefs;\n            followupTemplates = emailFollowups.length ? emailFollowups : buildDefaultFollowupTemplates(\"EMAIL\");\n            nextStepReason = emailFollowups.length ? \"email_followups_from_input\" : \"email_followups_defaulted\";\n        } else if (hasDm) {\n            message = leonidMessage.text;\n            groundingRefs = leonidMessage.grounding_refs || groundingRefs;\n            followupTemplates = dmFollowups.length ? dmFollowups : buildDefaultFollowupTemplates(channel);\n            nextStepReason = dmFollowups.length ? \"dm_followups_from_input\" : \"dm_followups_defaulted\";\n        } else if (hasEmail && channel !== \"EMAIL\") {\n            message = emelyanEmail.body;\n            subject = emelyanEmail.subject || \"\";\n            channel = \"EMAIL\";\n            groundingRefs = emelyanEmail.grounding_refs || groundingRefs;\n            followupTemplates = emailFollowups.length ? emailFollowups : buildDefaultFollowupTemplates(\"EMAIL\");\n            nextStepReason = \"email_fallback_from_missing_dm\";\n        } else {\n            message = buildMinimalTemplate(personalization.text, channel);\n            followupTemplates = buildDefaultFollowupTemplates(channel);\n            needsReview = true;\n            nextStepReason = \"fallback_template_used\";\n            operatorNotes = \"Нет входных followups, применены шаблоны D+2/D+5/D+9.\";\n        }\n        if (!personalizationText) needsReview = true;\n        if (!operatorNotes && !personalizationText) {\n            operatorNotes = \"Персонализация слабая, проверь перед отправкой.\";\n        }\n        return {\n            channel,\n            message,\n            subject,\n            needsReview,\n            groundingRefs,\n            personalizationText,\n            followupTemplates,\n            nextStepReason,\n            operatorNotes\n        };\n    };\n    sourcePriority.forEach((source)=>{\n        sources[source].forEach(({ lead, type })=>{\n            if (rows.length >= input.defaults.max_items) return;\n            const messageInfo = buildMessageForLead(type, lead);\n            const dedupeKey = lead.dedupe_key || lead.dedupe_key_raw || lead.url || lead.website || lead.name;\n            const row = buildRow({\n                lead: {\n                    ...lead,\n                    name: lead.name || lead.title || lead.lead_name || (type === \"hot\" ? `Hot lead: ${lead.title || \"\"}` : \"\")\n                },\n                type,\n                channel: messageInfo.channel,\n                message: messageInfo.message,\n                body: messageInfo.message,\n                subject: messageInfo.subject,\n                personalization: messageInfo.personalizationText || personalization.text,\n                status: input.defaults.status_default,\n                nextDate,\n                nextStepReason: messageInfo.nextStepReason,\n                sourceRefs: {\n                    from_maxim: type === \"local\",\n                    from_fedor: type === \"b2b\",\n                    from_artem: type === \"hot\",\n                    from_anatoly: Boolean(inputs.anatoly_account_json),\n                    from_leonid: Boolean(leonidMessage),\n                    from_emelyan: Boolean(emelyanEmail)\n                },\n                groundingRefs: messageInfo.groundingRefs,\n                needsReview: messageInfo.needsReview,\n                followupTemplates: messageInfo.followupTemplates,\n                batchKey: `${messageInfo.channel}|${type}`,\n                operatorNotes: messageInfo.operatorNotes || (lead.notes ? String(lead.notes) : \"\"),\n                dedupe_key: dedupeKey\n            });\n            pushRow(row);\n        });\n    });\n    const columns = [\n        \"lead_id\",\n        \"lead_name\",\n        \"channel\",\n        \"contact\",\n        \"city\",\n        \"category\",\n        \"personalization\",\n        \"subject\",\n        \"body\",\n        \"message\",\n        \"status\",\n        \"next_step\",\n        \"next_step_reason\",\n        \"next_followup_date\",\n        \"batch_key\",\n        \"operator_notes\",\n        \"dedupe_key\"\n    ];\n    const csvRows = rows.map((row)=>({\n            ...row,\n            contact: JSON.stringify(row.contact ?? {})\n        }));\n    const csv = buildCsv(csvRows, columns);\n    const readyCount = rows.filter((row)=>row.status === \"READY\").length;\n    const byChannel = rows.reduce((acc, row)=>{\n        acc[row.channel] = (acc[row.channel] ?? 0) + 1;\n        return acc;\n    }, {});\n    const needsReviewCount = rows.filter((row)=>row.needsReview).length;\n    const output = {\n        bdr_table: rows,\n        meta: {\n            generated_at: new Date().toISOString(),\n            stats: {\n                total_rows: rows.length,\n                ready_count: readyCount,\n                by_channel: byChannel,\n                needs_review_count: needsReviewCount\n            },\n            limitations: handoffMismatch ? [\n                \"handoff format mismatch\"\n            ] : [],\n            assumptions: [],\n            needsReview: handoffMismatch,\n            status_transition_rules: {\n                transitions: [\n                    {\n                        from: \"READY\",\n                        to: \"SENT\",\n                        when: \"оператор отправил первое сообщение\"\n                    },\n                    {\n                        from: \"SENT\",\n                        to: \"NO_REPLY\",\n                        when: \"нет ответа после followup D+9\"\n                    },\n                    {\n                        from: \"NO_REPLY\",\n                        to: \"INTERESTED\",\n                        when: \"получен ответ с интересом\"\n                    }\n                ],\n                next_step_reason: \"Строка хранится в bdr_table[].next_step_reason.\"\n            },\n            quality_checks: {\n                no_fabrication: true,\n                dedupe_ok: dedupe.size === rows.length,\n                has_messages: rows.some((row)=>row.message)\n            },\n            export_helpers: {\n                columns,\n                csv\n            }\n        }\n    };\n    applyBudgetMeta(output.meta, input);\n    return {\n        output: wrapOutput(output, input),\n        effectiveInput: input\n    };\n};\nconst generateBorisOutput = async (input = {}, options = {})=>{\n    const result = await generateOutput(input, options);\n    return result.output;\n};\nconst validateBorisOutput = (payload)=>{\n    const errors = [];\n    const legacy = unwrapLegacy(payload);\n    if (!legacy || typeof legacy !== \"object\") {\n        return {\n            valid: false,\n            errors: [\n                \"Output must be an object.\"\n            ]\n        };\n    }\n    payload = legacy;\n    if (!Array.isArray(payload.bdr_table)) errors.push(\"bdr_table must be array\");\n    if (!payload.meta) errors.push(\"meta required\");\n    if (Array.isArray(payload.bdr_table)) {\n        payload.bdr_table.forEach((row, index)=>{\n            if (!row.batch_key || typeof row.batch_key !== \"string\") {\n                errors.push(`bdr_table[${index}].batch_key required`);\n            }\n            if (!Array.isArray(row.followup_templates)) {\n                errors.push(`bdr_table[${index}].followup_templates must be array`);\n            }\n            if (typeof row.body !== \"string\") {\n                errors.push(`bdr_table[${index}].body required`);\n            }\n            if (typeof row.next_step_reason !== \"string\") {\n                errors.push(`bdr_table[${index}].next_step_reason required`);\n            }\n        });\n    }\n    if (!payload.meta?.status_transition_rules) {\n        errors.push(\"meta.status_transition_rules required\");\n    }\n    if (payload.meta?.export_helpers?.columns) {\n        const columns = payload.meta.export_helpers.columns;\n        if (!columns.includes(\"subject\") || !columns.includes(\"body\")) {\n            errors.push(\"export_helpers.columns must include subject and body\");\n        }\n    }\n    return {\n        valid: errors.length === 0,\n        errors\n    };\n};\nmodule.exports = {\n    inputDefaults,\n    inputSchema,\n    outputSchema,\n    systemPrompt,\n    borisAgent,\n    normalizeInput,\n    generateOutput,\n    generateBorisOutput,\n    validateBorisOutput\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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WUFDakQ7WUFDQSxJQUFJLE9BQU9oTCxJQUFJc0YsZ0JBQWdCLEtBQUssVUFBVTtnQkFDNUN1RixPQUFPbkQsSUFBSSxDQUFDLENBQUMsVUFBVSxFQUFFc0QsTUFBTSwyQkFBMkIsQ0FBQztZQUM3RDtRQUNGO0lBQ0Y7SUFDQSxJQUFJLENBQUN6UCxRQUFRWixJQUFJLEVBQUUrTCx5QkFBeUI7UUFDMUNtRSxPQUFPbkQsSUFBSSxDQUFDO0lBQ2Q7SUFDQSxJQUFJbk0sUUFBUVosSUFBSSxFQUFFd00sZ0JBQWdCdkgsU0FBUztRQUN6QyxNQUFNQSxVQUFVckUsUUFBUVosSUFBSSxDQUFDd00sY0FBYyxDQUFDdkgsT0FBTztRQUNuRCxJQUFJLENBQUNBLFFBQVEvQyxRQUFRLENBQUMsY0FBYyxDQUFDK0MsUUFBUS9DLFFBQVEsQ0FBQyxTQUFTO1lBQzdEZ08sT0FBT25ELElBQUksQ0FBQztRQUNkO0lBQ0Y7SUFDQSxPQUFPO1FBQUVxRCxPQUFPRixPQUFPbEosTUFBTSxLQUFLO1FBQUdrSjtJQUFPO0FBQzlDO0FBRUFJLE9BQU9DLE9BQU8sR0FBRztJQUNmdFM7SUFDQXFCO0lBQ0FRO0lBQ0FHO0lBQ0FDO0lBQ0FpQztJQUNBOEk7SUFDQThFO0lBQ0FFO0FBQ0YiLCJzb3VyY2VzIjpbIi9Vc2Vycy9hYnV6YWRhL0Rlc2t0b3AvYWdlbnRPUy9saWIvYWdlbnRzL2JvcmlzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGNyeXB0byA9IHJlcXVpcmUoXCJjcnlwdG9cIik7XG5jb25zdCB7IGNhbm9uaWNhbGl6ZVVybCB9ID0gcmVxdWlyZShcIi4vd2ViQ2xpZW50LmpzXCIpO1xuY29uc3QgeyB3cmFwQWdlbnRPdXRwdXQsIHVud3JhcExlZ2FjeSB9ID0gcmVxdWlyZShcIi4uLy4uL3V0aWxzL2FnZW50RW52ZWxvcGUuanNcIik7XG5jb25zdCB7IGFwcGx5QnVkZ2V0LCBhcHBseUJ1ZGdldE1ldGEgfSA9IHJlcXVpcmUoXCIuLi8uLi91dGlscy9idWRnZXQuanNcIik7XG5cbmNvbnN0IGlucHV0RGVmYXVsdHMgPSB7XG4gIG1vZGU6IFwiZGVlcFwiLFxuICBwcmltYXJ5X2NoYW5uZWw6IFwibWl4ZWRcIixcbiAgZ29hbDogXCJnZXRfcmVwbHlcIixcbiAgc2NoZWR1bGluZzoge1xuICAgIGZvbGxvd3VwX2RheXM6IFsyLCA1LCA5XSxcbiAgICB0aW1lem9uZTogXCJFdXJvcGUvQmVybGluXCJcbiAgfSxcbiAgZGVmYXVsdHM6IHtcbiAgICBzdGF0dXNfZGVmYXVsdDogXCJSRUFEWVwiLFxuICAgIG1heF9pdGVtczogNTBcbiAgfSxcbiAgaW5wdXRzOiB7XG4gICAgbWF4aW1fbGVhZHNfanNvbjogbnVsbCxcbiAgICBmZWRvcl9sZWFkc19qc29uOiBudWxsLFxuICAgIGFydGVtX2hvdF9qc29uOiBudWxsLFxuICAgIGFuYXRvbHlfYWNjb3VudF9qc29uOiBudWxsLFxuICAgIGxlb25pZF9kbV9qc29uOiBudWxsLFxuICAgIGVtZWx5YW5fZW1haWxfanNvbjogbnVsbFxuICB9LFxuICBtYXBwaW5nX3J1bGVzOiB7XG4gICAgcHJlZmVyX2hvdF9vdmVyX2NvbGQ6IHRydWUsXG4gICAgcHJlZmVyX2RtX292ZXJfZW1haWxfZm9yX2xvY2FsOiB0cnVlXG4gIH0sXG4gIGxhbmd1YWdlOiBcInJ1XCJcbn07XG5cbmNvbnN0IGlucHV0U2NoZW1hID0ge1xuICB0eXBlOiBcIm9iamVjdFwiLFxuICBhZGRpdGlvbmFsUHJvcGVydGllczogZmFsc2UsXG4gIHByb3BlcnRpZXM6IHtcbiAgICBtb2RlOiB7IHR5cGU6IFwic3RyaW5nXCIsIGVudW06IFtcInF1aWNrXCIsIFwiZGVlcFwiXSwgZGVmYXVsdDogXCJkZWVwXCIgfSxcbiAgICBwcmltYXJ5X2NoYW5uZWw6IHtcbiAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICBlbnVtOiBbXCJ0ZWxlZ3JhbVwiLCBcInZrXCIsIFwid2hhdHNhcHBcIiwgXCJlbWFpbFwiLCBcIm1peGVkXCJdLFxuICAgICAgZGVmYXVsdDogXCJtaXhlZFwiXG4gICAgfSxcbiAgICBnb2FsOiB7XG4gICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgZW51bTogW1wiZ2V0X3JlcGx5XCIsIFwicXVhbGlmeVwiLCBcImJvb2tfY2FsbFwiLCBcInNlbmRfYXVkaXRcIl0sXG4gICAgICBkZWZhdWx0OiBcImdldF9yZXBseVwiXG4gICAgfSxcbiAgICBzY2hlZHVsaW5nOiB7XG4gICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgcHJvcGVydGllczoge1xuICAgICAgICBmb2xsb3d1cF9kYXlzOiB7IHR5cGU6IFwiYXJyYXlcIiwgaXRlbXM6IHsgdHlwZTogXCJudW1iZXJcIiB9IH0sXG4gICAgICAgIHRpbWV6b25lOiB7IHR5cGU6IFwic3RyaW5nXCIsIGRlZmF1bHQ6IFwiRXVyb3BlL0JlcmxpblwiIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIGRlZmF1bHRzOiB7XG4gICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgcHJvcGVydGllczoge1xuICAgICAgICBzdGF0dXNfZGVmYXVsdDogeyB0eXBlOiBcInN0cmluZ1wiLCBkZWZhdWx0OiBcIlJFQURZXCIgfSxcbiAgICAgICAgbWF4X2l0ZW1zOiB7IHR5cGU6IFwibnVtYmVyXCIsIGRlZmF1bHQ6IDUwIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIGlucHV0czogeyB0eXBlOiBcIm9iamVjdFwiIH0sXG4gICAgbWF4aW1fbGVhZHNfanNvbjogeyB0eXBlOiBbXCJvYmplY3RcIiwgXCJudWxsXCJdIH0sXG4gICAgZmVkb3JfbGVhZHNfanNvbjogeyB0eXBlOiBbXCJvYmplY3RcIiwgXCJudWxsXCJdIH0sXG4gICAgYXJ0ZW1faG90X2pzb246IHsgdHlwZTogW1wib2JqZWN0XCIsIFwibnVsbFwiXSB9LFxuICAgIGFuYXRvbHlfYWNjb3VudF9qc29uOiB7IHR5cGU6IFtcIm9iamVjdFwiLCBcIm51bGxcIl0gfSxcbiAgICBsZW9uaWRfZG1fanNvbjogeyB0eXBlOiBbXCJvYmplY3RcIiwgXCJudWxsXCJdIH0sXG4gICAgZW1lbHlhbl9lbWFpbF9qc29uOiB7IHR5cGU6IFtcIm9iamVjdFwiLCBcIm51bGxcIl0gfSxcbiAgICBtYXBwaW5nX3J1bGVzOiB7XG4gICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgcHJvcGVydGllczoge1xuICAgICAgICBwcmVmZXJfaG90X292ZXJfY29sZDogeyB0eXBlOiBcImJvb2xlYW5cIiwgZGVmYXVsdDogdHJ1ZSB9LFxuICAgICAgICBwcmVmZXJfZG1fb3Zlcl9lbWFpbF9mb3JfbG9jYWw6IHsgdHlwZTogXCJib29sZWFuXCIsIGRlZmF1bHQ6IHRydWUgfVxuICAgICAgfVxuICAgIH0sXG4gICAgbGFuZ3VhZ2U6IHsgdHlwZTogXCJzdHJpbmdcIiwgZGVmYXVsdDogXCJydVwiIH1cbiAgfSxcbiAgcmVxdWlyZWQ6IFtcIm1vZGVcIl0sXG4gIGRlZmF1bHQ6IGlucHV0RGVmYXVsdHNcbn07XG5cbmNvbnN0IG91dHB1dFNjaGVtYSA9IHtcbiAgdHlwZTogXCJvYmplY3RcIixcbiAgcmVxdWlyZWQ6IFtcImJkcl90YWJsZVwiLCBcIm1ldGFcIl0sXG4gIGFkZGl0aW9uYWxQcm9wZXJ0aWVzOiBmYWxzZSxcbiAgcHJvcGVydGllczoge1xuICAgIGJkcl90YWJsZTogeyB0eXBlOiBcImFycmF5XCIgfSxcbiAgICBtZXRhOiB7IHR5cGU6IFwib2JqZWN0XCIgfVxuICB9XG59O1xuXG5jb25zdCBzeXN0ZW1Qcm9tcHQgPSBg0KLRiyDigJQg0JjQmC3QsNCz0LXQvdGCIGFnZW50T1M6IFwi0JHQvtGA0LjRgSDigJQg0J7Qv9C10YDQsNGC0L7RgCBCRFJcIi5cbtCg0L7Qu9GMOiDRgdC60LvQtdC40LLQsNGC0Ywg0LvQuNC00YsgKyDQv9C10YDRgdC+0L3QsNC70LjQt9Cw0YbQuNGOICsg0YLQtdC60YHRgtGLINCyINCz0L7RgtC+0LLRg9GOINC+0YfQtdGA0LXQtNGMINC00LvRjyDQvtGC0L/RgNCw0LLQutC4INCx0LXQtyDQstGL0LTRg9C80L7Qui5gO1xuXG5jb25zdCBib3Jpc0FnZW50ID0ge1xuICBpZDogXCJib3Jpcy1iZHItb3BlcmF0b3ItcnVcIixcbiAgZGlzcGxheU5hbWU6IFwi0JHQvtGA0LjRgSDigJQg0J7Qv9C10YDQsNGC0L7RgCBCRFJcIixcbiAgZGVzY3JpcHRpb246XG4gICAgXCLQodC60LvQtdC40LLQsNC10YIg0LvQuNC00Ysg0Lgg0YLQtdC60YHRgtGLINC40Lcg0LTRgNGD0LPQuNGFINCw0LPQtdC90YLQvtCyINCyINC+0YfQtdGA0LXQtNGMIFJFQURZINGBINC00LXQtNGD0L/QvtC8INC4IENTVi5cIixcbiAgaW5wdXRTY2hlbWEsXG4gIG91dHB1dFNjaGVtYSxcbiAgc3lzdGVtUHJvbXB0XG59O1xuXG5jb25zdCB3cmFwT3V0cHV0ID0gKGxlZ2FjeU91dHB1dCwgaW5wdXQpID0+XG4gIHdyYXBBZ2VudE91dHB1dCh7XG4gICAgYWdlbnRJZDogYm9yaXNBZ2VudC5pZCxcbiAgICBpbnB1dEVjaG86IGlucHV0LFxuICAgIG1vZGU6IGlucHV0Lm1vZGUsXG4gICAgbGVnYWN5T3V0cHV0XG4gIH0pO1xuXG5jb25zdCB1bndyYXBQYXlsb2FkID0gKHBheWxvYWQpID0+XG4gIHBheWxvYWQgJiYgdHlwZW9mIHBheWxvYWQgPT09IFwib2JqZWN0XCIgJiYgcGF5bG9hZC5kYXRhICYmIHBheWxvYWQubWV0YVxuICAgID8gcGF5bG9hZC5kYXRhXG4gICAgOiBwYXlsb2FkO1xuXG5jb25zdCByZWFkUGF0aCA9IChvYmosIHBhdGgpID0+IHtcbiAgaWYgKCFvYmogfHwgdHlwZW9mIG9iaiAhPT0gXCJvYmplY3RcIiB8fCAhcGF0aCkgcmV0dXJuIHVuZGVmaW5lZDtcbiAgY29uc3Qga2V5cyA9IFN0cmluZyhwYXRoKS5zcGxpdChcIi5cIikuZmlsdGVyKEJvb2xlYW4pO1xuICBsZXQgY3Vyc29yID0gb2JqO1xuICBmb3IgKGNvbnN0IGtleSBvZiBrZXlzKSB7XG4gICAgaWYgKCFjdXJzb3IgfHwgKHR5cGVvZiBjdXJzb3IgIT09IFwib2JqZWN0XCIgJiYgIUFycmF5LmlzQXJyYXkoY3Vyc29yKSkpIHJldHVybiB1bmRlZmluZWQ7XG4gICAgY3Vyc29yID0gY3Vyc29yW2tleV07XG4gICAgaWYgKHR5cGVvZiBjdXJzb3IgPT09IFwidW5kZWZpbmVkXCIpIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbiAgcmV0dXJuIGN1cnNvcjtcbn07XG5cbmNvbnN0IHBpY2tGaXJzdERlZmluZWQgPSAob2JqLCBwYXRocykgPT4ge1xuICBmb3IgKGNvbnN0IHBhdGggb2YgcGF0aHMpIHtcbiAgICBjb25zdCB2YWx1ZSA9IHJlYWRQYXRoKG9iaiwgcGF0aCk7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gXCJ1bmRlZmluZWRcIikgcmV0dXJuIHZhbHVlO1xuICB9XG4gIHJldHVybiB1bmRlZmluZWQ7XG59O1xuXG5jb25zdCBleHRyYWN0SGFuZG9mZiA9IChwYXlsb2FkKSA9PlxuICBwYXlsb2FkICYmIHR5cGVvZiBwYXlsb2FkID09PSBcIm9iamVjdFwiICYmIHBheWxvYWQubWV0YSAmJiBwYXlsb2FkLm1ldGEuaGFuZG9mZlxuICAgID8gcGF5bG9hZC5tZXRhLmhhbmRvZmZcbiAgICA6IG51bGw7XG5cbmNvbnN0IGhhc0JvcmlzQ29tcGF0ID0gKGhhbmRvZmYpID0+XG4gIGhhbmRvZmYgJiZcbiAgQXJyYXkuaXNBcnJheShoYW5kb2ZmLmNvbXBhdCkgJiZcbiAgaGFuZG9mZi5jb21wYXQuaW5jbHVkZXMoYm9yaXNBZ2VudC5pZCk7XG5cbmNvbnN0IG5vcm1hbGl6ZUlucHV0ID0gKGlucHV0KSA9PiB7XG4gIGNvbnN0IHNhZmUgPSB0eXBlb2YgaW5wdXQgPT09IFwib2JqZWN0XCIgJiYgaW5wdXQgIT09IG51bGwgPyBpbnB1dCA6IHt9O1xuICBjb25zdCBidWRnZXQgPSBzYWZlLmJ1ZGdldCAmJiB0eXBlb2Ygc2FmZS5idWRnZXQgPT09IFwib2JqZWN0XCIgPyBzYWZlLmJ1ZGdldCA6IG51bGw7XG4gIGNvbnN0IG1lcmdlZElucHV0cyA9IHtcbiAgICAuLi5pbnB1dERlZmF1bHRzLmlucHV0cyxcbiAgICAuLi4oc2FmZS5pbnB1dHMgfHwge30pXG4gIH07XG5cbiAgY29uc3Qgbm9ybWFsaXplZCA9IHtcbiAgICBtb2RlOiBzYWZlLm1vZGUgPT09IFwicXVpY2tcIiA/IFwicXVpY2tcIiA6IFwiZGVlcFwiLFxuICAgIHByaW1hcnlfY2hhbm5lbDogW1widGVsZWdyYW1cIiwgXCJ2a1wiLCBcIndoYXRzYXBwXCIsIFwiZW1haWxcIiwgXCJtaXhlZFwiXS5pbmNsdWRlcyhzYWZlLnByaW1hcnlfY2hhbm5lbClcbiAgICAgID8gc2FmZS5wcmltYXJ5X2NoYW5uZWxcbiAgICAgIDogXCJtaXhlZFwiLFxuICAgIGdvYWw6IFtcImdldF9yZXBseVwiLCBcInF1YWxpZnlcIiwgXCJib29rX2NhbGxcIiwgXCJzZW5kX2F1ZGl0XCJdLmluY2x1ZGVzKHNhZmUuZ29hbClcbiAgICAgID8gc2FmZS5nb2FsXG4gICAgICA6IFwiZ2V0X3JlcGx5XCIsXG4gICAgc2NoZWR1bGluZzoge1xuICAgICAgZm9sbG93dXBfZGF5czogQXJyYXkuaXNBcnJheShzYWZlLnNjaGVkdWxpbmc/LmZvbGxvd3VwX2RheXMpXG4gICAgICAgID8gc2FmZS5zY2hlZHVsaW5nLmZvbGxvd3VwX2RheXMubWFwKChpdGVtKSA9PiBOdW1iZXIoaXRlbSkpLmZpbHRlcigoaXRlbSkgPT4gTnVtYmVyLmlzRmluaXRlKGl0ZW0pKVxuICAgICAgICA6IFsyLCA1LCA5XSxcbiAgICAgIHRpbWV6b25lOiB0eXBlb2Ygc2FmZS5zY2hlZHVsaW5nPy50aW1lem9uZSA9PT0gXCJzdHJpbmdcIiAmJiBzYWZlLnNjaGVkdWxpbmcudGltZXpvbmUudHJpbSgpXG4gICAgICAgID8gc2FmZS5zY2hlZHVsaW5nLnRpbWV6b25lLnRyaW0oKVxuICAgICAgICA6IFwiRXVyb3BlL0JlcmxpblwiXG4gICAgfSxcbiAgICBkZWZhdWx0czoge1xuICAgICAgc3RhdHVzX2RlZmF1bHQ6IHR5cGVvZiBzYWZlLmRlZmF1bHRzPy5zdGF0dXNfZGVmYXVsdCA9PT0gXCJzdHJpbmdcIlxuICAgICAgICA/IHNhZmUuZGVmYXVsdHMuc3RhdHVzX2RlZmF1bHRcbiAgICAgICAgOiBcIlJFQURZXCIsXG4gICAgICBtYXhfaXRlbXM6XG4gICAgICAgIHR5cGVvZiBzYWZlLmRlZmF1bHRzPy5tYXhfaXRlbXMgPT09IFwibnVtYmVyXCIgJiYgTnVtYmVyLmlzRmluaXRlKHNhZmUuZGVmYXVsdHMubWF4X2l0ZW1zKVxuICAgICAgICAgID8gTWF0aC5tYXgoMSwgTWF0aC5yb3VuZChzYWZlLmRlZmF1bHRzLm1heF9pdGVtcykpXG4gICAgICAgICAgOiA1MFxuICAgIH0sXG4gICAgaW5wdXRzOiB7XG4gICAgICBtYXhpbV9sZWFkc19qc29uOiBzYWZlLm1heGltX2xlYWRzX2pzb24gPz8gbWVyZ2VkSW5wdXRzLm1heGltX2xlYWRzX2pzb24gPz8gbnVsbCxcbiAgICAgIGZlZG9yX2xlYWRzX2pzb246IHNhZmUuZmVkb3JfbGVhZHNfanNvbiA/PyBtZXJnZWRJbnB1dHMuZmVkb3JfbGVhZHNfanNvbiA/PyBudWxsLFxuICAgICAgYXJ0ZW1faG90X2pzb246IHNhZmUuYXJ0ZW1faG90X2pzb24gPz8gbWVyZ2VkSW5wdXRzLmFydGVtX2hvdF9qc29uID8/IG51bGwsXG4gICAgICBhbmF0b2x5X2FjY291bnRfanNvbjogc2FmZS5hbmF0b2x5X2FjY291bnRfanNvbiA/PyBtZXJnZWRJbnB1dHMuYW5hdG9seV9hY2NvdW50X2pzb24gPz8gbnVsbCxcbiAgICAgIGxlb25pZF9kbV9qc29uOiBzYWZlLmxlb25pZF9kbV9qc29uID8/IG1lcmdlZElucHV0cy5sZW9uaWRfZG1fanNvbiA/PyBudWxsLFxuICAgICAgZW1lbHlhbl9lbWFpbF9qc29uOiBzYWZlLmVtZWx5YW5fZW1haWxfanNvbiA/PyBtZXJnZWRJbnB1dHMuZW1lbHlhbl9lbWFpbF9qc29uID8/IG51bGxcbiAgICB9LFxuICAgIG1hcHBpbmdfcnVsZXM6IHtcbiAgICAgIHByZWZlcl9ob3Rfb3Zlcl9jb2xkOlxuICAgICAgICB0eXBlb2Ygc2FmZS5tYXBwaW5nX3J1bGVzPy5wcmVmZXJfaG90X292ZXJfY29sZCA9PT0gXCJib29sZWFuXCJcbiAgICAgICAgICA/IHNhZmUubWFwcGluZ19ydWxlcy5wcmVmZXJfaG90X292ZXJfY29sZFxuICAgICAgICAgIDogdHJ1ZSxcbiAgICAgIHByZWZlcl9kbV9vdmVyX2VtYWlsX2Zvcl9sb2NhbDpcbiAgICAgICAgdHlwZW9mIHNhZmUubWFwcGluZ19ydWxlcz8ucHJlZmVyX2RtX292ZXJfZW1haWxfZm9yX2xvY2FsID09PSBcImJvb2xlYW5cIlxuICAgICAgICAgID8gc2FmZS5tYXBwaW5nX3J1bGVzLnByZWZlcl9kbV9vdmVyX2VtYWlsX2Zvcl9sb2NhbFxuICAgICAgICAgIDogdHJ1ZVxuICAgIH0sXG4gICAgbGFuZ3VhZ2U6IHNhZmUubGFuZ3VhZ2UgPT09IFwicnVcIiA/IFwicnVcIiA6IFwicnVcIlxuICB9O1xuXG4gIGNvbnN0IGJ1ZGdldFJlc3VsdCA9IGFwcGx5QnVkZ2V0KG5vcm1hbGl6ZWQsIGJ1ZGdldCwge1xuICAgIG1heEl0ZW1zUGF0aHM6IFtbXCJkZWZhdWx0c1wiLCBcIm1heF9pdGVtc1wiXV1cbiAgfSk7XG4gIG5vcm1hbGl6ZWQuYnVkZ2V0ID0gYnVkZ2V0O1xuICBub3JtYWxpemVkLmJ1ZGdldF9hcHBsaWVkID0gYnVkZ2V0UmVzdWx0LmJ1ZGdldF9hcHBsaWVkO1xuICBub3JtYWxpemVkLmJ1ZGdldF93YXJuaW5ncyA9IGJ1ZGdldFJlc3VsdC53YXJuaW5ncztcbiAgcmV0dXJuIG5vcm1hbGl6ZWQ7XG59O1xuXG5jb25zdCBnZXREYXRlSW5UaW1lWm9uZSA9IChkYXRlLCB0aW1lWm9uZSkgPT4ge1xuICBjb25zdCBmb3JtYXR0ZXIgPSBuZXcgSW50bC5EYXRlVGltZUZvcm1hdChcImVuLUNBXCIsIHtcbiAgICB0aW1lWm9uZSxcbiAgICB5ZWFyOiBcIm51bWVyaWNcIixcbiAgICBtb250aDogXCIyLWRpZ2l0XCIsXG4gICAgZGF5OiBcIjItZGlnaXRcIlxuICB9KTtcbiAgcmV0dXJuIGZvcm1hdHRlci5mb3JtYXQoZGF0ZSk7XG59O1xuXG5jb25zdCBhZGREYXlzID0gKGRhdGUsIGRheXMpID0+IG5ldyBEYXRlKGRhdGUuZ2V0VGltZSgpICsgZGF5cyAqIDI0ICogNjAgKiA2MCAqIDEwMDApO1xuXG5jb25zdCB0b0NoYW5uZWxMYWJlbCA9IChwcmltYXJ5Q2hhbm5lbCwgbGVhZFNvdXJjZSkgPT4ge1xuICBpZiAocHJpbWFyeUNoYW5uZWwgPT09IFwidGVsZWdyYW1cIikgcmV0dXJuIFwiVEdcIjtcbiAgaWYgKHByaW1hcnlDaGFubmVsID09PSBcInZrXCIpIHJldHVybiBcIlZLXCI7XG4gIGlmIChwcmltYXJ5Q2hhbm5lbCA9PT0gXCJ3aGF0c2FwcFwiKSByZXR1cm4gXCJXQVwiO1xuICBpZiAocHJpbWFyeUNoYW5uZWwgPT09IFwiZW1haWxcIikgcmV0dXJuIFwiRU1BSUxcIjtcbiAgaWYgKGxlYWRTb3VyY2UgPT09IFwidmtcIikgcmV0dXJuIFwiVktcIjtcbiAgaWYgKGxlYWRTb3VyY2UgPT09IFwidGVsZWdyYW1cIikgcmV0dXJuIFwiVEdcIjtcbiAgcmV0dXJuIFwiVEdcIjtcbn07XG5cbmNvbnN0IGhhc2hJZCA9ICh2YWx1ZSkgPT4ge1xuICByZXR1cm4gY3J5cHRvLmNyZWF0ZUhhc2goXCJzaGExXCIpLnVwZGF0ZShTdHJpbmcodmFsdWUpKS5kaWdlc3QoXCJoZXhcIikuc2xpY2UoMCwgMTIpO1xufTtcblxuY29uc3QgZXNjYXBlQ3N2ID0gKHZhbHVlKSA9PiB7XG4gIGNvbnN0IHN0cmluZ1ZhbHVlID0gdmFsdWUgPT0gbnVsbCA/IFwiXCIgOiBTdHJpbmcodmFsdWUpO1xuICBpZiAoL1tcIixcXG5dLy50ZXN0KHN0cmluZ1ZhbHVlKSkge1xuICAgIHJldHVybiBgXCIke3N0cmluZ1ZhbHVlLnJlcGxhY2UoL1wiL2csICdcIlwiJyl9XCJgO1xuICB9XG4gIHJldHVybiBzdHJpbmdWYWx1ZTtcbn07XG5cbmNvbnN0IGJ1aWxkQ3N2ID0gKHJvd3MsIGNvbHVtbnMpID0+IHtcbiAgY29uc3QgaGVhZGVyID0gY29sdW1ucy5tYXAoZXNjYXBlQ3N2KS5qb2luKFwiLFwiKTtcbiAgY29uc3QgbGluZXMgPSByb3dzLm1hcCgocm93KSA9PiBjb2x1bW5zLm1hcCgoY29sKSA9PiBlc2NhcGVDc3Yocm93W2NvbF0pKS5qb2luKFwiLFwiKSk7XG4gIHJldHVybiBbaGVhZGVyLCAuLi5saW5lc10uam9pbihcIlxcblwiKTtcbn07XG5cbmNvbnN0IG5vcm1hbGl6ZURtTWVzc2FnZSA9ICh2YWx1ZSkgPT4ge1xuICBpZiAoIXZhbHVlKSByZXR1cm4gbnVsbDtcbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIiAmJiB2YWx1ZS50cmltKCkpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdGV4dDogdmFsdWUudHJpbSgpLFxuICAgICAgcGVyc29uYWxpemF0aW9uX2xpbmU6IFwiXCIsXG4gICAgICBncm91bmRpbmdfcmVmczogW11cbiAgICB9O1xuICB9XG4gIGlmICh0eXBlb2YgdmFsdWUgIT09IFwib2JqZWN0XCIpIHJldHVybiBudWxsO1xuICBjb25zdCB0ZXh0ID0gU3RyaW5nKHZhbHVlLnRleHQgfHwgdmFsdWUuYm9keSB8fCB2YWx1ZS5tZXNzYWdlIHx8IFwiXCIpLnRyaW0oKTtcbiAgaWYgKCF0ZXh0KSByZXR1cm4gbnVsbDtcbiAgcmV0dXJuIHtcbiAgICAuLi52YWx1ZSxcbiAgICB0ZXh0LFxuICAgIHBlcnNvbmFsaXphdGlvbl9saW5lOiBTdHJpbmcodmFsdWUucGVyc29uYWxpemF0aW9uX2xpbmUgfHwgXCJcIikudHJpbSgpLFxuICAgIGdyb3VuZGluZ19yZWZzOiBBcnJheS5pc0FycmF5KHZhbHVlLmdyb3VuZGluZ19yZWZzKSA/IHZhbHVlLmdyb3VuZGluZ19yZWZzIDogW11cbiAgfTtcbn07XG5cbmNvbnN0IHBpY2tEbU1lc3NhZ2UgPSAobGVvbmlkSnNvbikgPT4ge1xuICBpZiAoIWxlb25pZEpzb24gfHwgdHlwZW9mIGxlb25pZEpzb24gIT09IFwib2JqZWN0XCIpIHJldHVybiBudWxsO1xuICBjb25zdCBkbVBhY2sgPSBsZW9uaWRKc29uLmRtX3BhY2sgfHwgbGVvbmlkSnNvbi5kbVBhY2sgfHwgbGVvbmlkSnNvbi5tZXNzYWdlc19wYWNrIHx8IHt9O1xuICBjb25zdCB2YXJpYW50cyA9IFtcbiAgICAuLi4oQXJyYXkuaXNBcnJheShkbVBhY2sudmFyaWFudHMpID8gZG1QYWNrLnZhcmlhbnRzIDogW10pLFxuICAgIC4uLihBcnJheS5pc0FycmF5KGxlb25pZEpzb24udmFyaWFudHMpID8gbGVvbmlkSnNvbi52YXJpYW50cyA6IFtdKVxuICBdO1xuXG4gIGNvbnN0IGNhbmRpZGF0ZXMgPSBbXG4gICAgZG1QYWNrLm1lc3NhZ2VzPy5maXJzdF9tZXNzYWdlLFxuICAgIGRtUGFjay5tZXNzYWdlcz8uZmlyc3RNZXNzYWdlLFxuICAgIGRtUGFjay5maXJzdF9tZXNzYWdlLFxuICAgIGRtUGFjay5maXJzdE1lc3NhZ2UsXG4gICAgbGVvbmlkSnNvbi5maXJzdF9tZXNzYWdlLFxuICAgIGxlb25pZEpzb24uZmlyc3RNZXNzYWdlLFxuICAgIGxlb25pZEpzb24ubWVzc2FnZSxcbiAgICBsZW9uaWRKc29uLnRleHQsXG4gICAgZG1QYWNrLm1lc3NhZ2UsXG4gICAgZG1QYWNrLnRleHQsXG4gICAgdmFyaWFudHNbMF0/LmZpcnN0X21lc3NhZ2UsXG4gICAgdmFyaWFudHNbMF0/LmZpcnN0TWVzc2FnZSxcbiAgICB2YXJpYW50c1swXT8ubWVzc2FnZSxcbiAgICB2YXJpYW50c1swXT8udGV4dCxcbiAgICB2YXJpYW50c1swXVxuICBdO1xuXG4gIGZvciAoY29uc3QgY2FuZGlkYXRlIG9mIGNhbmRpZGF0ZXMpIHtcbiAgICBjb25zdCBub3JtYWxpemVkID0gbm9ybWFsaXplRG1NZXNzYWdlKGNhbmRpZGF0ZSk7XG4gICAgaWYgKG5vcm1hbGl6ZWQpIHJldHVybiBub3JtYWxpemVkO1xuICB9XG4gIHJldHVybiBudWxsO1xufTtcblxuY29uc3Qgbm9ybWFsaXplRW1haWxNZXNzYWdlID0gKHZhbHVlKSA9PiB7XG4gIGlmICghdmFsdWUpIHJldHVybiBudWxsO1xuICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiICYmIHZhbHVlLnRyaW0oKSkge1xuICAgIHJldHVybiB7XG4gICAgICBkYXlfb2Zmc2V0OiAwLFxuICAgICAgc3ViamVjdDogXCJcIixcbiAgICAgIGJvZHk6IHZhbHVlLnRyaW0oKSxcbiAgICAgIGdyb3VuZGluZ19yZWZzOiBbXVxuICAgIH07XG4gIH1cbiAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gXCJvYmplY3RcIikgcmV0dXJuIG51bGw7XG4gIGNvbnN0IGJvZHkgPSBTdHJpbmcodmFsdWUuYm9keSB8fCB2YWx1ZS50ZXh0IHx8IHZhbHVlLm1lc3NhZ2UgfHwgXCJcIikudHJpbSgpO1xuICBjb25zdCBzdWJqZWN0ID0gU3RyaW5nKHZhbHVlLnN1YmplY3QgfHwgdmFsdWUudGl0bGUgfHwgXCJcIikudHJpbSgpO1xuICBpZiAoIWJvZHkgJiYgIXN1YmplY3QpIHJldHVybiBudWxsO1xuICByZXR1cm4ge1xuICAgIC4uLnZhbHVlLFxuICAgIGRheV9vZmZzZXQ6IE51bWJlci5pc0Zpbml0ZShOdW1iZXIodmFsdWUuZGF5X29mZnNldCkpID8gTnVtYmVyKHZhbHVlLmRheV9vZmZzZXQpIDogMCxcbiAgICBzdWJqZWN0LFxuICAgIGJvZHksXG4gICAgZ3JvdW5kaW5nX3JlZnM6IEFycmF5LmlzQXJyYXkodmFsdWUuZ3JvdW5kaW5nX3JlZnMpID8gdmFsdWUuZ3JvdW5kaW5nX3JlZnMgOiBbXVxuICB9O1xufTtcblxuY29uc3QgcGlja0VtYWlsTWVzc2FnZSA9IChlbWVseWFuSnNvbikgPT4ge1xuICBpZiAoIWVtZWx5YW5Kc29uIHx8IHR5cGVvZiBlbWVseWFuSnNvbiAhPT0gXCJvYmplY3RcIikgcmV0dXJuIG51bGw7XG4gIGNvbnN0IHNlcXVlbmNlcyA9IHBpY2tGaXJzdERlZmluZWQoZW1lbHlhbkpzb24sIFtcbiAgICBcImVtYWlsX3NlcXVlbmNlc1wiLFxuICAgIFwiZGF0YS5lbWFpbF9zZXF1ZW5jZXNcIlxuICBdKTtcbiAgY29uc3QgZmlyc3RTZXF1ZW5jZSA9IEFycmF5LmlzQXJyYXkoc2VxdWVuY2VzKSAmJiBzZXF1ZW5jZXMubGVuZ3RoID8gc2VxdWVuY2VzWzBdIDogbnVsbDtcbiAgY29uc3QgZmlyc3RFbWFpbCA9IEFycmF5LmlzQXJyYXkoZmlyc3RTZXF1ZW5jZT8uZW1haWxzKSA/IGZpcnN0U2VxdWVuY2UuZW1haWxzWzBdIDogbnVsbDtcbiAgY29uc3QgY2FuZGlkYXRlcyA9IFtcbiAgICBmaXJzdEVtYWlsLFxuICAgIGZpcnN0U2VxdWVuY2U/LmZpcnN0X2VtYWlsLFxuICAgIGZpcnN0U2VxdWVuY2U/LnByaW1hcnlfZW1haWwsXG4gICAgZW1lbHlhbkpzb24sXG4gICAgZW1lbHlhbkpzb24uZGF0YSxcbiAgICBlbWVseWFuSnNvbi5kYXRhPy5maXJzdF9lbWFpbCxcbiAgICBlbWVseWFuSnNvbi5kYXRhPy5wcmltYXJ5X2VtYWlsLFxuICAgIGVtZWx5YW5Kc29uLmRhdGE/LmVtYWlsLFxuICAgIGVtZWx5YW5Kc29uLmRhdGE/Lm1lc3NhZ2UsXG4gICAgZW1lbHlhbkpzb24uZGF0YT8uYm9keSxcbiAgICBlbWVseWFuSnNvbi5maXJzdF9lbWFpbCxcbiAgICBlbWVseWFuSnNvbi5wcmltYXJ5X2VtYWlsLFxuICAgIGVtZWx5YW5Kc29uLmVtYWlsLFxuICAgIGVtZWx5YW5Kc29uLm1lc3NhZ2UsXG4gICAgZW1lbHlhbkpzb24uYm9keVxuICBdO1xuICBmb3IgKGNvbnN0IGNhbmRpZGF0ZSBvZiBjYW5kaWRhdGVzKSB7XG4gICAgY29uc3Qgbm9ybWFsaXplZCA9IG5vcm1hbGl6ZUVtYWlsTWVzc2FnZShjYW5kaWRhdGUpO1xuICAgIGlmIChub3JtYWxpemVkKSByZXR1cm4gbm9ybWFsaXplZDtcbiAgfVxuICByZXR1cm4gbnVsbDtcbn07XG5cbmNvbnN0IHBpY2tEbUZvbGxvd3VwcyA9IChsZW9uaWRKc29uKSA9PiB7XG4gIGlmICghbGVvbmlkSnNvbiB8fCB0eXBlb2YgbGVvbmlkSnNvbiAhPT0gXCJvYmplY3RcIikgcmV0dXJuIFtdO1xuICBjb25zdCBmb2xsb3d1cHMgPSBwaWNrRmlyc3REZWZpbmVkKGxlb25pZEpzb24sIFtcbiAgICBcImRtX3BhY2subWVzc2FnZXMuZm9sbG93dXBzXCIsXG4gICAgXCJkbVBhY2subWVzc2FnZXMuZm9sbG93dXBzXCIsXG4gICAgXCJkbV9wYWNrLmZvbGxvd3Vwc1wiLFxuICAgIFwiZm9sbG93dXBzXCJcbiAgXSk7XG4gIGNvbnN0IGxpc3QgPSBBcnJheS5pc0FycmF5KGZvbGxvd3VwcykgPyBmb2xsb3d1cHMgOiBbXTtcbiAgcmV0dXJuIGxpc3RcbiAgICAubWFwKChpdGVtKSA9PiAoe1xuICAgICAgZGF5X29mZnNldDogTnVtYmVyKGl0ZW0/LmRheV9vZmZzZXQpLFxuICAgICAgdGV4dDogdHlwZW9mIGl0ZW0gPT09IFwic3RyaW5nXCIgPyBpdGVtLnRyaW0oKSA6IFN0cmluZyhpdGVtPy50ZXh0IHx8IGl0ZW0/Lm1lc3NhZ2UgfHwgXCJcIikudHJpbSgpXG4gICAgfSkpXG4gICAgLmZpbHRlcigoaXRlbSkgPT4gTnVtYmVyLmlzRmluaXRlKGl0ZW0uZGF5X29mZnNldCkgJiYgaXRlbS50ZXh0KVxuICAgIC5zbGljZSgwLCAzKTtcbn07XG5cbmNvbnN0IHBpY2tFbWFpbEZvbGxvd3VwcyA9IChlbWVseWFuSnNvbikgPT4ge1xuICBpZiAoIWVtZWx5YW5Kc29uIHx8IHR5cGVvZiBlbWVseWFuSnNvbiAhPT0gXCJvYmplY3RcIikgcmV0dXJuIFtdO1xuICBjb25zdCBzZXF1ZW5jZXMgPSBBcnJheS5pc0FycmF5KGVtZWx5YW5Kc29uLmVtYWlsX3NlcXVlbmNlcykgPyBlbWVseWFuSnNvbi5lbWFpbF9zZXF1ZW5jZXMgOiBbXTtcbiAgY29uc3QgZmlyc3RTZXF1ZW5jZSA9IHNlcXVlbmNlc1swXTtcbiAgY29uc3QgZW1haWxzQ2FuZGlkYXRlID0gcGlja0ZpcnN0RGVmaW5lZChlbWVseWFuSnNvbiwgW1xuICAgIFwiZW1haWxfc2VxdWVuY2VzLjAuZW1haWxzXCIsXG4gICAgXCJkYXRhLmVtYWlsX3NlcXVlbmNlcy4wLmVtYWlsc1wiLFxuICAgIFwiZm9sbG93dXBzXCIsXG4gICAgXCJlbWFpbHNcIlxuICBdKTtcbiAgY29uc3QgZW1haWxzID0gQXJyYXkuaXNBcnJheShlbWFpbHNDYW5kaWRhdGUpXG4gICAgPyBlbWFpbHNDYW5kaWRhdGVcbiAgICA6IEFycmF5LmlzQXJyYXkoZmlyc3RTZXF1ZW5jZT8uZW1haWxzKVxuICAgICAgPyBmaXJzdFNlcXVlbmNlLmVtYWlsc1xuICAgICAgOiBbXTtcbiAgcmV0dXJuIGVtYWlsc1xuICAgIC5maWx0ZXIoKGl0ZW0pID0+IE51bWJlcihpdGVtPy5kYXlfb2Zmc2V0KSA+IDApXG4gICAgLnNsaWNlKDAsIDMpXG4gICAgLm1hcCgoaXRlbSkgPT4gKHtcbiAgICAgIGRheV9vZmZzZXQ6IE51bWJlcihpdGVtPy5kYXlfb2Zmc2V0KSxcbiAgICAgIHN1YmplY3Q6IFN0cmluZyhpdGVtPy5zdWJqZWN0IHx8IGl0ZW0/LnRpdGxlIHx8IFwiXCIpLnRyaW0oKSxcbiAgICAgIGJvZHk6IFN0cmluZyhpdGVtPy5ib2R5IHx8IGl0ZW0/LnRleHQgfHwgXCJcIikudHJpbSgpXG4gICAgfSkpXG4gICAgLmZpbHRlcigoaXRlbSkgPT4gTnVtYmVyLmlzRmluaXRlKGl0ZW0uZGF5X29mZnNldCkgJiYgaXRlbS5ib2R5KTtcbn07XG5cbmNvbnN0IGJ1aWxkRGVmYXVsdEZvbGxvd3VwVGVtcGxhdGVzID0gKGNoYW5uZWwpID0+IHtcbiAgaWYgKGNoYW5uZWwgPT09IFwiRU1BSUxcIikge1xuICAgIHJldHVybiBbXG4gICAgICB7IGRheV9vZmZzZXQ6IDIsIHN1YmplY3Q6IFwi0JrQvtGA0L7RgtC60L7QtSDQvdCw0L/QvtC80LjQvdCw0L3QuNC1XCIsIGJvZHk6IFwi0J3QsNC/0L7QvNC90Y4g0L/RgNC+INC/0LjRgdGM0LzQviDQstGL0YjQtS4g0JXRgdC70Lgg0LDQutGC0YPQsNC70YzQvdC+LCDQv9GA0LjRiNC70Y4gMiDRiNCw0LPQsC5cIiB9LFxuICAgICAgeyBkYXlfb2Zmc2V0OiA1LCBzdWJqZWN0OiBcItCa0LXQudGBLdC90LDQvNC10LpcIiwgYm9keTogXCLQldGB0YLRjCDRgNC10LvQtdCy0LDQvdGC0L3Ri9C5INC/0YDQuNC80LXRgCDQsdC10Lcg0YbQuNGE0YAuINCf0YDQuNGB0LvQsNGC0Ywg0YLQtdC60YHRgtC+0Lw/XCIgfSxcbiAgICAgIHsgZGF5X29mZnNldDogOSwgc3ViamVjdDogXCLQl9Cw0LrRgNGL0LLQsNGOINGC0YDQtdC0XCIsIGJvZHk6IFwi0JXRgdC70Lgg0L3QtdCw0LrRgtGD0LDQu9GM0L3Qviwg0LfQsNC60YDQvtGOINGC0YDQtdC0INC4INCy0LXRgNC90YPRgdGMINC/0L7Qt9C20LUuXCIgfVxuICAgIF07XG4gIH1cbiAgcmV0dXJuIFtcbiAgICB7IGRheV9vZmZzZXQ6IDIsIHRleHQ6IFwi0J3QsNC/0L7QvNC90Y4g0L/RgNC+INGB0L7QvtCx0YnQtdC90LjQtSDQstGL0YjQtS4g0JXRgdC70Lgg0LDQutGC0YPQsNC70YzQvdC+LCDRgdC60LjQvdGDIDIg0YjQsNCz0LAuXCIgfSxcbiAgICB7IGRheV9vZmZzZXQ6IDUsIHRleHQ6IFwi0JXRgdGC0Ywg0L/QvtGF0L7QttC40Lkg0LrQtdC50YEg0LHQtdC3INGG0LjRhNGALiDQodC60LjQvdGD0YLRjCDQutC+0YDQvtGC0LrQvj9cIiB9LFxuICAgIHsgZGF5X29mZnNldDogOSwgdGV4dDogXCLQldGB0LvQuCDQvdC1INCyINC/0YDQuNC+0YDQuNGC0LXRgtC1LCDQt9Cw0LrRgNC+0Y4g0YLQtdC80YMg0LHQtdC3INC70LjRiNC90LjRhSDRgdC+0L7QsdGJ0LXQvdC40LkuXCIgfVxuICBdO1xufTtcblxuY29uc3QgZXh0cmFjdFBlcnNvbmFsaXphdGlvbiA9IChhbmF0b2x5SnNvbiwgYXJ0ZW1Kc29uLCBsZW9uaWRNZXNzYWdlKSA9PiB7XG4gIGlmIChsZW9uaWRNZXNzYWdlPy5wZXJzb25hbGl6YXRpb25fbGluZSkge1xuICAgIHJldHVybiB7IHRleHQ6IGxlb25pZE1lc3NhZ2UucGVyc29uYWxpemF0aW9uX2xpbmUsIHJlZnM6IGxlb25pZE1lc3NhZ2UuZ3JvdW5kaW5nX3JlZnMgfHwgW10gfTtcbiAgfVxuXG4gIGlmIChhbmF0b2x5SnNvbj8uYWNjb3VudF9jYXJkKSB7XG4gICAgY29uc3QgaG9vayA9IGFuYXRvbHlKc29uLmFjY291bnRfY2FyZC50b3BfcGVyc29uYWxpemF0aW9uX2hvb2tzPy5bMF07XG4gICAgaWYgKGhvb2s/Lmhvb2tfdGV4dCkge1xuICAgICAgcmV0dXJuIHsgdGV4dDogaG9vay5ob29rX3RleHQsIHJlZnM6IGhvb2sucmVsYXRlZF9wcm9vZnMgfHwgW10gfTtcbiAgICB9XG4gIH1cblxuICBpZiAoYXJ0ZW1Kc29uPy5ob3RfbGVhZHM/Lmxlbmd0aCkge1xuICAgIGNvbnN0IGxlYWQgPSBhcnRlbUpzb24uaG90X2xlYWRzWzBdO1xuICAgIGlmIChsZWFkPy5ob3RfcmVhc29ucz8ubGVuZ3RoKSB7XG4gICAgICByZXR1cm4geyB0ZXh0OiBsZWFkLmhvdF9yZWFzb25zWzBdLCByZWZzOiBsZWFkLnByb29mX3JlZnMgfHwgW10gfTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4geyB0ZXh0OiBcIlwiLCByZWZzOiBbXSB9O1xufTtcblxuY29uc3QgYnVpbGRNaW5pbWFsVGVtcGxhdGUgPSAocGVyc29uYWxpemF0aW9uLCBjaGFubmVsKSA9PiB7XG4gIGNvbnN0IGludHJvID0gY2hhbm5lbCA9PT0gXCJFTUFJTFwiID8gXCLQlNC+0LHRgNGL0Lkg0LTQtdC90YwuXCIgOiBcItCf0YDQuNCy0LXRgi5cIjtcbiAgY29uc3QgbGluZSA9IHBlcnNvbmFsaXphdGlvbiA/IGDQktC40LbRgyAke3BlcnNvbmFsaXphdGlvbn0uYCA6IFwi0JrQvtGA0L7RgtC60LjQuSDQstC+0L/RgNC+0YEuXCI7XG4gIHJldHVybiBgJHtpbnRyb30gJHtsaW5lfSDQnNC+0LPRgyDQv9C+0LrQsNC30LDRgtGMIDLigJMzINC40LTQtdC4LiDQkNC60YLRg9Cw0LvRjNC90L4/YDtcbn07XG5cbmNvbnN0IGJ1aWxkUm93ID0gKHtcbiAgbGVhZCxcbiAgdHlwZSxcbiAgY2hhbm5lbCxcbiAgbWVzc2FnZSxcbiAgYm9keSxcbiAgc3ViamVjdCxcbiAgcGVyc29uYWxpemF0aW9uLFxuICBzdGF0dXMsXG4gIG5leHREYXRlLFxuICBuZXh0U3RlcFJlYXNvbixcbiAgc291cmNlUmVmcyxcbiAgZ3JvdW5kaW5nUmVmcyxcbiAgbmVlZHNSZXZpZXcsXG4gIGZvbGxvd3VwVGVtcGxhdGVzLFxuICBiYXRjaEtleSxcbiAgb3BlcmF0b3JOb3Rlc1xufSkgPT4ge1xuICBjb25zdCByYXdLZXkgPVxuICAgIGxlYWQuZGVkdXBlX2tleSB8fFxuICAgIGxlYWQuZGVkdXBlX2tleV9yYXcgfHxcbiAgICAobGVhZC51cmwgPyBjYW5vbmljYWxpemVVcmwobGVhZC51cmwpIDogXCJcIikgfHxcbiAgICBsZWFkLndlYnNpdGUgfHxcbiAgICBsZWFkLnBob25lIHx8XG4gICAgbGVhZC5lbWFpbCB8fFxuICAgIGxlYWQubmFtZSB8fFxuICAgIFwibGVhZFwiO1xuICBjb25zdCBkZWR1cGVLZXkgPSBTdHJpbmcocmF3S2V5KTtcbiAgY29uc3QgbGVhZElkID0gaGFzaElkKGRlZHVwZUtleSk7XG4gIHJldHVybiB7XG4gICAgbGVhZF9pZDogbGVhZElkLFxuICAgIGxlYWRfbmFtZTogbGVhZC5uYW1lIHx8IGxlYWQudGl0bGUgfHwgbGVhZC5sZWFkX25hbWUgfHwgXCJIb3QgbGVhZFwiLFxuICAgIGNoYW5uZWwsXG4gICAgY29udGFjdDoge1xuICAgICAgd2Vic2l0ZTogbGVhZC53ZWJzaXRlIHx8IG51bGwsXG4gICAgICBlbWFpbDogbGVhZC5lbWFpbCB8fCBudWxsLFxuICAgICAgcGhvbmU6IGxlYWQucGhvbmUgfHwgbnVsbCxcbiAgICAgIHVybDogbGVhZC51cmwgfHwgbGVhZC5jYXJkX3VybCB8fCBudWxsXG4gICAgfSxcbiAgICBjaXR5OiBsZWFkLmNpdHkgfHwgbnVsbCxcbiAgICBjYXRlZ29yeTogbGVhZC5jYXRlZ29yeSB8fCBsZWFkLmNhdGVnb3J5X2hpbnQgfHwgbnVsbCxcbiAgICBwZXJzb25hbGl6YXRpb246IHBlcnNvbmFsaXphdGlvbiB8fCBcIlwiLFxuICAgIG1lc3NhZ2UsXG4gICAgYm9keTogYm9keSB8fCBtZXNzYWdlIHx8IFwiXCIsXG4gICAgc3ViamVjdDogc3ViamVjdCB8fCAoY2hhbm5lbCA9PT0gXCJFTUFJTFwiID8gXCLQmtC+0YDQvtGC0LrQuNC5INCy0L7Qv9GA0L7RgVwiIDogdW5kZWZpbmVkKSxcbiAgICBzdGF0dXMsXG4gICAgbmV4dF9zdGVwOiBzdGF0dXMgPT09IFwiUkVBRFlcIiA/IFwiU2VuZCBmb2xsb3ctdXAgIzFcIiA6IFwiV2FpdCByZXBseVwiLFxuICAgIG5leHRfc3RlcF9yZWFzb246IG5leHRTdGVwUmVhc29uIHx8IFwicmVhZHlfZm9yX3NlbmRcIixcbiAgICBuZXh0X2ZvbGxvd3VwX2RhdGU6IG5leHREYXRlLFxuICAgIGZvbGxvd3VwX3RlbXBsYXRlczogQXJyYXkuaXNBcnJheShmb2xsb3d1cFRlbXBsYXRlcykgPyBmb2xsb3d1cFRlbXBsYXRlcyA6IFtdLFxuICAgIGJhdGNoX2tleTogYmF0Y2hLZXkgfHwgYCR7Y2hhbm5lbH18JHt0eXBlfWAsXG4gICAgb3BlcmF0b3Jfbm90ZXM6IG9wZXJhdG9yTm90ZXMgfHwgXCJcIixcbiAgICBzb3VyY2VfcmVmczogc291cmNlUmVmcyxcbiAgICBncm91bmRpbmdfcmVmczogZ3JvdW5kaW5nUmVmcyB8fCBbXSxcbiAgICBuZWVkc1JldmlldyxcbiAgICBkZWR1cGVfa2V5OiBkZWR1cGVLZXlcbiAgfTtcbn07XG5cbmNvbnN0IGdlbmVyYXRlT3V0cHV0ID0gYXN5bmMgKHJhd0lucHV0ID0ge30sIG9wdGlvbnMgPSB7fSkgPT4ge1xuICBjb25zdCBpbnB1dCA9IG5vcm1hbGl6ZUlucHV0KHJhd0lucHV0KTtcbiAgY29uc3QgaW5wdXRzID0gaW5wdXQuaW5wdXRzO1xuXG4gIGNvbnN0IGhhc0FueUlucHV0ID0gQm9vbGVhbihcbiAgICBpbnB1dHMubWF4aW1fbGVhZHNfanNvbiB8fFxuICAgICAgaW5wdXRzLmZlZG9yX2xlYWRzX2pzb24gfHxcbiAgICAgIGlucHV0cy5hcnRlbV9ob3RfanNvbiB8fFxuICAgICAgaW5wdXRzLmFuYXRvbHlfYWNjb3VudF9qc29uIHx8XG4gICAgICBpbnB1dHMubGVvbmlkX2RtX2pzb24gfHxcbiAgICAgIGlucHV0cy5lbWVseWFuX2VtYWlsX2pzb25cbiAgKTtcblxuICBpZiAoIWhhc0FueUlucHV0KSB7XG4gICAgY29uc3Qgb3V0cHV0ID0ge1xuICAgICAgYmRyX3RhYmxlOiBbXSxcbiAgICAgIG1ldGE6IHtcbiAgICAgICAgZ2VuZXJhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIHN0YXRzOiB7IHRvdGFsX3Jvd3M6IDAsIHJlYWR5X2NvdW50OiAwLCBieV9jaGFubmVsOiB7fSwgbmVlZHNfcmV2aWV3X2NvdW50OiAwIH0sXG4gICAgICAgIGxpbWl0YXRpb25zOiBbXCLQmtCw0LrQuNC1IEpTT04g0YLRiyDRhdC+0YfQtdGI0Ywg0YHQutC70LXQuNGC0YwgKNC70LjQtNGLICsg0YLQtdC60YHRgtGLKT9cIl0sXG4gICAgICAgIGFzc3VtcHRpb25zOiBbXSxcbiAgICAgICAgc3RhdHVzX3RyYW5zaXRpb25fcnVsZXM6IHtcbiAgICAgICAgICB0cmFuc2l0aW9uczogW1xuICAgICAgICAgICAgeyBmcm9tOiBcIlJFQURZXCIsIHRvOiBcIlNFTlRcIiwgd2hlbjogXCLQvtC/0LXRgNCw0YLQvtGAINC+0YLQv9GA0LDQstC40Lsg0L/QtdGA0LLQvtC1INGB0L7QvtCx0YnQtdC90LjQtVwiIH0sXG4gICAgICAgICAgICB7IGZyb206IFwiU0VOVFwiLCB0bzogXCJOT19SRVBMWVwiLCB3aGVuOiBcItC90LXRgiDQvtGC0LLQtdGC0LAg0L/QvtGB0LvQtSBmb2xsb3d1cCBEKzlcIiB9LFxuICAgICAgICAgICAgeyBmcm9tOiBcIk5PX1JFUExZXCIsIHRvOiBcIklOVEVSRVNURURcIiwgd2hlbjogXCLQv9C+0LvRg9GH0LXQvSDQvtGC0LLQtdGCINGBINC40L3RgtC10YDQtdGB0L7QvFwiIH1cbiAgICAgICAgICBdLFxuICAgICAgICAgIG5leHRfc3RlcF9yZWFzb246IFwi0KHRgtGA0L7QutCwINGF0YDQsNC90LjRgtGB0Y8g0LIgYmRyX3RhYmxlW10ubmV4dF9zdGVwX3JlYXNvbi5cIlxuICAgICAgICB9LFxuICAgICAgICBxdWFsaXR5X2NoZWNrczogeyBub19mYWJyaWNhdGlvbjogdHJ1ZSwgZGVkdXBlX29rOiB0cnVlLCBoYXNfbWVzc2FnZXM6IGZhbHNlIH0sXG4gICAgICAgIGV4cG9ydF9oZWxwZXJzOiB7IGNvbHVtbnM6IFtdLCBjc3Y6IFwiXCIgfVxuICAgICAgfVxuICAgIH07XG4gICAgYXBwbHlCdWRnZXRNZXRhKG91dHB1dC5tZXRhLCBpbnB1dCk7XG4gICAgcmV0dXJuIHsgb3V0cHV0OiB3cmFwT3V0cHV0KG91dHB1dCwgaW5wdXQpLCBlZmZlY3RpdmVJbnB1dDogaW5wdXQgfTtcbiAgfVxuXG4gIGNvbnN0IHJhd1BheWxvYWRzID0gW1xuICAgIGlucHV0cy5tYXhpbV9sZWFkc19qc29uLFxuICAgIGlucHV0cy5mZWRvcl9sZWFkc19qc29uLFxuICAgIGlucHV0cy5hcnRlbV9ob3RfanNvbixcbiAgICBpbnB1dHMuYW5hdG9seV9hY2NvdW50X2pzb24sXG4gICAgaW5wdXRzLmxlb25pZF9kbV9qc29uLFxuICAgIGlucHV0cy5lbWVseWFuX2VtYWlsX2pzb25cbiAgXS5maWx0ZXIoQm9vbGVhbik7XG5cbiAgY29uc3QgaGFuZG9mZklzc3VlcyA9IFtdO1xuICByYXdQYXlsb2Fkcy5mb3JFYWNoKChwYXlsb2FkKSA9PiB7XG4gICAgY29uc3QgaGFuZG9mZiA9IGV4dHJhY3RIYW5kb2ZmKHBheWxvYWQpO1xuICAgIGlmICghaGFuZG9mZiB8fCAhaGFuZG9mZi50eXBlIHx8ICFoYW5kb2ZmLnZlcnNpb24pIHtcbiAgICAgIGhhbmRvZmZJc3N1ZXMucHVzaChcIm1pc3NpbmdcIik7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICghaGFzQm9yaXNDb21wYXQoaGFuZG9mZikpIHtcbiAgICAgIGhhbmRvZmZJc3N1ZXMucHVzaChcImluY29tcGF0aWJsZVwiKTtcbiAgICB9XG4gIH0pO1xuXG4gIGNvbnN0IGhhbmRvZmZNaXNtYXRjaCA9IHJhd1BheWxvYWRzLmxlbmd0aCA+IDAgJiYgaGFuZG9mZklzc3Vlcy5sZW5ndGggPiAwO1xuXG4gIGNvbnN0IG5vcm1hbGl6ZWRJbnB1dHMgPSB7XG4gICAgbWF4aW1fbGVhZHNfanNvbjogdW53cmFwUGF5bG9hZChpbnB1dHMubWF4aW1fbGVhZHNfanNvbiksXG4gICAgZmVkb3JfbGVhZHNfanNvbjogdW53cmFwUGF5bG9hZChpbnB1dHMuZmVkb3JfbGVhZHNfanNvbiksXG4gICAgYXJ0ZW1faG90X2pzb246IHVud3JhcFBheWxvYWQoaW5wdXRzLmFydGVtX2hvdF9qc29uKSxcbiAgICBhbmF0b2x5X2FjY291bnRfanNvbjogdW53cmFwUGF5bG9hZChpbnB1dHMuYW5hdG9seV9hY2NvdW50X2pzb24pLFxuICAgIGxlb25pZF9kbV9qc29uOiB1bndyYXBQYXlsb2FkKGlucHV0cy5sZW9uaWRfZG1fanNvbiksXG4gICAgZW1lbHlhbl9lbWFpbF9qc29uOiB1bndyYXBQYXlsb2FkKGlucHV0cy5lbWVseWFuX2VtYWlsX2pzb24pXG4gIH07XG5cbiAgY29uc3QgZXh0cmFjdExlYWRzID0gKHBheWxvYWQpID0+IHtcbiAgICBjb25zdCBsaXN0ID0gcGlja0ZpcnN0RGVmaW5lZChwYXlsb2FkLCBbXG4gICAgICBcImxlYWRzXCIsXG4gICAgICBcImRhdGEubGVhZHNcIixcbiAgICAgIFwiY29tcGFueV9jYW5kaWRhdGVzXCIsXG4gICAgICBcImRhdGEuY29tcGFueV9jYW5kaWRhdGVzXCIsXG4gICAgICBcIm1ldGEuaGFuZG9mZi5lbnRpdGllcy5sZWFkc1wiXG4gICAgXSk7XG4gICAgcmV0dXJuIEFycmF5LmlzQXJyYXkobGlzdCkgPyBsaXN0IDogW107XG4gIH07XG5cbiAgY29uc3QgZXh0cmFjdEhvdExlYWRzID0gKHBheWxvYWQpID0+IHtcbiAgICBjb25zdCBsaXN0ID0gcGlja0ZpcnN0RGVmaW5lZChwYXlsb2FkLCBbXG4gICAgICBcImhvdF9sZWFkc1wiLFxuICAgICAgXCJkYXRhLmhvdF9sZWFkc1wiLFxuICAgICAgXCJtZXRhLmhhbmRvZmYuZW50aXRpZXMuaG90X2xlYWRzXCIsXG4gICAgICBcIm1ldGEuaGFuZG9mZi5lbnRpdGllcy5sZWFkc1wiXG4gICAgXSk7XG4gICAgcmV0dXJuIEFycmF5LmlzQXJyYXkobGlzdCkgPyBsaXN0IDogW107XG4gIH07XG5cbiAgY29uc3QgbWF4aW1MZWFkcyA9IGV4dHJhY3RMZWFkcyhub3JtYWxpemVkSW5wdXRzLm1heGltX2xlYWRzX2pzb24pO1xuICBjb25zdCBmZWRvckxlYWRzID0gZXh0cmFjdExlYWRzKG5vcm1hbGl6ZWRJbnB1dHMuZmVkb3JfbGVhZHNfanNvbik7XG4gIGNvbnN0IGhvdExlYWRzID0gZXh0cmFjdEhvdExlYWRzKG5vcm1hbGl6ZWRJbnB1dHMuYXJ0ZW1faG90X2pzb24pO1xuXG4gIGNvbnN0IGxlb25pZE1lc3NhZ2UgPSBwaWNrRG1NZXNzYWdlKG5vcm1hbGl6ZWRJbnB1dHMubGVvbmlkX2RtX2pzb24pO1xuICBjb25zdCBlbWVseWFuRW1haWwgPSBwaWNrRW1haWxNZXNzYWdlKG5vcm1hbGl6ZWRJbnB1dHMuZW1lbHlhbl9lbWFpbF9qc29uKTtcbiAgY29uc3QgZG1Gb2xsb3d1cHMgPSBwaWNrRG1Gb2xsb3d1cHMobm9ybWFsaXplZElucHV0cy5sZW9uaWRfZG1fanNvbik7XG4gIGNvbnN0IGVtYWlsRm9sbG93dXBzID0gcGlja0VtYWlsRm9sbG93dXBzKG5vcm1hbGl6ZWRJbnB1dHMuZW1lbHlhbl9lbWFpbF9qc29uKTtcbiAgY29uc3QgcGVyc29uYWxpemF0aW9uID0gZXh0cmFjdFBlcnNvbmFsaXphdGlvbihcbiAgICBub3JtYWxpemVkSW5wdXRzLmFuYXRvbHlfYWNjb3VudF9qc29uLFxuICAgIG5vcm1hbGl6ZWRJbnB1dHMuYXJ0ZW1faG90X2pzb24sXG4gICAgbGVvbmlkTWVzc2FnZVxuICApO1xuXG4gIGNvbnN0IHNjaGVkdWxpbmdEYXlzID0gaW5wdXQuc2NoZWR1bGluZy5mb2xsb3d1cF9kYXlzLmxlbmd0aCA/IGlucHV0LnNjaGVkdWxpbmcuZm9sbG93dXBfZGF5cyA6IFsyLCA1LCA5XTtcbiAgY29uc3QgbmV4dERhdGUgPSBnZXREYXRlSW5UaW1lWm9uZShhZGREYXlzKG5ldyBEYXRlKCksIHNjaGVkdWxpbmdEYXlzWzBdKSwgaW5wdXQuc2NoZWR1bGluZy50aW1lem9uZSk7XG5cbiAgY29uc3Qgcm93cyA9IFtdO1xuICBjb25zdCBkZWR1cGUgPSBuZXcgU2V0KCk7XG5cbiAgY29uc3QgcHVzaFJvdyA9IChyb3cpID0+IHtcbiAgICBpZiAoZGVkdXBlLmhhcyhyb3cuZGVkdXBlX2tleSkpIHJldHVybjtcbiAgICBkZWR1cGUuYWRkKHJvdy5kZWR1cGVfa2V5KTtcbiAgICByb3dzLnB1c2gocm93KTtcbiAgfTtcblxuICBjb25zdCBwcmVmZXJIb3QgPSBpbnB1dC5tYXBwaW5nX3J1bGVzLnByZWZlcl9ob3Rfb3Zlcl9jb2xkO1xuICBjb25zdCBzb3VyY2VQcmlvcml0eSA9IHByZWZlckhvdFxuICAgID8gW1wiaG90XCIsIFwibG9jYWxcIiwgXCJiMmJcIl1cbiAgICA6IFtcImxvY2FsXCIsIFwiYjJiXCIsIFwiaG90XCJdO1xuXG4gIGNvbnN0IHNvdXJjZXMgPSB7XG4gICAgaG90OiBob3RMZWFkcy5tYXAoKGxlYWQpID0+ICh7IGxlYWQsIHR5cGU6IFwiaG90XCIgfSkpLFxuICAgIGxvY2FsOiBtYXhpbUxlYWRzLm1hcCgobGVhZCkgPT4gKHsgbGVhZCwgdHlwZTogXCJsb2NhbFwiIH0pKSxcbiAgICBiMmI6IGZlZG9yTGVhZHMubWFwKChsZWFkKSA9PiAoeyBsZWFkLCB0eXBlOiBcImIyYlwiIH0pKVxuICB9O1xuXG4gIGNvbnN0IGJ1aWxkTWVzc2FnZUZvckxlYWQgPSAobGVhZFR5cGUsIGxlYWQpID0+IHtcbiAgICBjb25zdCBjaGFubmVsUHJlZmVyZW5jZSA9IGlucHV0LnByaW1hcnlfY2hhbm5lbDtcbiAgICBjb25zdCBoYXNEbSA9IEJvb2xlYW4obGVvbmlkTWVzc2FnZSk7XG4gICAgY29uc3QgaGFzRW1haWwgPSBCb29sZWFuKGVtZWx5YW5FbWFpbCk7XG5cbiAgICBsZXQgY2hhbm5lbCA9IFwiVEdcIjtcbiAgICBsZXQgbWVzc2FnZSA9IFwiXCI7XG4gICAgbGV0IHN1YmplY3QgPSBcIlwiO1xuICAgIGxldCBuZWVkc1JldmlldyA9IGZhbHNlO1xuICAgIGxldCBncm91bmRpbmdSZWZzID0gcGVyc29uYWxpemF0aW9uLnJlZnMgfHwgW107XG4gICAgbGV0IHBlcnNvbmFsaXphdGlvblRleHQgPSBwZXJzb25hbGl6YXRpb24udGV4dDtcbiAgICBsZXQgZm9sbG93dXBUZW1wbGF0ZXMgPSBbXTtcbiAgICBsZXQgbmV4dFN0ZXBSZWFzb24gPSBcInJlYWR5X2Zvcl9zZW5kXCI7XG4gICAgbGV0IG9wZXJhdG9yTm90ZXMgPSBcIlwiO1xuXG4gICAgaWYgKGNoYW5uZWxQcmVmZXJlbmNlID09PSBcImVtYWlsXCIpIHtcbiAgICAgIGNoYW5uZWwgPSBcIkVNQUlMXCI7XG4gICAgfSBlbHNlIGlmIChjaGFubmVsUHJlZmVyZW5jZSA9PT0gXCJ0ZWxlZ3JhbVwiKSB7XG4gICAgICBjaGFubmVsID0gXCJUR1wiO1xuICAgIH0gZWxzZSBpZiAoY2hhbm5lbFByZWZlcmVuY2UgPT09IFwidmtcIikge1xuICAgICAgY2hhbm5lbCA9IFwiVktcIjtcbiAgICB9IGVsc2UgaWYgKGNoYW5uZWxQcmVmZXJlbmNlID09PSBcIndoYXRzYXBwXCIpIHtcbiAgICAgIGNoYW5uZWwgPSBcIldBXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChsZWFkVHlwZSA9PT0gXCJsb2NhbFwiKSB7XG4gICAgICAgIGNoYW5uZWwgPSBpbnB1dC5tYXBwaW5nX3J1bGVzLnByZWZlcl9kbV9vdmVyX2VtYWlsX2Zvcl9sb2NhbCA/IFwiVEdcIiA6IFwiRU1BSUxcIjtcbiAgICAgIH0gZWxzZSBpZiAobGVhZFR5cGUgPT09IFwiYjJiXCIpIHtcbiAgICAgICAgY2hhbm5lbCA9IFwiRU1BSUxcIjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNoYW5uZWwgPSBcIlRHXCI7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGxlYWRUeXBlID09PSBcImhvdFwiICYmIGxlYWQ/LmhvdF9yZWFzb25zPy5sZW5ndGgpIHtcbiAgICAgIHBlcnNvbmFsaXphdGlvblRleHQgPSBsZWFkLmhvdF9yZWFzb25zWzBdO1xuICAgICAgZ3JvdW5kaW5nUmVmcyA9IGxlYWQucHJvb2ZfcmVmcyB8fCBncm91bmRpbmdSZWZzO1xuICAgIH1cblxuICAgIGlmIChjaGFubmVsID09PSBcIkVNQUlMXCIgJiYgaGFzRW1haWwpIHtcbiAgICAgIG1lc3NhZ2UgPSBlbWVseWFuRW1haWwuYm9keTtcbiAgICAgIHN1YmplY3QgPSBlbWVseWFuRW1haWwuc3ViamVjdCB8fCBcIlwiO1xuICAgICAgZ3JvdW5kaW5nUmVmcyA9IGVtZWx5YW5FbWFpbC5ncm91bmRpbmdfcmVmcyB8fCBncm91bmRpbmdSZWZzO1xuICAgICAgZm9sbG93dXBUZW1wbGF0ZXMgPSBlbWFpbEZvbGxvd3Vwcy5sZW5ndGggPyBlbWFpbEZvbGxvd3VwcyA6IGJ1aWxkRGVmYXVsdEZvbGxvd3VwVGVtcGxhdGVzKFwiRU1BSUxcIik7XG4gICAgICBuZXh0U3RlcFJlYXNvbiA9IGVtYWlsRm9sbG93dXBzLmxlbmd0aCA/IFwiZW1haWxfZm9sbG93dXBzX2Zyb21faW5wdXRcIiA6IFwiZW1haWxfZm9sbG93dXBzX2RlZmF1bHRlZFwiO1xuICAgIH0gZWxzZSBpZiAoaGFzRG0pIHtcbiAgICAgIG1lc3NhZ2UgPSBsZW9uaWRNZXNzYWdlLnRleHQ7XG4gICAgICBncm91bmRpbmdSZWZzID0gbGVvbmlkTWVzc2FnZS5ncm91bmRpbmdfcmVmcyB8fCBncm91bmRpbmdSZWZzO1xuICAgICAgZm9sbG93dXBUZW1wbGF0ZXMgPSBkbUZvbGxvd3Vwcy5sZW5ndGggPyBkbUZvbGxvd3VwcyA6IGJ1aWxkRGVmYXVsdEZvbGxvd3VwVGVtcGxhdGVzKGNoYW5uZWwpO1xuICAgICAgbmV4dFN0ZXBSZWFzb24gPSBkbUZvbGxvd3Vwcy5sZW5ndGggPyBcImRtX2ZvbGxvd3Vwc19mcm9tX2lucHV0XCIgOiBcImRtX2ZvbGxvd3Vwc19kZWZhdWx0ZWRcIjtcbiAgICB9IGVsc2UgaWYgKGhhc0VtYWlsICYmIGNoYW5uZWwgIT09IFwiRU1BSUxcIikge1xuICAgICAgbWVzc2FnZSA9IGVtZWx5YW5FbWFpbC5ib2R5O1xuICAgICAgc3ViamVjdCA9IGVtZWx5YW5FbWFpbC5zdWJqZWN0IHx8IFwiXCI7XG4gICAgICBjaGFubmVsID0gXCJFTUFJTFwiO1xuICAgICAgZ3JvdW5kaW5nUmVmcyA9IGVtZWx5YW5FbWFpbC5ncm91bmRpbmdfcmVmcyB8fCBncm91bmRpbmdSZWZzO1xuICAgICAgZm9sbG93dXBUZW1wbGF0ZXMgPSBlbWFpbEZvbGxvd3Vwcy5sZW5ndGggPyBlbWFpbEZvbGxvd3VwcyA6IGJ1aWxkRGVmYXVsdEZvbGxvd3VwVGVtcGxhdGVzKFwiRU1BSUxcIik7XG4gICAgICBuZXh0U3RlcFJlYXNvbiA9IFwiZW1haWxfZmFsbGJhY2tfZnJvbV9taXNzaW5nX2RtXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIG1lc3NhZ2UgPSBidWlsZE1pbmltYWxUZW1wbGF0ZShwZXJzb25hbGl6YXRpb24udGV4dCwgY2hhbm5lbCk7XG4gICAgICBmb2xsb3d1cFRlbXBsYXRlcyA9IGJ1aWxkRGVmYXVsdEZvbGxvd3VwVGVtcGxhdGVzKGNoYW5uZWwpO1xuICAgICAgbmVlZHNSZXZpZXcgPSB0cnVlO1xuICAgICAgbmV4dFN0ZXBSZWFzb24gPSBcImZhbGxiYWNrX3RlbXBsYXRlX3VzZWRcIjtcbiAgICAgIG9wZXJhdG9yTm90ZXMgPSBcItCd0LXRgiDQstGF0L7QtNC90YvRhSBmb2xsb3d1cHMsINC/0YDQuNC80LXQvdC10L3RiyDRiNCw0LHQu9C+0L3RiyBEKzIvRCs1L0QrOS5cIjtcbiAgICB9XG5cbiAgICBpZiAoIXBlcnNvbmFsaXphdGlvblRleHQpIG5lZWRzUmV2aWV3ID0gdHJ1ZTtcbiAgICBpZiAoIW9wZXJhdG9yTm90ZXMgJiYgIXBlcnNvbmFsaXphdGlvblRleHQpIHtcbiAgICAgIG9wZXJhdG9yTm90ZXMgPSBcItCf0LXRgNGB0L7QvdCw0LvQuNC30LDRhtC40Y8g0YHQu9Cw0LHQsNGPLCDQv9GA0L7QstC10YDRjCDQv9C10YDQtdC0INC+0YLQv9GA0LDQstC60L7QuS5cIjtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgY2hhbm5lbCxcbiAgICAgIG1lc3NhZ2UsXG4gICAgICBzdWJqZWN0LFxuICAgICAgbmVlZHNSZXZpZXcsXG4gICAgICBncm91bmRpbmdSZWZzLFxuICAgICAgcGVyc29uYWxpemF0aW9uVGV4dCxcbiAgICAgIGZvbGxvd3VwVGVtcGxhdGVzLFxuICAgICAgbmV4dFN0ZXBSZWFzb24sXG4gICAgICBvcGVyYXRvck5vdGVzXG4gICAgfTtcbiAgfTtcblxuICBzb3VyY2VQcmlvcml0eS5mb3JFYWNoKChzb3VyY2UpID0+IHtcbiAgICBzb3VyY2VzW3NvdXJjZV0uZm9yRWFjaCgoeyBsZWFkLCB0eXBlIH0pID0+IHtcbiAgICAgIGlmIChyb3dzLmxlbmd0aCA+PSBpbnB1dC5kZWZhdWx0cy5tYXhfaXRlbXMpIHJldHVybjtcbiAgICAgIGNvbnN0IG1lc3NhZ2VJbmZvID0gYnVpbGRNZXNzYWdlRm9yTGVhZCh0eXBlLCBsZWFkKTtcbiAgICAgIGNvbnN0IGRlZHVwZUtleSA9IGxlYWQuZGVkdXBlX2tleSB8fCBsZWFkLmRlZHVwZV9rZXlfcmF3IHx8IGxlYWQudXJsIHx8IGxlYWQud2Vic2l0ZSB8fCBsZWFkLm5hbWU7XG4gICAgICBjb25zdCByb3cgPSBidWlsZFJvdyh7XG4gICAgICAgIGxlYWQ6IHtcbiAgICAgICAgICAuLi5sZWFkLFxuICAgICAgICAgIG5hbWU6IGxlYWQubmFtZSB8fCBsZWFkLnRpdGxlIHx8IGxlYWQubGVhZF9uYW1lIHx8ICh0eXBlID09PSBcImhvdFwiID8gYEhvdCBsZWFkOiAke2xlYWQudGl0bGUgfHwgXCJcIn1gIDogXCJcIilcbiAgICAgICAgfSxcbiAgICAgICAgdHlwZSxcbiAgICAgICAgY2hhbm5lbDogbWVzc2FnZUluZm8uY2hhbm5lbCxcbiAgICAgICAgbWVzc2FnZTogbWVzc2FnZUluZm8ubWVzc2FnZSxcbiAgICAgICAgYm9keTogbWVzc2FnZUluZm8ubWVzc2FnZSxcbiAgICAgICAgc3ViamVjdDogbWVzc2FnZUluZm8uc3ViamVjdCxcbiAgICAgICAgcGVyc29uYWxpemF0aW9uOiBtZXNzYWdlSW5mby5wZXJzb25hbGl6YXRpb25UZXh0IHx8IHBlcnNvbmFsaXphdGlvbi50ZXh0LFxuICAgICAgICBzdGF0dXM6IGlucHV0LmRlZmF1bHRzLnN0YXR1c19kZWZhdWx0LFxuICAgICAgICBuZXh0RGF0ZSxcbiAgICAgICAgbmV4dFN0ZXBSZWFzb246IG1lc3NhZ2VJbmZvLm5leHRTdGVwUmVhc29uLFxuICAgICAgICBzb3VyY2VSZWZzOiB7XG4gICAgICAgICAgZnJvbV9tYXhpbTogdHlwZSA9PT0gXCJsb2NhbFwiLFxuICAgICAgICAgIGZyb21fZmVkb3I6IHR5cGUgPT09IFwiYjJiXCIsXG4gICAgICAgICAgZnJvbV9hcnRlbTogdHlwZSA9PT0gXCJob3RcIixcbiAgICAgICAgICBmcm9tX2FuYXRvbHk6IEJvb2xlYW4oaW5wdXRzLmFuYXRvbHlfYWNjb3VudF9qc29uKSxcbiAgICAgICAgICBmcm9tX2xlb25pZDogQm9vbGVhbihsZW9uaWRNZXNzYWdlKSxcbiAgICAgICAgICBmcm9tX2VtZWx5YW46IEJvb2xlYW4oZW1lbHlhbkVtYWlsKVxuICAgICAgICB9LFxuICAgICAgICBncm91bmRpbmdSZWZzOiBtZXNzYWdlSW5mby5ncm91bmRpbmdSZWZzLFxuICAgICAgICBuZWVkc1JldmlldzogbWVzc2FnZUluZm8ubmVlZHNSZXZpZXcsXG4gICAgICAgIGZvbGxvd3VwVGVtcGxhdGVzOiBtZXNzYWdlSW5mby5mb2xsb3d1cFRlbXBsYXRlcyxcbiAgICAgICAgYmF0Y2hLZXk6IGAke21lc3NhZ2VJbmZvLmNoYW5uZWx9fCR7dHlwZX1gLFxuICAgICAgICBvcGVyYXRvck5vdGVzOiBtZXNzYWdlSW5mby5vcGVyYXRvck5vdGVzIHx8IChsZWFkLm5vdGVzID8gU3RyaW5nKGxlYWQubm90ZXMpIDogXCJcIiksXG4gICAgICAgIGRlZHVwZV9rZXk6IGRlZHVwZUtleVxuICAgICAgfSk7XG4gICAgICBwdXNoUm93KHJvdyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGNvbnN0IGNvbHVtbnMgPSBbXG4gICAgXCJsZWFkX2lkXCIsXG4gICAgXCJsZWFkX25hbWVcIixcbiAgICBcImNoYW5uZWxcIixcbiAgICBcImNvbnRhY3RcIixcbiAgICBcImNpdHlcIixcbiAgICBcImNhdGVnb3J5XCIsXG4gICAgXCJwZXJzb25hbGl6YXRpb25cIixcbiAgICBcInN1YmplY3RcIixcbiAgICBcImJvZHlcIixcbiAgICBcIm1lc3NhZ2VcIixcbiAgICBcInN0YXR1c1wiLFxuICAgIFwibmV4dF9zdGVwXCIsXG4gICAgXCJuZXh0X3N0ZXBfcmVhc29uXCIsXG4gICAgXCJuZXh0X2ZvbGxvd3VwX2RhdGVcIixcbiAgICBcImJhdGNoX2tleVwiLFxuICAgIFwib3BlcmF0b3Jfbm90ZXNcIixcbiAgICBcImRlZHVwZV9rZXlcIlxuICBdO1xuXG4gIGNvbnN0IGNzdlJvd3MgPSByb3dzLm1hcCgocm93KSA9PiAoe1xuICAgIC4uLnJvdyxcbiAgICBjb250YWN0OiBKU09OLnN0cmluZ2lmeShyb3cuY29udGFjdCA/PyB7fSlcbiAgfSkpO1xuXG4gIGNvbnN0IGNzdiA9IGJ1aWxkQ3N2KGNzdlJvd3MsIGNvbHVtbnMpO1xuICBjb25zdCByZWFkeUNvdW50ID0gcm93cy5maWx0ZXIoKHJvdykgPT4gcm93LnN0YXR1cyA9PT0gXCJSRUFEWVwiKS5sZW5ndGg7XG4gIGNvbnN0IGJ5Q2hhbm5lbCA9IHJvd3MucmVkdWNlKChhY2MsIHJvdykgPT4ge1xuICAgIGFjY1tyb3cuY2hhbm5lbF0gPSAoYWNjW3Jvdy5jaGFubmVsXSA/PyAwKSArIDE7XG4gICAgcmV0dXJuIGFjYztcbiAgfSwge30pO1xuICBjb25zdCBuZWVkc1Jldmlld0NvdW50ID0gcm93cy5maWx0ZXIoKHJvdykgPT4gcm93Lm5lZWRzUmV2aWV3KS5sZW5ndGg7XG5cbiAgY29uc3Qgb3V0cHV0ID0ge1xuICAgIGJkcl90YWJsZTogcm93cyxcbiAgICBtZXRhOiB7XG4gICAgICBnZW5lcmF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIHN0YXRzOiB7XG4gICAgICAgIHRvdGFsX3Jvd3M6IHJvd3MubGVuZ3RoLFxuICAgICAgICByZWFkeV9jb3VudDogcmVhZHlDb3VudCxcbiAgICAgICAgYnlfY2hhbm5lbDogYnlDaGFubmVsLFxuICAgICAgICBuZWVkc19yZXZpZXdfY291bnQ6IG5lZWRzUmV2aWV3Q291bnRcbiAgICAgIH0sXG4gICAgICBsaW1pdGF0aW9uczogaGFuZG9mZk1pc21hdGNoID8gW1wiaGFuZG9mZiBmb3JtYXQgbWlzbWF0Y2hcIl0gOiBbXSxcbiAgICAgIGFzc3VtcHRpb25zOiBbXSxcbiAgICAgIG5lZWRzUmV2aWV3OiBoYW5kb2ZmTWlzbWF0Y2gsXG4gICAgICBzdGF0dXNfdHJhbnNpdGlvbl9ydWxlczoge1xuICAgICAgICB0cmFuc2l0aW9uczogW1xuICAgICAgICAgIHsgZnJvbTogXCJSRUFEWVwiLCB0bzogXCJTRU5UXCIsIHdoZW46IFwi0L7Qv9C10YDQsNGC0L7RgCDQvtGC0L/RgNCw0LLQuNC7INC/0LXRgNCy0L7QtSDRgdC+0L7QsdGJ0LXQvdC40LVcIiB9LFxuICAgICAgICAgIHsgZnJvbTogXCJTRU5UXCIsIHRvOiBcIk5PX1JFUExZXCIsIHdoZW46IFwi0L3QtdGCINC+0YLQstC10YLQsCDQv9C+0YHQu9C1IGZvbGxvd3VwIEQrOVwiIH0sXG4gICAgICAgICAgeyBmcm9tOiBcIk5PX1JFUExZXCIsIHRvOiBcIklOVEVSRVNURURcIiwgd2hlbjogXCLQv9C+0LvRg9GH0LXQvSDQvtGC0LLQtdGCINGBINC40L3RgtC10YDQtdGB0L7QvFwiIH1cbiAgICAgICAgXSxcbiAgICAgICAgbmV4dF9zdGVwX3JlYXNvbjogXCLQodGC0YDQvtC60LAg0YXRgNCw0L3QuNGC0YHRjyDQsiBiZHJfdGFibGVbXS5uZXh0X3N0ZXBfcmVhc29uLlwiXG4gICAgICB9LFxuICAgICAgcXVhbGl0eV9jaGVja3M6IHtcbiAgICAgICAgbm9fZmFicmljYXRpb246IHRydWUsXG4gICAgICAgIGRlZHVwZV9vazogZGVkdXBlLnNpemUgPT09IHJvd3MubGVuZ3RoLFxuICAgICAgICBoYXNfbWVzc2FnZXM6IHJvd3Muc29tZSgocm93KSA9PiByb3cubWVzc2FnZSlcbiAgICAgIH0sXG4gICAgICBleHBvcnRfaGVscGVyczoge1xuICAgICAgICBjb2x1bW5zLFxuICAgICAgICBjc3ZcbiAgICAgIH1cbiAgICB9XG4gIH07XG4gIGFwcGx5QnVkZ2V0TWV0YShvdXRwdXQubWV0YSwgaW5wdXQpO1xuXG4gIHJldHVybiB7IG91dHB1dDogd3JhcE91dHB1dChvdXRwdXQsIGlucHV0KSwgZWZmZWN0aXZlSW5wdXQ6IGlucHV0IH07XG59O1xuXG5jb25zdCBnZW5lcmF0ZUJvcmlzT3V0cHV0ID0gYXN5bmMgKGlucHV0ID0ge30sIG9wdGlvbnMgPSB7fSkgPT4ge1xuICBjb25zdCByZXN1bHQgPSBhd2FpdCBnZW5lcmF0ZU91dHB1dChpbnB1dCwgb3B0aW9ucyk7XG4gIHJldHVybiByZXN1bHQub3V0cHV0O1xufTtcblxuY29uc3QgdmFsaWRhdGVCb3Jpc091dHB1dCA9IChwYXlsb2FkKSA9PiB7XG4gIGNvbnN0IGVycm9ycyA9IFtdO1xuICBjb25zdCBsZWdhY3kgPSB1bndyYXBMZWdhY3kocGF5bG9hZCk7XG4gIGlmICghbGVnYWN5IHx8IHR5cGVvZiBsZWdhY3kgIT09IFwib2JqZWN0XCIpIHtcbiAgICByZXR1cm4geyB2YWxpZDogZmFsc2UsIGVycm9yczogW1wiT3V0cHV0IG11c3QgYmUgYW4gb2JqZWN0LlwiXSB9O1xuICB9XG4gIHBheWxvYWQgPSBsZWdhY3k7XG4gIGlmICghQXJyYXkuaXNBcnJheShwYXlsb2FkLmJkcl90YWJsZSkpIGVycm9ycy5wdXNoKFwiYmRyX3RhYmxlIG11c3QgYmUgYXJyYXlcIik7XG4gIGlmICghcGF5bG9hZC5tZXRhKSBlcnJvcnMucHVzaChcIm1ldGEgcmVxdWlyZWRcIik7XG4gIGlmIChBcnJheS5pc0FycmF5KHBheWxvYWQuYmRyX3RhYmxlKSkge1xuICAgIHBheWxvYWQuYmRyX3RhYmxlLmZvckVhY2goKHJvdywgaW5kZXgpID0+IHtcbiAgICAgIGlmICghcm93LmJhdGNoX2tleSB8fCB0eXBlb2Ygcm93LmJhdGNoX2tleSAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICBlcnJvcnMucHVzaChgYmRyX3RhYmxlWyR7aW5kZXh9XS5iYXRjaF9rZXkgcmVxdWlyZWRgKTtcbiAgICAgIH1cbiAgICAgIGlmICghQXJyYXkuaXNBcnJheShyb3cuZm9sbG93dXBfdGVtcGxhdGVzKSkge1xuICAgICAgICBlcnJvcnMucHVzaChgYmRyX3RhYmxlWyR7aW5kZXh9XS5mb2xsb3d1cF90ZW1wbGF0ZXMgbXVzdCBiZSBhcnJheWApO1xuICAgICAgfVxuICAgICAgaWYgKHR5cGVvZiByb3cuYm9keSAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICBlcnJvcnMucHVzaChgYmRyX3RhYmxlWyR7aW5kZXh9XS5ib2R5IHJlcXVpcmVkYCk7XG4gICAgICB9XG4gICAgICBpZiAodHlwZW9mIHJvdy5uZXh0X3N0ZXBfcmVhc29uICE9PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIGVycm9ycy5wdXNoKGBiZHJfdGFibGVbJHtpbmRleH1dLm5leHRfc3RlcF9yZWFzb24gcmVxdWlyZWRgKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICBpZiAoIXBheWxvYWQubWV0YT8uc3RhdHVzX3RyYW5zaXRpb25fcnVsZXMpIHtcbiAgICBlcnJvcnMucHVzaChcIm1ldGEuc3RhdHVzX3RyYW5zaXRpb25fcnVsZXMgcmVxdWlyZWRcIik7XG4gIH1cbiAgaWYgKHBheWxvYWQubWV0YT8uZXhwb3J0X2hlbHBlcnM/LmNvbHVtbnMpIHtcbiAgICBjb25zdCBjb2x1bW5zID0gcGF5bG9hZC5tZXRhLmV4cG9ydF9oZWxwZXJzLmNvbHVtbnM7XG4gICAgaWYgKCFjb2x1bW5zLmluY2x1ZGVzKFwic3ViamVjdFwiKSB8fCAhY29sdW1ucy5pbmNsdWRlcyhcImJvZHlcIikpIHtcbiAgICAgIGVycm9ycy5wdXNoKFwiZXhwb3J0X2hlbHBlcnMuY29sdW1ucyBtdXN0IGluY2x1ZGUgc3ViamVjdCBhbmQgYm9keVwiKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHsgdmFsaWQ6IGVycm9ycy5sZW5ndGggPT09IDAsIGVycm9ycyB9O1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIGlucHV0RGVmYXVsdHMsXG4gIGlucHV0U2NoZW1hLFxuICBvdXRwdXRTY2hlbWEsXG4gIHN5c3RlbVByb21wdCxcbiAgYm9yaXNBZ2VudCxcbiAgbm9ybWFsaXplSW5wdXQsXG4gIGdlbmVyYXRlT3V0cHV0LFxuICBnZW5lcmF0ZUJvcmlzT3V0cHV0LFxuICB2YWxpZGF0ZUJvcmlzT3V0cHV0XG59O1xuIl0sIm5hbWVzIjpbImNyeXB0byIsInJlcXVpcmUiLCJjYW5vbmljYWxpemVVcmwiLCJ3cmFwQWdlbnRPdXRwdXQiLCJ1bndyYXBMZWdhY3kiLCJhcHBseUJ1ZGdldCIsImFwcGx5QnVkZ2V0TWV0YSIsImlucHV0RGVmYXVsdHMiLCJtb2RlIiwicHJpbWFyeV9jaGFubmVsIiwiZ29hbCIsInNjaGVkdWxpbmciLCJmb2xsb3d1cF9kYXlzIiwidGltZXpvbmUiLCJkZWZhdWx0cyIsInN0YXR1c19kZWZhdWx0IiwibWF4X2l0ZW1zIiwiaW5wdXRzIiwibWF4aW1fbGVhZHNfanNvbiIsImZlZG9yX2xlYWRzX2pzb24iLCJhcnRlbV9ob3RfanNvbiIsImFuYXRvbHlfYWNjb3VudF9qc29uIiwibGVvbmlkX2RtX2pzb24iLCJlbWVseWFuX2VtYWlsX2pzb24iLCJtYXBwaW5nX3J1bGVzIiwicHJlZmVyX2hvdF9vdmVyX2NvbGQiLCJwcmVmZXJfZG1fb3Zlcl9lbWFpbF9mb3JfbG9jYWwiLCJsYW5ndWFnZSIsImlucHV0U2NoZW1hIiwidHlwZSIsImFkZGl0aW9uYWxQcm9wZXJ0aWVzIiwicHJvcGVydGllcyIsImVudW0iLCJkZWZhdWx0IiwiaXRlbXMiLCJyZXF1aXJlZCIsIm91dHB1dFNjaGVtYSIsImJkcl90YWJsZSIsIm1ldGEiLCJzeXN0ZW1Qcm9tcHQiLCJib3Jpc0FnZW50IiwiaWQiLCJkaXNwbGF5TmFtZSIsImRlc2NyaXB0aW9uIiwid3JhcE91dHB1dCIsImxlZ2FjeU91dHB1dCIsImlucHV0IiwiYWdlbnRJZCIsImlucHV0RWNobyIsInVud3JhcFBheWxvYWQiLCJwYXlsb2FkIiwiZGF0YSIsInJlYWRQYXRoIiwib2JqIiwicGF0aCIsInVuZGVmaW5lZCIsImtleXMiLCJTdHJpbmciLCJzcGxpdCIsImZpbHRlciIsIkJvb2xlYW4iLCJjdXJzb3IiLCJrZXkiLCJBcnJheSIsImlzQXJyYXkiLCJwaWNrRmlyc3REZWZpbmVkIiwicGF0aHMiLCJ2YWx1ZSIsImV4dHJhY3RIYW5kb2ZmIiwiaGFuZG9mZiIsImhhc0JvcmlzQ29tcGF0IiwiY29tcGF0IiwiaW5jbHVkZXMiLCJub3JtYWxpemVJbnB1dCIsInNhZmUiLCJidWRnZXQiLCJtZXJnZWRJbnB1dHMiLCJub3JtYWxpemVkIiwibWFwIiwiaXRlbSIsIk51bWJlciIsImlzRmluaXRlIiwidHJpbSIsIk1hdGgiLCJtYXgiLCJyb3VuZCIsImJ1ZGdldFJlc3VsdCIsIm1heEl0ZW1zUGF0aHMiLCJidWRnZXRfYXBwbGllZCIsImJ1ZGdldF93YXJuaW5ncyIsIndhcm5pbmdzIiwiZ2V0RGF0ZUluVGltZVpvbmUiLCJkYXRlIiwidGltZVpvbmUiLCJmb3JtYXR0ZXIiLCJJbnRsIiwiRGF0ZVRpbWVGb3JtYXQiLCJ5ZWFyIiwibW9udGgiLCJkYXkiLCJmb3JtYXQiLCJhZGREYXlzIiwiZGF5cyIsIkRhdGUiLCJnZXRUaW1lIiwidG9DaGFubmVsTGFiZWwiLCJwcmltYXJ5Q2hhbm5lbCIsImxlYWRTb3VyY2UiLCJoYXNoSWQiLCJjcmVhdGVIYXNoIiwidXBkYXRlIiwiZGlnZXN0Iiwic2xpY2UiLCJlc2NhcGVDc3YiLCJzdHJpbmdWYWx1ZSIsInRlc3QiLCJyZXBsYWNlIiwiYnVpbGRDc3YiLCJyb3dzIiwiY29sdW1ucyIsImhlYWRlciIsImpvaW4iLCJsaW5lcyIsInJvdyIsImNvbCIsIm5vcm1hbGl6ZURtTWVzc2FnZSIsInRleHQiLCJwZXJzb25hbGl6YXRpb25fbGluZSIsImdyb3VuZGluZ19yZWZzIiwiYm9keSIsIm1lc3NhZ2UiLCJwaWNrRG1NZXNzYWdlIiwibGVvbmlkSnNvbiIsImRtUGFjayIsImRtX3BhY2siLCJtZXNzYWdlc19wYWNrIiwidmFyaWFudHMiLCJjYW5kaWRhdGVzIiwibWVzc2FnZXMiLCJmaXJzdF9tZXNzYWdlIiwiZmlyc3RNZXNzYWdlIiwiY2FuZGlkYXRlIiwibm9ybWFsaXplRW1haWxNZXNzYWdlIiwiZGF5X29mZnNldCIsInN1YmplY3QiLCJ0aXRsZSIsInBpY2tFbWFpbE1lc3NhZ2UiLCJlbWVseWFuSnNvbiIsInNlcXVlbmNlcyIsImZpcnN0U2VxdWVuY2UiLCJsZW5ndGgiLCJmaXJzdEVtYWlsIiwiZW1haWxzIiwiZmlyc3RfZW1haWwiLCJwcmltYXJ5X2VtYWlsIiwiZW1haWwiLCJwaWNrRG1Gb2xsb3d1cHMiLCJmb2xsb3d1cHMiLCJsaXN0IiwicGlja0VtYWlsRm9sbG93dXBzIiwiZW1haWxfc2VxdWVuY2VzIiwiZW1haWxzQ2FuZGlkYXRlIiwiYnVpbGREZWZhdWx0Rm9sbG93dXBUZW1wbGF0ZXMiLCJjaGFubmVsIiwiZXh0cmFjdFBlcnNvbmFsaXphdGlvbiIsImFuYXRvbHlKc29uIiwiYXJ0ZW1Kc29uIiwibGVvbmlkTWVzc2FnZSIsInJlZnMiLCJhY2NvdW50X2NhcmQiLCJob29rIiwidG9wX3BlcnNvbmFsaXphdGlvbl9ob29rcyIsImhvb2tfdGV4dCIsInJlbGF0ZWRfcHJvb2ZzIiwiaG90X2xlYWRzIiwibGVhZCIsImhvdF9yZWFzb25zIiwicHJvb2ZfcmVmcyIsImJ1aWxkTWluaW1hbFRlbXBsYXRlIiwicGVyc29uYWxpemF0aW9uIiwiaW50cm8iLCJsaW5lIiwiYnVpbGRSb3ciLCJzdGF0dXMiLCJuZXh0RGF0ZSIsIm5leHRTdGVwUmVhc29uIiwic291cmNlUmVmcyIsImdyb3VuZGluZ1JlZnMiLCJuZWVkc1JldmlldyIsImZvbGxvd3VwVGVtcGxhdGVzIiwiYmF0Y2hLZXkiLCJvcGVyYXRvck5vdGVzIiwicmF3S2V5IiwiZGVkdXBlX2tleSIsImRlZHVwZV9rZXlfcmF3IiwidXJsIiwid2Vic2l0ZSIsInBob25lIiwibmFtZSIsImRlZHVwZUtleSIsImxlYWRJZCIsImxlYWRfaWQiLCJsZWFkX25hbWUiLCJjb250YWN0IiwiY2FyZF91cmwiLCJjaXR5IiwiY2F0ZWdvcnkiLCJjYXRlZ29yeV9oaW50IiwibmV4dF9zdGVwIiwibmV4dF9zdGVwX3JlYXNvbiIsIm5leHRfZm9sbG93dXBfZGF0ZSIsImZvbGxvd3VwX3RlbXBsYXRlcyIsImJhdGNoX2tleSIsIm9wZXJhdG9yX25vdGVzIiwic291cmNlX3JlZnMiLCJnZW5lcmF0ZU91dHB1dCIsInJhd0lucHV0Iiwib3B0aW9ucyIsImhhc0FueUlucHV0Iiwib3V0cHV0IiwiZ2VuZXJhdGVkX2F0IiwidG9JU09TdHJpbmciLCJzdGF0cyIsInRvdGFsX3Jvd3MiLCJyZWFkeV9jb3VudCIsImJ5X2NoYW5uZWwiLCJuZWVkc19yZXZpZXdfY291bnQiLCJsaW1pdGF0aW9ucyIsImFzc3VtcHRpb25zIiwic3RhdHVzX3RyYW5zaXRpb25fcnVsZXMiLCJ0cmFuc2l0aW9ucyIsImZyb20iLCJ0byIsIndoZW4iLCJxdWFsaXR5X2NoZWNrcyIsIm5vX2ZhYnJpY2F0aW9uIiwiZGVkdXBlX29rIiwiaGFzX21lc3NhZ2VzIiwiZXhwb3J0X2hlbHBlcnMiLCJjc3YiLCJlZmZlY3RpdmVJbnB1dCIsInJhd1BheWxvYWRzIiwiaGFuZG9mZklzc3VlcyIsImZvckVhY2giLCJ2ZXJzaW9uIiwicHVzaCIsImhhbmRvZmZNaXNtYXRjaCIsIm5vcm1hbGl6ZWRJbnB1dHMiLCJleHRyYWN0TGVhZHMiLCJleHRyYWN0SG90TGVhZHMiLCJtYXhpbUxlYWRzIiwiZmVkb3JMZWFkcyIsImhvdExlYWRzIiwiZW1lbHlhbkVtYWlsIiwiZG1Gb2xsb3d1cHMiLCJlbWFpbEZvbGxvd3VwcyIsInNjaGVkdWxpbmdEYXlzIiwiZGVkdXBlIiwiU2V0IiwicHVzaFJvdyIsImhhcyIsImFkZCIsInByZWZlckhvdCIsInNvdXJjZVByaW9yaXR5Iiwic291cmNlcyIsImhvdCIsImxvY2FsIiwiYjJiIiwiYnVpbGRNZXNzYWdlRm9yTGVhZCIsImxlYWRUeXBlIiwiY2hhbm5lbFByZWZlcmVuY2UiLCJoYXNEbSIsImhhc0VtYWlsIiwicGVyc29uYWxpemF0aW9uVGV4dCIsInNvdXJjZSIsIm1lc3NhZ2VJbmZvIiwiZnJvbV9tYXhpbSIsImZyb21fZmVkb3IiLCJmcm9tX2FydGVtIiwiZnJvbV9hbmF0b2x5IiwiZnJvbV9sZW9uaWQiLCJmcm9tX2VtZWx5YW4iLCJub3RlcyIsImNzdlJvd3MiLCJKU09OIiwic3RyaW5naWZ5IiwicmVhZHlDb3VudCIsImJ5Q2hhbm5lbCIsInJlZHVjZSIsImFjYyIsIm5lZWRzUmV2aWV3Q291bnQiLCJzaXplIiwic29tZSIsImdlbmVyYXRlQm9yaXNPdXRwdXQiLCJyZXN1bHQiLCJ2YWxpZGF0ZUJvcmlzT3V0cHV0IiwiZXJyb3JzIiwibGVnYWN5IiwidmFsaWQiLCJpbmRleCIsIm1vZHVsZSIsImV4cG9ydHMiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/agents/boris.js\n");

/***/ }),

/***/ "(rsc)/./lib/agents/webClient.js":
/*!*********************************!*\
  !*** ./lib/agents/webClient.js ***!
  \*********************************/
/***/ ((module) => {

eval("\nconst sleep = (ms)=>new Promise((resolve)=>setTimeout(resolve, ms));\nconst USER_AGENTS = [\n    \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36\",\n    \"Mozilla/5.0 (Macintosh; Intel Mac OS X 13_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36\",\n    \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36\",\n    \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:122.0) Gecko/20100101 Firefox/122.0\",\n    \"Mozilla/5.0 (Macintosh; Intel Mac OS X 14_1; rv:121.0) Gecko/20100101 Firefox/121.0\",\n    \"Mozilla/5.0 (iPhone; CPU iPhone OS 17_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.1 Mobile/15E148 Safari/604.1\"\n];\nconst DEFAULT_HEADERS = {\n    Accept: \"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\",\n    \"Accept-Language\": \"ru-RU,ru;q=0.9,en;q=0.8\",\n    \"Cache-Control\": \"no-cache\",\n    Pragma: \"no-cache\"\n};\nconst stripHtml = (html)=>{\n    return html.replace(/<script[\\s\\S]*?<\\/script>/gi, \" \").replace(/<style[\\s\\S]*?<\\/style>/gi, \" \").replace(/<noscript[\\s\\S]*?<\\/noscript>/gi, \" \").replace(/<[^>]+>/g, \" \").replace(/&nbsp;/gi, \" \").replace(/&amp;/gi, \"&\").replace(/\\s+/g, \" \").trim();\n};\nconst extractTitle = (html)=>{\n    const match = html.match(/<title[^>]*>([^<]+)<\\/title>/i);\n    return match ? match[1].trim() : \"\";\n};\nconst extractLinks = (html)=>{\n    const links = [];\n    const regex = /href\\s*=\\s*[\"']([^\"']+)[\"']/gi;\n    let match = null;\n    while(match = regex.exec(html)){\n        const href = match[1];\n        if (href.startsWith(\"http\")) {\n            links.push(href);\n        }\n    }\n    return links;\n};\nconst decodeYandexRedirect = (url)=>{\n    try {\n        const parsed = new URL(url);\n        const target = parsed.searchParams.get(\"url\");\n        return target ? decodeURIComponent(target) : url;\n    } catch  {\n        return url;\n    }\n};\nconst extractRobotsRules = (content)=>{\n    const lines = content.split(\"\\n\").map((line)=>line.trim());\n    let apply = false;\n    const disallow = [];\n    for (const line of lines){\n        if (!line || line.startsWith(\"#\")) continue;\n        const [rawKey, rawValue] = line.split(\":\");\n        if (!rawKey || rawValue === undefined) continue;\n        const key = rawKey.trim().toLowerCase();\n        const value = rawValue.trim();\n        if (key === \"user-agent\") {\n            apply = value === \"*\";\n        } else if (apply && key === \"disallow\") {\n            disallow.push(value);\n        }\n    }\n    return disallow;\n};\nconst canonicalizeUrl = (url)=>{\n    try {\n        const parsed = new URL(url);\n        parsed.protocol = \"https:\";\n        const paramsToRemove = [];\n        parsed.searchParams.forEach((_, key)=>{\n            const lower = key.toLowerCase();\n            if (lower.startsWith(\"utm_\") || [\n                \"gclid\",\n                \"yclid\",\n                \"fbclid\",\n                \"ref\",\n                \"from\"\n            ].includes(lower)) {\n                paramsToRemove.push(key);\n            }\n        });\n        paramsToRemove.forEach((key)=>parsed.searchParams.delete(key));\n        let hostname = parsed.hostname.toLowerCase().replace(/^www\\./, \"\");\n        parsed.hostname = hostname;\n        if (hostname === \"t.me\" || hostname === \"telegram.me\") {\n            let path = parsed.pathname.replace(/\\/+$/, \"\");\n            if (path.startsWith(\"/s/\")) path = path.slice(2);\n            parsed.pathname = path || \"/\";\n            parsed.search = \"\";\n            return `https://t.me${parsed.pathname}`;\n        }\n        if (hostname === \"vk.com\") {\n            const parts = parsed.pathname.split(\"/\").filter(Boolean);\n            parsed.pathname = parts.length ? `/${parts[0]}` : \"/\";\n            parsed.search = \"\";\n            return parsed.toString().replace(/\\/$/, \"\");\n        }\n        parsed.pathname = parsed.pathname.replace(/\\/+$/, \"\") || \"/\";\n        parsed.hash = \"\";\n        return parsed.toString();\n    } catch  {\n        return url;\n    }\n};\nconst getDomain = (url)=>{\n    try {\n        return new URL(url).hostname.replace(/^www\\\\./, \"\").toLowerCase();\n    } catch  {\n        return \"\";\n    }\n};\nclass WebClient {\n    constructor(options){\n        this.maxRequests = options.maxRequests;\n        this.minDelayMs = options.minDelayMs ?? 600;\n        this.userAgents = options.userAgents ?? USER_AGENTS;\n        this.timeoutMs = options.timeoutMs ?? 15000;\n        this.searchTimeoutMs = options.searchTimeoutMs ?? 12000;\n        this.lastRequestAt = 0;\n        this.startTime = Date.now();\n        this.stats = {\n            requests_made: 0,\n            blocked_count: 0,\n            errors_count: 0,\n            duration_ms: 0,\n            top_errors: [],\n            warnings: []\n        };\n        this.robotsCache = new Map();\n        this.domainFailures = new Map();\n        this.domainCooldown = new Map();\n        this.consecutiveRateLimit = 0;\n        this.lowTrafficMode = false;\n        this.trace = [];\n        this.errorCounts = new Map();\n    }\n    getStats() {\n        return {\n            ...this.stats,\n            duration_ms: Date.now() - this.startTime\n        };\n    }\n    getTrace() {\n        return [\n            ...this.trace\n        ];\n    }\n    recordWarning(message) {\n        if (!this.stats.warnings.includes(message)) {\n            this.stats.warnings.push(message);\n        }\n    }\n    recordError(domain, code) {\n        if (!domain) return;\n        const key = `${domain}:${code || \"ERR\"}`;\n        const next = (this.errorCounts.get(key) ?? 0) + 1;\n        this.errorCounts.set(key, next);\n        const entries = Array.from(this.errorCounts.entries()).map(([entryKey, count])=>{\n            const [entryDomain, entryCode] = entryKey.split(\":\");\n            return {\n                domain: entryDomain,\n                code: entryCode,\n                count\n            };\n        }).sort((a, b)=>b.count - a.count).slice(0, 5);\n        this.stats.top_errors = entries;\n    }\n    async throttle() {\n        const delay = this.lowTrafficMode ? Math.max(this.minDelayMs, 2000) : this.minDelayMs;\n        const diff = Date.now() - this.lastRequestAt;\n        if (diff < delay) {\n            await sleep(delay - diff);\n        }\n        this.lastRequestAt = Date.now();\n    }\n    async fetchWithLimit(url, options = {}) {\n        if (this.stats.requests_made >= this.maxRequests) {\n            throw new Error(\"WEB_REQUEST_LIMIT\");\n        }\n        await this.throttle();\n        this.stats.requests_made += 1;\n        const userAgent = this.userAgents[Math.floor(Math.random() * this.userAgents.length)];\n        const headers = {\n            ...DEFAULT_HEADERS,\n            ...options.headers || {},\n            \"User-Agent\": userAgent\n        };\n        const domain = getDomain(url);\n        let attempt = 0;\n        let lastError = null;\n        while(attempt < 3){\n            const controller = new AbortController();\n            const timeoutMs = options.timeoutMs ?? this.timeoutMs;\n            const timeout = setTimeout(()=>controller.abort(), timeoutMs);\n            try {\n                const response = await fetch(url, {\n                    cache: \"no-store\",\n                    headers,\n                    signal: controller.signal\n                });\n                const text = await response.text();\n                clearTimeout(timeout);\n                if ([\n                    429,\n                    503,\n                    520,\n                    522\n                ].includes(response.status)) {\n                    this.consecutiveRateLimit += 1;\n                    this.recordError(domain, response.status);\n                    if (this.consecutiveRateLimit >= 2 && !this.lowTrafficMode) {\n                        this.lowTrafficMode = true;\n                        this.recordWarning(\"rate-limited, switched to low-traffic mode\");\n                        this.maxRequests = Math.max(10, Math.floor(this.maxRequests * 0.8));\n                    }\n                    const delay = Math.min(8000, 400 * 2 ** attempt);\n                    const jitter = delay * (0.5 + Math.random());\n                    await sleep(jitter);\n                    attempt += 1;\n                    continue;\n                }\n                this.consecutiveRateLimit = 0;\n                return {\n                    ok: response.ok,\n                    status: response.status,\n                    text\n                };\n            } catch (error) {\n                clearTimeout(timeout);\n                lastError = error;\n                this.stats.errors_count += 1;\n                this.recordError(domain, \"FETCH\");\n                const delay = Math.min(8000, 400 * 2 ** attempt);\n                const jitter = delay * (0.5 + Math.random());\n                await sleep(jitter);\n                attempt += 1;\n            }\n        }\n        if (lastError) throw lastError;\n        throw new Error(\"FETCH_FAILED\");\n    }\n    async canFetch(url) {\n        try {\n            const parsed = new URL(url);\n            const domain = parsed.origin;\n            if (!this.robotsCache.has(domain)) {\n                try {\n                    const robotsUrl = `${domain}/robots.txt`;\n                    const response = await this.fetchWithLimit(robotsUrl);\n                    if (!response.ok) {\n                        this.robotsCache.set(domain, []);\n                    } else {\n                        const disallow = extractRobotsRules(response.text);\n                        this.robotsCache.set(domain, disallow);\n                    }\n                } catch  {\n                    this.robotsCache.set(domain, []);\n                }\n            }\n            const rules = this.robotsCache.get(domain) ?? [];\n            const path = parsed.pathname;\n            if (rules.includes(\"/\")) {\n                return false;\n            }\n            return !rules.some((rule)=>rule && path.startsWith(rule));\n        } catch  {\n            return false;\n        }\n    }\n    async fetchPage(url, options = {}) {\n        const canonicalUrl = canonicalizeUrl(url);\n        const domain = getDomain(canonicalUrl);\n        const cooldownUntil = this.domainCooldown.get(domain);\n        if (cooldownUntil && cooldownUntil > Date.now()) {\n            this.stats.blocked_count += 1;\n            this.stats.errors_count += 1;\n            this.recordError(domain, \"COOLDOWN\");\n            return {\n                blocked: true,\n                url: canonicalUrl\n            };\n        }\n        const allowed = await this.canFetch(canonicalUrl);\n        if (!allowed) {\n            this.stats.blocked_count += 1;\n            this.stats.errors_count += 1;\n            this.recordError(domain, \"ROBOTS\");\n            return {\n                blocked: true,\n                url: canonicalUrl\n            };\n        }\n        this.trace.push({\n            domain,\n            type: options.type || \"page\"\n        });\n        let response;\n        try {\n            response = await this.fetchWithLimit(canonicalUrl, {\n                timeoutMs: options.timeoutMs\n            });\n        } catch (error) {\n            const failures = (this.domainFailures.get(domain) ?? 0) + 1;\n            this.domainFailures.set(domain, failures);\n            if (failures >= 5) {\n                this.domainCooldown.set(domain, Date.now() + 10 * 60 * 1000);\n                this.recordWarning(`circuit-breaker:${domain}`);\n            }\n            this.stats.errors_count += 1;\n            this.recordError(domain, \"FETCH\");\n            return {\n                blocked: true,\n                url: canonicalUrl\n            };\n        }\n        if (!response.ok) {\n            this.stats.errors_count += 1;\n            this.recordError(domain, response.status);\n            const failures = (this.domainFailures.get(domain) ?? 0) + 1;\n            this.domainFailures.set(domain, failures);\n            if (failures >= 5) {\n                this.domainCooldown.set(domain, Date.now() + 10 * 60 * 1000);\n                this.recordWarning(`circuit-breaker:${domain}`);\n            }\n            return {\n                blocked: true,\n                url: canonicalUrl\n            };\n        }\n        this.domainFailures.set(domain, 0);\n        const html = response.text;\n        const title = extractTitle(html);\n        const text = stripHtml(html);\n        return {\n            url: canonicalUrl,\n            title,\n            html,\n            text\n        };\n    }\n    async search(query, engine = \"yandex\", limit = 5) {\n        const searchUrl = engine === \"yandex\" ? `https://yandex.ru/search/?text=${encodeURIComponent(query)}` : `https://duckduckgo.com/html/?q=${encodeURIComponent(query)}`;\n        const page = await this.fetchPage(searchUrl, {\n            timeoutMs: this.searchTimeoutMs,\n            type: \"search\"\n        });\n        if (\"blocked\" in page) {\n            return [];\n        }\n        const links = extractLinks(page.html).map((link)=>link.includes(\"yandex\") ? decodeYandexRedirect(link) : link).filter((link)=>link.startsWith(\"http\"));\n        const results = [];\n        const seen = new Set();\n        for (const link of links){\n            if (results.length >= limit) break;\n            try {\n                const url = new URL(link);\n                if (url.hostname.includes(\"yandex\") || url.hostname.includes(\"duckduckgo\")) {\n                    continue;\n                }\n            } catch  {\n                continue;\n            }\n            if (seen.has(link)) continue;\n            seen.add(link);\n            results.push({\n                url: canonicalizeUrl(link),\n                title: page.title,\n                snippet: query,\n                query,\n                engine,\n                source_url: searchUrl\n            });\n        }\n        return results;\n    }\n}\nmodule.exports = {\n    WebClient,\n    canonicalizeUrl\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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U0FBUyxDQUFDVyxXQUFXO1lBQzNDdEYsV0FBVyxJQUFJLENBQUNDLGVBQWU7WUFDL0IrRSxNQUFNO1FBQ1I7UUFDQSxJQUFJLGFBQWFRLE1BQU07WUFDckIsT0FBTyxFQUFFO1FBQ1g7UUFFQSxNQUFNN0ksUUFBUUQsYUFBYThJLEtBQUtuSixJQUFJLEVBQ2pDd0IsR0FBRyxDQUFDLENBQUM0SCxPQUFVQSxLQUFLNUcsUUFBUSxDQUFDLFlBQVk1QixxQkFBcUJ3SSxRQUFRQSxNQUN0RXBHLE1BQU0sQ0FBQyxDQUFDb0csT0FBU0EsS0FBSzFJLFVBQVUsQ0FBQztRQUVwQyxNQUFNMkksVUFBVSxFQUFFO1FBQ2xCLE1BQU1DLE9BQU8sSUFBSUM7UUFFakIsS0FBSyxNQUFNSCxRQUFROUksTUFBTztZQUN4QixJQUFJK0ksUUFBUW5HLE1BQU0sSUFBSThGLE9BQU87WUFDN0IsSUFBSTtnQkFDRixNQUFNbkksTUFBTSxJQUFJRSxJQUFJcUk7Z0JBQ3BCLElBQUl2SSxJQUFJNkIsUUFBUSxDQUFDRixRQUFRLENBQUMsYUFBYTNCLElBQUk2QixRQUFRLENBQUNGLFFBQVEsQ0FBQyxlQUFlO29CQUMxRTtnQkFDRjtZQUNGLEVBQUUsT0FBTTtnQkFDTjtZQUNGO1lBQ0EsSUFBSThHLEtBQUtyQixHQUFHLENBQUNtQixPQUFPO1lBQ3BCRSxLQUFLRSxHQUFHLENBQUNKO1lBQ1RDLFFBQVExSSxJQUFJLENBQUM7Z0JBQ1hFLEtBQUtxQixnQkFBZ0JrSDtnQkFDckJQLE9BQU9NLEtBQUtOLEtBQUs7Z0JBQ2pCWSxTQUFTWDtnQkFDVEE7Z0JBQ0FDO2dCQUNBVyxZQUFZVDtZQUNkO1FBQ0Y7UUFFQSxPQUFPSTtJQUNUO0FBQ0Y7QUFFQU0sT0FBT0MsT0FBTyxHQUFHO0lBQ2Z0RztJQUNBcEI7QUFDRiIsInNvdXJjZXMiOlsiL1VzZXJzL2FidXphZGEvRGVza3RvcC9hZ2VudE9TL2xpYi9hZ2VudHMvd2ViQ2xpZW50LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHNsZWVwID0gKG1zKSA9PiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCBtcykpO1xuXG5jb25zdCBVU0VSX0FHRU5UUyA9IFtcbiAgXCJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTIyLjAuMC4wIFNhZmFyaS81MzcuMzZcIixcbiAgXCJNb3ppbGxhLzUuMCAoTWFjaW50b3NoOyBJbnRlbCBNYWMgT1MgWCAxM181KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTIxLjAuMC4wIFNhZmFyaS81MzcuMzZcIixcbiAgXCJNb3ppbGxhLzUuMCAoWDExOyBMaW51eCB4ODZfNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMjAuMC4wLjAgU2FmYXJpLzUzNy4zNlwiLFxuICBcIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQ7IHJ2OjEyMi4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzEyMi4wXCIsXG4gIFwiTW96aWxsYS81LjAgKE1hY2ludG9zaDsgSW50ZWwgTWFjIE9TIFggMTRfMTsgcnY6MTIxLjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvMTIxLjBcIixcbiAgXCJNb3ppbGxhLzUuMCAoaVBob25lOyBDUFUgaVBob25lIE9TIDE3XzEgbGlrZSBNYWMgT1MgWCkgQXBwbGVXZWJLaXQvNjA1LjEuMTUgKEtIVE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzE3LjEgTW9iaWxlLzE1RTE0OCBTYWZhcmkvNjA0LjFcIlxuXTtcblxuY29uc3QgREVGQVVMVF9IRUFERVJTID0ge1xuICBBY2NlcHQ6IFwidGV4dC9odG1sLGFwcGxpY2F0aW9uL3hodG1sK3htbCxhcHBsaWNhdGlvbi94bWw7cT0wLjksKi8qO3E9MC44XCIsXG4gIFwiQWNjZXB0LUxhbmd1YWdlXCI6IFwicnUtUlUscnU7cT0wLjksZW47cT0wLjhcIixcbiAgXCJDYWNoZS1Db250cm9sXCI6IFwibm8tY2FjaGVcIixcbiAgUHJhZ21hOiBcIm5vLWNhY2hlXCJcbn07XG5cbmNvbnN0IHN0cmlwSHRtbCA9IChodG1sKSA9PiB7XG4gIHJldHVybiBodG1sXG4gICAgLnJlcGxhY2UoLzxzY3JpcHRbXFxzXFxTXSo/PFxcL3NjcmlwdD4vZ2ksIFwiIFwiKVxuICAgIC5yZXBsYWNlKC88c3R5bGVbXFxzXFxTXSo/PFxcL3N0eWxlPi9naSwgXCIgXCIpXG4gICAgLnJlcGxhY2UoLzxub3NjcmlwdFtcXHNcXFNdKj88XFwvbm9zY3JpcHQ+L2dpLCBcIiBcIilcbiAgICAucmVwbGFjZSgvPFtePl0rPi9nLCBcIiBcIilcbiAgICAucmVwbGFjZSgvJm5ic3A7L2dpLCBcIiBcIilcbiAgICAucmVwbGFjZSgvJmFtcDsvZ2ksIFwiJlwiKVxuICAgIC5yZXBsYWNlKC9cXHMrL2csIFwiIFwiKVxuICAgIC50cmltKCk7XG59O1xuXG5jb25zdCBleHRyYWN0VGl0bGUgPSAoaHRtbCkgPT4ge1xuICBjb25zdCBtYXRjaCA9IGh0bWwubWF0Y2goLzx0aXRsZVtePl0qPihbXjxdKyk8XFwvdGl0bGU+L2kpO1xuICByZXR1cm4gbWF0Y2ggPyBtYXRjaFsxXS50cmltKCkgOiBcIlwiO1xufTtcblxuY29uc3QgZXh0cmFjdExpbmtzID0gKGh0bWwpID0+IHtcbiAgY29uc3QgbGlua3MgPSBbXTtcbiAgY29uc3QgcmVnZXggPSAvaHJlZlxccyo9XFxzKltcIiddKFteXCInXSspW1wiJ10vZ2k7XG4gIGxldCBtYXRjaCA9IG51bGw7XG4gIHdoaWxlICgobWF0Y2ggPSByZWdleC5leGVjKGh0bWwpKSkge1xuICAgIGNvbnN0IGhyZWYgPSBtYXRjaFsxXTtcbiAgICBpZiAoaHJlZi5zdGFydHNXaXRoKFwiaHR0cFwiKSkge1xuICAgICAgbGlua3MucHVzaChocmVmKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGxpbmtzO1xufTtcblxuY29uc3QgZGVjb2RlWWFuZGV4UmVkaXJlY3QgPSAodXJsKSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcGFyc2VkID0gbmV3IFVSTCh1cmwpO1xuICAgIGNvbnN0IHRhcmdldCA9IHBhcnNlZC5zZWFyY2hQYXJhbXMuZ2V0KFwidXJsXCIpO1xuICAgIHJldHVybiB0YXJnZXQgPyBkZWNvZGVVUklDb21wb25lbnQodGFyZ2V0KSA6IHVybDtcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIHVybDtcbiAgfVxufTtcblxuY29uc3QgZXh0cmFjdFJvYm90c1J1bGVzID0gKGNvbnRlbnQpID0+IHtcbiAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KFwiXFxuXCIpLm1hcCgobGluZSkgPT4gbGluZS50cmltKCkpO1xuICBsZXQgYXBwbHkgPSBmYWxzZTtcbiAgY29uc3QgZGlzYWxsb3cgPSBbXTtcbiAgZm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XG4gICAgaWYgKCFsaW5lIHx8IGxpbmUuc3RhcnRzV2l0aChcIiNcIikpIGNvbnRpbnVlO1xuICAgIGNvbnN0IFtyYXdLZXksIHJhd1ZhbHVlXSA9IGxpbmUuc3BsaXQoXCI6XCIpO1xuICAgIGlmICghcmF3S2V5IHx8IHJhd1ZhbHVlID09PSB1bmRlZmluZWQpIGNvbnRpbnVlO1xuICAgIGNvbnN0IGtleSA9IHJhd0tleS50cmltKCkudG9Mb3dlckNhc2UoKTtcbiAgICBjb25zdCB2YWx1ZSA9IHJhd1ZhbHVlLnRyaW0oKTtcbiAgICBpZiAoa2V5ID09PSBcInVzZXItYWdlbnRcIikge1xuICAgICAgYXBwbHkgPSB2YWx1ZSA9PT0gXCIqXCI7XG4gICAgfSBlbHNlIGlmIChhcHBseSAmJiBrZXkgPT09IFwiZGlzYWxsb3dcIikge1xuICAgICAgZGlzYWxsb3cucHVzaCh2YWx1ZSk7XG4gICAgfVxuICB9XG4gIHJldHVybiBkaXNhbGxvdztcbn07XG5cbmNvbnN0IGNhbm9uaWNhbGl6ZVVybCA9ICh1cmwpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBwYXJzZWQgPSBuZXcgVVJMKHVybCk7XG4gICAgcGFyc2VkLnByb3RvY29sID0gXCJodHRwczpcIjtcbiAgICBjb25zdCBwYXJhbXNUb1JlbW92ZSA9IFtdO1xuICAgIHBhcnNlZC5zZWFyY2hQYXJhbXMuZm9yRWFjaCgoXywga2V5KSA9PiB7XG4gICAgICBjb25zdCBsb3dlciA9IGtleS50b0xvd2VyQ2FzZSgpO1xuICAgICAgaWYgKFxuICAgICAgICBsb3dlci5zdGFydHNXaXRoKFwidXRtX1wiKSB8fFxuICAgICAgICBbXCJnY2xpZFwiLCBcInljbGlkXCIsIFwiZmJjbGlkXCIsIFwicmVmXCIsIFwiZnJvbVwiXS5pbmNsdWRlcyhsb3dlcilcbiAgICAgICkge1xuICAgICAgICBwYXJhbXNUb1JlbW92ZS5wdXNoKGtleSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcGFyYW1zVG9SZW1vdmUuZm9yRWFjaCgoa2V5KSA9PiBwYXJzZWQuc2VhcmNoUGFyYW1zLmRlbGV0ZShrZXkpKTtcblxuICAgIGxldCBob3N0bmFtZSA9IHBhcnNlZC5ob3N0bmFtZS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL153d3dcXC4vLCBcIlwiKTtcbiAgICBwYXJzZWQuaG9zdG5hbWUgPSBob3N0bmFtZTtcblxuICAgIGlmIChob3N0bmFtZSA9PT0gXCJ0Lm1lXCIgfHwgaG9zdG5hbWUgPT09IFwidGVsZWdyYW0ubWVcIikge1xuICAgICAgbGV0IHBhdGggPSBwYXJzZWQucGF0aG5hbWUucmVwbGFjZSgvXFwvKyQvLCBcIlwiKTtcbiAgICAgIGlmIChwYXRoLnN0YXJ0c1dpdGgoXCIvcy9cIikpIHBhdGggPSBwYXRoLnNsaWNlKDIpO1xuICAgICAgcGFyc2VkLnBhdGhuYW1lID0gcGF0aCB8fCBcIi9cIjtcbiAgICAgIHBhcnNlZC5zZWFyY2ggPSBcIlwiO1xuICAgICAgcmV0dXJuIGBodHRwczovL3QubWUke3BhcnNlZC5wYXRobmFtZX1gO1xuICAgIH1cblxuICAgIGlmIChob3N0bmFtZSA9PT0gXCJ2ay5jb21cIikge1xuICAgICAgY29uc3QgcGFydHMgPSBwYXJzZWQucGF0aG5hbWUuc3BsaXQoXCIvXCIpLmZpbHRlcihCb29sZWFuKTtcbiAgICAgIHBhcnNlZC5wYXRobmFtZSA9IHBhcnRzLmxlbmd0aCA/IGAvJHtwYXJ0c1swXX1gIDogXCIvXCI7XG4gICAgICBwYXJzZWQuc2VhcmNoID0gXCJcIjtcbiAgICAgIHJldHVybiBwYXJzZWQudG9TdHJpbmcoKS5yZXBsYWNlKC9cXC8kLywgXCJcIik7XG4gICAgfVxuXG4gICAgcGFyc2VkLnBhdGhuYW1lID0gcGFyc2VkLnBhdGhuYW1lLnJlcGxhY2UoL1xcLyskLywgXCJcIikgfHwgXCIvXCI7XG4gICAgcGFyc2VkLmhhc2ggPSBcIlwiO1xuICAgIHJldHVybiBwYXJzZWQudG9TdHJpbmcoKTtcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIHVybDtcbiAgfVxufTtcblxuY29uc3QgZ2V0RG9tYWluID0gKHVybCkgPT4ge1xuICB0cnkge1xuICAgIHJldHVybiBuZXcgVVJMKHVybCkuaG9zdG5hbWUucmVwbGFjZSgvXnd3d1xcXFwuLywgXCJcIikudG9Mb3dlckNhc2UoKTtcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIFwiXCI7XG4gIH1cbn07XG5cbmNsYXNzIFdlYkNsaWVudCB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICB0aGlzLm1heFJlcXVlc3RzID0gb3B0aW9ucy5tYXhSZXF1ZXN0cztcbiAgICB0aGlzLm1pbkRlbGF5TXMgPSBvcHRpb25zLm1pbkRlbGF5TXMgPz8gNjAwO1xuICAgIHRoaXMudXNlckFnZW50cyA9IG9wdGlvbnMudXNlckFnZW50cyA/PyBVU0VSX0FHRU5UUztcbiAgICB0aGlzLnRpbWVvdXRNcyA9IG9wdGlvbnMudGltZW91dE1zID8/IDE1MDAwO1xuICAgIHRoaXMuc2VhcmNoVGltZW91dE1zID0gb3B0aW9ucy5zZWFyY2hUaW1lb3V0TXMgPz8gMTIwMDA7XG4gICAgdGhpcy5sYXN0UmVxdWVzdEF0ID0gMDtcbiAgICB0aGlzLnN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gICAgdGhpcy5zdGF0cyA9IHtcbiAgICAgIHJlcXVlc3RzX21hZGU6IDAsXG4gICAgICBibG9ja2VkX2NvdW50OiAwLFxuICAgICAgZXJyb3JzX2NvdW50OiAwLFxuICAgICAgZHVyYXRpb25fbXM6IDAsXG4gICAgICB0b3BfZXJyb3JzOiBbXSxcbiAgICAgIHdhcm5pbmdzOiBbXVxuICAgIH07XG4gICAgdGhpcy5yb2JvdHNDYWNoZSA9IG5ldyBNYXAoKTtcbiAgICB0aGlzLmRvbWFpbkZhaWx1cmVzID0gbmV3IE1hcCgpO1xuICAgIHRoaXMuZG9tYWluQ29vbGRvd24gPSBuZXcgTWFwKCk7XG4gICAgdGhpcy5jb25zZWN1dGl2ZVJhdGVMaW1pdCA9IDA7XG4gICAgdGhpcy5sb3dUcmFmZmljTW9kZSA9IGZhbHNlO1xuICAgIHRoaXMudHJhY2UgPSBbXTtcbiAgICB0aGlzLmVycm9yQ291bnRzID0gbmV3IE1hcCgpO1xuICB9XG5cbiAgZ2V0U3RhdHMoKSB7XG4gICAgcmV0dXJuIHsgLi4udGhpcy5zdGF0cywgZHVyYXRpb25fbXM6IERhdGUubm93KCkgLSB0aGlzLnN0YXJ0VGltZSB9O1xuICB9XG5cbiAgZ2V0VHJhY2UoKSB7XG4gICAgcmV0dXJuIFsuLi50aGlzLnRyYWNlXTtcbiAgfVxuXG4gIHJlY29yZFdhcm5pbmcobWVzc2FnZSkge1xuICAgIGlmICghdGhpcy5zdGF0cy53YXJuaW5ncy5pbmNsdWRlcyhtZXNzYWdlKSkge1xuICAgICAgdGhpcy5zdGF0cy53YXJuaW5ncy5wdXNoKG1lc3NhZ2UpO1xuICAgIH1cbiAgfVxuXG4gIHJlY29yZEVycm9yKGRvbWFpbiwgY29kZSkge1xuICAgIGlmICghZG9tYWluKSByZXR1cm47XG4gICAgY29uc3Qga2V5ID0gYCR7ZG9tYWlufToke2NvZGUgfHwgXCJFUlJcIn1gO1xuICAgIGNvbnN0IG5leHQgPSAodGhpcy5lcnJvckNvdW50cy5nZXQoa2V5KSA/PyAwKSArIDE7XG4gICAgdGhpcy5lcnJvckNvdW50cy5zZXQoa2V5LCBuZXh0KTtcbiAgICBjb25zdCBlbnRyaWVzID0gQXJyYXkuZnJvbSh0aGlzLmVycm9yQ291bnRzLmVudHJpZXMoKSlcbiAgICAgIC5tYXAoKFtlbnRyeUtleSwgY291bnRdKSA9PiB7XG4gICAgICAgIGNvbnN0IFtlbnRyeURvbWFpbiwgZW50cnlDb2RlXSA9IGVudHJ5S2V5LnNwbGl0KFwiOlwiKTtcbiAgICAgICAgcmV0dXJuIHsgZG9tYWluOiBlbnRyeURvbWFpbiwgY29kZTogZW50cnlDb2RlLCBjb3VudCB9O1xuICAgICAgfSlcbiAgICAgIC5zb3J0KChhLCBiKSA9PiBiLmNvdW50IC0gYS5jb3VudClcbiAgICAgIC5zbGljZSgwLCA1KTtcbiAgICB0aGlzLnN0YXRzLnRvcF9lcnJvcnMgPSBlbnRyaWVzO1xuICB9XG5cbiAgYXN5bmMgdGhyb3R0bGUoKSB7XG4gICAgY29uc3QgZGVsYXkgPSB0aGlzLmxvd1RyYWZmaWNNb2RlID8gTWF0aC5tYXgodGhpcy5taW5EZWxheU1zLCAyMDAwKSA6IHRoaXMubWluRGVsYXlNcztcbiAgICBjb25zdCBkaWZmID0gRGF0ZS5ub3coKSAtIHRoaXMubGFzdFJlcXVlc3RBdDtcbiAgICBpZiAoZGlmZiA8IGRlbGF5KSB7XG4gICAgICBhd2FpdCBzbGVlcChkZWxheSAtIGRpZmYpO1xuICAgIH1cbiAgICB0aGlzLmxhc3RSZXF1ZXN0QXQgPSBEYXRlLm5vdygpO1xuICB9XG5cbiAgYXN5bmMgZmV0Y2hXaXRoTGltaXQodXJsLCBvcHRpb25zID0ge30pIHtcbiAgICBpZiAodGhpcy5zdGF0cy5yZXF1ZXN0c19tYWRlID49IHRoaXMubWF4UmVxdWVzdHMpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIldFQl9SRVFVRVNUX0xJTUlUXCIpO1xuICAgIH1cbiAgICBhd2FpdCB0aGlzLnRocm90dGxlKCk7XG4gICAgdGhpcy5zdGF0cy5yZXF1ZXN0c19tYWRlICs9IDE7XG4gICAgY29uc3QgdXNlckFnZW50ID1cbiAgICAgIHRoaXMudXNlckFnZW50c1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiB0aGlzLnVzZXJBZ2VudHMubGVuZ3RoKV07XG4gICAgY29uc3QgaGVhZGVycyA9IHtcbiAgICAgIC4uLkRFRkFVTFRfSEVBREVSUyxcbiAgICAgIC4uLihvcHRpb25zLmhlYWRlcnMgfHwge30pLFxuICAgICAgXCJVc2VyLUFnZW50XCI6IHVzZXJBZ2VudFxuICAgIH07XG4gICAgY29uc3QgZG9tYWluID0gZ2V0RG9tYWluKHVybCk7XG5cbiAgICBsZXQgYXR0ZW1wdCA9IDA7XG4gICAgbGV0IGxhc3RFcnJvciA9IG51bGw7XG5cbiAgICB3aGlsZSAoYXR0ZW1wdCA8IDMpIHtcbiAgICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XG4gICAgICBjb25zdCB0aW1lb3V0TXMgPSBvcHRpb25zLnRpbWVvdXRNcyA/PyB0aGlzLnRpbWVvdXRNcztcbiAgICAgIGNvbnN0IHRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IGNvbnRyb2xsZXIuYWJvcnQoKSwgdGltZW91dE1zKTtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XG4gICAgICAgICAgY2FjaGU6IFwibm8tc3RvcmVcIixcbiAgICAgICAgICBoZWFkZXJzLFxuICAgICAgICAgIHNpZ25hbDogY29udHJvbGxlci5zaWduYWxcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHRleHQgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcblxuICAgICAgICBpZiAoWzQyOSwgNTAzLCA1MjAsIDUyMl0uaW5jbHVkZXMocmVzcG9uc2Uuc3RhdHVzKSkge1xuICAgICAgICAgIHRoaXMuY29uc2VjdXRpdmVSYXRlTGltaXQgKz0gMTtcbiAgICAgICAgICB0aGlzLnJlY29yZEVycm9yKGRvbWFpbiwgcmVzcG9uc2Uuc3RhdHVzKTtcbiAgICAgICAgICBpZiAodGhpcy5jb25zZWN1dGl2ZVJhdGVMaW1pdCA+PSAyICYmICF0aGlzLmxvd1RyYWZmaWNNb2RlKSB7XG4gICAgICAgICAgICB0aGlzLmxvd1RyYWZmaWNNb2RlID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMucmVjb3JkV2FybmluZyhcInJhdGUtbGltaXRlZCwgc3dpdGNoZWQgdG8gbG93LXRyYWZmaWMgbW9kZVwiKTtcbiAgICAgICAgICAgIHRoaXMubWF4UmVxdWVzdHMgPSBNYXRoLm1heCgxMCwgTWF0aC5mbG9vcih0aGlzLm1heFJlcXVlc3RzICogMC44KSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IGRlbGF5ID0gTWF0aC5taW4oODAwMCwgNDAwICogMiAqKiBhdHRlbXB0KTtcbiAgICAgICAgICBjb25zdCBqaXR0ZXIgPSBkZWxheSAqICgwLjUgKyBNYXRoLnJhbmRvbSgpKTtcbiAgICAgICAgICBhd2FpdCBzbGVlcChqaXR0ZXIpO1xuICAgICAgICAgIGF0dGVtcHQgKz0gMTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuY29uc2VjdXRpdmVSYXRlTGltaXQgPSAwO1xuICAgICAgICByZXR1cm4geyBvazogcmVzcG9uc2Uub2ssIHN0YXR1czogcmVzcG9uc2Uuc3RhdHVzLCB0ZXh0IH07XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7XG4gICAgICAgIGxhc3RFcnJvciA9IGVycm9yO1xuICAgICAgICB0aGlzLnN0YXRzLmVycm9yc19jb3VudCArPSAxO1xuICAgICAgICB0aGlzLnJlY29yZEVycm9yKGRvbWFpbiwgXCJGRVRDSFwiKTtcbiAgICAgICAgY29uc3QgZGVsYXkgPSBNYXRoLm1pbig4MDAwLCA0MDAgKiAyICoqIGF0dGVtcHQpO1xuICAgICAgICBjb25zdCBqaXR0ZXIgPSBkZWxheSAqICgwLjUgKyBNYXRoLnJhbmRvbSgpKTtcbiAgICAgICAgYXdhaXQgc2xlZXAoaml0dGVyKTtcbiAgICAgICAgYXR0ZW1wdCArPSAxO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChsYXN0RXJyb3IpIHRocm93IGxhc3RFcnJvcjtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJGRVRDSF9GQUlMRURcIik7XG4gIH1cblxuICBhc3luYyBjYW5GZXRjaCh1cmwpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcGFyc2VkID0gbmV3IFVSTCh1cmwpO1xuICAgICAgY29uc3QgZG9tYWluID0gcGFyc2VkLm9yaWdpbjtcbiAgICAgIGlmICghdGhpcy5yb2JvdHNDYWNoZS5oYXMoZG9tYWluKSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHJvYm90c1VybCA9IGAke2RvbWFpbn0vcm9ib3RzLnR4dGA7XG4gICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmZldGNoV2l0aExpbWl0KHJvYm90c1VybCk7XG4gICAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgdGhpcy5yb2JvdHNDYWNoZS5zZXQoZG9tYWluLCBbXSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGRpc2FsbG93ID0gZXh0cmFjdFJvYm90c1J1bGVzKHJlc3BvbnNlLnRleHQpO1xuICAgICAgICAgICAgdGhpcy5yb2JvdHNDYWNoZS5zZXQoZG9tYWluLCBkaXNhbGxvdyk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICB0aGlzLnJvYm90c0NhY2hlLnNldChkb21haW4sIFtdKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBjb25zdCBydWxlcyA9IHRoaXMucm9ib3RzQ2FjaGUuZ2V0KGRvbWFpbikgPz8gW107XG4gICAgICBjb25zdCBwYXRoID0gcGFyc2VkLnBhdGhuYW1lO1xuICAgICAgaWYgKHJ1bGVzLmluY2x1ZGVzKFwiL1wiKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICByZXR1cm4gIXJ1bGVzLnNvbWUoKHJ1bGUpID0+IHJ1bGUgJiYgcGF0aC5zdGFydHNXaXRoKHJ1bGUpKTtcbiAgICB9IGNhdGNoIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBmZXRjaFBhZ2UodXJsLCBvcHRpb25zID0ge30pIHtcbiAgICBjb25zdCBjYW5vbmljYWxVcmwgPSBjYW5vbmljYWxpemVVcmwodXJsKTtcbiAgICBjb25zdCBkb21haW4gPSBnZXREb21haW4oY2Fub25pY2FsVXJsKTtcbiAgICBjb25zdCBjb29sZG93blVudGlsID0gdGhpcy5kb21haW5Db29sZG93bi5nZXQoZG9tYWluKTtcbiAgICBpZiAoY29vbGRvd25VbnRpbCAmJiBjb29sZG93blVudGlsID4gRGF0ZS5ub3coKSkge1xuICAgICAgdGhpcy5zdGF0cy5ibG9ja2VkX2NvdW50ICs9IDE7XG4gICAgICB0aGlzLnN0YXRzLmVycm9yc19jb3VudCArPSAxO1xuICAgICAgdGhpcy5yZWNvcmRFcnJvcihkb21haW4sIFwiQ09PTERPV05cIik7XG4gICAgICByZXR1cm4geyBibG9ja2VkOiB0cnVlLCB1cmw6IGNhbm9uaWNhbFVybCB9O1xuICAgIH1cblxuICAgIGNvbnN0IGFsbG93ZWQgPSBhd2FpdCB0aGlzLmNhbkZldGNoKGNhbm9uaWNhbFVybCk7XG4gICAgaWYgKCFhbGxvd2VkKSB7XG4gICAgICB0aGlzLnN0YXRzLmJsb2NrZWRfY291bnQgKz0gMTtcbiAgICAgIHRoaXMuc3RhdHMuZXJyb3JzX2NvdW50ICs9IDE7XG4gICAgICB0aGlzLnJlY29yZEVycm9yKGRvbWFpbiwgXCJST0JPVFNcIik7XG4gICAgICByZXR1cm4geyBibG9ja2VkOiB0cnVlLCB1cmw6IGNhbm9uaWNhbFVybCB9O1xuICAgIH1cbiAgICB0aGlzLnRyYWNlLnB1c2goeyBkb21haW4sIHR5cGU6IG9wdGlvbnMudHlwZSB8fCBcInBhZ2VcIiB9KTtcbiAgICBsZXQgcmVzcG9uc2U7XG4gICAgdHJ5IHtcbiAgICAgIHJlc3BvbnNlID0gYXdhaXQgdGhpcy5mZXRjaFdpdGhMaW1pdChjYW5vbmljYWxVcmwsIHtcbiAgICAgICAgdGltZW91dE1zOiBvcHRpb25zLnRpbWVvdXRNc1xuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnN0IGZhaWx1cmVzID0gKHRoaXMuZG9tYWluRmFpbHVyZXMuZ2V0KGRvbWFpbikgPz8gMCkgKyAxO1xuICAgICAgdGhpcy5kb21haW5GYWlsdXJlcy5zZXQoZG9tYWluLCBmYWlsdXJlcyk7XG4gICAgICBpZiAoZmFpbHVyZXMgPj0gNSkge1xuICAgICAgICB0aGlzLmRvbWFpbkNvb2xkb3duLnNldChkb21haW4sIERhdGUubm93KCkgKyAxMCAqIDYwICogMTAwMCk7XG4gICAgICAgIHRoaXMucmVjb3JkV2FybmluZyhgY2lyY3VpdC1icmVha2VyOiR7ZG9tYWlufWApO1xuICAgICAgfVxuICAgICAgdGhpcy5zdGF0cy5lcnJvcnNfY291bnQgKz0gMTtcbiAgICAgIHRoaXMucmVjb3JkRXJyb3IoZG9tYWluLCBcIkZFVENIXCIpO1xuICAgICAgcmV0dXJuIHsgYmxvY2tlZDogdHJ1ZSwgdXJsOiBjYW5vbmljYWxVcmwgfTtcbiAgICB9XG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgdGhpcy5zdGF0cy5lcnJvcnNfY291bnQgKz0gMTtcbiAgICAgIHRoaXMucmVjb3JkRXJyb3IoZG9tYWluLCByZXNwb25zZS5zdGF0dXMpO1xuICAgICAgY29uc3QgZmFpbHVyZXMgPSAodGhpcy5kb21haW5GYWlsdXJlcy5nZXQoZG9tYWluKSA/PyAwKSArIDE7XG4gICAgICB0aGlzLmRvbWFpbkZhaWx1cmVzLnNldChkb21haW4sIGZhaWx1cmVzKTtcbiAgICAgIGlmIChmYWlsdXJlcyA+PSA1KSB7XG4gICAgICAgIHRoaXMuZG9tYWluQ29vbGRvd24uc2V0KGRvbWFpbiwgRGF0ZS5ub3coKSArIDEwICogNjAgKiAxMDAwKTtcbiAgICAgICAgdGhpcy5yZWNvcmRXYXJuaW5nKGBjaXJjdWl0LWJyZWFrZXI6JHtkb21haW59YCk7XG4gICAgICB9XG4gICAgICByZXR1cm4geyBibG9ja2VkOiB0cnVlLCB1cmw6IGNhbm9uaWNhbFVybCB9O1xuICAgIH1cbiAgICB0aGlzLmRvbWFpbkZhaWx1cmVzLnNldChkb21haW4sIDApO1xuICAgIGNvbnN0IGh0bWwgPSByZXNwb25zZS50ZXh0O1xuICAgIGNvbnN0IHRpdGxlID0gZXh0cmFjdFRpdGxlKGh0bWwpO1xuICAgIGNvbnN0IHRleHQgPSBzdHJpcEh0bWwoaHRtbCk7XG4gICAgcmV0dXJuIHsgdXJsOiBjYW5vbmljYWxVcmwsIHRpdGxlLCBodG1sLCB0ZXh0IH07XG4gIH1cblxuICBhc3luYyBzZWFyY2gocXVlcnksIGVuZ2luZSA9IFwieWFuZGV4XCIsIGxpbWl0ID0gNSkge1xuICAgIGNvbnN0IHNlYXJjaFVybCA9XG4gICAgICBlbmdpbmUgPT09IFwieWFuZGV4XCJcbiAgICAgICAgPyBgaHR0cHM6Ly95YW5kZXgucnUvc2VhcmNoLz90ZXh0PSR7ZW5jb2RlVVJJQ29tcG9uZW50KHF1ZXJ5KX1gXG4gICAgICAgIDogYGh0dHBzOi8vZHVja2R1Y2tnby5jb20vaHRtbC8/cT0ke2VuY29kZVVSSUNvbXBvbmVudChxdWVyeSl9YDtcblxuICAgIGNvbnN0IHBhZ2UgPSBhd2FpdCB0aGlzLmZldGNoUGFnZShzZWFyY2hVcmwsIHtcbiAgICAgIHRpbWVvdXRNczogdGhpcy5zZWFyY2hUaW1lb3V0TXMsXG4gICAgICB0eXBlOiBcInNlYXJjaFwiXG4gICAgfSk7XG4gICAgaWYgKFwiYmxvY2tlZFwiIGluIHBhZ2UpIHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICBjb25zdCBsaW5rcyA9IGV4dHJhY3RMaW5rcyhwYWdlLmh0bWwpXG4gICAgICAubWFwKChsaW5rKSA9PiAobGluay5pbmNsdWRlcyhcInlhbmRleFwiKSA/IGRlY29kZVlhbmRleFJlZGlyZWN0KGxpbmspIDogbGluaykpXG4gICAgICAuZmlsdGVyKChsaW5rKSA9PiBsaW5rLnN0YXJ0c1dpdGgoXCJodHRwXCIpKTtcblxuICAgIGNvbnN0IHJlc3VsdHMgPSBbXTtcbiAgICBjb25zdCBzZWVuID0gbmV3IFNldCgpO1xuXG4gICAgZm9yIChjb25zdCBsaW5rIG9mIGxpbmtzKSB7XG4gICAgICBpZiAocmVzdWx0cy5sZW5ndGggPj0gbGltaXQpIGJyZWFrO1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgdXJsID0gbmV3IFVSTChsaW5rKTtcbiAgICAgICAgaWYgKHVybC5ob3N0bmFtZS5pbmNsdWRlcyhcInlhbmRleFwiKSB8fCB1cmwuaG9zdG5hbWUuaW5jbHVkZXMoXCJkdWNrZHVja2dvXCIpKSB7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2gge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIGlmIChzZWVuLmhhcyhsaW5rKSkgY29udGludWU7XG4gICAgICBzZWVuLmFkZChsaW5rKTtcbiAgICAgIHJlc3VsdHMucHVzaCh7XG4gICAgICAgIHVybDogY2Fub25pY2FsaXplVXJsKGxpbmspLFxuICAgICAgICB0aXRsZTogcGFnZS50aXRsZSxcbiAgICAgICAgc25pcHBldDogcXVlcnksXG4gICAgICAgIHF1ZXJ5LFxuICAgICAgICBlbmdpbmUsXG4gICAgICAgIHNvdXJjZV91cmw6IHNlYXJjaFVybFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdHM7XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIFdlYkNsaWVudCxcbiAgY2Fub25pY2FsaXplVXJsXG59O1xuIl0sIm5hbWVzIjpbInNsZWVwIiwibXMiLCJQcm9taXNlIiwicmVzb2x2ZSIsInNldFRpbWVvdXQiLCJVU0VSX0FHRU5UUyIsIkRFRkFVTFRfSEVBREVSUyIsIkFjY2VwdCIsIlByYWdtYSIsInN0cmlwSHRtbCIsImh0bWwiLCJyZXBsYWNlIiwidHJpbSIsImV4dHJhY3RUaXRsZSIsIm1hdGNoIiwiZXh0cmFjdExpbmtzIiwibGlua3MiLCJyZWdleCIsImV4ZWMiLCJocmVmIiwic3RhcnRzV2l0aCIsInB1c2giLCJkZWNvZGVZYW5kZXhSZWRpcmVjdCIsInVybCIsInBhcnNlZCIsIlVSTCIsInRhcmdldCIsInNlYXJjaFBhcmFtcyIsImdldCIsImRlY29kZVVSSUNvbXBvbmVudCIsImV4dHJhY3RSb2JvdHNSdWxlcyIsImNvbnRlbnQiLCJsaW5lcyIsInNwbGl0IiwibWFwIiwibGluZSIsImFwcGx5IiwiZGlzYWxsb3ciLCJyYXdLZXkiLCJyYXdWYWx1ZSIsInVuZGVmaW5lZCIsImtleSIsInRvTG93ZXJDYXNlIiwidmFsdWUiLCJjYW5vbmljYWxpemVVcmwiLCJwcm90b2NvbCIsInBhcmFtc1RvUmVtb3ZlIiwiZm9yRWFjaCIsIl8iLCJsb3dlciIsImluY2x1ZGVzIiwiZGVsZXRlIiwiaG9zdG5hbWUiLCJwYXRoIiwicGF0aG5hbWUiLCJzbGljZSIsInNlYXJjaCIsInBhcnRzIiwiZmlsdGVyIiwiQm9vbGVhbiIsImxlbmd0aCIsInRvU3RyaW5nIiwiaGFzaCIsImdldERvbWFpbiIsIldlYkNsaWVudCIsIm9wdGlvbnMiLCJtYXhSZXF1ZXN0cyIsIm1pbkRlbGF5TXMiLCJ1c2VyQWdlbnRzIiwidGltZW91dE1zIiwic2VhcmNoVGltZW91dE1zIiwibGFzdFJlcXVlc3RBdCIsInN0YXJ0VGltZSIsIkRhdGUiLCJub3ciLCJzdGF0cyIsInJlcXVlc3RzX21hZGUiLCJibG9ja2VkX2NvdW50IiwiZXJyb3JzX2NvdW50IiwiZHVyYXRpb25fbXMiLCJ0b3BfZXJyb3JzIiwid2FybmluZ3MiLCJyb2JvdHNDYWNoZSIsIk1hcCIsImRvbWFpbkZhaWx1cmVzIiwiZG9tYWluQ29vbGRvd24iLCJjb25zZWN1dGl2ZVJhdGVMaW1pdCIsImxvd1RyYWZmaWNNb2RlIiwidHJhY2UiLCJlcnJvckNvdW50cyIsImdldFN0YXRzIiwiZ2V0VHJhY2UiLCJyZWNvcmRXYXJuaW5nIiwibWVzc2FnZSIsInJlY29yZEVycm9yIiwiZG9tYWluIiwiY29kZSIsIm5leHQiLCJzZXQiLCJlbnRyaWVzIiwiQXJyYXkiLCJmcm9tIiwiZW50cnlLZXkiLCJjb3VudCIsImVudHJ5RG9tYWluIiwiZW50cnlDb2RlIiwic29ydCIsImEiLCJiIiwidGhyb3R0bGUiLCJkZWxheSIsIk1hdGgiLCJtYXgiLCJkaWZmIiwiZmV0Y2hXaXRoTGltaXQiLCJFcnJvciIsInVzZXJBZ2VudCIsImZsb29yIiwicmFuZG9tIiwiaGVhZGVycyIsImF0dGVtcHQiLCJsYXN0RXJyb3IiLCJjb250cm9sbGVyIiwiQWJvcnRDb250cm9sbGVyIiwidGltZW91dCIsImFib3J0IiwicmVzcG9uc2UiLCJmZXRjaCIsImNhY2hlIiwic2lnbmFsIiwidGV4dCIsImNsZWFyVGltZW91dCIsInN0YXR1cyIsIm1pbiIsImppdHRlciIsIm9rIiwiZXJyb3IiLCJjYW5GZXRjaCIsIm9yaWdpbiIsImhhcyIsInJvYm90c1VybCIsInJ1bGVzIiwic29tZSIsInJ1bGUiLCJmZXRjaFBhZ2UiLCJjYW5vbmljYWxVcmwiLCJjb29sZG93blVudGlsIiwiYmxvY2tlZCIsImFsbG93ZWQiLCJ0eXBlIiwiZmFpbHVyZXMiLCJ0aXRsZSIsInF1ZXJ5IiwiZW5naW5lIiwibGltaXQiLCJzZWFyY2hVcmwiLCJlbmNvZGVVUklDb21wb25lbnQiLCJwYWdlIiwibGluayIsInJlc3VsdHMiLCJzZWVuIiwiU2V0IiwiYWRkIiwic25pcHBldCIsInNvdXJjZV91cmwiLCJtb2R1bGUiLCJleHBvcnRzIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/agents/webClient.js\n");

/***/ }),

/***/ "(rsc)/./lib/llm/provider.js":
/*!*****************************!*\
  !*** ./lib/llm/provider.js ***!
  \*****************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("\nconst fs = __webpack_require__(/*! node:fs */ \"node:fs\");\nconst path = __webpack_require__(/*! node:path */ \"node:path\");\nconst DEFAULT_PROVIDER = \"fake\";\nconst normalizeProviderName = (value)=>{\n    const normalized = String(value || \"\").trim().toLowerCase();\n    return normalized === \"real\" ? \"real\" : \"fake\";\n};\nconst getConfiguredProviderName = ()=>normalizeProviderName(process.env.LLM_PROVIDER || DEFAULT_PROVIDER);\nconst hasRealProviderCredentials = ()=>Boolean(String(process.env.OPENAI_API_KEY || \"\").trim());\nconst AGENT_ID_ALIASES = {\n    platon: \"platon-prospect-research-ru\",\n    anatoly: \"anatoly-account-research-ru\",\n    maxim: \"maxim-local-leads-ru\"\n};\nconst canonicalAgentId = (agentId)=>{\n    if (!agentId) return \"\";\n    const normalized = String(agentId).trim();\n    return AGENT_ID_ALIASES[normalized] || normalized;\n};\nconst resolveFixtureOutputPath = (agentId, fixturesRoot)=>{\n    const canonical = canonicalAgentId(agentId);\n    if (!canonical) return \"\";\n    const root = fixturesRoot || path.join(process.cwd(), \"fixtures\", \"agents\");\n    return path.join(root, canonical, \"output.json\");\n};\nconst hasFixtureForAgent = (agentId, fixturesRoot)=>{\n    const outputPath = resolveFixtureOutputPath(agentId, fixturesRoot);\n    return Boolean(outputPath && fs.existsSync(outputPath));\n};\nconst stripVolatile = (value)=>{\n    if (!value || typeof value !== \"object\") return value;\n    if (Array.isArray(value)) return value.map((item)=>stripVolatile(item));\n    const next = {};\n    Object.entries(value).forEach(([key, val])=>{\n        if (key === \"generated_at\") {\n            next[key] = \"1970-01-01T00:00:00.000Z\";\n            return;\n        }\n        if (key === \"run_id\" || key === \"trace_id\") {\n            next[key] = \"stub-run\";\n            return;\n        }\n        if (key === \"duration_ms\") {\n            next[key] = 0;\n            return;\n        }\n        next[key] = stripVolatile(val);\n    });\n    return next;\n};\nconst cloneJson = (value)=>{\n    try {\n        return JSON.parse(JSON.stringify(value));\n    } catch  {\n        return value;\n    }\n};\nconst pickSchemaNode = (schema)=>{\n    if (!schema || typeof schema !== \"object\") return {};\n    if (Array.isArray(schema.oneOf) && schema.oneOf.length) return schema.oneOf[0] || {};\n    if (Array.isArray(schema.anyOf) && schema.anyOf.length) return schema.anyOf[0] || {};\n    if (Array.isArray(schema.allOf) && schema.allOf.length) {\n        return schema.allOf.reduce((acc, item)=>({\n                ...acc,\n                ...item\n            }), {});\n    }\n    return schema;\n};\nconst schemaType = (schema)=>{\n    const node = pickSchemaNode(schema);\n    if (!node || typeof node !== \"object\") return \"object\";\n    if (node.const !== undefined) return typeof node.const;\n    if (node.default !== undefined) return typeof node.default;\n    if (Array.isArray(node.enum) && node.enum.length) return typeof node.enum[0];\n    if (Array.isArray(node.type)) return node.type[0] || \"object\";\n    return node.type || \"object\";\n};\nconst valueForFormat = (format)=>{\n    if (format === \"date-time\") return \"1970-01-01T00:00:00.000Z\";\n    if (format === \"date\") return \"1970-01-01\";\n    if (format === \"email\") return \"stub@example.com\";\n    if (format === \"uri\" || format === \"url\") return \"https://example.com\";\n    return \"stub\";\n};\nconst buildFromSchema = (schema, keyHint = \"\")=>{\n    const node = pickSchemaNode(schema);\n    if (!node || typeof node !== \"object\") return {};\n    if (Object.prototype.hasOwnProperty.call(node, \"const\")) return cloneJson(node.const);\n    if (Object.prototype.hasOwnProperty.call(node, \"default\")) return cloneJson(node.default);\n    if (Array.isArray(node.enum) && node.enum.length) return cloneJson(node.enum[0]);\n    const type = schemaType(node);\n    if (type === \"string\") {\n        if (node.format) return valueForFormat(node.format);\n        if (keyHint.toLowerCase().includes(\"email\")) return \"stub@example.com\";\n        if (keyHint.toLowerCase().includes(\"url\") || keyHint.toLowerCase().includes(\"link\")) {\n            return \"https://example.com\";\n        }\n        return \"stub\";\n    }\n    if (type === \"number\" || type === \"integer\") {\n        if (Number.isFinite(node.minimum)) return Number(node.minimum);\n        return 0;\n    }\n    if (type === \"boolean\") return false;\n    if (type === \"array\") {\n        const itemSchema = node.items || {};\n        return [\n            buildFromSchema(itemSchema, keyHint ? `${keyHint}_item` : \"item\")\n        ];\n    }\n    if (type === \"object\") {\n        const properties = node.properties && typeof node.properties === \"object\" ? node.properties : {};\n        const required = Array.isArray(node.required) ? node.required : [];\n        const keys = new Set([\n            ...required,\n            ...Object.keys(properties)\n        ]);\n        const result = {};\n        if (keys.size === 0) {\n            return keyHint === \"meta\" ? {\n                generated_at: \"1970-01-01T00:00:00.000Z\"\n            } : {};\n        }\n        keys.forEach((key)=>{\n            const childSchema = properties[key] || {};\n            result[key] = buildFromSchema(childSchema, key);\n        });\n        return result;\n    }\n    return {};\n};\nclass FakeLLMProvider {\n    constructor(options = {}){\n        this.name = \"fake\";\n        this.fixturesRoot = options.fixturesRoot || path.join(process.cwd(), \"fixtures\", \"agents\");\n    }\n    loadFixtureData(agentId) {\n        const outputPath = resolveFixtureOutputPath(agentId, this.fixturesRoot);\n        if (!outputPath || !fs.existsSync(outputPath)) return null;\n        try {\n            const parsed = JSON.parse(fs.readFileSync(outputPath, \"utf8\"));\n            const legacyData = parsed && parsed.data ? parsed.data : parsed;\n            return stripVolatile(cloneJson(legacyData));\n        } catch  {\n            return null;\n        }\n    }\n    async generateJson({ schema, meta } = {}) {\n        const agentId = meta && typeof meta === \"object\" ? meta.agent_id || meta.agentId : \"\";\n        const fixtureData = agentId ? this.loadFixtureData(agentId) : null;\n        if (fixtureData) {\n            return fixtureData;\n        }\n        return buildFromSchema(schema || {}, \"root\");\n    }\n}\nconst sanitizeSchemaName = (value)=>{\n    const normalized = String(value || \"agent_output\").replace(/[^a-zA-Z0-9_]/g, \"_\").replace(/_+/g, \"_\").replace(/^_+|_+$/g, \"\");\n    return normalized || \"agent_output\";\n};\nconst stripCodeFences = (value)=>String(value || \"\").replace(/```json/gi, \"```\").replace(/^```/, \"\").replace(/```$/, \"\").trim();\nconst parseJsonString = (value)=>{\n    if (typeof value !== \"string\") return null;\n    const direct = value.trim();\n    if (!direct) return null;\n    try {\n        return JSON.parse(direct);\n    } catch  {\n    // continue\n    }\n    const stripped = stripCodeFences(direct);\n    if (!stripped) return null;\n    try {\n        return JSON.parse(stripped);\n    } catch  {\n        return null;\n    }\n};\nconst extractErrorMessage = (payload)=>{\n    if (!payload || typeof payload !== \"object\") return \"\";\n    if (payload.error && typeof payload.error === \"object\") {\n        const message = payload.error.message || payload.error.code;\n        if (message) return String(message);\n    }\n    return \"\";\n};\nconst getNumericOption = (value, fallback)=>{\n    const numeric = Number(value);\n    return Number.isFinite(numeric) ? numeric : fallback;\n};\nclass RealLLMProvider {\n    constructor(options = {}){\n        this.name = \"real\";\n        this.apiKey = options.apiKey || process.env.OPENAI_API_KEY || \"\";\n        this.baseUrl = String(options.baseUrl || process.env.OPENAI_BASE_URL || \"https://api.openai.com/v1\").replace(/\\/+$/, \"\");\n        this.model = options.model || process.env.OPENAI_MODEL || \"gpt-5-mini\";\n        this.timeoutMs = getNumericOption(options.timeoutMs || process.env.OPENAI_TIMEOUT_MS, 45000);\n        this.fetchImpl = options.fetch || globalThis.fetch;\n    }\n    async requestChatCompletions(payload) {\n        if (typeof this.fetchImpl !== \"function\") {\n            throw new Error(\"Global fetch is not available for RealLLMProvider.\");\n        }\n        const controller = new AbortController();\n        const timeout = setTimeout(()=>controller.abort(), this.timeoutMs);\n        let response;\n        try {\n            response = await this.fetchImpl(`${this.baseUrl}/chat/completions`, {\n                method: \"POST\",\n                headers: {\n                    \"content-type\": \"application/json\",\n                    authorization: `Bearer ${this.apiKey}`\n                },\n                body: JSON.stringify(payload),\n                signal: controller.signal\n            });\n        } catch (error) {\n            const message = error && typeof error === \"object\" && error.name === \"AbortError\" ? `OpenAI request timed out after ${this.timeoutMs}ms` : `OpenAI request failed: ${error instanceof Error ? error.message : \"unknown error\"}`;\n            throw new Error(message);\n        } finally{\n            clearTimeout(timeout);\n        }\n        const text = await response.text();\n        const parsed = parseJsonString(text) || {};\n        if (!response.ok) {\n            const apiMessage = extractErrorMessage(parsed);\n            const reason = apiMessage || text.slice(0, 300) || `HTTP ${response.status}`;\n            const error = new Error(`OpenAI request failed (${response.status}): ${reason}`);\n            error.status = response.status;\n            throw error;\n        }\n        return parsed;\n    }\n    extractMessageText(payload) {\n        const content = payload?.choices?.[0]?.message?.content;\n        if (typeof content === \"string\") return content;\n        if (Array.isArray(content)) {\n            return content.map((part)=>{\n                if (!part || typeof part !== \"object\") return \"\";\n                if (typeof part.text === \"string\") return part.text;\n                if (part.text && typeof part.text === \"object\" && typeof part.text.value === \"string\") {\n                    return part.text.value;\n                }\n                if (typeof part.content === \"string\") return part.content;\n                return \"\";\n            }).join(\"\").trim();\n        }\n        return \"\";\n    }\n    buildMessages(system, prompt, schema) {\n        const baseSystem = typeof system === \"string\" && system.trim() ? system.trim() : \"You are a strict JSON assistant.\";\n        const schemaHint = schema && typeof schema === \"object\" && Object.keys(schema).length ? `Return only JSON that matches this schema:\\n${JSON.stringify(schema)}` : \"Return only valid JSON.\";\n        const userPrompt = typeof prompt === \"string\" && prompt.trim() ? prompt.trim() : \"{}\";\n        return [\n            {\n                role: \"system\",\n                content: `${baseSystem}\\n\\n${schemaHint}`\n            },\n            {\n                role: \"user\",\n                content: userPrompt\n            }\n        ];\n    }\n    async generateJson({ system, prompt, schema, temperature, maxTokens, meta } = {}) {\n        if (!this.apiKey) {\n            throw new Error(\"OPENAI_API_KEY is required when LLM_PROVIDER=real.\");\n        }\n        const requestedModel = meta && typeof meta === \"object\" && typeof meta.model === \"string\" ? meta.model.trim() : \"\";\n        const model = requestedModel || this.model;\n        const messages = this.buildMessages(system, prompt, schema);\n        const cappedTemperature = Math.min(Math.max(getNumericOption(temperature, 0.2), 0), 1.5);\n        const tokenLimit = Math.max(200, Math.min(6000, getNumericOption(maxTokens, 1800)));\n        const hasSchema = Boolean(schema && typeof schema === \"object\" && Object.keys(schema).length);\n        const schemaName = sanitizeSchemaName(meta && typeof meta === \"object\" ? meta.agent_id || meta.agentId || \"agent_output\" : \"agent_output\");\n        const withSchemaPayload = {\n            model,\n            messages,\n            temperature: cappedTemperature,\n            max_tokens: tokenLimit,\n            response_format: hasSchema ? {\n                type: \"json_schema\",\n                json_schema: {\n                    name: schemaName,\n                    strict: true,\n                    schema\n                }\n            } : {\n                type: \"json_object\"\n            }\n        };\n        let firstResult;\n        try {\n            firstResult = await this.requestChatCompletions(withSchemaPayload);\n        } catch (error) {\n            // Some models/endpoints may reject json_schema; fallback to plain json_object.\n            const fallbackPayload = {\n                model,\n                messages,\n                temperature: cappedTemperature,\n                max_tokens: tokenLimit,\n                response_format: {\n                    type: \"json_object\"\n                }\n            };\n            firstResult = await this.requestChatCompletions(fallbackPayload);\n        }\n        const text = this.extractMessageText(firstResult);\n        const parsed = parseJsonString(text);\n        if (parsed && typeof parsed === \"object\") {\n            return parsed;\n        }\n        throw new Error(\"OpenAI returned non-JSON output for generateJson().\");\n    }\n}\nconst createLLMProvider = ({ provider, fixturesRoot } = {})=>{\n    const mode = normalizeProviderName(provider || getConfiguredProviderName());\n    if (mode === \"real\") return new RealLLMProvider();\n    return new FakeLLMProvider({\n        fixturesRoot\n    });\n};\nlet singleton = null;\nconst getLLMProvider = (options = {})=>{\n    if (options.forceNew) return createLLMProvider(options);\n    if (!singleton) singleton = createLLMProvider(options);\n    return singleton;\n};\nconst isFakeLLMProvider = (provider)=>{\n    const name = provider && typeof provider === \"object\" ? provider.name : \"\";\n    return normalizeProviderName(name) === \"fake\";\n};\nmodule.exports = {\n    FakeLLMProvider,\n    RealLLMProvider,\n    buildFromSchema,\n    canonicalAgentId,\n    createLLMProvider,\n    getConfiguredProviderName,\n    getLLMProvider,\n    hasRealProviderCredentials,\n    hasFixtureForAgent,\n    isFakeLLMProvider,\n    resolveFixtureOutputPath,\n    stripVolatile\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TDtJQUN6QixNQUFNckYsT0FBT3FGLFlBQVksT0FBT0EsYUFBYSxXQUFXQSxTQUFTckYsSUFBSSxHQUFHO0lBQ3hFLE9BQU9qRixzQkFBc0JpRixVQUFVO0FBQ3pDO0FBRUEyRixPQUFPQyxPQUFPLEdBQUc7SUFDZjlGO0lBQ0EwQjtJQUNBN0M7SUFDQTNDO0lBQ0FvSjtJQUNBL0o7SUFDQW1LO0lBQ0EvSjtJQUNBZTtJQUNBa0o7SUFDQXhKO0lBQ0FTO0FBQ0YiLCJzb3VyY2VzIjpbIi9Vc2Vycy9hYnV6YWRhL0Rlc2t0b3AvYWdlbnRPUy9saWIvbGxtL3Byb3ZpZGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGZzID0gcmVxdWlyZShcIm5vZGU6ZnNcIik7XG5jb25zdCBwYXRoID0gcmVxdWlyZShcIm5vZGU6cGF0aFwiKTtcblxuY29uc3QgREVGQVVMVF9QUk9WSURFUiA9IFwiZmFrZVwiO1xuXG5jb25zdCBub3JtYWxpemVQcm92aWRlck5hbWUgPSAodmFsdWUpID0+IHtcbiAgY29uc3Qgbm9ybWFsaXplZCA9IFN0cmluZyh2YWx1ZSB8fCBcIlwiKS50cmltKCkudG9Mb3dlckNhc2UoKTtcbiAgcmV0dXJuIG5vcm1hbGl6ZWQgPT09IFwicmVhbFwiID8gXCJyZWFsXCIgOiBcImZha2VcIjtcbn07XG5cbmNvbnN0IGdldENvbmZpZ3VyZWRQcm92aWRlck5hbWUgPSAoKSA9PiBub3JtYWxpemVQcm92aWRlck5hbWUocHJvY2Vzcy5lbnYuTExNX1BST1ZJREVSIHx8IERFRkFVTFRfUFJPVklERVIpO1xuY29uc3QgaGFzUmVhbFByb3ZpZGVyQ3JlZGVudGlhbHMgPSAoKSA9PlxuICBCb29sZWFuKFN0cmluZyhwcm9jZXNzLmVudi5PUEVOQUlfQVBJX0tFWSB8fCBcIlwiKS50cmltKCkpO1xuXG5jb25zdCBBR0VOVF9JRF9BTElBU0VTID0ge1xuICBwbGF0b246IFwicGxhdG9uLXByb3NwZWN0LXJlc2VhcmNoLXJ1XCIsXG4gIGFuYXRvbHk6IFwiYW5hdG9seS1hY2NvdW50LXJlc2VhcmNoLXJ1XCIsXG4gIG1heGltOiBcIm1heGltLWxvY2FsLWxlYWRzLXJ1XCJcbn07XG5cbmNvbnN0IGNhbm9uaWNhbEFnZW50SWQgPSAoYWdlbnRJZCkgPT4ge1xuICBpZiAoIWFnZW50SWQpIHJldHVybiBcIlwiO1xuICBjb25zdCBub3JtYWxpemVkID0gU3RyaW5nKGFnZW50SWQpLnRyaW0oKTtcbiAgcmV0dXJuIEFHRU5UX0lEX0FMSUFTRVNbbm9ybWFsaXplZF0gfHwgbm9ybWFsaXplZDtcbn07XG5cbmNvbnN0IHJlc29sdmVGaXh0dXJlT3V0cHV0UGF0aCA9IChhZ2VudElkLCBmaXh0dXJlc1Jvb3QpID0+IHtcbiAgY29uc3QgY2Fub25pY2FsID0gY2Fub25pY2FsQWdlbnRJZChhZ2VudElkKTtcbiAgaWYgKCFjYW5vbmljYWwpIHJldHVybiBcIlwiO1xuICBjb25zdCByb290ID0gZml4dHVyZXNSb290IHx8IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCBcImZpeHR1cmVzXCIsIFwiYWdlbnRzXCIpO1xuICByZXR1cm4gcGF0aC5qb2luKHJvb3QsIGNhbm9uaWNhbCwgXCJvdXRwdXQuanNvblwiKTtcbn07XG5cbmNvbnN0IGhhc0ZpeHR1cmVGb3JBZ2VudCA9IChhZ2VudElkLCBmaXh0dXJlc1Jvb3QpID0+IHtcbiAgY29uc3Qgb3V0cHV0UGF0aCA9IHJlc29sdmVGaXh0dXJlT3V0cHV0UGF0aChhZ2VudElkLCBmaXh0dXJlc1Jvb3QpO1xuICByZXR1cm4gQm9vbGVhbihvdXRwdXRQYXRoICYmIGZzLmV4aXN0c1N5bmMob3V0cHV0UGF0aCkpO1xufTtcblxuY29uc3Qgc3RyaXBWb2xhdGlsZSA9ICh2YWx1ZSkgPT4ge1xuICBpZiAoIXZhbHVlIHx8IHR5cGVvZiB2YWx1ZSAhPT0gXCJvYmplY3RcIikgcmV0dXJuIHZhbHVlO1xuICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHJldHVybiB2YWx1ZS5tYXAoKGl0ZW0pID0+IHN0cmlwVm9sYXRpbGUoaXRlbSkpO1xuXG4gIGNvbnN0IG5leHQgPSB7fTtcbiAgT2JqZWN0LmVudHJpZXModmFsdWUpLmZvckVhY2goKFtrZXksIHZhbF0pID0+IHtcbiAgICBpZiAoa2V5ID09PSBcImdlbmVyYXRlZF9hdFwiKSB7XG4gICAgICBuZXh0W2tleV0gPSBcIjE5NzAtMDEtMDFUMDA6MDA6MDAuMDAwWlwiO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoa2V5ID09PSBcInJ1bl9pZFwiIHx8IGtleSA9PT0gXCJ0cmFjZV9pZFwiKSB7XG4gICAgICBuZXh0W2tleV0gPSBcInN0dWItcnVuXCI7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChrZXkgPT09IFwiZHVyYXRpb25fbXNcIikge1xuICAgICAgbmV4dFtrZXldID0gMDtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgbmV4dFtrZXldID0gc3RyaXBWb2xhdGlsZSh2YWwpO1xuICB9KTtcbiAgcmV0dXJuIG5leHQ7XG59O1xuXG5jb25zdCBjbG9uZUpzb24gPSAodmFsdWUpID0+IHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh2YWx1ZSkpO1xuICB9IGNhdGNoIHtcbiAgICByZXR1cm4gdmFsdWU7XG4gIH1cbn07XG5cbmNvbnN0IHBpY2tTY2hlbWFOb2RlID0gKHNjaGVtYSkgPT4ge1xuICBpZiAoIXNjaGVtYSB8fCB0eXBlb2Ygc2NoZW1hICE9PSBcIm9iamVjdFwiKSByZXR1cm4ge307XG4gIGlmIChBcnJheS5pc0FycmF5KHNjaGVtYS5vbmVPZikgJiYgc2NoZW1hLm9uZU9mLmxlbmd0aCkgcmV0dXJuIHNjaGVtYS5vbmVPZlswXSB8fCB7fTtcbiAgaWYgKEFycmF5LmlzQXJyYXkoc2NoZW1hLmFueU9mKSAmJiBzY2hlbWEuYW55T2YubGVuZ3RoKSByZXR1cm4gc2NoZW1hLmFueU9mWzBdIHx8IHt9O1xuICBpZiAoQXJyYXkuaXNBcnJheShzY2hlbWEuYWxsT2YpICYmIHNjaGVtYS5hbGxPZi5sZW5ndGgpIHtcbiAgICByZXR1cm4gc2NoZW1hLmFsbE9mLnJlZHVjZSgoYWNjLCBpdGVtKSA9PiAoeyAuLi5hY2MsIC4uLml0ZW0gfSksIHt9KTtcbiAgfVxuICByZXR1cm4gc2NoZW1hO1xufTtcblxuY29uc3Qgc2NoZW1hVHlwZSA9IChzY2hlbWEpID0+IHtcbiAgY29uc3Qgbm9kZSA9IHBpY2tTY2hlbWFOb2RlKHNjaGVtYSk7XG4gIGlmICghbm9kZSB8fCB0eXBlb2Ygbm9kZSAhPT0gXCJvYmplY3RcIikgcmV0dXJuIFwib2JqZWN0XCI7XG4gIGlmIChub2RlLmNvbnN0ICE9PSB1bmRlZmluZWQpIHJldHVybiB0eXBlb2Ygbm9kZS5jb25zdDtcbiAgaWYgKG5vZGUuZGVmYXVsdCAhPT0gdW5kZWZpbmVkKSByZXR1cm4gdHlwZW9mIG5vZGUuZGVmYXVsdDtcbiAgaWYgKEFycmF5LmlzQXJyYXkobm9kZS5lbnVtKSAmJiBub2RlLmVudW0ubGVuZ3RoKSByZXR1cm4gdHlwZW9mIG5vZGUuZW51bVswXTtcbiAgaWYgKEFycmF5LmlzQXJyYXkobm9kZS50eXBlKSkgcmV0dXJuIG5vZGUudHlwZVswXSB8fCBcIm9iamVjdFwiO1xuICByZXR1cm4gbm9kZS50eXBlIHx8IFwib2JqZWN0XCI7XG59O1xuXG5jb25zdCB2YWx1ZUZvckZvcm1hdCA9IChmb3JtYXQpID0+IHtcbiAgaWYgKGZvcm1hdCA9PT0gXCJkYXRlLXRpbWVcIikgcmV0dXJuIFwiMTk3MC0wMS0wMVQwMDowMDowMC4wMDBaXCI7XG4gIGlmIChmb3JtYXQgPT09IFwiZGF0ZVwiKSByZXR1cm4gXCIxOTcwLTAxLTAxXCI7XG4gIGlmIChmb3JtYXQgPT09IFwiZW1haWxcIikgcmV0dXJuIFwic3R1YkBleGFtcGxlLmNvbVwiO1xuICBpZiAoZm9ybWF0ID09PSBcInVyaVwiIHx8IGZvcm1hdCA9PT0gXCJ1cmxcIikgcmV0dXJuIFwiaHR0cHM6Ly9leGFtcGxlLmNvbVwiO1xuICByZXR1cm4gXCJzdHViXCI7XG59O1xuXG5jb25zdCBidWlsZEZyb21TY2hlbWEgPSAoc2NoZW1hLCBrZXlIaW50ID0gXCJcIikgPT4ge1xuICBjb25zdCBub2RlID0gcGlja1NjaGVtYU5vZGUoc2NoZW1hKTtcbiAgaWYgKCFub2RlIHx8IHR5cGVvZiBub2RlICE9PSBcIm9iamVjdFwiKSByZXR1cm4ge307XG5cbiAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChub2RlLCBcImNvbnN0XCIpKSByZXR1cm4gY2xvbmVKc29uKG5vZGUuY29uc3QpO1xuICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG5vZGUsIFwiZGVmYXVsdFwiKSkgcmV0dXJuIGNsb25lSnNvbihub2RlLmRlZmF1bHQpO1xuICBpZiAoQXJyYXkuaXNBcnJheShub2RlLmVudW0pICYmIG5vZGUuZW51bS5sZW5ndGgpIHJldHVybiBjbG9uZUpzb24obm9kZS5lbnVtWzBdKTtcblxuICBjb25zdCB0eXBlID0gc2NoZW1hVHlwZShub2RlKTtcblxuICBpZiAodHlwZSA9PT0gXCJzdHJpbmdcIikge1xuICAgIGlmIChub2RlLmZvcm1hdCkgcmV0dXJuIHZhbHVlRm9yRm9ybWF0KG5vZGUuZm9ybWF0KTtcbiAgICBpZiAoa2V5SGludC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwiZW1haWxcIikpIHJldHVybiBcInN0dWJAZXhhbXBsZS5jb21cIjtcbiAgICBpZiAoa2V5SGludC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwidXJsXCIpIHx8IGtleUhpbnQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcImxpbmtcIikpIHtcbiAgICAgIHJldHVybiBcImh0dHBzOi8vZXhhbXBsZS5jb21cIjtcbiAgICB9XG4gICAgcmV0dXJuIFwic3R1YlwiO1xuICB9XG5cbiAgaWYgKHR5cGUgPT09IFwibnVtYmVyXCIgfHwgdHlwZSA9PT0gXCJpbnRlZ2VyXCIpIHtcbiAgICBpZiAoTnVtYmVyLmlzRmluaXRlKG5vZGUubWluaW11bSkpIHJldHVybiBOdW1iZXIobm9kZS5taW5pbXVtKTtcbiAgICByZXR1cm4gMDtcbiAgfVxuXG4gIGlmICh0eXBlID09PSBcImJvb2xlYW5cIikgcmV0dXJuIGZhbHNlO1xuXG4gIGlmICh0eXBlID09PSBcImFycmF5XCIpIHtcbiAgICBjb25zdCBpdGVtU2NoZW1hID0gbm9kZS5pdGVtcyB8fCB7fTtcbiAgICByZXR1cm4gW2J1aWxkRnJvbVNjaGVtYShpdGVtU2NoZW1hLCBrZXlIaW50ID8gYCR7a2V5SGludH1faXRlbWAgOiBcIml0ZW1cIildO1xuICB9XG5cbiAgaWYgKHR5cGUgPT09IFwib2JqZWN0XCIpIHtcbiAgICBjb25zdCBwcm9wZXJ0aWVzID0gbm9kZS5wcm9wZXJ0aWVzICYmIHR5cGVvZiBub2RlLnByb3BlcnRpZXMgPT09IFwib2JqZWN0XCIgPyBub2RlLnByb3BlcnRpZXMgOiB7fTtcbiAgICBjb25zdCByZXF1aXJlZCA9IEFycmF5LmlzQXJyYXkobm9kZS5yZXF1aXJlZCkgPyBub2RlLnJlcXVpcmVkIDogW107XG4gICAgY29uc3Qga2V5cyA9IG5ldyBTZXQoWy4uLnJlcXVpcmVkLCAuLi5PYmplY3Qua2V5cyhwcm9wZXJ0aWVzKV0pO1xuICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xuXG4gICAgaWYgKGtleXMuc2l6ZSA9PT0gMCkge1xuICAgICAgcmV0dXJuIGtleUhpbnQgPT09IFwibWV0YVwiID8geyBnZW5lcmF0ZWRfYXQ6IFwiMTk3MC0wMS0wMVQwMDowMDowMC4wMDBaXCIgfSA6IHt9O1xuICAgIH1cblxuICAgIGtleXMuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgICBjb25zdCBjaGlsZFNjaGVtYSA9IHByb3BlcnRpZXNba2V5XSB8fCB7fTtcbiAgICAgIHJlc3VsdFtrZXldID0gYnVpbGRGcm9tU2NoZW1hKGNoaWxkU2NoZW1hLCBrZXkpO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIHJldHVybiB7fTtcbn07XG5cbmNsYXNzIEZha2VMTE1Qcm92aWRlciB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMgPSB7fSkge1xuICAgIHRoaXMubmFtZSA9IFwiZmFrZVwiO1xuICAgIHRoaXMuZml4dHVyZXNSb290ID0gb3B0aW9ucy5maXh0dXJlc1Jvb3QgfHwgcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksIFwiZml4dHVyZXNcIiwgXCJhZ2VudHNcIik7XG4gIH1cblxuICBsb2FkRml4dHVyZURhdGEoYWdlbnRJZCkge1xuICAgIGNvbnN0IG91dHB1dFBhdGggPSByZXNvbHZlRml4dHVyZU91dHB1dFBhdGgoYWdlbnRJZCwgdGhpcy5maXh0dXJlc1Jvb3QpO1xuICAgIGlmICghb3V0cHV0UGF0aCB8fCAhZnMuZXhpc3RzU3luYyhvdXRwdXRQYXRoKSkgcmV0dXJuIG51bGw7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHBhcnNlZCA9IEpTT04ucGFyc2UoZnMucmVhZEZpbGVTeW5jKG91dHB1dFBhdGgsIFwidXRmOFwiKSk7XG4gICAgICBjb25zdCBsZWdhY3lEYXRhID0gcGFyc2VkICYmIHBhcnNlZC5kYXRhID8gcGFyc2VkLmRhdGEgOiBwYXJzZWQ7XG4gICAgICByZXR1cm4gc3RyaXBWb2xhdGlsZShjbG9uZUpzb24obGVnYWN5RGF0YSkpO1xuICAgIH0gY2F0Y2gge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZ2VuZXJhdGVKc29uKHsgc2NoZW1hLCBtZXRhIH0gPSB7fSkge1xuICAgIGNvbnN0IGFnZW50SWQgPSBtZXRhICYmIHR5cGVvZiBtZXRhID09PSBcIm9iamVjdFwiID8gbWV0YS5hZ2VudF9pZCB8fCBtZXRhLmFnZW50SWQgOiBcIlwiO1xuICAgIGNvbnN0IGZpeHR1cmVEYXRhID0gYWdlbnRJZCA/IHRoaXMubG9hZEZpeHR1cmVEYXRhKGFnZW50SWQpIDogbnVsbDtcbiAgICBpZiAoZml4dHVyZURhdGEpIHtcbiAgICAgIHJldHVybiBmaXh0dXJlRGF0YTtcbiAgICB9XG5cbiAgICByZXR1cm4gYnVpbGRGcm9tU2NoZW1hKHNjaGVtYSB8fCB7fSwgXCJyb290XCIpO1xuICB9XG59XG5cbmNvbnN0IHNhbml0aXplU2NoZW1hTmFtZSA9ICh2YWx1ZSkgPT4ge1xuICBjb25zdCBub3JtYWxpemVkID0gU3RyaW5nKHZhbHVlIHx8IFwiYWdlbnRfb3V0cHV0XCIpXG4gICAgLnJlcGxhY2UoL1teYS16QS1aMC05X10vZywgXCJfXCIpXG4gICAgLnJlcGxhY2UoL18rL2csIFwiX1wiKVxuICAgIC5yZXBsYWNlKC9eXyt8XyskL2csIFwiXCIpO1xuICByZXR1cm4gbm9ybWFsaXplZCB8fCBcImFnZW50X291dHB1dFwiO1xufTtcblxuY29uc3Qgc3RyaXBDb2RlRmVuY2VzID0gKHZhbHVlKSA9PlxuICBTdHJpbmcodmFsdWUgfHwgXCJcIilcbiAgICAucmVwbGFjZSgvYGBganNvbi9naSwgXCJgYGBcIilcbiAgICAucmVwbGFjZSgvXmBgYC8sIFwiXCIpXG4gICAgLnJlcGxhY2UoL2BgYCQvLCBcIlwiKVxuICAgIC50cmltKCk7XG5cbmNvbnN0IHBhcnNlSnNvblN0cmluZyA9ICh2YWx1ZSkgPT4ge1xuICBpZiAodHlwZW9mIHZhbHVlICE9PSBcInN0cmluZ1wiKSByZXR1cm4gbnVsbDtcbiAgY29uc3QgZGlyZWN0ID0gdmFsdWUudHJpbSgpO1xuICBpZiAoIWRpcmVjdCkgcmV0dXJuIG51bGw7XG4gIHRyeSB7XG4gICAgcmV0dXJuIEpTT04ucGFyc2UoZGlyZWN0KTtcbiAgfSBjYXRjaCB7XG4gICAgLy8gY29udGludWVcbiAgfVxuICBjb25zdCBzdHJpcHBlZCA9IHN0cmlwQ29kZUZlbmNlcyhkaXJlY3QpO1xuICBpZiAoIXN0cmlwcGVkKSByZXR1cm4gbnVsbDtcbiAgdHJ5IHtcbiAgICByZXR1cm4gSlNPTi5wYXJzZShzdHJpcHBlZCk7XG4gIH0gY2F0Y2gge1xuICAgIHJldHVybiBudWxsO1xuICB9XG59O1xuXG5jb25zdCBleHRyYWN0RXJyb3JNZXNzYWdlID0gKHBheWxvYWQpID0+IHtcbiAgaWYgKCFwYXlsb2FkIHx8IHR5cGVvZiBwYXlsb2FkICE9PSBcIm9iamVjdFwiKSByZXR1cm4gXCJcIjtcbiAgaWYgKHBheWxvYWQuZXJyb3IgJiYgdHlwZW9mIHBheWxvYWQuZXJyb3IgPT09IFwib2JqZWN0XCIpIHtcbiAgICBjb25zdCBtZXNzYWdlID0gcGF5bG9hZC5lcnJvci5tZXNzYWdlIHx8IHBheWxvYWQuZXJyb3IuY29kZTtcbiAgICBpZiAobWVzc2FnZSkgcmV0dXJuIFN0cmluZyhtZXNzYWdlKTtcbiAgfVxuICByZXR1cm4gXCJcIjtcbn07XG5cbmNvbnN0IGdldE51bWVyaWNPcHRpb24gPSAodmFsdWUsIGZhbGxiYWNrKSA9PiB7XG4gIGNvbnN0IG51bWVyaWMgPSBOdW1iZXIodmFsdWUpO1xuICByZXR1cm4gTnVtYmVyLmlzRmluaXRlKG51bWVyaWMpID8gbnVtZXJpYyA6IGZhbGxiYWNrO1xufTtcblxuY2xhc3MgUmVhbExMTVByb3ZpZGVyIHtcbiAgY29uc3RydWN0b3Iob3B0aW9ucyA9IHt9KSB7XG4gICAgdGhpcy5uYW1lID0gXCJyZWFsXCI7XG4gICAgdGhpcy5hcGlLZXkgPSBvcHRpb25zLmFwaUtleSB8fCBwcm9jZXNzLmVudi5PUEVOQUlfQVBJX0tFWSB8fCBcIlwiO1xuICAgIHRoaXMuYmFzZVVybCA9IFN0cmluZyhcbiAgICAgIG9wdGlvbnMuYmFzZVVybCB8fCBwcm9jZXNzLmVudi5PUEVOQUlfQkFTRV9VUkwgfHwgXCJodHRwczovL2FwaS5vcGVuYWkuY29tL3YxXCJcbiAgICApLnJlcGxhY2UoL1xcLyskLywgXCJcIik7XG4gICAgdGhpcy5tb2RlbCA9IG9wdGlvbnMubW9kZWwgfHwgcHJvY2Vzcy5lbnYuT1BFTkFJX01PREVMIHx8IFwiZ3B0LTUtbWluaVwiO1xuICAgIHRoaXMudGltZW91dE1zID0gZ2V0TnVtZXJpY09wdGlvbihvcHRpb25zLnRpbWVvdXRNcyB8fCBwcm9jZXNzLmVudi5PUEVOQUlfVElNRU9VVF9NUywgNDUwMDApO1xuICAgIHRoaXMuZmV0Y2hJbXBsID0gb3B0aW9ucy5mZXRjaCB8fCBnbG9iYWxUaGlzLmZldGNoO1xuICB9XG5cbiAgYXN5bmMgcmVxdWVzdENoYXRDb21wbGV0aW9ucyhwYXlsb2FkKSB7XG4gICAgaWYgKHR5cGVvZiB0aGlzLmZldGNoSW1wbCAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJHbG9iYWwgZmV0Y2ggaXMgbm90IGF2YWlsYWJsZSBmb3IgUmVhbExMTVByb3ZpZGVyLlwiKTtcbiAgICB9XG4gICAgY29uc3QgY29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcbiAgICBjb25zdCB0aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiBjb250cm9sbGVyLmFib3J0KCksIHRoaXMudGltZW91dE1zKTtcbiAgICBsZXQgcmVzcG9uc2U7XG4gICAgdHJ5IHtcbiAgICAgIHJlc3BvbnNlID0gYXdhaXQgdGhpcy5mZXRjaEltcGwoYCR7dGhpcy5iYXNlVXJsfS9jaGF0L2NvbXBsZXRpb25zYCwge1xuICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgXCJjb250ZW50LXR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICAgICAgYXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuYXBpS2V5fWBcbiAgICAgICAgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkocGF5bG9hZCksXG4gICAgICAgIHNpZ25hbDogY29udHJvbGxlci5zaWduYWxcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zdCBtZXNzYWdlID1cbiAgICAgICAgZXJyb3IgJiYgdHlwZW9mIGVycm9yID09PSBcIm9iamVjdFwiICYmIGVycm9yLm5hbWUgPT09IFwiQWJvcnRFcnJvclwiXG4gICAgICAgICAgPyBgT3BlbkFJIHJlcXVlc3QgdGltZWQgb3V0IGFmdGVyICR7dGhpcy50aW1lb3V0TXN9bXNgXG4gICAgICAgICAgOiBgT3BlbkFJIHJlcXVlc3QgZmFpbGVkOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogXCJ1bmtub3duIGVycm9yXCJ9YDtcbiAgICAgIHRocm93IG5ldyBFcnJvcihtZXNzYWdlKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xuICAgIH1cblxuICAgIGNvbnN0IHRleHQgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgY29uc3QgcGFyc2VkID0gcGFyc2VKc29uU3RyaW5nKHRleHQpIHx8IHt9O1xuICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgIGNvbnN0IGFwaU1lc3NhZ2UgPSBleHRyYWN0RXJyb3JNZXNzYWdlKHBhcnNlZCk7XG4gICAgICBjb25zdCByZWFzb24gPSBhcGlNZXNzYWdlIHx8IHRleHQuc2xpY2UoMCwgMzAwKSB8fCBgSFRUUCAke3Jlc3BvbnNlLnN0YXR1c31gO1xuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoYE9wZW5BSSByZXF1ZXN0IGZhaWxlZCAoJHtyZXNwb25zZS5zdGF0dXN9KTogJHtyZWFzb259YCk7XG4gICAgICBlcnJvci5zdGF0dXMgPSByZXNwb25zZS5zdGF0dXM7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gICAgcmV0dXJuIHBhcnNlZDtcbiAgfVxuXG4gIGV4dHJhY3RNZXNzYWdlVGV4dChwYXlsb2FkKSB7XG4gICAgY29uc3QgY29udGVudCA9IHBheWxvYWQ/LmNob2ljZXM/LlswXT8ubWVzc2FnZT8uY29udGVudDtcbiAgICBpZiAodHlwZW9mIGNvbnRlbnQgPT09IFwic3RyaW5nXCIpIHJldHVybiBjb250ZW50O1xuICAgIGlmIChBcnJheS5pc0FycmF5KGNvbnRlbnQpKSB7XG4gICAgICByZXR1cm4gY29udGVudFxuICAgICAgICAubWFwKChwYXJ0KSA9PiB7XG4gICAgICAgICAgaWYgKCFwYXJ0IHx8IHR5cGVvZiBwYXJ0ICE9PSBcIm9iamVjdFwiKSByZXR1cm4gXCJcIjtcbiAgICAgICAgICBpZiAodHlwZW9mIHBhcnQudGV4dCA9PT0gXCJzdHJpbmdcIikgcmV0dXJuIHBhcnQudGV4dDtcbiAgICAgICAgICBpZiAocGFydC50ZXh0ICYmIHR5cGVvZiBwYXJ0LnRleHQgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIHBhcnQudGV4dC52YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgcmV0dXJuIHBhcnQudGV4dC52YWx1ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHR5cGVvZiBwYXJ0LmNvbnRlbnQgPT09IFwic3RyaW5nXCIpIHJldHVybiBwYXJ0LmNvbnRlbnQ7XG4gICAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgICAgIH0pXG4gICAgICAgIC5qb2luKFwiXCIpXG4gICAgICAgIC50cmltKCk7XG4gICAgfVxuICAgIHJldHVybiBcIlwiO1xuICB9XG5cbiAgYnVpbGRNZXNzYWdlcyhzeXN0ZW0sIHByb21wdCwgc2NoZW1hKSB7XG4gICAgY29uc3QgYmFzZVN5c3RlbSA9XG4gICAgICB0eXBlb2Ygc3lzdGVtID09PSBcInN0cmluZ1wiICYmIHN5c3RlbS50cmltKClcbiAgICAgICAgPyBzeXN0ZW0udHJpbSgpXG4gICAgICAgIDogXCJZb3UgYXJlIGEgc3RyaWN0IEpTT04gYXNzaXN0YW50LlwiO1xuICAgIGNvbnN0IHNjaGVtYUhpbnQgPVxuICAgICAgc2NoZW1hICYmIHR5cGVvZiBzY2hlbWEgPT09IFwib2JqZWN0XCIgJiYgT2JqZWN0LmtleXMoc2NoZW1hKS5sZW5ndGhcbiAgICAgICAgPyBgUmV0dXJuIG9ubHkgSlNPTiB0aGF0IG1hdGNoZXMgdGhpcyBzY2hlbWE6XFxuJHtKU09OLnN0cmluZ2lmeShzY2hlbWEpfWBcbiAgICAgICAgOiBcIlJldHVybiBvbmx5IHZhbGlkIEpTT04uXCI7XG4gICAgY29uc3QgdXNlclByb21wdCA9IHR5cGVvZiBwcm9tcHQgPT09IFwic3RyaW5nXCIgJiYgcHJvbXB0LnRyaW0oKSA/IHByb21wdC50cmltKCkgOiBcInt9XCI7XG4gICAgcmV0dXJuIFtcbiAgICAgIHsgcm9sZTogXCJzeXN0ZW1cIiwgY29udGVudDogYCR7YmFzZVN5c3RlbX1cXG5cXG4ke3NjaGVtYUhpbnR9YCB9LFxuICAgICAgeyByb2xlOiBcInVzZXJcIiwgY29udGVudDogdXNlclByb21wdCB9XG4gICAgXTtcbiAgfVxuXG4gIGFzeW5jIGdlbmVyYXRlSnNvbih7IHN5c3RlbSwgcHJvbXB0LCBzY2hlbWEsIHRlbXBlcmF0dXJlLCBtYXhUb2tlbnMsIG1ldGEgfSA9IHt9KSB7XG4gICAgaWYgKCF0aGlzLmFwaUtleSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiT1BFTkFJX0FQSV9LRVkgaXMgcmVxdWlyZWQgd2hlbiBMTE1fUFJPVklERVI9cmVhbC5cIik7XG4gICAgfVxuXG4gICAgY29uc3QgcmVxdWVzdGVkTW9kZWwgPVxuICAgICAgbWV0YSAmJiB0eXBlb2YgbWV0YSA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgbWV0YS5tb2RlbCA9PT0gXCJzdHJpbmdcIlxuICAgICAgICA/IG1ldGEubW9kZWwudHJpbSgpXG4gICAgICAgIDogXCJcIjtcbiAgICBjb25zdCBtb2RlbCA9IHJlcXVlc3RlZE1vZGVsIHx8IHRoaXMubW9kZWw7XG4gICAgY29uc3QgbWVzc2FnZXMgPSB0aGlzLmJ1aWxkTWVzc2FnZXMoc3lzdGVtLCBwcm9tcHQsIHNjaGVtYSk7XG4gICAgY29uc3QgY2FwcGVkVGVtcGVyYXR1cmUgPSBNYXRoLm1pbihNYXRoLm1heChnZXROdW1lcmljT3B0aW9uKHRlbXBlcmF0dXJlLCAwLjIpLCAwKSwgMS41KTtcbiAgICBjb25zdCB0b2tlbkxpbWl0ID0gTWF0aC5tYXgoMjAwLCBNYXRoLm1pbig2MDAwLCBnZXROdW1lcmljT3B0aW9uKG1heFRva2VucywgMTgwMCkpKTtcbiAgICBjb25zdCBoYXNTY2hlbWEgPSBCb29sZWFuKHNjaGVtYSAmJiB0eXBlb2Ygc2NoZW1hID09PSBcIm9iamVjdFwiICYmIE9iamVjdC5rZXlzKHNjaGVtYSkubGVuZ3RoKTtcbiAgICBjb25zdCBzY2hlbWFOYW1lID0gc2FuaXRpemVTY2hlbWFOYW1lKFxuICAgICAgbWV0YSAmJiB0eXBlb2YgbWV0YSA9PT0gXCJvYmplY3RcIiA/IG1ldGEuYWdlbnRfaWQgfHwgbWV0YS5hZ2VudElkIHx8IFwiYWdlbnRfb3V0cHV0XCIgOiBcImFnZW50X291dHB1dFwiXG4gICAgKTtcblxuICAgIGNvbnN0IHdpdGhTY2hlbWFQYXlsb2FkID0ge1xuICAgICAgbW9kZWwsXG4gICAgICBtZXNzYWdlcyxcbiAgICAgIHRlbXBlcmF0dXJlOiBjYXBwZWRUZW1wZXJhdHVyZSxcbiAgICAgIG1heF90b2tlbnM6IHRva2VuTGltaXQsXG4gICAgICByZXNwb25zZV9mb3JtYXQ6IGhhc1NjaGVtYVxuICAgICAgICA/IHtcbiAgICAgICAgICAgIHR5cGU6IFwianNvbl9zY2hlbWFcIixcbiAgICAgICAgICAgIGpzb25fc2NoZW1hOiB7IG5hbWU6IHNjaGVtYU5hbWUsIHN0cmljdDogdHJ1ZSwgc2NoZW1hIH1cbiAgICAgICAgICB9XG4gICAgICAgIDogeyB0eXBlOiBcImpzb25fb2JqZWN0XCIgfVxuICAgIH07XG5cbiAgICBsZXQgZmlyc3RSZXN1bHQ7XG4gICAgdHJ5IHtcbiAgICAgIGZpcnN0UmVzdWx0ID0gYXdhaXQgdGhpcy5yZXF1ZXN0Q2hhdENvbXBsZXRpb25zKHdpdGhTY2hlbWFQYXlsb2FkKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgLy8gU29tZSBtb2RlbHMvZW5kcG9pbnRzIG1heSByZWplY3QganNvbl9zY2hlbWE7IGZhbGxiYWNrIHRvIHBsYWluIGpzb25fb2JqZWN0LlxuICAgICAgY29uc3QgZmFsbGJhY2tQYXlsb2FkID0ge1xuICAgICAgICBtb2RlbCxcbiAgICAgICAgbWVzc2FnZXMsXG4gICAgICAgIHRlbXBlcmF0dXJlOiBjYXBwZWRUZW1wZXJhdHVyZSxcbiAgICAgICAgbWF4X3Rva2VuczogdG9rZW5MaW1pdCxcbiAgICAgICAgcmVzcG9uc2VfZm9ybWF0OiB7IHR5cGU6IFwianNvbl9vYmplY3RcIiB9XG4gICAgICB9O1xuICAgICAgZmlyc3RSZXN1bHQgPSBhd2FpdCB0aGlzLnJlcXVlc3RDaGF0Q29tcGxldGlvbnMoZmFsbGJhY2tQYXlsb2FkKTtcbiAgICB9XG5cbiAgICBjb25zdCB0ZXh0ID0gdGhpcy5leHRyYWN0TWVzc2FnZVRleHQoZmlyc3RSZXN1bHQpO1xuICAgIGNvbnN0IHBhcnNlZCA9IHBhcnNlSnNvblN0cmluZyh0ZXh0KTtcbiAgICBpZiAocGFyc2VkICYmIHR5cGVvZiBwYXJzZWQgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgIHJldHVybiBwYXJzZWQ7XG4gICAgfVxuXG4gICAgdGhyb3cgbmV3IEVycm9yKFwiT3BlbkFJIHJldHVybmVkIG5vbi1KU09OIG91dHB1dCBmb3IgZ2VuZXJhdGVKc29uKCkuXCIpO1xuICB9XG59XG5cbmNvbnN0IGNyZWF0ZUxMTVByb3ZpZGVyID0gKHsgcHJvdmlkZXIsIGZpeHR1cmVzUm9vdCB9ID0ge30pID0+IHtcbiAgY29uc3QgbW9kZSA9IG5vcm1hbGl6ZVByb3ZpZGVyTmFtZShwcm92aWRlciB8fCBnZXRDb25maWd1cmVkUHJvdmlkZXJOYW1lKCkpO1xuICBpZiAobW9kZSA9PT0gXCJyZWFsXCIpIHJldHVybiBuZXcgUmVhbExMTVByb3ZpZGVyKCk7XG4gIHJldHVybiBuZXcgRmFrZUxMTVByb3ZpZGVyKHsgZml4dHVyZXNSb290IH0pO1xufTtcblxubGV0IHNpbmdsZXRvbiA9IG51bGw7XG5cbmNvbnN0IGdldExMTVByb3ZpZGVyID0gKG9wdGlvbnMgPSB7fSkgPT4ge1xuICBpZiAob3B0aW9ucy5mb3JjZU5ldykgcmV0dXJuIGNyZWF0ZUxMTVByb3ZpZGVyKG9wdGlvbnMpO1xuICBpZiAoIXNpbmdsZXRvbikgc2luZ2xldG9uID0gY3JlYXRlTExNUHJvdmlkZXIob3B0aW9ucyk7XG4gIHJldHVybiBzaW5nbGV0b247XG59O1xuXG5jb25zdCBpc0Zha2VMTE1Qcm92aWRlciA9IChwcm92aWRlcikgPT4ge1xuICBjb25zdCBuYW1lID0gcHJvdmlkZXIgJiYgdHlwZW9mIHByb3ZpZGVyID09PSBcIm9iamVjdFwiID8gcHJvdmlkZXIubmFtZSA6IFwiXCI7XG4gIHJldHVybiBub3JtYWxpemVQcm92aWRlck5hbWUobmFtZSkgPT09IFwiZmFrZVwiO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIEZha2VMTE1Qcm92aWRlcixcbiAgUmVhbExMTVByb3ZpZGVyLFxuICBidWlsZEZyb21TY2hlbWEsXG4gIGNhbm9uaWNhbEFnZW50SWQsXG4gIGNyZWF0ZUxMTVByb3ZpZGVyLFxuICBnZXRDb25maWd1cmVkUHJvdmlkZXJOYW1lLFxuICBnZXRMTE1Qcm92aWRlcixcbiAgaGFzUmVhbFByb3ZpZGVyQ3JlZGVudGlhbHMsXG4gIGhhc0ZpeHR1cmVGb3JBZ2VudCxcbiAgaXNGYWtlTExNUHJvdmlkZXIsXG4gIHJlc29sdmVGaXh0dXJlT3V0cHV0UGF0aCxcbiAgc3RyaXBWb2xhdGlsZVxufTtcbiJdLCJuYW1lcyI6WyJmcyIsInJlcXVpcmUiLCJwYXRoIiwiREVGQVVMVF9QUk9WSURFUiIsIm5vcm1hbGl6ZVByb3ZpZGVyTmFtZSIsInZhbHVlIiwibm9ybWFsaXplZCIsIlN0cmluZyIsInRyaW0iLCJ0b0xvd2VyQ2FzZSIsImdldENvbmZpZ3VyZWRQcm92aWRlck5hbWUiLCJwcm9jZXNzIiwiZW52IiwiTExNX1BST1ZJREVSIiwiaGFzUmVhbFByb3ZpZGVyQ3JlZGVudGlhbHMiLCJCb29sZWFuIiwiT1BFTkFJX0FQSV9LRVkiLCJBR0VOVF9JRF9BTElBU0VTIiwicGxhdG9uIiwiYW5hdG9seSIsIm1heGltIiwiY2Fub25pY2FsQWdlbnRJZCIsImFnZW50SWQiLCJyZXNvbHZlRml4dHVyZU91dHB1dFBhdGgiLCJmaXh0dXJlc1Jvb3QiLCJjYW5vbmljYWwiLCJyb290Iiwiam9pbiIsImN3ZCIsImhhc0ZpeHR1cmVGb3JBZ2VudCIsIm91dHB1dFBhdGgiLCJleGlzdHNTeW5jIiwic3RyaXBWb2xhdGlsZSIsIkFycmF5IiwiaXNBcnJheSIsIm1hcCIsIml0ZW0iLCJuZXh0IiwiT2JqZWN0IiwiZW50cmllcyIsImZvckVhY2giLCJrZXkiLCJ2YWwiLCJjbG9uZUpzb24iLCJKU09OIiwicGFyc2UiLCJzdHJpbmdpZnkiLCJwaWNrU2NoZW1hTm9kZSIsInNjaGVtYSIsIm9uZU9mIiwibGVuZ3RoIiwiYW55T2YiLCJhbGxPZiIsInJlZHVjZSIsImFjYyIsInNjaGVtYVR5cGUiLCJub2RlIiwiY29uc3QiLCJ1bmRlZmluZWQiLCJkZWZhdWx0IiwiZW51bSIsInR5cGUiLCJ2YWx1ZUZvckZvcm1hdCIsImZvcm1hdCIsImJ1aWxkRnJvbVNjaGVtYSIsImtleUhpbnQiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJpbmNsdWRlcyIsIk51bWJlciIsImlzRmluaXRlIiwibWluaW11bSIsIml0ZW1TY2hlbWEiLCJpdGVtcyIsInByb3BlcnRpZXMiLCJyZXF1aXJlZCIsImtleXMiLCJTZXQiLCJyZXN1bHQiLCJzaXplIiwiZ2VuZXJhdGVkX2F0IiwiY2hpbGRTY2hlbWEiLCJGYWtlTExNUHJvdmlkZXIiLCJvcHRpb25zIiwibmFtZSIsImxvYWRGaXh0dXJlRGF0YSIsInBhcnNlZCIsInJlYWRGaWxlU3luYyIsImxlZ2FjeURhdGEiLCJkYXRhIiwiZ2VuZXJhdGVKc29uIiwibWV0YSIsImFnZW50X2lkIiwiZml4dHVyZURhdGEiLCJzYW5pdGl6ZVNjaGVtYU5hbWUiLCJyZXBsYWNlIiwic3RyaXBDb2RlRmVuY2VzIiwicGFyc2VKc29uU3RyaW5nIiwiZGlyZWN0Iiwic3RyaXBwZWQiLCJleHRyYWN0RXJyb3JNZXNzYWdlIiwicGF5bG9hZCIsImVycm9yIiwibWVzc2FnZSIsImNvZGUiLCJnZXROdW1lcmljT3B0aW9uIiwiZmFsbGJhY2siLCJudW1lcmljIiwiUmVhbExMTVByb3ZpZGVyIiwiYXBpS2V5IiwiYmFzZVVybCIsIk9QRU5BSV9CQVNFX1VSTCIsIm1vZGVsIiwiT1BFTkFJX01PREVMIiwidGltZW91dE1zIiwiT1BFTkFJX1RJTUVPVVRfTVMiLCJmZXRjaEltcGwiLCJmZXRjaCIsImdsb2JhbFRoaXMiLCJyZXF1ZXN0Q2hhdENvbXBsZXRpb25zIiwiRXJyb3IiLCJjb250cm9sbGVyIiwiQWJvcnRDb250cm9sbGVyIiwidGltZW91dCIsInNldFRpbWVvdXQiLCJhYm9ydCIsInJlc3BvbnNlIiwibWV0aG9kIiwiaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJib2R5Iiwic2lnbmFsIiwiY2xlYXJUaW1lb3V0IiwidGV4dCIsIm9rIiwiYXBpTWVzc2FnZSIsInJlYXNvbiIsInNsaWNlIiwic3RhdHVzIiwiZXh0cmFjdE1lc3NhZ2VUZXh0IiwiY29udGVudCIsImNob2ljZXMiLCJwYXJ0IiwiYnVpbGRNZXNzYWdlcyIsInN5c3RlbSIsInByb21wdCIsImJhc2VTeXN0ZW0iLCJzY2hlbWFIaW50IiwidXNlclByb21wdCIsInJvbGUiLCJ0ZW1wZXJhdHVyZSIsIm1heFRva2VucyIsInJlcXVlc3RlZE1vZGVsIiwibWVzc2FnZXMiLCJjYXBwZWRUZW1wZXJhdHVyZSIsIk1hdGgiLCJtaW4iLCJtYXgiLCJ0b2tlbkxpbWl0IiwiaGFzU2NoZW1hIiwic2NoZW1hTmFtZSIsIndpdGhTY2hlbWFQYXlsb2FkIiwibWF4X3Rva2VucyIsInJlc3BvbnNlX2Zvcm1hdCIsImpzb25fc2NoZW1hIiwic3RyaWN0IiwiZmlyc3RSZXN1bHQiLCJmYWxsYmFja1BheWxvYWQiLCJjcmVhdGVMTE1Qcm92aWRlciIsInByb3ZpZGVyIiwibW9kZSIsInNpbmdsZXRvbiIsImdldExMTVByb3ZpZGVyIiwiZm9yY2VOZXciLCJpc0Zha2VMTE1Qcm92aWRlciIsIm1vZHVsZSIsImV4cG9ydHMiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/llm/provider.js\n");

/***/ }),

/***/ "(rsc)/./utils/agentEnvelope.js":
/*!********************************!*\
  !*** ./utils/agentEnvelope.js ***!
  \********************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("\nconst { randomUUID } = __webpack_require__(/*! crypto */ \"crypto\");\nconst { getAgentSchema } = __webpack_require__(/*! ./agentSchemas */ \"(rsc)/./utils/agentSchemas.js\");\nconst { validateAgentResponse } = __webpack_require__(/*! ./validateAgentResponse */ \"(rsc)/./utils/validateAgentResponse.js\");\nconst { buildHandoff } = __webpack_require__(/*! ./handoff */ \"(rsc)/./utils/handoff.js\");\nconst { getConfiguredProviderName, hasRealProviderCredentials } = __webpack_require__(/*! ../lib/llm/provider.js */ \"(rsc)/./lib/llm/provider.js\");\nconst makeRunId = ()=>{\n    if (typeof randomUUID === \"function\") {\n        return randomUUID();\n    }\n    const rand = Math.random().toString(36).slice(2, 8);\n    return `run_${Date.now()}_${rand}`;\n};\nconst deriveQualityChecks = (legacyMeta = {})=>{\n    const legacy = legacyMeta && legacyMeta.quality_checks ? legacyMeta.quality_checks : {};\n    const providerName = getConfiguredProviderName();\n    const withinLimits = typeof legacy.within_max_words === \"boolean\" ? legacy.within_max_words : typeof legacy.within_limits === \"boolean\" ? legacy.within_limits : true;\n    const noFabrication = typeof legacy.no_fabrication === \"boolean\" ? legacy.no_fabrication : typeof legacy.no_gray_scraping === \"boolean\" ? legacy.no_gray_scraping : true;\n    const dedupeOk = typeof legacy.dedupe_ok === \"boolean\" ? legacy.dedupe_ok : true;\n    const groundingOk = typeof legacy.grounded_claims_ok === \"boolean\" ? legacy.grounded_claims_ok : typeof legacy.grounding_ok === \"boolean\" ? legacy.grounding_ok : true;\n    const llmConnectedByEnv = providerName === \"real\" && hasRealProviderCredentials();\n    return {\n        no_fabrication: noFabrication,\n        within_limits: withinLimits,\n        dedupe_ok: dedupeOk,\n        grounding_ok: groundingOk,\n        llm_connected: typeof legacy.llm_connected === \"boolean\" ? legacy.llm_connected : llmConnectedByEnv,\n        schema_valid: true\n    };\n};\nconst unwrapLegacy = (payload)=>{\n    if (payload && payload.data && payload.meta) return payload.data;\n    return payload;\n};\nconst sanitizeInputEcho = (input)=>{\n    if (!input || typeof input !== \"object\") return input;\n    const clone = Array.isArray(input) ? [\n        ...input\n    ] : {\n        ...input\n    };\n    if (Array.isArray(clone)) return clone;\n    Object.keys(clone).forEach((key)=>{\n        if (key.startsWith(\"__\")) {\n            delete clone[key];\n        }\n    });\n    return clone;\n};\nconst wrapAgentOutput = ({ agentId, inputEcho, mode, legacyOutput, webStatsOverride, traceId })=>{\n    const data = legacyOutput || {};\n    const legacyMeta = data && data.meta ? data.meta : {};\n    const schema = getAgentSchema(agentId);\n    const validation = validateAgentResponse(data, schema);\n    const qualityChecks = deriveQualityChecks(legacyMeta);\n    qualityChecks.schema_valid = validation.ok;\n    const limitations = Array.isArray(legacyMeta.limitations) ? legacyMeta.limitations : [];\n    const assumptions = Array.isArray(legacyMeta.assumptions) ? legacyMeta.assumptions : [];\n    const warnings = Array.isArray(legacyMeta.warnings) ? legacyMeta.warnings : [];\n    const budgetApplied = legacyMeta && typeof legacyMeta.budget_applied === \"object\" ? legacyMeta.budget_applied : null;\n    const knowledgeUsed = legacyMeta && legacyMeta.knowledge_used || inputEcho && inputEcho.__knowledge_used || {\n        workspace_items: 0,\n        agent_items: 0,\n        top_ids: []\n    };\n    const web_stats = webStatsOverride || (legacyMeta && legacyMeta.web_stats ? legacyMeta.web_stats : null);\n    const handoff = buildHandoff(agentId, data);\n    const envelopeMeta = {\n        agent_id: agentId,\n        generated_at: new Date().toISOString(),\n        run_id: makeRunId(),\n        mode: mode || \"\",\n        input_echo: sanitizeInputEcho(inputEcho) || {},\n        quality_checks: qualityChecks,\n        limitations,\n        assumptions,\n        handoff,\n        web_stats,\n        knowledge_used: knowledgeUsed\n    };\n    if (warnings.length) {\n        envelopeMeta.warnings = warnings;\n    }\n    if (budgetApplied) {\n        envelopeMeta.budget_applied = budgetApplied;\n    }\n    const hasWebStats = web_stats && typeof web_stats === \"object\";\n    const trace_id = traceId || (hasWebStats ? envelopeMeta.run_id : undefined);\n    if (trace_id) {\n        envelopeMeta.trace_id = trace_id;\n    }\n    return {\n        data,\n        meta: envelopeMeta,\n        validation\n    };\n};\nmodule.exports = {\n    wrapAgentOutput,\n    unwrapLegacy\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUEsSUFBSUgsU0FBU2lCLE1BQU0sRUFBRTtRQUNuQk4sYUFBYVgsUUFBUSxHQUFHQTtJQUMxQjtJQUNBLElBQUlDLGVBQWU7UUFDakJVLGFBQWFULGNBQWMsR0FBR0Q7SUFDaEM7SUFFQSxNQUFNaUIsY0FBY1QsYUFBYSxPQUFPQSxjQUFjO0lBQ3RELE1BQU1VLFdBQVcxQixXQUFZeUIsQ0FBQUEsY0FBY1AsYUFBYUksTUFBTSxHQUFHSyxTQUFRO0lBQ3pFLElBQUlELFVBQVU7UUFDWlIsYUFBYVEsUUFBUSxHQUFHQTtJQUMxQjtJQUVBLE9BQU87UUFBRTVDO1FBQU1DLE1BQU1tQztRQUFjaEI7SUFBVztBQUNoRDtBQUVBMEIsT0FBT0MsT0FBTyxHQUFHO0lBQ2ZuQztJQUNBZDtBQUNGIiwic291cmNlcyI6WyIvVXNlcnMvYWJ1emFkYS9EZXNrdG9wL2FnZW50T1MvdXRpbHMvYWdlbnRFbnZlbG9wZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB7IHJhbmRvbVVVSUQgfSA9IHJlcXVpcmUoXCJjcnlwdG9cIik7XG5jb25zdCB7IGdldEFnZW50U2NoZW1hIH0gPSByZXF1aXJlKFwiLi9hZ2VudFNjaGVtYXNcIik7XG5jb25zdCB7IHZhbGlkYXRlQWdlbnRSZXNwb25zZSB9ID0gcmVxdWlyZShcIi4vdmFsaWRhdGVBZ2VudFJlc3BvbnNlXCIpO1xuY29uc3QgeyBidWlsZEhhbmRvZmYgfSA9IHJlcXVpcmUoXCIuL2hhbmRvZmZcIik7XG5jb25zdCB7XG4gIGdldENvbmZpZ3VyZWRQcm92aWRlck5hbWUsXG4gIGhhc1JlYWxQcm92aWRlckNyZWRlbnRpYWxzXG59ID0gcmVxdWlyZShcIi4uL2xpYi9sbG0vcHJvdmlkZXIuanNcIik7XG5cbmNvbnN0IG1ha2VSdW5JZCA9ICgpID0+IHtcbiAgaWYgKHR5cGVvZiByYW5kb21VVUlEID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICByZXR1cm4gcmFuZG9tVVVJRCgpO1xuICB9XG4gIGNvbnN0IHJhbmQgPSBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zbGljZSgyLCA4KTtcbiAgcmV0dXJuIGBydW5fJHtEYXRlLm5vdygpfV8ke3JhbmR9YDtcbn07XG5cbmNvbnN0IGRlcml2ZVF1YWxpdHlDaGVja3MgPSAobGVnYWN5TWV0YSA9IHt9KSA9PiB7XG4gIGNvbnN0IGxlZ2FjeSA9IGxlZ2FjeU1ldGEgJiYgbGVnYWN5TWV0YS5xdWFsaXR5X2NoZWNrcyA/IGxlZ2FjeU1ldGEucXVhbGl0eV9jaGVja3MgOiB7fTtcbiAgY29uc3QgcHJvdmlkZXJOYW1lID0gZ2V0Q29uZmlndXJlZFByb3ZpZGVyTmFtZSgpO1xuICBjb25zdCB3aXRoaW5MaW1pdHMgPVxuICAgIHR5cGVvZiBsZWdhY3kud2l0aGluX21heF93b3JkcyA9PT0gXCJib29sZWFuXCJcbiAgICAgID8gbGVnYWN5LndpdGhpbl9tYXhfd29yZHNcbiAgICAgIDogdHlwZW9mIGxlZ2FjeS53aXRoaW5fbGltaXRzID09PSBcImJvb2xlYW5cIlxuICAgICAgICA/IGxlZ2FjeS53aXRoaW5fbGltaXRzXG4gICAgICAgIDogdHJ1ZTtcbiAgY29uc3Qgbm9GYWJyaWNhdGlvbiA9XG4gICAgdHlwZW9mIGxlZ2FjeS5ub19mYWJyaWNhdGlvbiA9PT0gXCJib29sZWFuXCJcbiAgICAgID8gbGVnYWN5Lm5vX2ZhYnJpY2F0aW9uXG4gICAgICA6IHR5cGVvZiBsZWdhY3kubm9fZ3JheV9zY3JhcGluZyA9PT0gXCJib29sZWFuXCJcbiAgICAgICAgPyBsZWdhY3kubm9fZ3JheV9zY3JhcGluZ1xuICAgICAgICA6IHRydWU7XG4gIGNvbnN0IGRlZHVwZU9rID0gdHlwZW9mIGxlZ2FjeS5kZWR1cGVfb2sgPT09IFwiYm9vbGVhblwiID8gbGVnYWN5LmRlZHVwZV9vayA6IHRydWU7XG4gIGNvbnN0IGdyb3VuZGluZ09rID1cbiAgICB0eXBlb2YgbGVnYWN5Lmdyb3VuZGVkX2NsYWltc19vayA9PT0gXCJib29sZWFuXCJcbiAgICAgID8gbGVnYWN5Lmdyb3VuZGVkX2NsYWltc19va1xuICAgICAgOiB0eXBlb2YgbGVnYWN5Lmdyb3VuZGluZ19vayA9PT0gXCJib29sZWFuXCJcbiAgICAgICAgPyBsZWdhY3kuZ3JvdW5kaW5nX29rXG4gICAgICAgIDogdHJ1ZTtcbiAgY29uc3QgbGxtQ29ubmVjdGVkQnlFbnYgPSBwcm92aWRlck5hbWUgPT09IFwicmVhbFwiICYmIGhhc1JlYWxQcm92aWRlckNyZWRlbnRpYWxzKCk7XG4gIHJldHVybiB7XG4gICAgbm9fZmFicmljYXRpb246IG5vRmFicmljYXRpb24sXG4gICAgd2l0aGluX2xpbWl0czogd2l0aGluTGltaXRzLFxuICAgIGRlZHVwZV9vazogZGVkdXBlT2ssXG4gICAgZ3JvdW5kaW5nX29rOiBncm91bmRpbmdPayxcbiAgICBsbG1fY29ubmVjdGVkOlxuICAgICAgdHlwZW9mIGxlZ2FjeS5sbG1fY29ubmVjdGVkID09PSBcImJvb2xlYW5cIlxuICAgICAgICA/IGxlZ2FjeS5sbG1fY29ubmVjdGVkXG4gICAgICAgIDogbGxtQ29ubmVjdGVkQnlFbnYsXG4gICAgc2NoZW1hX3ZhbGlkOiB0cnVlXG4gIH07XG59O1xuXG5jb25zdCB1bndyYXBMZWdhY3kgPSAocGF5bG9hZCkgPT4ge1xuICBpZiAocGF5bG9hZCAmJiBwYXlsb2FkLmRhdGEgJiYgcGF5bG9hZC5tZXRhKSByZXR1cm4gcGF5bG9hZC5kYXRhO1xuICByZXR1cm4gcGF5bG9hZDtcbn07XG5cbmNvbnN0IHNhbml0aXplSW5wdXRFY2hvID0gKGlucHV0KSA9PiB7XG4gIGlmICghaW5wdXQgfHwgdHlwZW9mIGlucHV0ICE9PSBcIm9iamVjdFwiKSByZXR1cm4gaW5wdXQ7XG4gIGNvbnN0IGNsb25lID0gQXJyYXkuaXNBcnJheShpbnB1dCkgPyBbLi4uaW5wdXRdIDogeyAuLi5pbnB1dCB9O1xuICBpZiAoQXJyYXkuaXNBcnJheShjbG9uZSkpIHJldHVybiBjbG9uZTtcbiAgT2JqZWN0LmtleXMoY2xvbmUpLmZvckVhY2goKGtleSkgPT4ge1xuICAgIGlmIChrZXkuc3RhcnRzV2l0aChcIl9fXCIpKSB7XG4gICAgICBkZWxldGUgY2xvbmVba2V5XTtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gY2xvbmU7XG59O1xuXG5jb25zdCB3cmFwQWdlbnRPdXRwdXQgPSAoe1xuICBhZ2VudElkLFxuICBpbnB1dEVjaG8sXG4gIG1vZGUsXG4gIGxlZ2FjeU91dHB1dCxcbiAgd2ViU3RhdHNPdmVycmlkZSxcbiAgdHJhY2VJZFxufSkgPT4ge1xuICBjb25zdCBkYXRhID0gbGVnYWN5T3V0cHV0IHx8IHt9O1xuICBjb25zdCBsZWdhY3lNZXRhID0gZGF0YSAmJiBkYXRhLm1ldGEgPyBkYXRhLm1ldGEgOiB7fTtcbiAgY29uc3Qgc2NoZW1hID0gZ2V0QWdlbnRTY2hlbWEoYWdlbnRJZCk7XG4gIGNvbnN0IHZhbGlkYXRpb24gPSB2YWxpZGF0ZUFnZW50UmVzcG9uc2UoZGF0YSwgc2NoZW1hKTtcblxuICBjb25zdCBxdWFsaXR5Q2hlY2tzID0gZGVyaXZlUXVhbGl0eUNoZWNrcyhsZWdhY3lNZXRhKTtcbiAgcXVhbGl0eUNoZWNrcy5zY2hlbWFfdmFsaWQgPSB2YWxpZGF0aW9uLm9rO1xuXG4gIGNvbnN0IGxpbWl0YXRpb25zID0gQXJyYXkuaXNBcnJheShsZWdhY3lNZXRhLmxpbWl0YXRpb25zKSA/IGxlZ2FjeU1ldGEubGltaXRhdGlvbnMgOiBbXTtcbiAgY29uc3QgYXNzdW1wdGlvbnMgPSBBcnJheS5pc0FycmF5KGxlZ2FjeU1ldGEuYXNzdW1wdGlvbnMpID8gbGVnYWN5TWV0YS5hc3N1bXB0aW9ucyA6IFtdO1xuICBjb25zdCB3YXJuaW5ncyA9IEFycmF5LmlzQXJyYXkobGVnYWN5TWV0YS53YXJuaW5ncykgPyBsZWdhY3lNZXRhLndhcm5pbmdzIDogW107XG4gIGNvbnN0IGJ1ZGdldEFwcGxpZWQgPVxuICAgIGxlZ2FjeU1ldGEgJiYgdHlwZW9mIGxlZ2FjeU1ldGEuYnVkZ2V0X2FwcGxpZWQgPT09IFwib2JqZWN0XCJcbiAgICAgID8gbGVnYWN5TWV0YS5idWRnZXRfYXBwbGllZFxuICAgICAgOiBudWxsO1xuICBjb25zdCBrbm93bGVkZ2VVc2VkID1cbiAgICAobGVnYWN5TWV0YSAmJiBsZWdhY3lNZXRhLmtub3dsZWRnZV91c2VkKSB8fFxuICAgIChpbnB1dEVjaG8gJiYgaW5wdXRFY2hvLl9fa25vd2xlZGdlX3VzZWQpIHx8XG4gICAgeyB3b3Jrc3BhY2VfaXRlbXM6IDAsIGFnZW50X2l0ZW1zOiAwLCB0b3BfaWRzOiBbXSB9O1xuXG4gIGNvbnN0IHdlYl9zdGF0cyA9XG4gICAgd2ViU3RhdHNPdmVycmlkZSB8fCAobGVnYWN5TWV0YSAmJiBsZWdhY3lNZXRhLndlYl9zdGF0cyA/IGxlZ2FjeU1ldGEud2ViX3N0YXRzIDogbnVsbCk7XG5cbiAgY29uc3QgaGFuZG9mZiA9IGJ1aWxkSGFuZG9mZihhZ2VudElkLCBkYXRhKTtcblxuICBjb25zdCBlbnZlbG9wZU1ldGEgPSB7XG4gICAgYWdlbnRfaWQ6IGFnZW50SWQsXG4gICAgZ2VuZXJhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgcnVuX2lkOiBtYWtlUnVuSWQoKSxcbiAgICBtb2RlOiBtb2RlIHx8IFwiXCIsXG4gICAgaW5wdXRfZWNobzogc2FuaXRpemVJbnB1dEVjaG8oaW5wdXRFY2hvKSB8fCB7fSxcbiAgICBxdWFsaXR5X2NoZWNrczogcXVhbGl0eUNoZWNrcyxcbiAgICBsaW1pdGF0aW9ucyxcbiAgICBhc3N1bXB0aW9ucyxcbiAgICBoYW5kb2ZmLFxuICAgIHdlYl9zdGF0cyxcbiAgICBrbm93bGVkZ2VfdXNlZDoga25vd2xlZGdlVXNlZFxuICB9O1xuXG4gIGlmICh3YXJuaW5ncy5sZW5ndGgpIHtcbiAgICBlbnZlbG9wZU1ldGEud2FybmluZ3MgPSB3YXJuaW5ncztcbiAgfVxuICBpZiAoYnVkZ2V0QXBwbGllZCkge1xuICAgIGVudmVsb3BlTWV0YS5idWRnZXRfYXBwbGllZCA9IGJ1ZGdldEFwcGxpZWQ7XG4gIH1cblxuICBjb25zdCBoYXNXZWJTdGF0cyA9IHdlYl9zdGF0cyAmJiB0eXBlb2Ygd2ViX3N0YXRzID09PSBcIm9iamVjdFwiO1xuICBjb25zdCB0cmFjZV9pZCA9IHRyYWNlSWQgfHwgKGhhc1dlYlN0YXRzID8gZW52ZWxvcGVNZXRhLnJ1bl9pZCA6IHVuZGVmaW5lZCk7XG4gIGlmICh0cmFjZV9pZCkge1xuICAgIGVudmVsb3BlTWV0YS50cmFjZV9pZCA9IHRyYWNlX2lkO1xuICB9XG5cbiAgcmV0dXJuIHsgZGF0YSwgbWV0YTogZW52ZWxvcGVNZXRhLCB2YWxpZGF0aW9uIH07XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgd3JhcEFnZW50T3V0cHV0LFxuICB1bndyYXBMZWdhY3lcbn07XG4iXSwibmFtZXMiOlsicmFuZG9tVVVJRCIsInJlcXVpcmUiLCJnZXRBZ2VudFNjaGVtYSIsInZhbGlkYXRlQWdlbnRSZXNwb25zZSIsImJ1aWxkSGFuZG9mZiIsImdldENvbmZpZ3VyZWRQcm92aWRlck5hbWUiLCJoYXNSZWFsUHJvdmlkZXJDcmVkZW50aWFscyIsIm1ha2VSdW5JZCIsInJhbmQiLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJzbGljZSIsIkRhdGUiLCJub3ciLCJkZXJpdmVRdWFsaXR5Q2hlY2tzIiwibGVnYWN5TWV0YSIsImxlZ2FjeSIsInF1YWxpdHlfY2hlY2tzIiwicHJvdmlkZXJOYW1lIiwid2l0aGluTGltaXRzIiwid2l0aGluX21heF93b3JkcyIsIndpdGhpbl9saW1pdHMiLCJub0ZhYnJpY2F0aW9uIiwibm9fZmFicmljYXRpb24iLCJub19ncmF5X3NjcmFwaW5nIiwiZGVkdXBlT2siLCJkZWR1cGVfb2siLCJncm91bmRpbmdPayIsImdyb3VuZGVkX2NsYWltc19vayIsImdyb3VuZGluZ19vayIsImxsbUNvbm5lY3RlZEJ5RW52IiwibGxtX2Nvbm5lY3RlZCIsInNjaGVtYV92YWxpZCIsInVud3JhcExlZ2FjeSIsInBheWxvYWQiLCJkYXRhIiwibWV0YSIsInNhbml0aXplSW5wdXRFY2hvIiwiaW5wdXQiLCJjbG9uZSIsIkFycmF5IiwiaXNBcnJheSIsIk9iamVjdCIsImtleXMiLCJmb3JFYWNoIiwia2V5Iiwic3RhcnRzV2l0aCIsIndyYXBBZ2VudE91dHB1dCIsImFnZW50SWQiLCJpbnB1dEVjaG8iLCJtb2RlIiwibGVnYWN5T3V0cHV0Iiwid2ViU3RhdHNPdmVycmlkZSIsInRyYWNlSWQiLCJzY2hlbWEiLCJ2YWxpZGF0aW9uIiwicXVhbGl0eUNoZWNrcyIsIm9rIiwibGltaXRhdGlvbnMiLCJhc3N1bXB0aW9ucyIsIndhcm5pbmdzIiwiYnVkZ2V0QXBwbGllZCIsImJ1ZGdldF9hcHBsaWVkIiwia25vd2xlZGdlVXNlZCIsImtub3dsZWRnZV91c2VkIiwiX19rbm93bGVkZ2VfdXNlZCIsIndvcmtzcGFjZV9pdGVtcyIsImFnZW50X2l0ZW1zIiwidG9wX2lkcyIsIndlYl9zdGF0cyIsImhhbmRvZmYiLCJlbnZlbG9wZU1ldGEiLCJhZ2VudF9pZCIsImdlbmVyYXRlZF9hdCIsInRvSVNPU3RyaW5nIiwicnVuX2lkIiwiaW5wdXRfZWNobyIsImxlbmd0aCIsImhhc1dlYlN0YXRzIiwidHJhY2VfaWQiLCJ1bmRlZmluZWQiLCJtb2R1bGUiLCJleHBvcnRzIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./utils/agentEnvelope.js\n");

/***/ }),

/***/ "(rsc)/./utils/agentSchemas.js":
/*!*******************************!*\
  !*** ./utils/agentSchemas.js ***!
  \*******************************/
/***/ ((module) => {

eval("\nconst platonSchema = {\n    required: {\n        segments: \"array\",\n        company_candidates: \"array\",\n        meta: \"object\"\n    }\n};\nconst agentSchemas = {\n    \"platon-prospect-research-ru\": platonSchema,\n    platon: platonSchema,\n    \"anatoly-account-research-ru\": {\n        required: {\n            account_card: \"object\",\n            meta: \"object\"\n        }\n    },\n    \"timofey-competitor-analysis-ru\": {\n        required: {\n            competitors: \"array\",\n            comparison_table: \"array\",\n            win_angles: \"array\",\n            agentos_positioning: \"object\",\n            offers: \"object\",\n            meta: \"object\"\n        }\n    },\n    \"maxim-local-leads-ru\": {\n        required: {\n            leads: \"array\",\n            meta: \"object\"\n        }\n    },\n    \"fedor-b2b-leads-ru\": {\n        required: {\n            leads: \"array\",\n            meta: \"object\"\n        }\n    },\n    \"artem-hot-leads-ru\": {\n        required: {\n            hot_leads: \"array\",\n            meta: \"object\"\n        }\n    },\n    \"leonid-outreach-dm-ru\": {\n        required: {\n            dm_pack: \"object\",\n            meta: \"object\"\n        }\n    },\n    \"emelyan-cold-email-ru\": {\n        required: {\n            email_sequences: \"array\",\n            meta: \"object\"\n        }\n    },\n    \"boris-bdr-operator-ru\": {\n        required: {\n            bdr_table: \"array\",\n            meta: \"object\"\n        }\n    },\n    \"pavel-reels-analysis-ru\": {\n        required: {\n            analysis: \"object\",\n            script_skeleton: \"object\",\n            improvements: \"object\",\n            meta: \"object\"\n        }\n    },\n    \"trofim-shorts-analogs-ru\": {\n        required: {\n            formats: \"array\",\n            recommendations: \"object\",\n            meta: \"object\"\n        }\n    },\n    \"irina-content-ideation-ru\": {\n        required: {\n            pillars: \"array\",\n            topics: \"array\",\n            cta_bank: \"object\",\n            meta: \"object\"\n        }\n    },\n    \"hariton-viral-hooks-ru\": {\n        required: {\n            hooks: \"array\",\n            posts: \"array\",\n            scripts: \"array\",\n            meta: \"object\"\n        }\n    },\n    \"kostya-image-generation-ru\": {\n        required: {\n            concepts: \"array\",\n            meta: \"object\"\n        }\n    },\n    \"seva-content-repurposing-ru\": {\n        required: {\n            pack: \"object\",\n            meta: \"object\"\n        }\n    },\n    \"mitya-workflow-diagram-ru\": {\n        required: {\n            diagram: \"object\",\n            landing_text: \"object\",\n            deck_script: \"object\",\n            meta: \"object\"\n        }\n    },\n    \"board-ceo-ru\": {\n        required: {\n            review: \"object\",\n            meta: \"object\"\n        }\n    },\n    \"board-cto-ru\": {\n        required: {\n            review: \"object\",\n            meta: \"object\"\n        }\n    },\n    \"board-cfo-ru\": {\n        required: {\n            review: \"object\",\n            meta: \"object\"\n        }\n    },\n    \"board-chair-ru\": {\n        required: {\n            review: \"object\",\n            meta: \"object\"\n        }\n    }\n};\nconst getAgentSchema = (agentId)=>agentSchemas[agentId] || null;\nmodule.exports = {\n    agentSchemas,\n    getAgentSchema\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi91dGlscy9hZ2VudFNjaGVtYXMuanMiLCJtYXBwaW5ncyI6IjtBQUFBLE1BQU1BLGVBQWU7SUFDbkJDLFVBQVU7UUFBRUMsVUFBVTtRQUFTQyxvQkFBb0I7UUFBU0MsTUFBTTtJQUFTO0FBQzdFO0FBRUEsTUFBTUMsZUFBZTtJQUNuQiwrQkFBK0JMO0lBQy9CTSxRQUFRTjtJQUNSLCtCQUErQjtRQUM3QkMsVUFBVTtZQUFFTSxjQUFjO1lBQVVILE1BQU07UUFBUztJQUNyRDtJQUNBLGtDQUFrQztRQUNoQ0gsVUFBVTtZQUNSTyxhQUFhO1lBQ2JDLGtCQUFrQjtZQUNsQkMsWUFBWTtZQUNaQyxxQkFBcUI7WUFDckJDLFFBQVE7WUFDUlIsTUFBTTtRQUNSO0lBQ0Y7SUFDQSx3QkFBd0I7UUFDdEJILFVBQVU7WUFBRVksT0FBTztZQUFTVCxNQUFNO1FBQVM7SUFDN0M7SUFDQSxzQkFBc0I7UUFDcEJILFVBQVU7WUFBRVksT0FBTztZQUFTVCxNQUFNO1FBQVM7SUFDN0M7SUFDQSxzQkFBc0I7UUFDcEJILFVBQVU7WUFBRWEsV0FBVztZQUFTVixNQUFNO1FBQVM7SUFDakQ7SUFDQSx5QkFBeUI7UUFDdkJILFVBQVU7WUFBRWMsU0FBUztZQUFVWCxNQUFNO1FBQVM7SUFDaEQ7SUFDQSx5QkFBeUI7UUFDdkJILFVBQVU7WUFBRWUsaUJBQWlCO1lBQVNaLE1BQU07UUFBUztJQUN2RDtJQUNBLHlCQUF5QjtRQUN2QkgsVUFBVTtZQUFFZ0IsV0FBVztZQUFTYixNQUFNO1FBQVM7SUFDakQ7SUFDQSwyQkFBMkI7UUFDekJILFVBQVU7WUFBRWlCLFVBQVU7WUFBVUMsaUJBQWlCO1lBQVVDLGNBQWM7WUFBVWhCLE1BQU07UUFBUztJQUNwRztJQUNBLDRCQUE0QjtRQUMxQkgsVUFBVTtZQUFFb0IsU0FBUztZQUFTQyxpQkFBaUI7WUFBVWxCLE1BQU07UUFBUztJQUMxRTtJQUNBLDZCQUE2QjtRQUMzQkgsVUFBVTtZQUFFc0IsU0FBUztZQUFTQyxRQUFRO1lBQVNDLFVBQVU7WUFBVXJCLE1BQU07UUFBUztJQUNwRjtJQUNBLDBCQUEwQjtRQUN4QkgsVUFBVTtZQUFFeUIsT0FBTztZQUFTQyxPQUFPO1lBQVNDLFNBQVM7WUFBU3hCLE1BQU07UUFBUztJQUMvRTtJQUNBLDhCQUE4QjtRQUM1QkgsVUFBVTtZQUFFNEIsVUFBVTtZQUFTekIsTUFBTTtRQUFTO0lBQ2hEO0lBQ0EsK0JBQStCO1FBQzdCSCxVQUFVO1lBQUU2QixNQUFNO1lBQVUxQixNQUFNO1FBQVM7SUFDN0M7SUFDQSw2QkFBNkI7UUFDM0JILFVBQVU7WUFBRThCLFNBQVM7WUFBVUMsY0FBYztZQUFVQyxhQUFhO1lBQVU3QixNQUFNO1FBQVM7SUFDL0Y7SUFDQSxnQkFBZ0I7UUFDZEgsVUFBVTtZQUFFaUMsUUFBUTtZQUFVOUIsTUFBTTtRQUFTO0lBQy9DO0lBQ0EsZ0JBQWdCO1FBQ2RILFVBQVU7WUFBRWlDLFFBQVE7WUFBVTlCLE1BQU07UUFBUztJQUMvQztJQUNBLGdCQUFnQjtRQUNkSCxVQUFVO1lBQUVpQyxRQUFRO1lBQVU5QixNQUFNO1FBQVM7SUFDL0M7SUFDQSxrQkFBa0I7UUFDaEJILFVBQVU7WUFBRWlDLFFBQVE7WUFBVTlCLE1BQU07UUFBUztJQUMvQztBQUNGO0FBRUEsTUFBTStCLGlCQUFpQixDQUFDQyxVQUFZL0IsWUFBWSxDQUFDK0IsUUFBUSxJQUFJO0FBRTdEQyxPQUFPQyxPQUFPLEdBQUc7SUFBRWpDO0lBQWM4QjtBQUFlIiwic291cmNlcyI6WyIvVXNlcnMvYWJ1emFkYS9EZXNrdG9wL2FnZW50T1MvdXRpbHMvYWdlbnRTY2hlbWFzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHBsYXRvblNjaGVtYSA9IHtcbiAgcmVxdWlyZWQ6IHsgc2VnbWVudHM6IFwiYXJyYXlcIiwgY29tcGFueV9jYW5kaWRhdGVzOiBcImFycmF5XCIsIG1ldGE6IFwib2JqZWN0XCIgfVxufTtcblxuY29uc3QgYWdlbnRTY2hlbWFzID0ge1xuICBcInBsYXRvbi1wcm9zcGVjdC1yZXNlYXJjaC1ydVwiOiBwbGF0b25TY2hlbWEsXG4gIHBsYXRvbjogcGxhdG9uU2NoZW1hLFxuICBcImFuYXRvbHktYWNjb3VudC1yZXNlYXJjaC1ydVwiOiB7XG4gICAgcmVxdWlyZWQ6IHsgYWNjb3VudF9jYXJkOiBcIm9iamVjdFwiLCBtZXRhOiBcIm9iamVjdFwiIH1cbiAgfSxcbiAgXCJ0aW1vZmV5LWNvbXBldGl0b3ItYW5hbHlzaXMtcnVcIjoge1xuICAgIHJlcXVpcmVkOiB7XG4gICAgICBjb21wZXRpdG9yczogXCJhcnJheVwiLFxuICAgICAgY29tcGFyaXNvbl90YWJsZTogXCJhcnJheVwiLFxuICAgICAgd2luX2FuZ2xlczogXCJhcnJheVwiLFxuICAgICAgYWdlbnRvc19wb3NpdGlvbmluZzogXCJvYmplY3RcIixcbiAgICAgIG9mZmVyczogXCJvYmplY3RcIixcbiAgICAgIG1ldGE6IFwib2JqZWN0XCJcbiAgICB9XG4gIH0sXG4gIFwibWF4aW0tbG9jYWwtbGVhZHMtcnVcIjoge1xuICAgIHJlcXVpcmVkOiB7IGxlYWRzOiBcImFycmF5XCIsIG1ldGE6IFwib2JqZWN0XCIgfVxuICB9LFxuICBcImZlZG9yLWIyYi1sZWFkcy1ydVwiOiB7XG4gICAgcmVxdWlyZWQ6IHsgbGVhZHM6IFwiYXJyYXlcIiwgbWV0YTogXCJvYmplY3RcIiB9XG4gIH0sXG4gIFwiYXJ0ZW0taG90LWxlYWRzLXJ1XCI6IHtcbiAgICByZXF1aXJlZDogeyBob3RfbGVhZHM6IFwiYXJyYXlcIiwgbWV0YTogXCJvYmplY3RcIiB9XG4gIH0sXG4gIFwibGVvbmlkLW91dHJlYWNoLWRtLXJ1XCI6IHtcbiAgICByZXF1aXJlZDogeyBkbV9wYWNrOiBcIm9iamVjdFwiLCBtZXRhOiBcIm9iamVjdFwiIH1cbiAgfSxcbiAgXCJlbWVseWFuLWNvbGQtZW1haWwtcnVcIjoge1xuICAgIHJlcXVpcmVkOiB7IGVtYWlsX3NlcXVlbmNlczogXCJhcnJheVwiLCBtZXRhOiBcIm9iamVjdFwiIH1cbiAgfSxcbiAgXCJib3Jpcy1iZHItb3BlcmF0b3ItcnVcIjoge1xuICAgIHJlcXVpcmVkOiB7IGJkcl90YWJsZTogXCJhcnJheVwiLCBtZXRhOiBcIm9iamVjdFwiIH1cbiAgfSxcbiAgXCJwYXZlbC1yZWVscy1hbmFseXNpcy1ydVwiOiB7XG4gICAgcmVxdWlyZWQ6IHsgYW5hbHlzaXM6IFwib2JqZWN0XCIsIHNjcmlwdF9za2VsZXRvbjogXCJvYmplY3RcIiwgaW1wcm92ZW1lbnRzOiBcIm9iamVjdFwiLCBtZXRhOiBcIm9iamVjdFwiIH1cbiAgfSxcbiAgXCJ0cm9maW0tc2hvcnRzLWFuYWxvZ3MtcnVcIjoge1xuICAgIHJlcXVpcmVkOiB7IGZvcm1hdHM6IFwiYXJyYXlcIiwgcmVjb21tZW5kYXRpb25zOiBcIm9iamVjdFwiLCBtZXRhOiBcIm9iamVjdFwiIH1cbiAgfSxcbiAgXCJpcmluYS1jb250ZW50LWlkZWF0aW9uLXJ1XCI6IHtcbiAgICByZXF1aXJlZDogeyBwaWxsYXJzOiBcImFycmF5XCIsIHRvcGljczogXCJhcnJheVwiLCBjdGFfYmFuazogXCJvYmplY3RcIiwgbWV0YTogXCJvYmplY3RcIiB9XG4gIH0sXG4gIFwiaGFyaXRvbi12aXJhbC1ob29rcy1ydVwiOiB7XG4gICAgcmVxdWlyZWQ6IHsgaG9va3M6IFwiYXJyYXlcIiwgcG9zdHM6IFwiYXJyYXlcIiwgc2NyaXB0czogXCJhcnJheVwiLCBtZXRhOiBcIm9iamVjdFwiIH1cbiAgfSxcbiAgXCJrb3N0eWEtaW1hZ2UtZ2VuZXJhdGlvbi1ydVwiOiB7XG4gICAgcmVxdWlyZWQ6IHsgY29uY2VwdHM6IFwiYXJyYXlcIiwgbWV0YTogXCJvYmplY3RcIiB9XG4gIH0sXG4gIFwic2V2YS1jb250ZW50LXJlcHVycG9zaW5nLXJ1XCI6IHtcbiAgICByZXF1aXJlZDogeyBwYWNrOiBcIm9iamVjdFwiLCBtZXRhOiBcIm9iamVjdFwiIH1cbiAgfSxcbiAgXCJtaXR5YS13b3JrZmxvdy1kaWFncmFtLXJ1XCI6IHtcbiAgICByZXF1aXJlZDogeyBkaWFncmFtOiBcIm9iamVjdFwiLCBsYW5kaW5nX3RleHQ6IFwib2JqZWN0XCIsIGRlY2tfc2NyaXB0OiBcIm9iamVjdFwiLCBtZXRhOiBcIm9iamVjdFwiIH1cbiAgfSxcbiAgXCJib2FyZC1jZW8tcnVcIjoge1xuICAgIHJlcXVpcmVkOiB7IHJldmlldzogXCJvYmplY3RcIiwgbWV0YTogXCJvYmplY3RcIiB9XG4gIH0sXG4gIFwiYm9hcmQtY3RvLXJ1XCI6IHtcbiAgICByZXF1aXJlZDogeyByZXZpZXc6IFwib2JqZWN0XCIsIG1ldGE6IFwib2JqZWN0XCIgfVxuICB9LFxuICBcImJvYXJkLWNmby1ydVwiOiB7XG4gICAgcmVxdWlyZWQ6IHsgcmV2aWV3OiBcIm9iamVjdFwiLCBtZXRhOiBcIm9iamVjdFwiIH1cbiAgfSxcbiAgXCJib2FyZC1jaGFpci1ydVwiOiB7XG4gICAgcmVxdWlyZWQ6IHsgcmV2aWV3OiBcIm9iamVjdFwiLCBtZXRhOiBcIm9iamVjdFwiIH1cbiAgfVxufTtcblxuY29uc3QgZ2V0QWdlbnRTY2hlbWEgPSAoYWdlbnRJZCkgPT4gYWdlbnRTY2hlbWFzW2FnZW50SWRdIHx8IG51bGw7XG5cbm1vZHVsZS5leHBvcnRzID0geyBhZ2VudFNjaGVtYXMsIGdldEFnZW50U2NoZW1hIH07XG4iXSwibmFtZXMiOlsicGxhdG9uU2NoZW1hIiwicmVxdWlyZWQiLCJzZWdtZW50cyIsImNvbXBhbnlfY2FuZGlkYXRlcyIsIm1ldGEiLCJhZ2VudFNjaGVtYXMiLCJwbGF0b24iLCJhY2NvdW50X2NhcmQiLCJjb21wZXRpdG9ycyIsImNvbXBhcmlzb25fdGFibGUiLCJ3aW5fYW5nbGVzIiwiYWdlbnRvc19wb3NpdGlvbmluZyIsIm9mZmVycyIsImxlYWRzIiwiaG90X2xlYWRzIiwiZG1fcGFjayIsImVtYWlsX3NlcXVlbmNlcyIsImJkcl90YWJsZSIsImFuYWx5c2lzIiwic2NyaXB0X3NrZWxldG9uIiwiaW1wcm92ZW1lbnRzIiwiZm9ybWF0cyIsInJlY29tbWVuZGF0aW9ucyIsInBpbGxhcnMiLCJ0b3BpY3MiLCJjdGFfYmFuayIsImhvb2tzIiwicG9zdHMiLCJzY3JpcHRzIiwiY29uY2VwdHMiLCJwYWNrIiwiZGlhZ3JhbSIsImxhbmRpbmdfdGV4dCIsImRlY2tfc2NyaXB0IiwicmV2aWV3IiwiZ2V0QWdlbnRTY2hlbWEiLCJhZ2VudElkIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./utils/agentSchemas.js\n");

/***/ }),

/***/ "(rsc)/./utils/budget.js":
/*!*************************!*\
  !*** ./utils/budget.js ***!
  \*************************/
/***/ ((module) => {

eval("\nconst isFiniteNumber = (value)=>typeof value === \"number\" && Number.isFinite(value);\nconst getPath = (obj, path)=>{\n    if (!obj || !Array.isArray(path)) return undefined;\n    return path.reduce((acc, key)=>acc && typeof acc === \"object\" ? acc[key] : undefined, obj);\n};\nconst setPath = (obj, path, value)=>{\n    if (!obj || !Array.isArray(path)) return;\n    let cursor = obj;\n    for(let i = 0; i < path.length - 1; i += 1){\n        const key = path[i];\n        if (!cursor[key] || typeof cursor[key] !== \"object\") {\n            cursor[key] = {};\n        }\n        cursor = cursor[key];\n    }\n    cursor[path[path.length - 1]] = value;\n};\nconst clampValue = (current, maxValue)=>{\n    if (!isFiniteNumber(maxValue)) return current;\n    if (!isFiniteNumber(current)) return Math.round(maxValue);\n    return Math.min(current, maxValue);\n};\nconst applyBudget = (input, budget, options = {})=>{\n    const applied = {};\n    const warnings = new Set();\n    if (!budget || typeof budget !== \"object\") {\n        return {\n            budget_applied: null,\n            warnings: []\n        };\n    }\n    const { maxWebRequestsPath, maxItemsPaths = [], maxWordsPath } = options;\n    if (isFiniteNumber(budget.max_web_requests) && maxWebRequestsPath) {\n        const current = getPath(input, maxWebRequestsPath);\n        const clamped = clampValue(current, budget.max_web_requests);\n        if (isFiniteNumber(current) && clamped < current) warnings.add(\"budget_clamped\");\n        setPath(input, maxWebRequestsPath, Math.round(clamped));\n        applied.max_web_requests = Math.round(clamped);\n    }\n    if (isFiniteNumber(budget.max_items) && Array.isArray(maxItemsPaths) && maxItemsPaths.length) {\n        maxItemsPaths.forEach((path)=>{\n            const current = getPath(input, path);\n            const clamped = clampValue(current, budget.max_items);\n            if (isFiniteNumber(current) && clamped < current) warnings.add(\"budget_clamped\");\n            setPath(input, path, Math.round(clamped));\n        });\n        applied.max_items = Math.round(budget.max_items);\n    }\n    if (isFiniteNumber(budget.max_words) && maxWordsPath) {\n        const current = getPath(input, maxWordsPath);\n        const clamped = clampValue(current, budget.max_words);\n        if (isFiniteNumber(current) && clamped < current) warnings.add(\"budget_clamped\");\n        setPath(input, maxWordsPath, Math.round(clamped));\n        applied.max_words = Math.round(clamped);\n    }\n    return {\n        budget_applied: Object.keys(applied).length ? applied : null,\n        warnings: Array.from(warnings)\n    };\n};\nconst applyBudgetMeta = (meta, input)=>{\n    if (!meta || typeof meta !== \"object\" || !input || typeof input !== \"object\") return;\n    if (input.budget_applied) {\n        meta.budget_applied = input.budget_applied;\n    }\n    if (Array.isArray(input.budget_warnings) && input.budget_warnings.length) {\n        if (!Array.isArray(meta.warnings)) {\n            meta.warnings = [];\n        }\n        input.budget_warnings.forEach((warning)=>{\n            if (!meta.warnings.includes(warning)) meta.warnings.push(warning);\n        });\n    }\n};\nmodule.exports = {\n    applyBudget,\n    applyBudgetMeta\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVVkLFFBQVFvQixPQUFPUztRQUMvQixNQUFNRSxVQUFVbEIsV0FBV0MsU0FBU08sT0FBT2MsU0FBUztRQUNwRCxJQUFJdkMsZUFBZWtCLFlBQVlpQixVQUFVakIsU0FBU1UsU0FBU1EsR0FBRyxDQUFDO1FBQy9EdkIsUUFBUVcsT0FBT1MsY0FBY2IsS0FBS0MsS0FBSyxDQUFDYztRQUN4Q1IsUUFBUVksU0FBUyxHQUFHbkIsS0FBS0MsS0FBSyxDQUFDYztJQUNqQztJQUVBLE9BQU87UUFDTEwsZ0JBQWdCVSxPQUFPQyxJQUFJLENBQUNkLFNBQVNYLE1BQU0sR0FBR1csVUFBVTtRQUN4REMsVUFBVXJCLE1BQU1tQyxJQUFJLENBQUNkO0lBQ3ZCO0FBQ0Y7QUFFQSxNQUFNZSxrQkFBa0IsQ0FBQ0MsTUFBTXBCO0lBQzdCLElBQUksQ0FBQ29CLFFBQVEsT0FBT0EsU0FBUyxZQUFZLENBQUNwQixTQUFTLE9BQU9BLFVBQVUsVUFBVTtJQUM5RSxJQUFJQSxNQUFNTSxjQUFjLEVBQUU7UUFDeEJjLEtBQUtkLGNBQWMsR0FBR04sTUFBTU0sY0FBYztJQUM1QztJQUNBLElBQUl2QixNQUFNQyxPQUFPLENBQUNnQixNQUFNcUIsZUFBZSxLQUFLckIsTUFBTXFCLGVBQWUsQ0FBQzdCLE1BQU0sRUFBRTtRQUN4RSxJQUFJLENBQUNULE1BQU1DLE9BQU8sQ0FBQ29DLEtBQUtoQixRQUFRLEdBQUc7WUFDakNnQixLQUFLaEIsUUFBUSxHQUFHLEVBQUU7UUFDcEI7UUFDQUosTUFBTXFCLGVBQWUsQ0FBQ1AsT0FBTyxDQUFDLENBQUNRO1lBQzdCLElBQUksQ0FBQ0YsS0FBS2hCLFFBQVEsQ0FBQ21CLFFBQVEsQ0FBQ0QsVUFBVUYsS0FBS2hCLFFBQVEsQ0FBQ29CLElBQUksQ0FBQ0Y7UUFDM0Q7SUFDRjtBQUNGO0FBRUFHLE9BQU9DLE9BQU8sR0FBRztJQUFFM0I7SUFBYW9CO0FBQWdCIiwic291cmNlcyI6WyIvVXNlcnMvYWJ1emFkYS9EZXNrdG9wL2FnZW50T1MvdXRpbHMvYnVkZ2V0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGlzRmluaXRlTnVtYmVyID0gKHZhbHVlKSA9PiB0eXBlb2YgdmFsdWUgPT09IFwibnVtYmVyXCIgJiYgTnVtYmVyLmlzRmluaXRlKHZhbHVlKTtcblxuY29uc3QgZ2V0UGF0aCA9IChvYmosIHBhdGgpID0+IHtcbiAgaWYgKCFvYmogfHwgIUFycmF5LmlzQXJyYXkocGF0aCkpIHJldHVybiB1bmRlZmluZWQ7XG4gIHJldHVybiBwYXRoLnJlZHVjZSgoYWNjLCBrZXkpID0+IChhY2MgJiYgdHlwZW9mIGFjYyA9PT0gXCJvYmplY3RcIiA/IGFjY1trZXldIDogdW5kZWZpbmVkKSwgb2JqKTtcbn07XG5cbmNvbnN0IHNldFBhdGggPSAob2JqLCBwYXRoLCB2YWx1ZSkgPT4ge1xuICBpZiAoIW9iaiB8fCAhQXJyYXkuaXNBcnJheShwYXRoKSkgcmV0dXJuO1xuICBsZXQgY3Vyc29yID0gb2JqO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IHBhdGgubGVuZ3RoIC0gMTsgaSArPSAxKSB7XG4gICAgY29uc3Qga2V5ID0gcGF0aFtpXTtcbiAgICBpZiAoIWN1cnNvcltrZXldIHx8IHR5cGVvZiBjdXJzb3Jba2V5XSAhPT0gXCJvYmplY3RcIikge1xuICAgICAgY3Vyc29yW2tleV0gPSB7fTtcbiAgICB9XG4gICAgY3Vyc29yID0gY3Vyc29yW2tleV07XG4gIH1cbiAgY3Vyc29yW3BhdGhbcGF0aC5sZW5ndGggLSAxXV0gPSB2YWx1ZTtcbn07XG5cbmNvbnN0IGNsYW1wVmFsdWUgPSAoY3VycmVudCwgbWF4VmFsdWUpID0+IHtcbiAgaWYgKCFpc0Zpbml0ZU51bWJlcihtYXhWYWx1ZSkpIHJldHVybiBjdXJyZW50O1xuICBpZiAoIWlzRmluaXRlTnVtYmVyKGN1cnJlbnQpKSByZXR1cm4gTWF0aC5yb3VuZChtYXhWYWx1ZSk7XG4gIHJldHVybiBNYXRoLm1pbihjdXJyZW50LCBtYXhWYWx1ZSk7XG59O1xuXG5jb25zdCBhcHBseUJ1ZGdldCA9IChpbnB1dCwgYnVkZ2V0LCBvcHRpb25zID0ge30pID0+IHtcbiAgY29uc3QgYXBwbGllZCA9IHt9O1xuICBjb25zdCB3YXJuaW5ncyA9IG5ldyBTZXQoKTtcbiAgaWYgKCFidWRnZXQgfHwgdHlwZW9mIGJ1ZGdldCAhPT0gXCJvYmplY3RcIikge1xuICAgIHJldHVybiB7IGJ1ZGdldF9hcHBsaWVkOiBudWxsLCB3YXJuaW5nczogW10gfTtcbiAgfVxuXG4gIGNvbnN0IHsgbWF4V2ViUmVxdWVzdHNQYXRoLCBtYXhJdGVtc1BhdGhzID0gW10sIG1heFdvcmRzUGF0aCB9ID0gb3B0aW9ucztcblxuICBpZiAoaXNGaW5pdGVOdW1iZXIoYnVkZ2V0Lm1heF93ZWJfcmVxdWVzdHMpICYmIG1heFdlYlJlcXVlc3RzUGF0aCkge1xuICAgIGNvbnN0IGN1cnJlbnQgPSBnZXRQYXRoKGlucHV0LCBtYXhXZWJSZXF1ZXN0c1BhdGgpO1xuICAgIGNvbnN0IGNsYW1wZWQgPSBjbGFtcFZhbHVlKGN1cnJlbnQsIGJ1ZGdldC5tYXhfd2ViX3JlcXVlc3RzKTtcbiAgICBpZiAoaXNGaW5pdGVOdW1iZXIoY3VycmVudCkgJiYgY2xhbXBlZCA8IGN1cnJlbnQpIHdhcm5pbmdzLmFkZChcImJ1ZGdldF9jbGFtcGVkXCIpO1xuICAgIHNldFBhdGgoaW5wdXQsIG1heFdlYlJlcXVlc3RzUGF0aCwgTWF0aC5yb3VuZChjbGFtcGVkKSk7XG4gICAgYXBwbGllZC5tYXhfd2ViX3JlcXVlc3RzID0gTWF0aC5yb3VuZChjbGFtcGVkKTtcbiAgfVxuXG4gIGlmIChpc0Zpbml0ZU51bWJlcihidWRnZXQubWF4X2l0ZW1zKSAmJiBBcnJheS5pc0FycmF5KG1heEl0ZW1zUGF0aHMpICYmIG1heEl0ZW1zUGF0aHMubGVuZ3RoKSB7XG4gICAgbWF4SXRlbXNQYXRocy5mb3JFYWNoKChwYXRoKSA9PiB7XG4gICAgICBjb25zdCBjdXJyZW50ID0gZ2V0UGF0aChpbnB1dCwgcGF0aCk7XG4gICAgICBjb25zdCBjbGFtcGVkID0gY2xhbXBWYWx1ZShjdXJyZW50LCBidWRnZXQubWF4X2l0ZW1zKTtcbiAgICAgIGlmIChpc0Zpbml0ZU51bWJlcihjdXJyZW50KSAmJiBjbGFtcGVkIDwgY3VycmVudCkgd2FybmluZ3MuYWRkKFwiYnVkZ2V0X2NsYW1wZWRcIik7XG4gICAgICBzZXRQYXRoKGlucHV0LCBwYXRoLCBNYXRoLnJvdW5kKGNsYW1wZWQpKTtcbiAgICB9KTtcbiAgICBhcHBsaWVkLm1heF9pdGVtcyA9IE1hdGgucm91bmQoYnVkZ2V0Lm1heF9pdGVtcyk7XG4gIH1cblxuICBpZiAoaXNGaW5pdGVOdW1iZXIoYnVkZ2V0Lm1heF93b3JkcykgJiYgbWF4V29yZHNQYXRoKSB7XG4gICAgY29uc3QgY3VycmVudCA9IGdldFBhdGgoaW5wdXQsIG1heFdvcmRzUGF0aCk7XG4gICAgY29uc3QgY2xhbXBlZCA9IGNsYW1wVmFsdWUoY3VycmVudCwgYnVkZ2V0Lm1heF93b3Jkcyk7XG4gICAgaWYgKGlzRmluaXRlTnVtYmVyKGN1cnJlbnQpICYmIGNsYW1wZWQgPCBjdXJyZW50KSB3YXJuaW5ncy5hZGQoXCJidWRnZXRfY2xhbXBlZFwiKTtcbiAgICBzZXRQYXRoKGlucHV0LCBtYXhXb3Jkc1BhdGgsIE1hdGgucm91bmQoY2xhbXBlZCkpO1xuICAgIGFwcGxpZWQubWF4X3dvcmRzID0gTWF0aC5yb3VuZChjbGFtcGVkKTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgYnVkZ2V0X2FwcGxpZWQ6IE9iamVjdC5rZXlzKGFwcGxpZWQpLmxlbmd0aCA/IGFwcGxpZWQgOiBudWxsLFxuICAgIHdhcm5pbmdzOiBBcnJheS5mcm9tKHdhcm5pbmdzKVxuICB9O1xufTtcblxuY29uc3QgYXBwbHlCdWRnZXRNZXRhID0gKG1ldGEsIGlucHV0KSA9PiB7XG4gIGlmICghbWV0YSB8fCB0eXBlb2YgbWV0YSAhPT0gXCJvYmplY3RcIiB8fCAhaW5wdXQgfHwgdHlwZW9mIGlucHV0ICE9PSBcIm9iamVjdFwiKSByZXR1cm47XG4gIGlmIChpbnB1dC5idWRnZXRfYXBwbGllZCkge1xuICAgIG1ldGEuYnVkZ2V0X2FwcGxpZWQgPSBpbnB1dC5idWRnZXRfYXBwbGllZDtcbiAgfVxuICBpZiAoQXJyYXkuaXNBcnJheShpbnB1dC5idWRnZXRfd2FybmluZ3MpICYmIGlucHV0LmJ1ZGdldF93YXJuaW5ncy5sZW5ndGgpIHtcbiAgICBpZiAoIUFycmF5LmlzQXJyYXkobWV0YS53YXJuaW5ncykpIHtcbiAgICAgIG1ldGEud2FybmluZ3MgPSBbXTtcbiAgICB9XG4gICAgaW5wdXQuYnVkZ2V0X3dhcm5pbmdzLmZvckVhY2goKHdhcm5pbmcpID0+IHtcbiAgICAgIGlmICghbWV0YS53YXJuaW5ncy5pbmNsdWRlcyh3YXJuaW5nKSkgbWV0YS53YXJuaW5ncy5wdXNoKHdhcm5pbmcpO1xuICAgIH0pO1xuICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHsgYXBwbHlCdWRnZXQsIGFwcGx5QnVkZ2V0TWV0YSB9O1xuIl0sIm5hbWVzIjpbImlzRmluaXRlTnVtYmVyIiwidmFsdWUiLCJOdW1iZXIiLCJpc0Zpbml0ZSIsImdldFBhdGgiLCJvYmoiLCJwYXRoIiwiQXJyYXkiLCJpc0FycmF5IiwidW5kZWZpbmVkIiwicmVkdWNlIiwiYWNjIiwia2V5Iiwic2V0UGF0aCIsImN1cnNvciIsImkiLCJsZW5ndGgiLCJjbGFtcFZhbHVlIiwiY3VycmVudCIsIm1heFZhbHVlIiwiTWF0aCIsInJvdW5kIiwibWluIiwiYXBwbHlCdWRnZXQiLCJpbnB1dCIsImJ1ZGdldCIsIm9wdGlvbnMiLCJhcHBsaWVkIiwid2FybmluZ3MiLCJTZXQiLCJidWRnZXRfYXBwbGllZCIsIm1heFdlYlJlcXVlc3RzUGF0aCIsIm1heEl0ZW1zUGF0aHMiLCJtYXhXb3Jkc1BhdGgiLCJtYXhfd2ViX3JlcXVlc3RzIiwiY2xhbXBlZCIsImFkZCIsIm1heF9pdGVtcyIsImZvckVhY2giLCJtYXhfd29yZHMiLCJPYmplY3QiLCJrZXlzIiwiZnJvbSIsImFwcGx5QnVkZ2V0TWV0YSIsIm1ldGEiLCJidWRnZXRfd2FybmluZ3MiLCJ3YXJuaW5nIiwiaW5jbHVkZXMiLCJwdXNoIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./utils/budget.js\n");

/***/ }),

/***/ "(rsc)/./utils/handoff.js":
/*!**************************!*\
  !*** ./utils/handoff.js ***!
  \**************************/
/***/ ((module) => {

eval("\nconst HANDOFF_VERSION = \"1.0\";\nconst COMPAT_BY_TYPE = {\n    leads_table: [\n        \"anatoly-account-research-ru\",\n        \"leonid-outreach-dm-ru\",\n        \"emelyan-cold-email-ru\",\n        \"boris-bdr-operator-ru\"\n    ],\n    account_card: [\n        \"leonid-outreach-dm-ru\",\n        \"emelyan-cold-email-ru\",\n        \"boris-bdr-operator-ru\"\n    ],\n    hot_leads: [\n        \"leonid-outreach-dm-ru\",\n        \"boris-bdr-operator-ru\"\n    ],\n    messages_pack: [\n        \"boris-bdr-operator-ru\"\n    ],\n    bdr_queue: [],\n    board_review: [],\n    content_pack: []\n};\nconst RECOMMENDED_NEXT = {\n    \"platon-prospect-research-ru\": [\n        \"anatoly-account-research-ru\",\n        \"leonid-outreach-dm-ru\",\n        \"boris-bdr-operator-ru\"\n    ],\n    platon: [\n        \"anatoly-account-research-ru\",\n        \"leonid-outreach-dm-ru\",\n        \"boris-bdr-operator-ru\"\n    ],\n    \"maxim-local-leads-ru\": [\n        \"anatoly-account-research-ru\",\n        \"leonid-outreach-dm-ru\",\n        \"boris-bdr-operator-ru\"\n    ],\n    \"fedor-b2b-leads-ru\": [\n        \"anatoly-account-research-ru\",\n        \"emelyan-cold-email-ru\",\n        \"boris-bdr-operator-ru\"\n    ],\n    \"artem-hot-leads-ru\": [\n        \"anatoly-account-research-ru\",\n        \"leonid-outreach-dm-ru\",\n        \"boris-bdr-operator-ru\"\n    ],\n    \"anatoly-account-research-ru\": [\n        \"leonid-outreach-dm-ru\",\n        \"emelyan-cold-email-ru\",\n        \"boris-bdr-operator-ru\"\n    ],\n    \"timofey-competitor-analysis-ru\": [\n        \"platon-prospect-research-ru\",\n        \"anatoly-account-research-ru\",\n        \"boris-bdr-operator-ru\"\n    ],\n    \"leonid-outreach-dm-ru\": [\n        \"boris-bdr-operator-ru\"\n    ],\n    \"emelyan-cold-email-ru\": [\n        \"boris-bdr-operator-ru\"\n    ],\n    \"boris-bdr-operator-ru\": [\n        \"leonid-outreach-dm-ru\",\n        \"emelyan-cold-email-ru\"\n    ],\n    \"pavel-reels-analysis-ru\": [\n        \"hariton-viral-hooks-ru\",\n        \"trofim-shorts-analogs-ru\"\n    ],\n    \"trofim-shorts-analogs-ru\": [\n        \"hariton-viral-hooks-ru\",\n        \"pavel-reels-analysis-ru\"\n    ],\n    \"irina-content-ideation-ru\": [\n        \"hariton-viral-hooks-ru\",\n        \"kostya-image-generation-ru\"\n    ],\n    \"hariton-viral-hooks-ru\": [\n        \"kostya-image-generation-ru\",\n        \"seva-content-repurposing-ru\"\n    ],\n    \"kostya-image-generation-ru\": [\n        \"hariton-viral-hooks-ru\",\n        \"irina-content-ideation-ru\"\n    ],\n    \"seva-content-repurposing-ru\": [\n        \"hariton-viral-hooks-ru\",\n        \"kostya-image-generation-ru\"\n    ],\n    \"mitya-workflow-diagram-ru\": [\n        \"kostya-image-generation-ru\",\n        \"irina-content-ideation-ru\"\n    ],\n    \"board-ceo-ru\": [\n        \"board-chair-ru\"\n    ],\n    \"board-cto-ru\": [\n        \"board-chair-ru\"\n    ],\n    \"board-cfo-ru\": [\n        \"board-chair-ru\"\n    ],\n    \"board-chair-ru\": []\n};\nconst normalizeLead = (lead)=>{\n    if (!lead || typeof lead !== \"object\") return null;\n    const leadName = lead.name || lead.company_name || lead.title || lead.name_placeholder || lead.lead_label || lead.link || lead.url || \"Lead\";\n    const contact = {\n        email: lead.email || (lead.public_contacts ? lead.public_contacts.email : undefined) || undefined,\n        phone: lead.phone || (lead.public_contacts ? lead.public_contacts.phone : undefined) || undefined,\n        website: lead.website || lead.domain || undefined,\n        url: lead.link || lead.url || lead.source_url || undefined\n    };\n    const source = lead.source || lead.channel || lead.source_type || \"\";\n    return {\n        lead_name: String(leadName),\n        dedupe_key: lead.dedupe_key || lead.dedupe_key_raw || \"\",\n        contact,\n        source,\n        proof_refs: lead.proof_refs || undefined\n    };\n};\nconst buildLeadsTableEntities = (data)=>{\n    const list = data && data.leads || data && data.company_candidates || data && data.hot_leads || [];\n    const leads = Array.isArray(list) ? list.map(normalizeLead).filter(Boolean) : [];\n    return {\n        leads\n    };\n};\nconst buildAccountCardEntities = (data)=>{\n    const card = data && data.account_card ? data.account_card : {};\n    const meta = data && data.meta ? data.meta : {};\n    return {\n        company_name: card.company_name || \"\",\n        discovered_channels: card.discovered_channels || {},\n        hooks: card.top_personalization_hooks || [],\n        pains: card.pain_hypotheses || [],\n        proof_items: Array.isArray(meta.proof_items) ? meta.proof_items : []\n    };\n};\nconst buildMessagesPackEntities = (data, channelOverride)=>{\n    if (data && data.dm_pack) {\n        return {\n            lead_label: data.dm_pack.lead_label || \"lead\",\n            channel: data.dm_pack.channel || channelOverride || \"dm\",\n            messages: data.dm_pack.messages || data.dm_pack.variants || []\n        };\n    }\n    if (data && data.email_sequences) {\n        return {\n            lead_label: \"lead\",\n            channel: channelOverride || \"email\",\n            email_sequences: data.email_sequences\n        };\n    }\n    return {\n        lead_label: \"lead\",\n        channel: channelOverride || \"\",\n        messages: []\n    };\n};\nconst buildContentPackEntities = (data)=>{\n    if (!data || typeof data !== \"object\") return {};\n    const entities = {\n        ...data\n    };\n    if (entities.meta) delete entities.meta;\n    return entities;\n};\nconst buildBoardReviewEntities = (data)=>{\n    const review = data && typeof data.review === \"object\" ? data.review : {};\n    return {\n        role: review.role || \"\",\n        decision: review.decision || review.stance || review.recommendation || review.feasibility || \"\",\n        summary: review.final_summary || review.verdict || review.unit_economics_view || \"\",\n        references: review.references || {}\n    };\n};\nconst buildHandoff = (agentId, data)=>{\n    const recommended_next_agents = RECOMMENDED_NEXT[agentId] || [\n        \"boris-bdr-operator-ru\"\n    ];\n    if (agentId === \"platon\" || agentId === \"platon-prospect-research-ru\" || agentId === \"maxim-local-leads-ru\" || agentId === \"fedor-b2b-leads-ru\") {\n        const type = \"leads_table\";\n        return {\n            type,\n            version: HANDOFF_VERSION,\n            entities: buildLeadsTableEntities(data),\n            recommended_next_agents,\n            compat: COMPAT_BY_TYPE[type] || []\n        };\n    }\n    if (agentId === \"artem-hot-leads-ru\") {\n        const type = \"hot_leads\";\n        return {\n            type,\n            version: HANDOFF_VERSION,\n            entities: buildLeadsTableEntities(data),\n            recommended_next_agents,\n            compat: COMPAT_BY_TYPE[type] || []\n        };\n    }\n    if (agentId === \"anatoly-account-research-ru\") {\n        const type = \"account_card\";\n        return {\n            type,\n            version: HANDOFF_VERSION,\n            entities: buildAccountCardEntities(data),\n            recommended_next_agents,\n            compat: COMPAT_BY_TYPE[type] || []\n        };\n    }\n    if (agentId === \"leonid-outreach-dm-ru\") {\n        const type = \"messages_pack\";\n        return {\n            type,\n            version: HANDOFF_VERSION,\n            entities: buildMessagesPackEntities(data, \"dm\"),\n            recommended_next_agents,\n            compat: COMPAT_BY_TYPE[type] || []\n        };\n    }\n    if (agentId === \"emelyan-cold-email-ru\") {\n        const type = \"messages_pack\";\n        return {\n            type,\n            version: HANDOFF_VERSION,\n            entities: buildMessagesPackEntities(data, \"email\"),\n            recommended_next_agents,\n            compat: COMPAT_BY_TYPE[type] || []\n        };\n    }\n    if (agentId === \"boris-bdr-operator-ru\") {\n        const type = \"bdr_queue\";\n        return {\n            type,\n            version: HANDOFF_VERSION,\n            entities: {\n                rows: Array.isArray(data.bdr_table) ? data.bdr_table : []\n            },\n            recommended_next_agents,\n            compat: COMPAT_BY_TYPE[type] || []\n        };\n    }\n    if (agentId === \"timofey-competitor-analysis-ru\") {\n        const type = \"content_pack\";\n        return {\n            type,\n            version: HANDOFF_VERSION,\n            entities: {\n                competitors: data.competitors || [],\n                comparison_table: data.comparison_table || [],\n                offers: data.offers || {},\n                win_angles: data.win_angles || [],\n                agentos_positioning: data.agentos_positioning || {}\n            },\n            recommended_next_agents,\n            compat: COMPAT_BY_TYPE[type] || []\n        };\n    }\n    if (agentId === \"board-ceo-ru\" || agentId === \"board-cto-ru\" || agentId === \"board-cfo-ru\" || agentId === \"board-chair-ru\") {\n        const type = \"board_review\";\n        return {\n            type,\n            version: HANDOFF_VERSION,\n            entities: buildBoardReviewEntities(data),\n            recommended_next_agents,\n            compat: COMPAT_BY_TYPE[type] || []\n        };\n    }\n    const type = \"content_pack\";\n    return {\n        type,\n        version: HANDOFF_VERSION,\n        entities: buildContentPackEntities(data),\n        recommended_next_agents,\n        compat: COMPAT_BY_TYPE[type] || []\n    };\n};\nconst getHandoffTypeForAgent = (agentId)=>{\n    if (agentId === \"platon\" || agentId === \"platon-prospect-research-ru\" || agentId === \"maxim-local-leads-ru\" || agentId === \"fedor-b2b-leads-ru\") {\n        return \"leads_table\";\n    }\n    if (agentId === \"artem-hot-leads-ru\") return \"hot_leads\";\n    if (agentId === \"anatoly-account-research-ru\") return \"account_card\";\n    if (agentId === \"leonid-outreach-dm-ru\") return \"messages_pack\";\n    if (agentId === \"emelyan-cold-email-ru\") return \"messages_pack\";\n    if (agentId === \"boris-bdr-operator-ru\") return \"bdr_queue\";\n    if (agentId === \"timofey-competitor-analysis-ru\") return \"content_pack\";\n    if (agentId === \"board-ceo-ru\" || agentId === \"board-cto-ru\" || agentId === \"board-cfo-ru\" || agentId === \"board-chair-ru\") {\n        return \"board_review\";\n    }\n    return \"content_pack\";\n};\nmodule.exports = {\n    buildHandoff,\n    HANDOFF_VERSION,\n    COMPAT_BY_TYPE,\n    getHandoffTypeForAgent\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dG9wL2FnZW50T1MvdXRpbHMvaGFuZG9mZi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBIQU5ET0ZGX1ZFUlNJT04gPSBcIjEuMFwiO1xuXG5jb25zdCBDT01QQVRfQllfVFlQRSA9IHtcbiAgbGVhZHNfdGFibGU6IFtcbiAgICBcImFuYXRvbHktYWNjb3VudC1yZXNlYXJjaC1ydVwiLFxuICAgIFwibGVvbmlkLW91dHJlYWNoLWRtLXJ1XCIsXG4gICAgXCJlbWVseWFuLWNvbGQtZW1haWwtcnVcIixcbiAgICBcImJvcmlzLWJkci1vcGVyYXRvci1ydVwiXG4gIF0sXG4gIGFjY291bnRfY2FyZDogW1xuICAgIFwibGVvbmlkLW91dHJlYWNoLWRtLXJ1XCIsXG4gICAgXCJlbWVseWFuLWNvbGQtZW1haWwtcnVcIixcbiAgICBcImJvcmlzLWJkci1vcGVyYXRvci1ydVwiXG4gIF0sXG4gIGhvdF9sZWFkczogW1wibGVvbmlkLW91dHJlYWNoLWRtLXJ1XCIsIFwiYm9yaXMtYmRyLW9wZXJhdG9yLXJ1XCJdLFxuICBtZXNzYWdlc19wYWNrOiBbXCJib3Jpcy1iZHItb3BlcmF0b3ItcnVcIl0sXG4gIGJkcl9xdWV1ZTogW10sXG4gIGJvYXJkX3JldmlldzogW10sXG4gIGNvbnRlbnRfcGFjazogW11cbn07XG5cbmNvbnN0IFJFQ09NTUVOREVEX05FWFQgPSB7XG4gIFwicGxhdG9uLXByb3NwZWN0LXJlc2VhcmNoLXJ1XCI6IFtcbiAgICBcImFuYXRvbHktYWNjb3VudC1yZXNlYXJjaC1ydVwiLFxuICAgIFwibGVvbmlkLW91dHJlYWNoLWRtLXJ1XCIsXG4gICAgXCJib3Jpcy1iZHItb3BlcmF0b3ItcnVcIlxuICBdLFxuICBwbGF0b246IFtcbiAgICBcImFuYXRvbHktYWNjb3VudC1yZXNlYXJjaC1ydVwiLFxuICAgIFwibGVvbmlkLW91dHJlYWNoLWRtLXJ1XCIsXG4gICAgXCJib3Jpcy1iZHItb3BlcmF0b3ItcnVcIlxuICBdLFxuICBcIm1heGltLWxvY2FsLWxlYWRzLXJ1XCI6IFtcbiAgICBcImFuYXRvbHktYWNjb3VudC1yZXNlYXJjaC1ydVwiLFxuICAgIFwibGVvbmlkLW91dHJlYWNoLWRtLXJ1XCIsXG4gICAgXCJib3Jpcy1iZHItb3BlcmF0b3ItcnVcIlxuICBdLFxuICBcImZlZG9yLWIyYi1sZWFkcy1ydVwiOiBbXG4gICAgXCJhbmF0b2x5LWFjY291bnQtcmVzZWFyY2gtcnVcIixcbiAgICBcImVtZWx5YW4tY29sZC1lbWFpbC1ydVwiLFxuICAgIFwiYm9yaXMtYmRyLW9wZXJhdG9yLXJ1XCJcbiAgXSxcbiAgXCJhcnRlbS1ob3QtbGVhZHMtcnVcIjogW1xuICAgIFwiYW5hdG9seS1hY2NvdW50LXJlc2VhcmNoLXJ1XCIsXG4gICAgXCJsZW9uaWQtb3V0cmVhY2gtZG0tcnVcIixcbiAgICBcImJvcmlzLWJkci1vcGVyYXRvci1ydVwiXG4gIF0sXG4gIFwiYW5hdG9seS1hY2NvdW50LXJlc2VhcmNoLXJ1XCI6IFtcbiAgICBcImxlb25pZC1vdXRyZWFjaC1kbS1ydVwiLFxuICAgIFwiZW1lbHlhbi1jb2xkLWVtYWlsLXJ1XCIsXG4gICAgXCJib3Jpcy1iZHItb3BlcmF0b3ItcnVcIlxuICBdLFxuICBcInRpbW9mZXktY29tcGV0aXRvci1hbmFseXNpcy1ydVwiOiBbXG4gICAgXCJwbGF0b24tcHJvc3BlY3QtcmVzZWFyY2gtcnVcIixcbiAgICBcImFuYXRvbHktYWNjb3VudC1yZXNlYXJjaC1ydVwiLFxuICAgIFwiYm9yaXMtYmRyLW9wZXJhdG9yLXJ1XCJcbiAgXSxcbiAgXCJsZW9uaWQtb3V0cmVhY2gtZG0tcnVcIjogW1wiYm9yaXMtYmRyLW9wZXJhdG9yLXJ1XCJdLFxuICBcImVtZWx5YW4tY29sZC1lbWFpbC1ydVwiOiBbXCJib3Jpcy1iZHItb3BlcmF0b3ItcnVcIl0sXG4gIFwiYm9yaXMtYmRyLW9wZXJhdG9yLXJ1XCI6IFtcImxlb25pZC1vdXRyZWFjaC1kbS1ydVwiLCBcImVtZWx5YW4tY29sZC1lbWFpbC1ydVwiXSxcbiAgXCJwYXZlbC1yZWVscy1hbmFseXNpcy1ydVwiOiBbXCJoYXJpdG9uLXZpcmFsLWhvb2tzLXJ1XCIsIFwidHJvZmltLXNob3J0cy1hbmFsb2dzLXJ1XCJdLFxuICBcInRyb2ZpbS1zaG9ydHMtYW5hbG9ncy1ydVwiOiBbXCJoYXJpdG9uLXZpcmFsLWhvb2tzLXJ1XCIsIFwicGF2ZWwtcmVlbHMtYW5hbHlzaXMtcnVcIl0sXG4gIFwiaXJpbmEtY29udGVudC1pZGVhdGlvbi1ydVwiOiBbXCJoYXJpdG9uLXZpcmFsLWhvb2tzLXJ1XCIsIFwia29zdHlhLWltYWdlLWdlbmVyYXRpb24tcnVcIl0sXG4gIFwiaGFyaXRvbi12aXJhbC1ob29rcy1ydVwiOiBbXCJrb3N0eWEtaW1hZ2UtZ2VuZXJhdGlvbi1ydVwiLCBcInNldmEtY29udGVudC1yZXB1cnBvc2luZy1ydVwiXSxcbiAgXCJrb3N0eWEtaW1hZ2UtZ2VuZXJhdGlvbi1ydVwiOiBbXCJoYXJpdG9uLXZpcmFsLWhvb2tzLXJ1XCIsIFwiaXJpbmEtY29udGVudC1pZGVhdGlvbi1ydVwiXSxcbiAgXCJzZXZhLWNvbnRlbnQtcmVwdXJwb3NpbmctcnVcIjogW1wiaGFyaXRvbi12aXJhbC1ob29rcy1ydVwiLCBcImtvc3R5YS1pbWFnZS1nZW5lcmF0aW9uLXJ1XCJdLFxuICBcIm1pdHlhLXdvcmtmbG93LWRpYWdyYW0tcnVcIjogW1wia29zdHlhLWltYWdlLWdlbmVyYXRpb24tcnVcIiwgXCJpcmluYS1jb250ZW50LWlkZWF0aW9uLXJ1XCJdLFxuICBcImJvYXJkLWNlby1ydVwiOiBbXCJib2FyZC1jaGFpci1ydVwiXSxcbiAgXCJib2FyZC1jdG8tcnVcIjogW1wiYm9hcmQtY2hhaXItcnVcIl0sXG4gIFwiYm9hcmQtY2ZvLXJ1XCI6IFtcImJvYXJkLWNoYWlyLXJ1XCJdLFxuICBcImJvYXJkLWNoYWlyLXJ1XCI6IFtdXG59O1xuXG5jb25zdCBub3JtYWxpemVMZWFkID0gKGxlYWQpID0+IHtcbiAgaWYgKCFsZWFkIHx8IHR5cGVvZiBsZWFkICE9PSBcIm9iamVjdFwiKSByZXR1cm4gbnVsbDtcbiAgY29uc3QgbGVhZE5hbWUgPVxuICAgIGxlYWQubmFtZSB8fFxuICAgIGxlYWQuY29tcGFueV9uYW1lIHx8XG4gICAgbGVhZC50aXRsZSB8fFxuICAgIGxlYWQubmFtZV9wbGFjZWhvbGRlciB8fFxuICAgIGxlYWQubGVhZF9sYWJlbCB8fFxuICAgIGxlYWQubGluayB8fFxuICAgIGxlYWQudXJsIHx8XG4gICAgXCJMZWFkXCI7XG4gIGNvbnN0IGNvbnRhY3QgPSB7XG4gICAgZW1haWw6IGxlYWQuZW1haWwgfHwgKGxlYWQucHVibGljX2NvbnRhY3RzID8gbGVhZC5wdWJsaWNfY29udGFjdHMuZW1haWwgOiB1bmRlZmluZWQpIHx8IHVuZGVmaW5lZCxcbiAgICBwaG9uZTogbGVhZC5waG9uZSB8fCAobGVhZC5wdWJsaWNfY29udGFjdHMgPyBsZWFkLnB1YmxpY19jb250YWN0cy5waG9uZSA6IHVuZGVmaW5lZCkgfHwgdW5kZWZpbmVkLFxuICAgIHdlYnNpdGU6IGxlYWQud2Vic2l0ZSB8fCBsZWFkLmRvbWFpbiB8fCB1bmRlZmluZWQsXG4gICAgdXJsOiBsZWFkLmxpbmsgfHwgbGVhZC51cmwgfHwgbGVhZC5zb3VyY2VfdXJsIHx8IHVuZGVmaW5lZFxuICB9O1xuICBjb25zdCBzb3VyY2UgPSBsZWFkLnNvdXJjZSB8fCBsZWFkLmNoYW5uZWwgfHwgbGVhZC5zb3VyY2VfdHlwZSB8fCBcIlwiO1xuICByZXR1cm4ge1xuICAgIGxlYWRfbmFtZTogU3RyaW5nKGxlYWROYW1lKSxcbiAgICBkZWR1cGVfa2V5OiBsZWFkLmRlZHVwZV9rZXkgfHwgbGVhZC5kZWR1cGVfa2V5X3JhdyB8fCBcIlwiLFxuICAgIGNvbnRhY3QsXG4gICAgc291cmNlLFxuICAgIHByb29mX3JlZnM6IGxlYWQucHJvb2ZfcmVmcyB8fCB1bmRlZmluZWRcbiAgfTtcbn07XG5cbmNvbnN0IGJ1aWxkTGVhZHNUYWJsZUVudGl0aWVzID0gKGRhdGEpID0+IHtcbiAgY29uc3QgbGlzdCA9XG4gICAgKGRhdGEgJiYgZGF0YS5sZWFkcykgfHxcbiAgICAoZGF0YSAmJiBkYXRhLmNvbXBhbnlfY2FuZGlkYXRlcykgfHxcbiAgICAoZGF0YSAmJiBkYXRhLmhvdF9sZWFkcykgfHxcbiAgICBbXTtcbiAgY29uc3QgbGVhZHMgPSBBcnJheS5pc0FycmF5KGxpc3QpID8gbGlzdC5tYXAobm9ybWFsaXplTGVhZCkuZmlsdGVyKEJvb2xlYW4pIDogW107XG4gIHJldHVybiB7IGxlYWRzIH07XG59O1xuXG5jb25zdCBidWlsZEFjY291bnRDYXJkRW50aXRpZXMgPSAoZGF0YSkgPT4ge1xuICBjb25zdCBjYXJkID0gZGF0YSAmJiBkYXRhLmFjY291bnRfY2FyZCA/IGRhdGEuYWNjb3VudF9jYXJkIDoge307XG4gIGNvbnN0IG1ldGEgPSBkYXRhICYmIGRhdGEubWV0YSA/IGRhdGEubWV0YSA6IHt9O1xuICByZXR1cm4ge1xuICAgIGNvbXBhbnlfbmFtZTogY2FyZC5jb21wYW55X25hbWUgfHwgXCJcIixcbiAgICBkaXNjb3ZlcmVkX2NoYW5uZWxzOiBjYXJkLmRpc2NvdmVyZWRfY2hhbm5lbHMgfHwge30sXG4gICAgaG9va3M6IGNhcmQudG9wX3BlcnNvbmFsaXphdGlvbl9ob29rcyB8fCBbXSxcbiAgICBwYWluczogY2FyZC5wYWluX2h5cG90aGVzZXMgfHwgW10sXG4gICAgcHJvb2ZfaXRlbXM6IEFycmF5LmlzQXJyYXkobWV0YS5wcm9vZl9pdGVtcykgPyBtZXRhLnByb29mX2l0ZW1zIDogW11cbiAgfTtcbn07XG5cbmNvbnN0IGJ1aWxkTWVzc2FnZXNQYWNrRW50aXRpZXMgPSAoZGF0YSwgY2hhbm5lbE92ZXJyaWRlKSA9PiB7XG4gIGlmIChkYXRhICYmIGRhdGEuZG1fcGFjaykge1xuICAgIHJldHVybiB7XG4gICAgICBsZWFkX2xhYmVsOiBkYXRhLmRtX3BhY2subGVhZF9sYWJlbCB8fCBcImxlYWRcIixcbiAgICAgIGNoYW5uZWw6IGRhdGEuZG1fcGFjay5jaGFubmVsIHx8IGNoYW5uZWxPdmVycmlkZSB8fCBcImRtXCIsXG4gICAgICBtZXNzYWdlczogZGF0YS5kbV9wYWNrLm1lc3NhZ2VzIHx8IGRhdGEuZG1fcGFjay52YXJpYW50cyB8fCBbXVxuICAgIH07XG4gIH1cbiAgaWYgKGRhdGEgJiYgZGF0YS5lbWFpbF9zZXF1ZW5jZXMpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbGVhZF9sYWJlbDogXCJsZWFkXCIsXG4gICAgICBjaGFubmVsOiBjaGFubmVsT3ZlcnJpZGUgfHwgXCJlbWFpbFwiLFxuICAgICAgZW1haWxfc2VxdWVuY2VzOiBkYXRhLmVtYWlsX3NlcXVlbmNlc1xuICAgIH07XG4gIH1cbiAgcmV0dXJuIHsgbGVhZF9sYWJlbDogXCJsZWFkXCIsIGNoYW5uZWw6IGNoYW5uZWxPdmVycmlkZSB8fCBcIlwiLCBtZXNzYWdlczogW10gfTtcbn07XG5cbmNvbnN0IGJ1aWxkQ29udGVudFBhY2tFbnRpdGllcyA9IChkYXRhKSA9PiB7XG4gIGlmICghZGF0YSB8fCB0eXBlb2YgZGF0YSAhPT0gXCJvYmplY3RcIikgcmV0dXJuIHt9O1xuICBjb25zdCBlbnRpdGllcyA9IHsgLi4uZGF0YSB9O1xuICBpZiAoZW50aXRpZXMubWV0YSkgZGVsZXRlIGVudGl0aWVzLm1ldGE7XG4gIHJldHVybiBlbnRpdGllcztcbn07XG5cbmNvbnN0IGJ1aWxkQm9hcmRSZXZpZXdFbnRpdGllcyA9IChkYXRhKSA9PiB7XG4gIGNvbnN0IHJldmlldyA9IGRhdGEgJiYgdHlwZW9mIGRhdGEucmV2aWV3ID09PSBcIm9iamVjdFwiID8gZGF0YS5yZXZpZXcgOiB7fTtcbiAgcmV0dXJuIHtcbiAgICByb2xlOiByZXZpZXcucm9sZSB8fCBcIlwiLFxuICAgIGRlY2lzaW9uOlxuICAgICAgcmV2aWV3LmRlY2lzaW9uIHx8XG4gICAgICByZXZpZXcuc3RhbmNlIHx8XG4gICAgICByZXZpZXcucmVjb21tZW5kYXRpb24gfHxcbiAgICAgIHJldmlldy5mZWFzaWJpbGl0eSB8fFxuICAgICAgXCJcIixcbiAgICBzdW1tYXJ5OlxuICAgICAgcmV2aWV3LmZpbmFsX3N1bW1hcnkgfHxcbiAgICAgIHJldmlldy52ZXJkaWN0IHx8XG4gICAgICByZXZpZXcudW5pdF9lY29ub21pY3NfdmlldyB8fFxuICAgICAgXCJcIixcbiAgICByZWZlcmVuY2VzOiByZXZpZXcucmVmZXJlbmNlcyB8fCB7fVxuICB9O1xufTtcblxuY29uc3QgYnVpbGRIYW5kb2ZmID0gKGFnZW50SWQsIGRhdGEpID0+IHtcbiAgY29uc3QgcmVjb21tZW5kZWRfbmV4dF9hZ2VudHMgPSBSRUNPTU1FTkRFRF9ORVhUW2FnZW50SWRdIHx8IFtcImJvcmlzLWJkci1vcGVyYXRvci1ydVwiXTtcblxuICBpZiAoXG4gICAgYWdlbnRJZCA9PT0gXCJwbGF0b25cIiB8fFxuICAgIGFnZW50SWQgPT09IFwicGxhdG9uLXByb3NwZWN0LXJlc2VhcmNoLXJ1XCIgfHxcbiAgICBhZ2VudElkID09PSBcIm1heGltLWxvY2FsLWxlYWRzLXJ1XCIgfHxcbiAgICBhZ2VudElkID09PSBcImZlZG9yLWIyYi1sZWFkcy1ydVwiXG4gICkge1xuICAgIGNvbnN0IHR5cGUgPSBcImxlYWRzX3RhYmxlXCI7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGUsXG4gICAgICB2ZXJzaW9uOiBIQU5ET0ZGX1ZFUlNJT04sXG4gICAgICBlbnRpdGllczogYnVpbGRMZWFkc1RhYmxlRW50aXRpZXMoZGF0YSksXG4gICAgICByZWNvbW1lbmRlZF9uZXh0X2FnZW50cyxcbiAgICAgIGNvbXBhdDogQ09NUEFUX0JZX1RZUEVbdHlwZV0gfHwgW11cbiAgICB9O1xuICB9XG5cbiAgaWYgKGFnZW50SWQgPT09IFwiYXJ0ZW0taG90LWxlYWRzLXJ1XCIpIHtcbiAgICBjb25zdCB0eXBlID0gXCJob3RfbGVhZHNcIjtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZSxcbiAgICAgIHZlcnNpb246IEhBTkRPRkZfVkVSU0lPTixcbiAgICAgIGVudGl0aWVzOiBidWlsZExlYWRzVGFibGVFbnRpdGllcyhkYXRhKSxcbiAgICAgIHJlY29tbWVuZGVkX25leHRfYWdlbnRzLFxuICAgICAgY29tcGF0OiBDT01QQVRfQllfVFlQRVt0eXBlXSB8fCBbXVxuICAgIH07XG4gIH1cblxuICBpZiAoYWdlbnRJZCA9PT0gXCJhbmF0b2x5LWFjY291bnQtcmVzZWFyY2gtcnVcIikge1xuICAgIGNvbnN0IHR5cGUgPSBcImFjY291bnRfY2FyZFwiO1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlLFxuICAgICAgdmVyc2lvbjogSEFORE9GRl9WRVJTSU9OLFxuICAgICAgZW50aXRpZXM6IGJ1aWxkQWNjb3VudENhcmRFbnRpdGllcyhkYXRhKSxcbiAgICAgIHJlY29tbWVuZGVkX25leHRfYWdlbnRzLFxuICAgICAgY29tcGF0OiBDT01QQVRfQllfVFlQRVt0eXBlXSB8fCBbXVxuICAgIH07XG4gIH1cblxuICBpZiAoYWdlbnRJZCA9PT0gXCJsZW9uaWQtb3V0cmVhY2gtZG0tcnVcIikge1xuICAgIGNvbnN0IHR5cGUgPSBcIm1lc3NhZ2VzX3BhY2tcIjtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZSxcbiAgICAgIHZlcnNpb246IEhBTkRPRkZfVkVSU0lPTixcbiAgICAgIGVudGl0aWVzOiBidWlsZE1lc3NhZ2VzUGFja0VudGl0aWVzKGRhdGEsIFwiZG1cIiksXG4gICAgICByZWNvbW1lbmRlZF9uZXh0X2FnZW50cyxcbiAgICAgIGNvbXBhdDogQ09NUEFUX0JZX1RZUEVbdHlwZV0gfHwgW11cbiAgICB9O1xuICB9XG5cbiAgaWYgKGFnZW50SWQgPT09IFwiZW1lbHlhbi1jb2xkLWVtYWlsLXJ1XCIpIHtcbiAgICBjb25zdCB0eXBlID0gXCJtZXNzYWdlc19wYWNrXCI7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGUsXG4gICAgICB2ZXJzaW9uOiBIQU5ET0ZGX1ZFUlNJT04sXG4gICAgICBlbnRpdGllczogYnVpbGRNZXNzYWdlc1BhY2tFbnRpdGllcyhkYXRhLCBcImVtYWlsXCIpLFxuICAgICAgcmVjb21tZW5kZWRfbmV4dF9hZ2VudHMsXG4gICAgICBjb21wYXQ6IENPTVBBVF9CWV9UWVBFW3R5cGVdIHx8IFtdXG4gICAgfTtcbiAgfVxuXG4gIGlmIChhZ2VudElkID09PSBcImJvcmlzLWJkci1vcGVyYXRvci1ydVwiKSB7XG4gICAgY29uc3QgdHlwZSA9IFwiYmRyX3F1ZXVlXCI7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGUsXG4gICAgICB2ZXJzaW9uOiBIQU5ET0ZGX1ZFUlNJT04sXG4gICAgICBlbnRpdGllczogeyByb3dzOiBBcnJheS5pc0FycmF5KGRhdGEuYmRyX3RhYmxlKSA/IGRhdGEuYmRyX3RhYmxlIDogW10gfSxcbiAgICAgIHJlY29tbWVuZGVkX25leHRfYWdlbnRzLFxuICAgICAgY29tcGF0OiBDT01QQVRfQllfVFlQRVt0eXBlXSB8fCBbXVxuICAgIH07XG4gIH1cblxuICBpZiAoYWdlbnRJZCA9PT0gXCJ0aW1vZmV5LWNvbXBldGl0b3ItYW5hbHlzaXMtcnVcIikge1xuICAgIGNvbnN0IHR5cGUgPSBcImNvbnRlbnRfcGFja1wiO1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlLFxuICAgICAgdmVyc2lvbjogSEFORE9GRl9WRVJTSU9OLFxuICAgICAgZW50aXRpZXM6IHtcbiAgICAgICAgY29tcGV0aXRvcnM6IGRhdGEuY29tcGV0aXRvcnMgfHwgW10sXG4gICAgICAgIGNvbXBhcmlzb25fdGFibGU6IGRhdGEuY29tcGFyaXNvbl90YWJsZSB8fCBbXSxcbiAgICAgICAgb2ZmZXJzOiBkYXRhLm9mZmVycyB8fCB7fSxcbiAgICAgICAgd2luX2FuZ2xlczogZGF0YS53aW5fYW5nbGVzIHx8IFtdLFxuICAgICAgICBhZ2VudG9zX3Bvc2l0aW9uaW5nOiBkYXRhLmFnZW50b3NfcG9zaXRpb25pbmcgfHwge31cbiAgICAgIH0sXG4gICAgICByZWNvbW1lbmRlZF9uZXh0X2FnZW50cyxcbiAgICAgIGNvbXBhdDogQ09NUEFUX0JZX1RZUEVbdHlwZV0gfHwgW11cbiAgICB9O1xuICB9XG5cbiAgaWYgKFxuICAgIGFnZW50SWQgPT09IFwiYm9hcmQtY2VvLXJ1XCIgfHxcbiAgICBhZ2VudElkID09PSBcImJvYXJkLWN0by1ydVwiIHx8XG4gICAgYWdlbnRJZCA9PT0gXCJib2FyZC1jZm8tcnVcIiB8fFxuICAgIGFnZW50SWQgPT09IFwiYm9hcmQtY2hhaXItcnVcIlxuICApIHtcbiAgICBjb25zdCB0eXBlID0gXCJib2FyZF9yZXZpZXdcIjtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZSxcbiAgICAgIHZlcnNpb246IEhBTkRPRkZfVkVSU0lPTixcbiAgICAgIGVudGl0aWVzOiBidWlsZEJvYXJkUmV2aWV3RW50aXRpZXMoZGF0YSksXG4gICAgICByZWNvbW1lbmRlZF9uZXh0X2FnZW50cyxcbiAgICAgIGNvbXBhdDogQ09NUEFUX0JZX1RZUEVbdHlwZV0gfHwgW11cbiAgICB9O1xuICB9XG5cbiAgY29uc3QgdHlwZSA9IFwiY29udGVudF9wYWNrXCI7XG4gIHJldHVybiB7XG4gICAgdHlwZSxcbiAgICB2ZXJzaW9uOiBIQU5ET0ZGX1ZFUlNJT04sXG4gICAgZW50aXRpZXM6IGJ1aWxkQ29udGVudFBhY2tFbnRpdGllcyhkYXRhKSxcbiAgICByZWNvbW1lbmRlZF9uZXh0X2FnZW50cyxcbiAgICBjb21wYXQ6IENPTVBBVF9CWV9UWVBFW3R5cGVdIHx8IFtdXG4gIH07XG59O1xuXG5jb25zdCBnZXRIYW5kb2ZmVHlwZUZvckFnZW50ID0gKGFnZW50SWQpID0+IHtcbiAgaWYgKFxuICAgIGFnZW50SWQgPT09IFwicGxhdG9uXCIgfHxcbiAgICBhZ2VudElkID09PSBcInBsYXRvbi1wcm9zcGVjdC1yZXNlYXJjaC1ydVwiIHx8XG4gICAgYWdlbnRJZCA9PT0gXCJtYXhpbS1sb2NhbC1sZWFkcy1ydVwiIHx8XG4gICAgYWdlbnRJZCA9PT0gXCJmZWRvci1iMmItbGVhZHMtcnVcIlxuICApIHtcbiAgICByZXR1cm4gXCJsZWFkc190YWJsZVwiO1xuICB9XG4gIGlmIChhZ2VudElkID09PSBcImFydGVtLWhvdC1sZWFkcy1ydVwiKSByZXR1cm4gXCJob3RfbGVhZHNcIjtcbiAgaWYgKGFnZW50SWQgPT09IFwiYW5hdG9seS1hY2NvdW50LXJlc2VhcmNoLXJ1XCIpIHJldHVybiBcImFjY291bnRfY2FyZFwiO1xuICBpZiAoYWdlbnRJZCA9PT0gXCJsZW9uaWQtb3V0cmVhY2gtZG0tcnVcIikgcmV0dXJuIFwibWVzc2FnZXNfcGFja1wiO1xuICBpZiAoYWdlbnRJZCA9PT0gXCJlbWVseWFuLWNvbGQtZW1haWwtcnVcIikgcmV0dXJuIFwibWVzc2FnZXNfcGFja1wiO1xuICBpZiAoYWdlbnRJZCA9PT0gXCJib3Jpcy1iZHItb3BlcmF0b3ItcnVcIikgcmV0dXJuIFwiYmRyX3F1ZXVlXCI7XG4gIGlmIChhZ2VudElkID09PSBcInRpbW9mZXktY29tcGV0aXRvci1hbmFseXNpcy1ydVwiKSByZXR1cm4gXCJjb250ZW50X3BhY2tcIjtcbiAgaWYgKFxuICAgIGFnZW50SWQgPT09IFwiYm9hcmQtY2VvLXJ1XCIgfHxcbiAgICBhZ2VudElkID09PSBcImJvYXJkLWN0by1ydVwiIHx8XG4gICAgYWdlbnRJZCA9PT0gXCJib2FyZC1jZm8tcnVcIiB8fFxuICAgIGFnZW50SWQgPT09IFwiYm9hcmQtY2hhaXItcnVcIlxuICApIHtcbiAgICByZXR1cm4gXCJib2FyZF9yZXZpZXdcIjtcbiAgfVxuICByZXR1cm4gXCJjb250ZW50X3BhY2tcIjtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0geyBidWlsZEhhbmRvZmYsIEhBTkRPRkZfVkVSU0lPTiwgQ09NUEFUX0JZX1RZUEUsIGdldEhhbmRvZmZUeXBlRm9yQWdlbnQgfTtcbiJdLCJuYW1lcyI6WyJIQU5ET0ZGX1ZFUlNJT04iLCJDT01QQVRfQllfVFlQRSIsImxlYWRzX3RhYmxlIiwiYWNjb3VudF9jYXJkIiwiaG90X2xlYWRzIiwibWVzc2FnZXNfcGFjayIsImJkcl9xdWV1ZSIsImJvYXJkX3JldmlldyIsImNvbnRlbnRfcGFjayIsIlJFQ09NTUVOREVEX05FWFQiLCJwbGF0b24iLCJub3JtYWxpemVMZWFkIiwibGVhZCIsImxlYWROYW1lIiwibmFtZSIsImNvbXBhbnlfbmFtZSIsInRpdGxlIiwibmFtZV9wbGFjZWhvbGRlciIsImxlYWRfbGFiZWwiLCJsaW5rIiwidXJsIiwiY29udGFjdCIsImVtYWlsIiwicHVibGljX2NvbnRhY3RzIiwidW5kZWZpbmVkIiwicGhvbmUiLCJ3ZWJzaXRlIiwiZG9tYWluIiwic291cmNlX3VybCIsInNvdXJjZSIsImNoYW5uZWwiLCJzb3VyY2VfdHlwZSIsImxlYWRfbmFtZSIsIlN0cmluZyIsImRlZHVwZV9rZXkiLCJkZWR1cGVfa2V5X3JhdyIsInByb29mX3JlZnMiLCJidWlsZExlYWRzVGFibGVFbnRpdGllcyIsImRhdGEiLCJsaXN0IiwibGVhZHMiLCJjb21wYW55X2NhbmRpZGF0ZXMiLCJBcnJheSIsImlzQXJyYXkiLCJtYXAiLCJmaWx0ZXIiLCJCb29sZWFuIiwiYnVpbGRBY2NvdW50Q2FyZEVudGl0aWVzIiwiY2FyZCIsIm1ldGEiLCJkaXNjb3ZlcmVkX2NoYW5uZWxzIiwiaG9va3MiLCJ0b3BfcGVyc29uYWxpemF0aW9uX2hvb2tzIiwicGFpbnMiLCJwYWluX2h5cG90aGVzZXMiLCJwcm9vZl9pdGVtcyIsImJ1aWxkTWVzc2FnZXNQYWNrRW50aXRpZXMiLCJjaGFubmVsT3ZlcnJpZGUiLCJkbV9wYWNrIiwibWVzc2FnZXMiLCJ2YXJpYW50cyIsImVtYWlsX3NlcXVlbmNlcyIsImJ1aWxkQ29udGVudFBhY2tFbnRpdGllcyIsImVudGl0aWVzIiwiYnVpbGRCb2FyZFJldmlld0VudGl0aWVzIiwicmV2aWV3Iiwicm9sZSIsImRlY2lzaW9uIiwic3RhbmNlIiwicmVjb21tZW5kYXRpb24iLCJmZWFzaWJpbGl0eSIsInN1bW1hcnkiLCJmaW5hbF9zdW1tYXJ5IiwidmVyZGljdCIsInVuaXRfZWNvbm9taWNzX3ZpZXciLCJyZWZlcmVuY2VzIiwiYnVpbGRIYW5kb2ZmIiwiYWdlbnRJZCIsInJlY29tbWVuZGVkX25leHRfYWdlbnRzIiwidHlwZSIsInZlcnNpb24iLCJjb21wYXQiLCJyb3dzIiwiYmRyX3RhYmxlIiwiY29tcGV0aXRvcnMiLCJjb21wYXJpc29uX3RhYmxlIiwib2ZmZXJzIiwid2luX2FuZ2xlcyIsImFnZW50b3NfcG9zaXRpb25pbmciLCJnZXRIYW5kb2ZmVHlwZUZvckFnZW50IiwibW9kdWxlIiwiZXhwb3J0cyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./utils/handoff.js\n");

/***/ }),

/***/ "(rsc)/./utils/validateAgentResponse.js":
/*!****************************************!*\
  !*** ./utils/validateAgentResponse.js ***!
  \****************************************/
/***/ ((module) => {

eval("\nconst isObject = (value)=>typeof value === \"object\" && value !== null && !Array.isArray(value);\nconst isType = (value, type)=>{\n    if (type === \"array\") return Array.isArray(value);\n    if (type === \"object\") return isObject(value);\n    if (type === \"string\") return typeof value === \"string\";\n    if (type === \"number\") return typeof value === \"number\" && Number.isFinite(value);\n    if (type === \"boolean\") return typeof value === \"boolean\";\n    return value !== undefined;\n};\nconst validateAgentResponse = (data, schema)=>{\n    const errors = [];\n    if (!isObject(data)) {\n        return {\n            ok: false,\n            errors: [\n                \"data must be an object\"\n            ]\n        };\n    }\n    if (!schema || !schema.required) return {\n        ok: true,\n        errors\n    };\n    const required = schema.required || {};\n    Object.entries(required).forEach(([key, type])=>{\n        if (!(key in data)) {\n            errors.push(`missing key: ${key}`);\n            return;\n        }\n        if (type && !isType(data[key], type)) {\n            errors.push(`invalid type for ${key}: expected ${type}`);\n        }\n    });\n    return {\n        ok: errors.length === 0,\n        errors\n    };\n};\nmodule.exports = {\n    validateAgentResponse\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi91dGlscy92YWxpZGF0ZUFnZW50UmVzcG9uc2UuanMiLCJtYXBwaW5ncyI6IjtBQUFBLE1BQU1BLFdBQVcsQ0FBQ0MsUUFBVSxPQUFPQSxVQUFVLFlBQVlBLFVBQVUsUUFBUSxDQUFDQyxNQUFNQyxPQUFPLENBQUNGO0FBRTFGLE1BQU1HLFNBQVMsQ0FBQ0gsT0FBT0k7SUFDckIsSUFBSUEsU0FBUyxTQUFTLE9BQU9ILE1BQU1DLE9BQU8sQ0FBQ0Y7SUFDM0MsSUFBSUksU0FBUyxVQUFVLE9BQU9MLFNBQVNDO0lBQ3ZDLElBQUlJLFNBQVMsVUFBVSxPQUFPLE9BQU9KLFVBQVU7SUFDL0MsSUFBSUksU0FBUyxVQUFVLE9BQU8sT0FBT0osVUFBVSxZQUFZSyxPQUFPQyxRQUFRLENBQUNOO0lBQzNFLElBQUlJLFNBQVMsV0FBVyxPQUFPLE9BQU9KLFVBQVU7SUFDaEQsT0FBT0EsVUFBVU87QUFDbkI7QUFFQSxNQUFNQyx3QkFBd0IsQ0FBQ0MsTUFBTUM7SUFDbkMsTUFBTUMsU0FBUyxFQUFFO0lBQ2pCLElBQUksQ0FBQ1osU0FBU1UsT0FBTztRQUNuQixPQUFPO1lBQUVHLElBQUk7WUFBT0QsUUFBUTtnQkFBQzthQUF5QjtRQUFDO0lBQ3pEO0lBQ0EsSUFBSSxDQUFDRCxVQUFVLENBQUNBLE9BQU9HLFFBQVEsRUFBRSxPQUFPO1FBQUVELElBQUk7UUFBTUQ7SUFBTztJQUMzRCxNQUFNRSxXQUFXSCxPQUFPRyxRQUFRLElBQUksQ0FBQztJQUNyQ0MsT0FBT0MsT0FBTyxDQUFDRixVQUFVRyxPQUFPLENBQUMsQ0FBQyxDQUFDQyxLQUFLYixLQUFLO1FBQzNDLElBQUksQ0FBRWEsQ0FBQUEsT0FBT1IsSUFBRyxHQUFJO1lBQ2xCRSxPQUFPTyxJQUFJLENBQUMsQ0FBQyxhQUFhLEVBQUVELEtBQUs7WUFDakM7UUFDRjtRQUNBLElBQUliLFFBQVEsQ0FBQ0QsT0FBT00sSUFBSSxDQUFDUSxJQUFJLEVBQUViLE9BQU87WUFDcENPLE9BQU9PLElBQUksQ0FBQyxDQUFDLGlCQUFpQixFQUFFRCxJQUFJLFdBQVcsRUFBRWIsTUFBTTtRQUN6RDtJQUNGO0lBQ0EsT0FBTztRQUFFUSxJQUFJRCxPQUFPUSxNQUFNLEtBQUs7UUFBR1I7SUFBTztBQUMzQztBQUVBUyxPQUFPQyxPQUFPLEdBQUc7SUFBRWI7QUFBc0IiLCJzb3VyY2VzIjpbIi9Vc2Vycy9hYnV6YWRhL0Rlc2t0b3AvYWdlbnRPUy91dGlscy92YWxpZGF0ZUFnZW50UmVzcG9uc2UuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgaXNPYmplY3QgPSAodmFsdWUpID0+IHR5cGVvZiB2YWx1ZSA9PT0gXCJvYmplY3RcIiAmJiB2YWx1ZSAhPT0gbnVsbCAmJiAhQXJyYXkuaXNBcnJheSh2YWx1ZSk7XG5cbmNvbnN0IGlzVHlwZSA9ICh2YWx1ZSwgdHlwZSkgPT4ge1xuICBpZiAodHlwZSA9PT0gXCJhcnJheVwiKSByZXR1cm4gQXJyYXkuaXNBcnJheSh2YWx1ZSk7XG4gIGlmICh0eXBlID09PSBcIm9iamVjdFwiKSByZXR1cm4gaXNPYmplY3QodmFsdWUpO1xuICBpZiAodHlwZSA9PT0gXCJzdHJpbmdcIikgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIjtcbiAgaWYgKHR5cGUgPT09IFwibnVtYmVyXCIpIHJldHVybiB0eXBlb2YgdmFsdWUgPT09IFwibnVtYmVyXCIgJiYgTnVtYmVyLmlzRmluaXRlKHZhbHVlKTtcbiAgaWYgKHR5cGUgPT09IFwiYm9vbGVhblwiKSByZXR1cm4gdHlwZW9mIHZhbHVlID09PSBcImJvb2xlYW5cIjtcbiAgcmV0dXJuIHZhbHVlICE9PSB1bmRlZmluZWQ7XG59O1xuXG5jb25zdCB2YWxpZGF0ZUFnZW50UmVzcG9uc2UgPSAoZGF0YSwgc2NoZW1hKSA9PiB7XG4gIGNvbnN0IGVycm9ycyA9IFtdO1xuICBpZiAoIWlzT2JqZWN0KGRhdGEpKSB7XG4gICAgcmV0dXJuIHsgb2s6IGZhbHNlLCBlcnJvcnM6IFtcImRhdGEgbXVzdCBiZSBhbiBvYmplY3RcIl0gfTtcbiAgfVxuICBpZiAoIXNjaGVtYSB8fCAhc2NoZW1hLnJlcXVpcmVkKSByZXR1cm4geyBvazogdHJ1ZSwgZXJyb3JzIH07XG4gIGNvbnN0IHJlcXVpcmVkID0gc2NoZW1hLnJlcXVpcmVkIHx8IHt9O1xuICBPYmplY3QuZW50cmllcyhyZXF1aXJlZCkuZm9yRWFjaCgoW2tleSwgdHlwZV0pID0+IHtcbiAgICBpZiAoIShrZXkgaW4gZGF0YSkpIHtcbiAgICAgIGVycm9ycy5wdXNoKGBtaXNzaW5nIGtleTogJHtrZXl9YCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICh0eXBlICYmICFpc1R5cGUoZGF0YVtrZXldLCB0eXBlKSkge1xuICAgICAgZXJyb3JzLnB1c2goYGludmFsaWQgdHlwZSBmb3IgJHtrZXl9OiBleHBlY3RlZCAke3R5cGV9YCk7XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIHsgb2s6IGVycm9ycy5sZW5ndGggPT09IDAsIGVycm9ycyB9O1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSB7IHZhbGlkYXRlQWdlbnRSZXNwb25zZSB9O1xuIl0sIm5hbWVzIjpbImlzT2JqZWN0IiwidmFsdWUiLCJBcnJheSIsImlzQXJyYXkiLCJpc1R5cGUiLCJ0eXBlIiwiTnVtYmVyIiwiaXNGaW5pdGUiLCJ1bmRlZmluZWQiLCJ2YWxpZGF0ZUFnZW50UmVzcG9uc2UiLCJkYXRhIiwic2NoZW1hIiwiZXJyb3JzIiwib2siLCJyZXF1aXJlZCIsIk9iamVjdCIsImVudHJpZXMiLCJmb3JFYWNoIiwia2V5IiwicHVzaCIsImxlbmd0aCIsIm1vZHVsZSIsImV4cG9ydHMiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./utils/validateAgentResponse.js\n");

/***/ })

};
;